(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{290:function(module,exports,__webpack_require__){(function(global){var require,require,f;f=function(){var define,module,exports;return function e(t,n,r){function o(i,l){if(!n[i]){if(!t[i]){if(!l&&"function"==typeof require&&require)return require(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};t[i][0].call(p.exports,(function(e){return o(t[i][1][e]||e)}),p,p.exports,e,t,n,r)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){"use strict";t.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,o=2,l=!0;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,c){n[r]=function(e){if(l)if(l=!1,e)c(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){l&&(l=!1,c(e))}}))}},{}],2:[function(e,t,n){"use strict";var r=n;r.length=function(e){var p=e.length;if(!p)return 0;for(var t=0;--p%4>1&&"="===e.charAt(p);)++t;return Math.ceil(3*e.length)/4-t};for(var o=new Array(64),l=new Array(123),i=0;i<64;)l[o[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(e,t,n){for(var r,l=null,c=[],i=0,f=0;t<n;){var b=e[t++];switch(f){case 0:c[i++]=o[b>>2],r=(3&b)<<4,f=1;break;case 1:c[i++]=o[r|b>>4],r=(15&b)<<2,f=2;break;case 2:c[i++]=o[r|b>>6],c[i++]=o[63&b],f=0}i>8191&&((l||(l=[])).push(String.fromCharCode.apply(String,c)),i=0)}return f&&(c[i++]=o[r],c[i++]=61,1===f&&(c[i++]=61)),l?(i&&l.push(String.fromCharCode.apply(String,c.slice(0,i))),l.join("")):String.fromCharCode.apply(String,c.slice(0,i))},r.decode=function(e,t,n){for(var r,o=n,c=0,i=0;i<e.length;){var f=e.charCodeAt(i++);if(61===f&&c>1)break;if(void 0===(f=l[f]))throw Error("invalid encoding");switch(c){case 0:r=f,c=1;break;case 1:t[n++]=r<<2|(48&f)>>4,r=f,c=2;break;case 2:t[n++]=(15&r)<<4|(60&f)>>2,r=f,c=3;break;case 3:t[n++]=(3&r)<<6|f,c=0}}if(1===c)throw Error("invalid encoding");return n-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,n){"use strict";function r(){this._listeners={}}t.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},{}],4:[function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function l(e,r,o){t[0]=e,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function c(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function f(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?o:l,e.writeFloatBE=r?l:o,e.readFloatLE=r?c:f,e.readFloatBE=r?f:c}():function(){function t(e,t,n,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var l=Math.floor(Math.log(t)/Math.LN2);e((o<<31|l+127<<23|8388607&Math.round(t*Math.pow(2,-l)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),o=2*(r>>31)+1,l=r>>>23&255,c=8388607&r;return 255===l?c?NaN:o*(1/0):0===l?1401298464324817e-60*o*c:o*Math.pow(2,l-150)*(c+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,l),e.readFloatLE=n.bind(null,c),e.readFloatBE=n.bind(null,f)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function l(e,r,o){t[0]=e,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function c(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function f(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:l,e.writeDoubleBE=r?l:o,e.readDoubleLE=r?c:f,e.readDoubleBE=r?f:c}():function(){function t(e,t,n,r,o,l){var c=r<0?1:0;if(c&&(r=-r),0===r)e(0,o,l+t),e(1/r>0?0:2147483648,o,l+n);else if(isNaN(r))e(0,o,l+t),e(2146959360,o,l+n);else if(r>17976931348623157e292)e(0,o,l+t),e((c<<31|2146435072)>>>0,o,l+n);else{var f;if(r<22250738585072014e-324)e((f=r/5e-324)>>>0,o,l+t),e((c<<31|f/4294967296)>>>0,o,l+n);else{var h=Math.floor(Math.log(r)/Math.LN2);1024===h&&(h=1023),e(4503599627370496*(f=r*Math.pow(2,-h))>>>0,o,l+t),e((c<<31|h+1023<<20|1048576*f&1048575)>>>0,o,l+n)}}}function n(e,t,n,r,o){var l=e(r,o+t),c=e(r,o+n),f=2*(c>>31)+1,h=c>>>20&2047,d=4294967296*(1048575&c)+l;return 2047===h?d?NaN:f*(1/0):0===h?5e-324*f*d:f*Math.pow(2,h-1075)*(d+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,l,4,0),e.readDoubleLE=n.bind(null,c,0,4),e.readDoubleBE=n.bind(null,f,4,0)}(),e}function o(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function l(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function c(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function f(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=r(r)},{}],5:[function(require,module,exports){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],6:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=n||8192,o=r>>>1,l=null,c=r;return function(n){if(n<1||n>o)return e(n);c+n>r&&(l=e(r),c=0);var f=t.call(l,c,c+=n);return 7&c&&(c=1+(7|c)),f}}},{}],7:[function(e,t,n){"use strict";var r=n;r.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,l=[],i=0;t<n;)(r=e[t++])<128?l[i++]=r:r>191&&r<224?l[i++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,l[i++]=55296+(r>>10),l[i++]=56320+(1023&r)):l[i++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],i>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,l)),i=0);return o?(i&&o.push(String.fromCharCode.apply(String,l.slice(0,i))),o.join("")):String.fromCharCode.apply(String,l.slice(0,i))},r.write=function(e,t,n){for(var r,o,l=n,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(i+1)))?(r=65536+((1023&r)<<10)+(1023&o),++i,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-l}},{}],8:[function(e,t,n){"use strict";var r,o,l,c=e("protobufjs/minimal"),f=c.Reader,h=c.util,d=c.roots.default||(c.roots.default={});d.tensorflow=((l={}).Any=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.typeUrl="",e.prototype.value=h.newBuffer([]),e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.Any;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.typeUrl=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),l.DataType=(r={},(o=Object.create(r))[r[0]="DT_INVALID"]=0,o[r[1]="DT_FLOAT"]=1,o[r[2]="DT_DOUBLE"]=2,o[r[3]="DT_INT32"]=3,o[r[4]="DT_UINT8"]=4,o[r[5]="DT_INT16"]=5,o[r[6]="DT_INT8"]=6,o[r[7]="DT_STRING"]=7,o[r[8]="DT_COMPLEX64"]=8,o[r[9]="DT_INT64"]=9,o[r[10]="DT_BOOL"]=10,o[r[11]="DT_QINT8"]=11,o[r[12]="DT_QUINT8"]=12,o[r[13]="DT_QINT32"]=13,o[r[14]="DT_BFLOAT16"]=14,o[r[101]="DT_FLOAT_REF"]=101,o[r[102]="DT_DOUBLE_REF"]=102,o[r[103]="DT_INT32_REF"]=103,o[r[104]="DT_UINT8_REF"]=104,o[r[105]="DT_INT16_REF"]=105,o[r[106]="DT_INT8_REF"]=106,o[r[107]="DT_STRING_REF"]=107,o[r[108]="DT_COMPLEX64_REF"]=108,o[r[109]="DT_INT64_REF"]=109,o[r[110]="DT_BOOL_REF"]=110,o[r[111]="DT_QINT8_REF"]=111,o[r[112]="DT_QUINT8_REF"]=112,o[r[113]="DT_QINT32_REF"]=113,o[r[114]="DT_BFLOAT16_REF"]=114,o),l.TensorShape=function(){function e(p){if(this.dim=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.dim=h.emptyArray,e.prototype.unknownRank=!1,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.TensorShape;e.pos<n;){var o=e.uint32();switch(o>>>3){case 2:r.dim&&r.dim.length||(r.dim=[]),r.dim.push(d.tensorflow.TensorShape.Dim.decode(e,e.uint32()));break;case 3:r.unknownRank=e.bool();break;default:e.skipType(7&o)}}return r},e.Dim=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.size=h.Long?h.Long.fromBits(0,0,!1):0,e.prototype.name="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.TensorShape.Dim;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.size=e.int64();break;case 2:r.name=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),l.Tensor=function(){function e(p){if(this.floatVal=[],this.doubleVal=[],this.intVal=[],this.stringVal=[],this.scomplexVal=[],this.int64Val=[],this.boolVal=[],this.uint32Val=[],this.uint64Val=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.dtype=0,e.prototype.tensorShape=null,e.prototype.versionNumber=0,e.prototype.tensorContent=h.newBuffer([]),e.prototype.floatVal=h.emptyArray,e.prototype.doubleVal=h.emptyArray,e.prototype.intVal=h.emptyArray,e.prototype.stringVal=h.emptyArray,e.prototype.scomplexVal=h.emptyArray,e.prototype.int64Val=h.emptyArray,e.prototype.boolVal=h.emptyArray,e.prototype.uint32Val=h.emptyArray,e.prototype.uint64Val=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.Tensor;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.dtype=e.int32();break;case 2:r.tensorShape=d.tensorflow.TensorShape.decode(e,e.uint32());break;case 3:r.versionNumber=e.int32();break;case 4:r.tensorContent=e.bytes();break;case 5:if(r.floatVal&&r.floatVal.length||(r.floatVal=[]),2==(7&o))for(var l=e.uint32()+e.pos;e.pos<l;)r.floatVal.push(e.float());else r.floatVal.push(e.float());break;case 6:if(r.doubleVal&&r.doubleVal.length||(r.doubleVal=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.doubleVal.push(e.double());else r.doubleVal.push(e.double());break;case 7:if(r.intVal&&r.intVal.length||(r.intVal=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.intVal.push(e.int32());else r.intVal.push(e.int32());break;case 8:r.stringVal&&r.stringVal.length||(r.stringVal=[]),r.stringVal.push(e.bytes());break;case 9:if(r.scomplexVal&&r.scomplexVal.length||(r.scomplexVal=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.scomplexVal.push(e.float());else r.scomplexVal.push(e.float());break;case 10:if(r.int64Val&&r.int64Val.length||(r.int64Val=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.int64Val.push(e.int64());else r.int64Val.push(e.int64());break;case 11:if(r.boolVal&&r.boolVal.length||(r.boolVal=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.boolVal.push(e.bool());else r.boolVal.push(e.bool());break;case 16:if(r.uint32Val&&r.uint32Val.length||(r.uint32Val=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.uint32Val.push(e.uint32());else r.uint32Val.push(e.uint32());break;case 17:if(r.uint64Val&&r.uint64Val.length||(r.uint64Val=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.uint64Val.push(e.uint64());else r.uint64Val.push(e.uint64());break;default:e.skipType(7&o)}}return r},e}(),l.AttrValue=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}var t;return e.prototype.list=null,e.prototype.s=h.newBuffer([]),e.prototype.i=h.Long?h.Long.fromBits(0,0,!1):0,e.prototype.f=0,e.prototype.b=!1,e.prototype.type=0,e.prototype.shape=null,e.prototype.tensor=null,e.prototype.placeholder="",e.prototype.func=null,Object.defineProperty(e.prototype,"value",{get:h.oneOfGetter(t=["list","s","i","f","b","type","shape","tensor","placeholder","func"]),set:h.oneOfSetter(t)}),e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.AttrValue;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.list=d.tensorflow.AttrValue.ListValue.decode(e,e.uint32());break;case 2:r.s=e.bytes();break;case 3:r.i=e.int64();break;case 4:r.f=e.float();break;case 5:r.b=e.bool();break;case 6:r.type=e.int32();break;case 7:r.shape=d.tensorflow.TensorShape.decode(e,e.uint32());break;case 8:r.tensor=d.tensorflow.Tensor.decode(e,e.uint32());break;case 9:r.placeholder=e.string();break;case 10:r.func=d.tensorflow.NameAttrList.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.ListValue=function(){function e(p){if(this.s=[],this.i=[],this.f=[],this.b=[],this.type=[],this.shape=[],this.tensor=[],this.func=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.s=h.emptyArray,e.prototype.i=h.emptyArray,e.prototype.f=h.emptyArray,e.prototype.b=h.emptyArray,e.prototype.type=h.emptyArray,e.prototype.shape=h.emptyArray,e.prototype.tensor=h.emptyArray,e.prototype.func=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.AttrValue.ListValue;e.pos<n;){var o=e.uint32();switch(o>>>3){case 2:r.s&&r.s.length||(r.s=[]),r.s.push(e.bytes());break;case 3:if(r.i&&r.i.length||(r.i=[]),2==(7&o))for(var l=e.uint32()+e.pos;e.pos<l;)r.i.push(e.int64());else r.i.push(e.int64());break;case 4:if(r.f&&r.f.length||(r.f=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.f.push(e.float());else r.f.push(e.float());break;case 5:if(r.b&&r.b.length||(r.b=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.b.push(e.bool());else r.b.push(e.bool());break;case 6:if(r.type&&r.type.length||(r.type=[]),2==(7&o))for(l=e.uint32()+e.pos;e.pos<l;)r.type.push(e.int32());else r.type.push(e.int32());break;case 7:r.shape&&r.shape.length||(r.shape=[]),r.shape.push(d.tensorflow.TensorShape.decode(e,e.uint32()));break;case 8:r.tensor&&r.tensor.length||(r.tensor=[]),r.tensor.push(d.tensorflow.Tensor.decode(e,e.uint32()));break;case 9:r.func&&r.func.length||(r.func=[]),r.func.push(d.tensorflow.NameAttrList.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),e}(),l.NameAttrList=function(){function e(p){if(this.attr={},p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.name="",e.prototype.attr=h.emptyObject,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new d.tensorflow.NameAttrList;e.pos<r;){var l=e.uint32();switch(l>>>3){case 1:o.name=e.string();break;case 2:e.skip().pos++,o.attr===h.emptyObject&&(o.attr={}),n=e.string(),e.pos++,o.attr[n]=d.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&l)}}return o},e}(),l.NodeDef=function(){function e(p){if(this.input=[],this.attr={},p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.name="",e.prototype.op="",e.prototype.input=h.emptyArray,e.prototype.device="",e.prototype.attr=h.emptyObject,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new d.tensorflow.NodeDef;e.pos<r;){var l=e.uint32();switch(l>>>3){case 1:o.name=e.string();break;case 2:o.op=e.string();break;case 3:o.input&&o.input.length||(o.input=[]),o.input.push(e.string());break;case 4:o.device=e.string();break;case 5:e.skip().pos++,o.attr===h.emptyObject&&(o.attr={}),n=e.string(),e.pos++,o.attr[n]=d.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&l)}}return o},e}(),l.VersionDef=function(){function e(p){if(this.badConsumers=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.producer=0,e.prototype.minConsumer=0,e.prototype.badConsumers=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.VersionDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.producer=e.int32();break;case 2:r.minConsumer=e.int32();break;case 3:if(r.badConsumers&&r.badConsumers.length||(r.badConsumers=[]),2==(7&o))for(var l=e.uint32()+e.pos;e.pos<l;)r.badConsumers.push(e.int32());else r.badConsumers.push(e.int32());break;default:e.skipType(7&o)}}return r},e}(),l.GraphDef=function(){function e(p){if(this.node=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.node=h.emptyArray,e.prototype.versions=null,e.prototype.library=null,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.GraphDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.node&&r.node.length||(r.node=[]),r.node.push(d.tensorflow.NodeDef.decode(e,e.uint32()));break;case 4:r.versions=d.tensorflow.VersionDef.decode(e,e.uint32());break;case 2:r.library=d.tensorflow.FunctionDefLibrary.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),l.CollectionDef=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}var t;return e.prototype.nodeList=null,e.prototype.bytesList=null,e.prototype.int64List=null,e.prototype.floatList=null,e.prototype.anyList=null,Object.defineProperty(e.prototype,"kind",{get:h.oneOfGetter(t=["nodeList","bytesList","int64List","floatList","anyList"]),set:h.oneOfSetter(t)}),e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.CollectionDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.nodeList=d.tensorflow.CollectionDef.NodeList.decode(e,e.uint32());break;case 2:r.bytesList=d.tensorflow.CollectionDef.BytesList.decode(e,e.uint32());break;case 3:r.int64List=d.tensorflow.CollectionDef.Int64List.decode(e,e.uint32());break;case 4:r.floatList=d.tensorflow.CollectionDef.FloatList.decode(e,e.uint32());break;case 5:r.anyList=d.tensorflow.CollectionDef.AnyList.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.NodeList=function(){function e(p){if(this.value=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.value=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.CollectionDef.NodeList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(e.string());break;default:e.skipType(7&o)}}return r},e}(),e.BytesList=function(){function e(p){if(this.value=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.value=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.CollectionDef.BytesList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(e.bytes());break;default:e.skipType(7&o)}}return r},e}(),e.Int64List=function(){function e(p){if(this.value=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.value=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.CollectionDef.Int64List;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:if(r.value&&r.value.length||(r.value=[]),2==(7&o))for(var l=e.uint32()+e.pos;e.pos<l;)r.value.push(e.int64());else r.value.push(e.int64());break;default:e.skipType(7&o)}}return r},e}(),e.FloatList=function(){function e(p){if(this.value=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.value=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.CollectionDef.FloatList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:if(r.value&&r.value.length||(r.value=[]),2==(7&o))for(var l=e.uint32()+e.pos;e.pos<l;)r.value.push(e.float());else r.value.push(e.float());break;default:e.skipType(7&o)}}return r},e}(),e.AnyList=function(){function e(p){if(this.value=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.value=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.CollectionDef.AnyList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.value&&r.value.length||(r.value=[]),r.value.push(d.tensorflow.Any.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),e}(),l.SaverDef=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.filenameTensorName="",e.prototype.saveTensorName="",e.prototype.restoreOpName="",e.prototype.maxToKeep=0,e.prototype.sharded=!1,e.prototype.keepCheckpointEveryNHours=0,e.prototype.version=0,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.SaverDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.filenameTensorName=e.string();break;case 2:r.saveTensorName=e.string();break;case 3:r.restoreOpName=e.string();break;case 4:r.maxToKeep=e.int32();break;case 5:r.sharded=e.bool();break;case 6:r.keepCheckpointEveryNHours=e.float();break;case 7:r.version=e.int32();break;default:e.skipType(7&o)}}return r},e.CheckpointFormatVersion=function(){var e={},t=Object.create(e);return t[e[0]="LEGACY"]=0,t[e[1]="V1"]=1,t[e[2]="V2"]=2,t}(),e}(),l.TensorInfo=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}var t;return e.prototype.name="",e.prototype.cooSparse=null,e.prototype.dtype=0,e.prototype.tensorShape=null,Object.defineProperty(e.prototype,"encoding",{get:h.oneOfGetter(t=["name","cooSparse"]),set:h.oneOfSetter(t)}),e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.TensorInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 4:r.cooSparse=d.tensorflow.TensorInfo.CooSparse.decode(e,e.uint32());break;case 2:r.dtype=e.int32();break;case 3:r.tensorShape=d.tensorflow.TensorShape.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.CooSparse=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.valuesTensorName="",e.prototype.indicesTensorName="",e.prototype.denseShapeTensorName="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.TensorInfo.CooSparse;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.valuesTensorName=e.string();break;case 2:r.indicesTensorName=e.string();break;case 3:r.denseShapeTensorName=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),l.SignatureDef=function(){function e(p){if(this.inputs={},this.outputs={},p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.inputs=h.emptyObject,e.prototype.outputs=h.emptyObject,e.prototype.methodName="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new d.tensorflow.SignatureDef;e.pos<r;){var l=e.uint32();switch(l>>>3){case 1:e.skip().pos++,o.inputs===h.emptyObject&&(o.inputs={}),n=e.string(),e.pos++,o.inputs[n]=d.tensorflow.TensorInfo.decode(e,e.uint32());break;case 2:e.skip().pos++,o.outputs===h.emptyObject&&(o.outputs={}),n=e.string(),e.pos++,o.outputs[n]=d.tensorflow.TensorInfo.decode(e,e.uint32());break;case 3:o.methodName=e.string();break;default:e.skipType(7&l)}}return o},e}(),l.AssetFileDef=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.tensorInfo=null,e.prototype.filename="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.AssetFileDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.tensorInfo=d.tensorflow.TensorInfo.decode(e,e.uint32());break;case 2:r.filename=e.string();break;default:e.skipType(7&o)}}return r},e}(),l.OpDef=function(){function e(p){if(this.inputArg=[],this.outputArg=[],this.attr=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.name="",e.prototype.inputArg=h.emptyArray,e.prototype.outputArg=h.emptyArray,e.prototype.attr=h.emptyArray,e.prototype.deprecation=null,e.prototype.summary="",e.prototype.description="",e.prototype.isCommutative=!1,e.prototype.isAggregate=!1,e.prototype.isStateful=!1,e.prototype.allowsUninitializedInput=!1,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.OpDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 2:r.inputArg&&r.inputArg.length||(r.inputArg=[]),r.inputArg.push(d.tensorflow.OpDef.ArgDef.decode(e,e.uint32()));break;case 3:r.outputArg&&r.outputArg.length||(r.outputArg=[]),r.outputArg.push(d.tensorflow.OpDef.ArgDef.decode(e,e.uint32()));break;case 4:r.attr&&r.attr.length||(r.attr=[]),r.attr.push(d.tensorflow.OpDef.AttrDef.decode(e,e.uint32()));break;case 8:r.deprecation=d.tensorflow.OpDef.OpDeprecation.decode(e,e.uint32());break;case 5:r.summary=e.string();break;case 6:r.description=e.string();break;case 18:r.isCommutative=e.bool();break;case 16:r.isAggregate=e.bool();break;case 17:r.isStateful=e.bool();break;case 19:r.allowsUninitializedInput=e.bool();break;default:e.skipType(7&o)}}return r},e.ArgDef=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.name="",e.prototype.description="",e.prototype.type=0,e.prototype.typeAttr="",e.prototype.numberAttr="",e.prototype.typeListAttr="",e.prototype.isRef=!1,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.OpDef.ArgDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 2:r.description=e.string();break;case 3:r.type=e.int32();break;case 4:r.typeAttr=e.string();break;case 5:r.numberAttr=e.string();break;case 6:r.typeListAttr=e.string();break;case 16:r.isRef=e.bool();break;default:e.skipType(7&o)}}return r},e}(),e.AttrDef=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.name="",e.prototype.type="",e.prototype.defaultValue=null,e.prototype.description="",e.prototype.hasMinimum=!1,e.prototype.minimum=h.Long?h.Long.fromBits(0,0,!1):0,e.prototype.allowedValues=null,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.OpDef.AttrDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.name=e.string();break;case 2:r.type=e.string();break;case 3:r.defaultValue=d.tensorflow.AttrValue.decode(e,e.uint32());break;case 4:r.description=e.string();break;case 5:r.hasMinimum=e.bool();break;case 6:r.minimum=e.int64();break;case 7:r.allowedValues=d.tensorflow.AttrValue.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),e.OpDeprecation=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.version=0,e.prototype.explanation="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.OpDef.OpDeprecation;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.version=e.int32();break;case 2:r.explanation=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),l.OpList=function(){function e(p){if(this.op=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.op=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.OpList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.op&&r.op.length||(r.op=[]),r.op.push(d.tensorflow.OpDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),l.MetaGraphDef=function(){function e(p){if(this.collectionDef={},this.signatureDef={},this.assetFileDef=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.metaInfoDef=null,e.prototype.graphDef=null,e.prototype.saverDef=null,e.prototype.collectionDef=h.emptyObject,e.prototype.signatureDef=h.emptyObject,e.prototype.assetFileDef=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new d.tensorflow.MetaGraphDef;e.pos<r;){var l=e.uint32();switch(l>>>3){case 1:o.metaInfoDef=d.tensorflow.MetaGraphDef.MetaInfoDef.decode(e,e.uint32());break;case 2:o.graphDef=d.tensorflow.GraphDef.decode(e,e.uint32());break;case 3:o.saverDef=d.tensorflow.SaverDef.decode(e,e.uint32());break;case 4:e.skip().pos++,o.collectionDef===h.emptyObject&&(o.collectionDef={}),n=e.string(),e.pos++,o.collectionDef[n]=d.tensorflow.CollectionDef.decode(e,e.uint32());break;case 5:e.skip().pos++,o.signatureDef===h.emptyObject&&(o.signatureDef={}),n=e.string(),e.pos++,o.signatureDef[n]=d.tensorflow.SignatureDef.decode(e,e.uint32());break;case 6:o.assetFileDef&&o.assetFileDef.length||(o.assetFileDef=[]),o.assetFileDef.push(d.tensorflow.AssetFileDef.decode(e,e.uint32()));break;default:e.skipType(7&l)}}return o},e.MetaInfoDef=function(){function e(p){if(this.tags=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.metaGraphVersion="",e.prototype.strippedOpList=null,e.prototype.anyInfo=null,e.prototype.tags=h.emptyArray,e.prototype.tensorflowVersion="",e.prototype.tensorflowGitVersion="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.MetaGraphDef.MetaInfoDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.metaGraphVersion=e.string();break;case 2:r.strippedOpList=d.tensorflow.OpList.decode(e,e.uint32());break;case 3:r.anyInfo=d.tensorflow.Any.decode(e,e.uint32());break;case 4:r.tags&&r.tags.length||(r.tags=[]),r.tags.push(e.string());break;case 5:r.tensorflowVersion=e.string();break;case 6:r.tensorflowGitVersion=e.string();break;default:e.skipType(7&o)}}return r},e}(),e}(),l.SavedModel=function(){function e(p){if(this.metaGraphs=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.savedModelSchemaVersion=h.Long?h.Long.fromBits(0,0,!1):0,e.prototype.metaGraphs=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.SavedModel;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.savedModelSchemaVersion=e.int64();break;case 2:r.metaGraphs&&r.metaGraphs.length||(r.metaGraphs=[]),r.metaGraphs.push(d.tensorflow.MetaGraphDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),l.FunctionDefLibrary=function(){function e(p){if(this.function=[],this.gradient=[],p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.function=h.emptyArray,e.prototype.gradient=h.emptyArray,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.FunctionDefLibrary;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.function&&r.function.length||(r.function=[]),r.function.push(d.tensorflow.FunctionDef.decode(e,e.uint32()));break;case 2:r.gradient&&r.gradient.length||(r.gradient=[]),r.gradient.push(d.tensorflow.GradientDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),l.FunctionDef=function(){function e(p){if(this.attr={},this.nodeDef=[],this.ret={},p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.signature=null,e.prototype.attr=h.emptyObject,e.prototype.nodeDef=h.emptyArray,e.prototype.ret=h.emptyObject,e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n,r=void 0===t?e.len:e.pos+t,o=new d.tensorflow.FunctionDef;e.pos<r;){var l=e.uint32();switch(l>>>3){case 1:o.signature=d.tensorflow.OpDef.decode(e,e.uint32());break;case 5:e.skip().pos++,o.attr===h.emptyObject&&(o.attr={}),n=e.string(),e.pos++,o.attr[n]=d.tensorflow.AttrValue.decode(e,e.uint32());break;case 3:o.nodeDef&&o.nodeDef.length||(o.nodeDef=[]),o.nodeDef.push(d.tensorflow.NodeDef.decode(e,e.uint32()));break;case 4:e.skip().pos++,o.ret===h.emptyObject&&(o.ret={}),n=e.string(),e.pos++,o.ret[n]=e.string();break;default:e.skipType(7&l)}}return o},e}(),l.GradientDef=function(){function e(p){if(p)for(var e=Object.keys(p),i=0;i<e.length;++i)null!=p[e[i]]&&(this[e[i]]=p[e[i]])}return e.prototype.functionName="",e.prototype.gradientFunc="",e.decode=function(e,t){e instanceof f||(e=f.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new d.tensorflow.GradientDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.functionName=e.string();break;case 2:r.gradientFunc=e.string();break;default:e.skipType(7&o)}}return r},e}(),l),t.exports=d},{"protobufjs/minimal":197}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this.weightMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var e=[],i=0;i<this.contexts.length-1;i++){var t=this.contexts.slice(0,this.contexts.length-i);e.push(this.contextIdforContexts(t))}e.push(""),this._currentContextIds=e},e.prototype.contextIdforContexts=function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":e.frameName+"-"+e.iterationId})).join("/"):""},e.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(e){return this.weightMap[e]},e}();n.ExecutionContext=r},{}],10:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("url"),f=e("../data/compiled_api"),h=e("../operations/operation_mapper"),d=e("./graph_executor"),m=function(){function e(e,t,n){this.modelUrl=e,this.weightManifestUrl=t,this.requestOption=n,this.version="n/a",this.pathPrefix=this.getPathPrefix()}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),e.prototype.getPathPrefix=function(){var e=c.parse(this.weightManifestUrl),t=e.pathname.split("/");return t.splice(-1),e.pathname=t.join("/"),c.format(e)+"/"},e.prototype.loadRemoteProtoFile=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,l;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch(this.modelUrl,this.requestOption)];case 1:return e=o.sent(),n=(t=f.tensorflow.GraphDef).decode,r=Uint8Array.bind,[4,e.arrayBuffer()];case 2:return[2,n.apply(t,[new(r.apply(Uint8Array,[void 0,o.sent()]))])];case 3:throw l=o.sent(),new Error(this.modelUrl+" not found. "+l);case 4:return[2]}}))}))},e.prototype.loadWeightManifest=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fetch(this.weightManifestUrl,this.requestOption)];case 1:return e=r.sent(),t=this,[4,e.clone().json()];case 2:return t.weightManifest=r.sent(),[3,4];case 3:throw n=r.sent(),new Error(this.weightManifestUrl+" not found. "+n);case 4:return[2]}}))}))},e.prototype.load=function(){return r(this,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:return e=this.loadRemoteProtoFile(),t=this.loadWeightManifest(),[4,Promise.all([e,t])];case 1:return n=o.sent()[0],this.version=n.versions.producer+"."+n.versions.minConsumer,[4,l.io.loadWeights(this.weightManifest,this.pathPrefix,void 0,this.requestOption)];case 2:return r=o.sent(),this.executor=new d.GraphExecutor(h.OperationMapper.Instance.transformGraph(n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}}))}))},e.prototype.execute=function(e,t){if(this.executor.isControlFlowModel)throw new Error("The model contains control flow ops, please use executeAsync method");var n=this.executor.execute(this.convertTensorMapToTensorsMap(e),t),r=Object.keys(n);return 1===r.length?n[r[0]]:n},e.prototype.executeAsync=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:if(!this.executor.isControlFlowModel)throw new Error("The model does not contain control flow ops, please use execute method for better performance.");return[4,this.executor.executeAsync(this.convertTensorMapToTensorsMap(e),t)];case 1:return n=o.sent(),[2,1===(r=Object.keys(n)).length?n[r[0]]:n]}}))}))},e.prototype.convertTensorMapToTensorsMap=function(map){return Object.keys(map).reduce((function(e,t){return e[t]=[map[t]],e}),{})},e.prototype.dispose=function(){this.executor.dispose()},e}();n.FrozenModel=m,n.loadFrozenModel=function(e,t,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,(r=new m(e,t,n)).load()];case 1:return o.sent(),[2,r]}}))}))}},{"../data/compiled_api":8,"../operations/operation_mapper":41,"./graph_executor":11,"@tensorflow/tfjs-core":50,url:220}],11:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs-core"),f=e("../operations/executors/utils"),h=e("../operations/operation_executor"),d=e("./execution_context"),m=function(){function e(e){this.graph=e,this.compiledOrder=[],this._weightMap={},this.placeholders=e.placeholders.map((function(e){return e.name})),this.outputs=e.outputs.map((function(e){return e.name})),this.compile()}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.placeholders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isControlFlowModel",{get:function(){return this.graph.withControlFlow},enumerable:!0,configurable:!0}),e.prototype.compile=function(){if(!this.graph.withControlFlow)for(var e=this.graph.inputs.slice(),t={};e.length>0;){var n=e.pop();t[n.name]=!0,this.compiledOrder.push(n),n.children.forEach((function(n){!t[n.name]&&n.inputNames.every((function(e){var n=f.getNodeNameAndIndex(e)[0];return t[n]}))&&e.push(n)}))}},e.prototype.execute=function(e,t){var n=this;return this.checkInput(e),c.tidy((function(){var o=new d.ExecutionContext(n._weightMap),l=n.compiledOrder.reduce((function(map,e){return map[e.name]=h.executeOp(e,map,o),map}),r({},n.weightMap,e));return n.findOutputs(l,o,t)}))},e.prototype.executeAsync=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o,c,f,h,m=this;return l(this,(function(l){switch(l.label){case 0:return n=new d.ExecutionContext(this._weightMap),[4,this.executeWithControlFlow(e,n)];case 1:return r=l.sent(),o=this.findOutputs(r,n,t),c=Object.keys(o).map((function(e){return o[e].id})),f=Object.keys(e).map((function(t){return e[t].map((function(input){return input.id}))})),h=[].concat.apply([],f),Object.keys(r).forEach((function(e){r[e].forEach((function(e){e&&-1===c.indexOf(e.id)&&-1===h.indexOf(e.id)&&-1===m.weightIds.indexOf(e.id)&&e.dispose()}))})),[2,o]}}))}))},e.prototype.executeWithControlFlow=function(e,t){return o(this,void 0,void 0,(function(){var n,o,c,d,m,y,v,w;return l(this,(function(l){switch(l.label){case 0:n=this.graph.inputs.map((function(e){return{node:e,contexts:t.currentContext}})),o=r({},this.weightMap,e),c={},l.label=1;case 1:return n.length>0?(d=n.pop(),t.currentContext=d.contexts,m=h.executeOp(d.node,o,t),y=f.getNodeNameAndIndex(d.node.name,t)[0],v=o,w=y,[4,m]):[3,3];case 2:return v[w]=l.sent(),d.node.children.forEach((function(e){var r=f.getNodeNameAndIndex(e.name,t)[0];c[r]||("merge"===e.op?e.inputNames.some((function(e){return!!f.getTensor(e,o,t)}))&&(c[r]=!0,n.push({contexts:t.currentContext,node:e})):e.inputNames.every((function(e){return!!f.getTensor(e,o,t)}))&&(c[r]=!0,n.push({contexts:t.currentContext,node:e})))})),[3,1];case 3:return[2,o]}}))}))},e.prototype.findOutputs=function(e,t,n){return!n||n instanceof Array||(n=[n]),(n||this.graph.outputs.map((function(e){return e.name}))).reduce((function(map,n){return map[n]=f.getTensor(n,e,t),map}),{})},e.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))},e.prototype.checkInput=function(e){var t=this,n=Object.keys(e),r=[],o=[];if(this.placeholders.forEach((function(e){-1===n.indexOf(e)&&r.push(e)})),n.forEach((function(e){-1===t.placeholders.indexOf(e)&&o.push(e)})),r.length>0)throw new Error("The dict provided in model.execute(dict) has the keys ["+n+"], but is missing the required keys: ["+r+"].");if(o.length>0)throw new Error("The dict provided in model.execute(dict) has unused keys: ["+o+"]. Please provide only the following keys: ["+this.placeholders+"].")},e}();n.GraphExecutor=m},{"../operations/executors/utils":26,"../operations/operation_executor":40,"./execution_context":9,"@tensorflow/tfjs-core":50}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./executor/frozen_model");n.FrozenModel=r.FrozenModel,n.loadFrozenModel=r.loadFrozenModel;var o=e("./version");n.version_converter=o.version},{"./executor/frozen_model":10,"./version":42}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"add":return[r.add(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"mod":return[r.mod(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"mul":return[r.mul(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"div":return[r.div(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"sub":return[r.sub(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"minimum":return[r.minimum(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"maximum":return[r.maximum(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"pow":return[r.pow(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"squaredDifference":return[r.squaredDifference(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="arithmetic"},{"./utils":26,"@tensorflow/tfjs-core":50}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"abs":return[r.abs(o.getParamValue("x",e,t,n))];case"acos":return[r.acos(o.getParamValue("x",e,t,n))];case"acosh":return[r.acosh(o.getParamValue("x",e,t,n))];case"asin":return[r.asin(o.getParamValue("x",e,t,n))];case"asinh":return[r.asinh(o.getParamValue("x",e,t,n))];case"atan":return[r.atan(o.getParamValue("x",e,t,n))];case"atanh":return[r.atanh(o.getParamValue("x",e,t,n))];case"ceil":return[r.ceil(o.getParamValue("x",e,t,n))];case"cos":return[r.cos(o.getParamValue("x",e,t,n))];case"cosh":return[r.cosh(o.getParamValue("x",e,t,n))];case"elu":return[r.elu(o.getParamValue("x",e,t,n))];case"erf":return[r.erf(o.getParamValue("x",e,t,n))];case"exp":return[r.exp(o.getParamValue("x",e,t,n))];case"expm1":return[r.expm1(o.getParamValue("x",e,t,n))];case"floor":return[r.floor(o.getParamValue("x",e,t,n))];case"log":return[r.log(o.getParamValue("x",e,t,n))];case"log1p":return[r.log1p(o.getParamValue("x",e,t,n))];case"neg":return[r.neg(o.getParamValue("x",e,t,n))];case"reciprocal":return[r.reciprocal(o.getParamValue("x",e,t,n))];case"relu":return[r.relu(o.getParamValue("x",e,t,n))];case"round":return[r.round(o.getParamValue("x",e,t,n))];case"selu":return[r.selu(o.getParamValue("x",e,t,n))];case"sigmoid":return[r.sigmoid(o.getParamValue("x",e,t,n))];case"sin":return[r.sin(o.getParamValue("x",e,t,n))];case"sign":return[r.sign(o.getParamValue("x",e,t,n))];case"sinh":return[r.sinh(o.getParamValue("x",e,t,n))];case"softplus":return[r.softplus(o.getParamValue("x",e,t,n))];case"sqrt":return[r.sqrt(o.getParamValue("x",e,t,n))];case"square":return[r.square(o.getParamValue("x",e,t,n))];case"tanh":return[r.tanh(o.getParamValue("x",e,t,n))];case"tan":return[r.tan(o.getParamValue("x",e,t,n))];case"clipByValue":return[r.clipByValue(o.getParamValue("x",e,t,n),o.getParamValue("clipValueMin",e,t,n),o.getParamValue("clipValueMax",e,t,n))];case"rsqrt":return[r.div(r.scalar(1,"float32"),r.sqrt(o.getTensor(e.inputNames[0],t,n)))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="basic_math"},{"./utils":26,"@tensorflow/tfjs-core":50}],15:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("./utils");n.executeOp=function(e,t,n){return r(this,void 0,void 0,(function(){var r,c,f,h,data,d,input;return o(this,(function(o){switch(o.label){case 0:switch(e.op){case"loopCond":return[3,1];case"switch":return[3,2];case"merge":return[3,4];case"enter":return[3,5];case"exit":return[3,6];case"nextIteration":return[3,7]}return[3,8];case 1:return[2,[l.getParamValue("pred",e,t,n)]];case 2:return r=l.getParamValue("pred",e,t,n),c=l.getParamValue("data",e,t,n),[4,r.data()];case 3:return[2,o.sent()[0]?[void 0,c]:[c,void 0]];case 4:return[2,(f=e.inputNames.find((function(e){return void 0!==l.getTensor(e,t,n)})))?[l.getTensor(f,t,n)]:void 0];case 5:return h=l.getParamValue("frameName",e,t,n),data=l.getParamValue("tensor",e,t,n),n.enterFrame(h),[2,[data]];case 6:return d=l.getParamValue("tensor",e,t,n),n.exitFrame(),[2,[d]];case 7:return input=l.getParamValue("tensor",e,t,n),n.nextIteration(),[2,[input]];case 8:throw TypeError("Node type "+e.op+" is not implemented")}}))}))},n.CATEGORY="control"},{"./utils":26}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"conv1d":var l=o.getParamValue("stride",e,t,n),c=o.getParamValue("pad",e,t,n),f=o.getParamValue("dataFormat",e,t,n).toUpperCase(),h=o.getParamValue("dilation",e,t,n);return[r.conv1d(o.getParamValue("x",e,t,n),o.getParamValue("filter",e,t,n),l,c,f,h)];case"conv2d":l=o.getParamValue("strides",e,t,n),c=o.getParamValue("pad",e,t,n),f=o.getParamValue("dataFormat",e,t,n).toUpperCase();var d=o.getParamValue("dilations",e,t,n);return[r.conv2d(o.getParamValue("x",e,t,n),o.getParamValue("filter",e,t,n),[l[1],l[2]],c,f,[d[0],d[1]])];case"conv2dTranspose":var m=o.getParamValue("outputShape",e,t,n);return l=o.getParamValue("strides",e,t,n),c=o.getParamValue("pad",e,t,n),[r.conv2dTranspose(o.getParamValue("x",e,t,n),o.getParamValue("filter",e,t,n),m,[l[1],l[2]],c)];case"depthwiseConv2d":return l=o.getParamValue("strides",e,t,n),c=o.getParamValue("pad",e,t,n),d=o.getParamValue("dilations",e,t,n),f=o.getParamValue("dataFormat",e,t,n).toUpperCase(),[r.depthwiseConv2d(o.getParamValue("input",e,t,n),o.getParamValue("filter",e,t,n),[l[1],l[2]],c,f,[d[0],d[1]])];case"avgPool":l=o.getParamValue("strides",e,t,n),c=o.getParamValue("pad",e,t,n);var y=o.getParamValue("kernelSize",e,t,n);return[r.avgPool(o.getParamValue("x",e,t,n),[y[1],y[2]],[l[1],l[2]],c)];case"maxPool":return l=o.getParamValue("strides",e,t,n),c=o.getParamValue("pad",e,t,n),y=o.getParamValue("kernelSize",e,t,n),[r.maxPool(o.getParamValue("x",e,t,n),[y[1],y[2]],[l[1],l[2]],c)];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="convolution"},{"./utils":26,"@tensorflow/tfjs-core":50}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"fill":var l=o.getParamValue("shape",e,t,n),c=o.getParamValue("value",e,t,n);return[r.fill(l,c)];case"linspace":var f=o.getParamValue("start",e,t,n),h=o.getParamValue("stop",e,t,n),d=o.getParamValue("num",e,t,n);return[r.linspace(f,h,d)];case"oneHot":var m=o.getParamValue("indices",e,t,n),y=o.getParamValue("depth",e,t,n),v=o.getParamValue("onValue",e,t,n),w=o.getParamValue("offValue",e,t,n);return[r.oneHot(m,y,v,w)];case"ones":return[r.ones(o.getParamValue("shape",e,t,n),o.getParamValue("dtype",e,t,n))];case"onesLike":return[r.onesLike(o.getParamValue("x",e,t,n))];case"randomUniform":return[r.randomUniform(o.getParamValue("shape",e,t,n),o.getParamValue("minval",e,t,n),o.getParamValue("maxval",e,t,n),o.getParamValue("dtype",e,t,n))];case"range":f=o.getParamValue("start",e,t,n);var x=o.getParamValue("stop",e,t,n),_=o.getParamValue("step",e,t,n);return[r.range(f,x,_,o.getParamValue("dtype",e,t,n))];case"truncatedNormal":l=o.getParamValue("shape",e,t,n);var N=o.getParamValue("mean",e,t,n),E=o.getParamValue("stdDev",e,t,n),A=o.getParamValue("seed",e,t,n);return[r.truncatedNormal(l,N,E,o.getParamValue("dtype",e,t,n),A)];case"zeros":return[r.zeros(o.getParamValue("shape",e,t,n),o.getParamValue("dtype",e,t,n))];case"zerosLike":return[r.zerosLike(o.getParamValue("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="creation"},{"./utils":26,"@tensorflow/tfjs-core":50}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"const":return t[e.name];case"placeholder":var l=o.getParamValue("default",e,t,n);return[o.getTensor(e.name,t,n)||l];case"identity":case"stopGradient":case"fakeQuantWithMinMaxVars":return[o.getParamValue("x",e,t,n)];case"snapshot":return[o.getParamValue("x",e,t,n).clone()];case"shape":return[r.tensor1d(o.getParamValue("x",e,t,n).shape,"int32")];case"noop":return[];case"print":var input=o.getParamValue("x",e,t,n),data=o.getParamValue("data",e,t,n),c=o.getParamValue("message",e,t,n),f=o.getParamValue("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(var i=0;i<data.length;i++)console.log(Array.prototype.slice.call(data[0].dataSync()).slice(0,f));return[input];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="graph"},{"./utils":26,"@tensorflow/tfjs-core":50}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"resizeBilinear":var l=o.getParamValue("images",e,t,n),c=o.getParamValue("size",e,t,n),f=o.getParamValue("alignCorners",e,t,n);return[r.image.resizeBilinear(l,[c[0],c[1]],f)];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="image"},{"./utils":26,"@tensorflow/tfjs-core":50}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"equal":return[r.equal(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"notEqual":return[r.notEqual(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"greater":return[r.greater(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"greaterEqual":return[r.greaterEqual(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"less":return[r.less(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"lessEqual":return[r.lessEqual(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"logicalAnd":return[r.logicalAnd(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"logicalNot":return[r.logicalNot(o.getParamValue("a",e,t,n))];case"logicalOr":return[r.logicalOr(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];case"where":return[r.where(o.getParamValue("condition",e,t,n),o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="logical"},{"./utils":26,"@tensorflow/tfjs-core":50}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"matMul":return[r.matMul(o.getParamValue("a",e,t,n),o.getParamValue("b",e,t,n),o.getParamValue("transposeA",e,t,n),o.getParamValue("transposeB",e,t,n))];case"transpose":return[r.transpose(o.getParamValue("x",e,t,n),o.getParamValue("perm",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="matrices"},{"./utils":26,"@tensorflow/tfjs-core":50}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"batchNormalization":return[r.batchNormalization(o.getParamValue("x",e,t,n),o.getParamValue("mean",e,t,n),o.getParamValue("variance",e,t,n),o.getParamValue("epsilon",e,t,n),o.getParamValue("scale",e,t,n),o.getParamValue("offset",e,t,n))];case"localResponseNormalization":return[r.localResponseNormalization(o.getParamValue("x",e,t,n),o.getParamValue("radius",e,t,n),o.getParamValue("bias",e,t,n),o.getParamValue("alpha",e,t,n),o.getParamValue("beta",e,t,n))];case"softmax":return[r.softmax(o.getParamValue("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="normalization"},{"./utils":26,"@tensorflow/tfjs-core":50}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"max":var l=o.getParamValue("axis",e,t,n),c=o.getParamValue("keepDims",e,t,n);return[r.max(o.getParamValue("x",e,t,n),l,c)];case"mean":return l=o.getParamValue("axis",e,t,n),c=o.getParamValue("keepDims",e,t,n),[r.mean(o.getParamValue("x",e,t,n),l,c)];case"min":return l=o.getParamValue("axis",e,t,n),c=o.getParamValue("keepDims",e,t,n),[r.min(o.getParamValue("x",e,t,n),l,c)];case"sum":return l=o.getParamValue("axis",e,t,n),c=o.getParamValue("keepDims",e,t,n),[r.sum(o.getParamValue("x",e,t,n),l,c)];case"argMax":return l=o.getParamValue("axis",e,t,n),[r.argMax(o.getParamValue("x",e,t,n),l)];case"argMin":return l=o.getParamValue("axis",e,t,n),[r.argMin(o.getParamValue("x",e,t,n),l)];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="reduction"},{"./utils":26,"@tensorflow/tfjs-core":50}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"concat":var l=o.getParamValue("axis",e,t,n),c=o.getParamValue("tensors",e,t,n);return[r.concat(c,l)];case"gather":l=o.getParamValue("axis",e,t,n);var input=o.getParamValue("x",e,t,n),f=o.getParamValue("indices",e,t,n);return[r.gather(input,f,l)];case"reverse":return l=o.getParamValue("axis",e,t,n),input=o.getParamValue("x",e,t,n),[r.reverse(input,l)];case"slice":var h=o.getParamValue("begin",e,t,n),d=o.getParamValue("size",e,t,n);return[r.slice(o.getParamValue("x",e,t,n),h,d)];case"stridedSlice":h=o.getParamValue("begin",e,t,n);var m=o.getParamValue("end",e,t,n),y=o.getParamValue("strides",e,t,n),v=o.getParamValue("beginMask",e,t,n),w=o.getParamValue("endMask",e,t,n);return[r.stridedSlice(o.getParamValue("x",e,t,n),h,m,y,v,w)];case"stack":return r.tidy((function(){var l=o.getParamValue("axis",e,t,n),c=o.getParamValue("tensors",e,t,n),f=c[0].shape,h=c[0].squeeze().shape,d=c.map((function(e){var t=r.util.arraysEqual(e.shape,f);if(!t&&!r.util.arraysEqual(e.squeeze().shape,h))throw new Error("the input tensors shape does not match");return t?e:e.reshape(f)}));return[r.stack(d,l)]}));case"tile":var x=o.getParamValue("reps",e,t,n);return[r.tile(o.getParamValue("x",e,t,n),x)];case"split":l=o.getParamValue("axis",e,t,n);var _=o.getParamValue("numOrSizeSplits",e,t,n);return r.split(o.getParamValue("x",e,t,n),_,l);default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="slice_join"},{"./utils":26,"@tensorflow/tfjs-core":50}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./utils");n.executeOp=function(e,t,n){switch(e.op){case"cast":return[r.cast(o.getParamValue("x",e,t,n),o.getParamValue("dtype",e,t,n))];case"expandDims":var l=e.params.axis.value;return[r.expandDims(o.getParamValue("x",e,t,n),l)];case"squeeze":return l=e.params.axis.value,[r.squeeze(o.getParamValue("x",e,t,n),l)];case"reshape":return[r.reshape(o.getParamValue("x",e,t,n),o.getParamValue("shape",e,t,n))];case"pad":return[r.pad(o.getParamValue("x",e,t,n),o.split(o.getParamValue("padding",e,t,n),2),o.getParamValue("constantValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},n.CATEGORY="transformation"},{"./utils":26,"@tensorflow/tfjs-core":50}],26:[function(e,t,n){"use strict";function r(e,t,n){var r=l(e),c=r[0],f=r[1],h=n.currentContextIds.find((function(e){return!!t[o(c,e)]}));return void 0!==h?t[o(c,h)][f]:void 0}function o(e,t){return t?e+"-"+t:e}function l(e){var t=e.lastIndexOf(":");return-1===t?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}Object.defineProperty(n,"__esModule",{value:!0}),n.getParamValue=function(e,t,n,o){var param=t.params[e];if(param&&void 0!==param.inputIndex){if("tensor"===param.type)return r(t.inputNames[param.inputIndex],n,o);if("tensors"===param.type)return(0===param.inputIndex?0===param.inputParamLength?t.inputNames:t.inputNames.slice(param.inputIndex,-param.inputParamLength):t.inputNames.splice(param.inputIndex)).map((function(e){return r(e,n,o)}));var data=Array.prototype.slice.call(r(t.inputNames.slice(param.inputIndex)[0],n,o).dataSync());return"number"===param.type?data[0]:data}return param&&param.value},n.getTensor=r,n.getNodeNameAndIndex=function(e,t){var n=l(e),r=n[0],c=n[1];return[o(r,t&&t.currentContextId),c]},n.parseNodeName=l,n.split=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n}},{}],27:[function(e,t,n){t.exports=[{tfOpName:"Add",dlOpName:"add",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BiasAdd",dlOpName:"add",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",dlOpName:"sub",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",dlOpName:"div",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",dlOpName:"div",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",dlOpName:"mul",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",dlOpName:"maximum",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"}]},{tfOpName:"Minimum",dlOpName:"minimum",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"}]},{tfOpName:"Pow",dlOpName:"pow",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",dlOpName:"squaredDifference",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",dlOpName:"mod",category:"arithmetic",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}]},{}],28:[function(e,t,n){t.exports=[{tfOpName:"Abs",dlOpName:"abs",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",dlOpName:"acos",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",dlOpName:"asin",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"atan",dlOpName:"atan",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",dlOpName:"ceil",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",dlOpName:"clipByValue",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"clip_value_min",dlParamName:"clipValueMin",type:"number"},{tfParamName:"clip_value_max",dlParamName:"clipValueMax",type:"number"}]},{tfOpName:"Cos",dlOpName:"cos",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",dlOpName:"cosh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",dlOpName:"elu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",dlOpName:"exp",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",dlOpName:"floor",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",dlOpName:"log",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",dlOpName:"neg",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",dlOpName:"relu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",dlOpName:"clipByValue",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{dlParamName:"clipValueMin",type:"number",defaultValue:0},{dlParamName:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",dlOpName:"selu",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",dlOpName:"sigmoid",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",dlOpName:"sin",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",dlOpName:"sinh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",dlOpName:"sqrt",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",dlOpName:"rsqrt",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",dlOpName:"square",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",dlOpName:"tan",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",dlOpName:"tanh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",dlOpName:"sign",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",dlOpName:"round",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",dlOpName:"expm1",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",dlOpName:"log1p",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",dlOpName:"reciprocal",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",dlOpName:"reciprocal",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",dlOpName:"softplus",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",dlOpName:"asinh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",dlOpName:"acosh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",dlOpName:"atanh",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",dlOpName:"erf",category:"basic_math",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}]},{}],29:[function(e,t,n){t.exports=[{tfOpName:"LoopCond",dlOpName:"loopCond",category:"control",params:[{tfInputIndex:0,dlParamName:"pred",type:"tensor"}]},{tfOpName:"Switch",dlOpName:"switch",category:"control",params:[{tfInputIndex:0,dlParamName:"data",type:"tensor"},{tfInputIndex:1,dlParamName:"pred",type:"tensor"}]},{tfOpName:"Merge",dlOpName:"merge",category:"control",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"}]},{tfOpName:"Enter",dlOpName:"enter",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"frame_name",dlParamName:"frameName",type:"string"},{tfParamName:"is_constant",dlParamName:"isConstant",type:"bool"}]},{tfOpName:"Exit",dlOpName:"exit",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",dlOpName:"nextIteration",category:"control",params:[{tfInputIndex:0,dlParamName:"tensor",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}]},{}],30:[function(e,t,n){t.exports=[{tfOpName:"AvgPool",dlOpName:"avgPool",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0},{tfParamName:"ksize",dlParamName:"kernelSize",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",dlOpName:"maxPool",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0},{tfParamName:"ksize",dlParamName:"kernelSize",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",dlOpName:"conv1d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"stride",dlParamName:"stride",type:"number"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NWC"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"dilation",dlParamName:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",dlOpName:"conv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"useCudnnOnGpu",dlParamName:"useCudnnOnGpu",type:"bool"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]},{tfOpName:"Conv2DBackpropInput",dlOpName:"conv2dTranspose",category:"convolution",params:[{tfInputIndex:2,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfInputIndex:0,dlParamName:"outputShape",type:"number[]"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",dlOpName:"depthwiseConv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"input",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",dlOpName:"depthwiseConv2d",category:"convolution",params:[{tfInputIndex:0,dlParamName:"input",type:"tensor"},{tfInputIndex:1,dlParamName:"filter",type:"tensor"},{tfParamName:"strides",dlParamName:"strides",type:"number[]"},{tfParamName:"padding",dlParamName:"pad",type:"string"},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",defaultValue:"NHWC"},{tfParamName:"dilations",dlParamName:"dilations",type:"number[]"}]}]},{}],31:[function(e,t,n){t.exports=[{tfOpName:"Fill",dlOpName:"fill",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfInputIndex:1,dlParamName:"value",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LinSpace",dlOpName:"linspace",category:"creation",params:[{tfInputIndex:0,dlParamName:"start",type:"number"},{tfInputIndex:1,dlParamName:"stop",type:"number"},{tfInputIndex:2,dlParamName:"num",type:"number"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",dlOpName:"oneHot",category:"creation",params:[{tfInputIndex:0,dlParamName:"indices",type:"tensor"},{tfInputIndex:1,dlParamName:"depth",type:"number"},{tfInputIndex:2,dlParamName:"onValue",type:"number",defaultValue:1},{tfInputIndex:3,dlParamName:"offValue",type:"number",defaultValue:0},{tfParamName:"axis",dlParamName:"axis",type:"number",notSupported:!0},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",dlOpName:"ones",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",dlOpName:"onesLike",category:"creation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",dlOpName:"randomUniform",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"minval",dlParamName:"minval",type:"number",defaultValue:0},{tfParamName:"maxval",dlParamName:"maxval",type:"number",defaultValue:1},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"seed",dlParamName:"seed",type:"number",defaultValue:0},{tfParamName:"seed2",dlParamName:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfParamName:"T",dlParamName:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",dlOpName:"range",category:"creation",params:[{tfInputIndex:0,dlParamName:"start",type:"number"},{tfInputIndex:1,dlParamName:"stop",type:"number"},{tfInputIndex:2,dlParamName:"step",type:"number",defaultValue:0},{tfParamName:"Tidx",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"truncatedNormal",dlOpName:"truncatedNormal",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"means",dlParamName:"mean",type:"number",defaultValue:0},{tfParamName:"stddev",dlParamName:"stdDev",type:"number",defaultValue:1},{tfParamName:"seed",dlParamName:"seed",type:"number"},{tfParamName:"seed2",dlParamName:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfParamName:"dtype",dlParamName:"dtype",type:"dtype"},{tfParamName:"T",dlParamName:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",dlOpName:"zeros",category:"creation",params:[{tfInputIndex:0,dlParamName:"shape",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",dlOpName:"zerosLike",category:"creation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype"}]}]},{}],32:[function(e,t,n){t.exports=[{tfOpName:"PlaceholderWithDefault",dlOpName:"placeholder",category:"graph",params:[{tfInputIndex:0,dlParamName:"default",type:"tensor"}]},{tfOpName:"Placeholder",dlOpName:"placeholder",category:"graph"},{tfOpName:"Const",dlOpName:"const",category:"graph"},{tfOpName:"Identity",dlOpName:"identity",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Snapshot",dlOpName:"snapshot",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Shape",dlOpName:"shape",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"Print",dlOpName:"print",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,tfInputParamLength:1,dlParamName:"data",type:"tensors"},{tfParamName:"message",dlParamName:"message",type:"string"},{tfParamName:"first_n",dlParamName:"firstN",type:"number",notSupprted:!0},{tfParamName:"summarize",dlParamName:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",dlOpName:"noop",category:"graph",params:[]},{tfOpName:"StopGradient",dlOpName:"stopGradient",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",dlOpName:"fakeQuantWithMinMaxVars",category:"graph",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"min",dlParamName:"min",type:"number"},{tfParamName:"max",dlParamName:"max",type:"number"}]}]},{}],33:[function(e,t,n){t.exports=[{tfOpName:"ResizeBilinear",dlOpName:"resizeBilinear",category:"image",params:[{tfInputIndex:0,dlParamName:"images",type:"tensor"},{tfInputIndex:1,dlParamName:"size",type:"number[]"},{tfParamName:"align_corners",dlParamName:"alignCorners",type:"bool"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}]},{}],34:[function(e,t,n){t.exports=[{tfOpName:"Equal",dlOpName:"equal",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",dlOpName:"notEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",dlOpName:"greater",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",dlOpName:"greaterEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",dlOpName:"less",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",dlOpName:"lessEqual",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",dlOpName:"logicalAnd",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",dlOpName:"logicalNot",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",dlOpName:"logicalOr",category:"logical",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",dlOpName:"where",category:"logical",params:[{tfInputIndex:0,dlParamName:"condition",type:"tensor"},{tfInputIndex:1,dlParamName:"a",type:"tensor"},{tfInputIndex:2,dlParamName:"b",type:"tensor"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}]},{}],35:[function(e,t,n){t.exports=[{tfOpName:"MatMul",dlOpName:"matMul",category:"matrices",params:[{tfInputIndex:0,dlParamName:"a",type:"tensor"},{tfInputIndex:1,dlParamName:"b",type:"tensor"},{tfParamName:"transpose_a",dlParamName:"transposeA",type:"bool",defaultValue:!1},{tfParamName:"transpose_b",dlParamName:"transposeB",type:"bool",defaultValue:!1},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",dlOpName:"transpose",category:"matrices",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"perm",dlParamName:"perm",type:"number[]"},{tfParamName:"T",dlParamName:"dtype",type:"dtype",notSupported:!0}]}]},{}],36:[function(e,t,n){t.exports=[{tfOpName:"FusedBatchNorm",dlOpName:"batchNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"scale",type:"tensor"},{tfInputIndex:2,dlParamName:"offset",type:"tensor"},{tfInputIndex:3,dlParamName:"mean",type:"tensor"},{tfInputIndex:4,dlParamName:"variance",type:"tensor"},{tfParamName:"epsilon",dlParamName:"epsilon",type:"number",defaultValue:.001},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",dlOpName:"batchNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"scale",type:"tensor"},{tfInputIndex:2,dlParamName:"offset",type:"tensor"},{tfInputIndex:3,dlParamName:"mean",type:"tensor"},{tfInputIndex:4,dlParamName:"variance",type:"tensor"},{tfParamName:"epsilon",dlParamName:"epsilon",type:"number",defaultValue:.001},{tfParamName:"data_format",dlParamName:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",dlOpName:"localResponseNormalization",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"depth_radius",dlParamName:"radius",type:"number",defaultValue:5},{tfParamName:"bias",dlParamName:"bias",type:"number",defaultValue:1},{tfParamName:"alpha",dlParamName:"alpha",type:"number",defaultValue:1},{tfParamName:"beta",dlParamName:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",dlOpName:"softmax",category:"normalization",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"}]}]},{}],37:[function(e,t,n){t.exports=[{tfOpName:"Max",dlOpName:"max",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Mean",dlOpName:"mean",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Min",dlOpName:"min",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"Sum",dlOpName:"sum",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number[]"},{tfParamName:"keep_dims",dlParamName:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",dlOpName:"argMax",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"ArgMin",dlOpName:"argMin",category:"reduction",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]}]},{}],38:[function(e,t,n){t.exports=[{tfOpName:"ConcatV2",dlOpName:"concat",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:1,dlParamName:"tensors",type:"tensors"},{tfInputIndex:-1,dlParamName:"axis",type:"number"}]},{tfOpName:"Concat",dlOpName:"concat",category:"slice_join",params:[{tfInputIndex:1,tfInputParamLength:1,dlParamName:"tensors",type:"tensors"},{tfInputIndex:0,dlParamName:"axis",type:"number"}]},{tfOpName:"GatherV2",dlOpName:"gather",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",dlOpName:"gather",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"indices",type:"tensor"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0},{tfParamName:"validate_indices",dlParamName:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",dlOpName:"reverse",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"ReverseV2",dlOpName:"reverse",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"axis",type:"number"}]},{tfOpName:"Slice",dlOpName:"slice",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"begin",type:"number[]"},{tfInputIndex:2,dlParamName:"size",type:"number[]"}]},{tfOpName:"StridedSlice",dlOpName:"stridedSlice",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"begin",type:"number[]"},{tfInputIndex:2,dlParamName:"end",type:"number[]"},{tfInputIndex:3,dlParamName:"strides",type:"number[]"},{tfParamName:"begin_mask",dlParamName:"beginMask",type:"number",defaultValue:0},{tfParamName:"end_mask",dlParamName:"endMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",dlOpName:"stack",category:"slice_join",params:[{tfInputIndex:0,tfInputParamLength:0,dlParamName:"tensors",type:"tensors"},{tfParamName:"axis",dlParamName:"axis",type:"number",defaultValue:0}]},{tfOpName:"Tile",dlOpName:"tile",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"reps",type:"number[]"}]},{tfOpName:"Split",dlOpName:"split",category:"slice_join",params:[{tfInputIndex:0,dlParamName:"axis",type:"number",defaultValue:0},{tfInputIndex:1,dlParamName:"x",type:"tensor"},{tfParamName:"num_split",dlParamName:"numOrSizeSplits",type:"number",defaultValue:1}]}]},{}],39:[function(e,t,n){t.exports=[{tfOpName:"Cast",dlOpName:"cast",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"SrcT",dlParamName:"sdtype",type:"dtype",notSupported:!0},{tfParamName:"DstT",dlParamName:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",dlOpName:"expandDims",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,tfParamNameDeprecated:"dim",dlParamName:"axis",type:"number"}]},{tfOpName:"Pad",dlOpName:"pad",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"padding",type:"number[]"},{tfParamName:"constant_value",dlParamName:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",dlOpName:"pad",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"padding",type:"number[]"},{tfInputIndex:2,dlParamName:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",dlOpName:"reshape",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfInputIndex:1,dlParamName:"shape",type:"number[]"}]},{tfOpName:"Squeeze",dlOpName:"squeeze",category:"transformation",params:[{tfInputIndex:0,dlParamName:"x",type:"tensor"},{tfParamName:"axis",tfParamNameDeprecated:"squeeze_dims",dlParamName:"axis",type:"number[]"}]}]},{}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./executors/arithmetic_executor"),o=e("./executors/basic_math_executor"),l=e("./executors/control_executor"),c=e("./executors/convolution_executor"),f=e("./executors/creation_executor"),h=e("./executors/graph_executor"),image=e("./executors/image_executor"),d=e("./executors/logical_executor"),m=e("./executors/matrices_executor"),y=e("./executors/normalization_executor"),v=e("./executors/reduction_executor"),w=e("./executors/slice_join_executor"),x=e("./executors/transformation_executor");n.executeOp=function(e,t,n){switch(e.category){case"arithmetic":return r.executeOp(e,t,n);case"basic_math":return o.executeOp(e,t,n);case"control":return l.executeOp(e,t,n);case"convolution":return c.executeOp(e,t,n);case"creation":return f.executeOp(e,t,n);case"image":return image.executeOp(e,t,n);case"graph":return h.executeOp(e,t,n);case"logical":return d.executeOp(e,t,n);case"matrices":return m.executeOp(e,t,n);case"normalization":return y.executeOp(e,t,n);case"reduction":return v.executeOp(e,t,n);case"slice_join":return w.executeOp(e,t,n);case"transformation":return x.executeOp(e,t,n);default:throw TypeError("Node type "+e.op+" is not implemented")}}},{"./executors/arithmetic_executor":13,"./executors/basic_math_executor":14,"./executors/control_executor":15,"./executors/convolution_executor":16,"./executors/creation_executor":17,"./executors/graph_executor":18,"./executors/image_executor":19,"./executors/logical_executor":20,"./executors/matrices_executor":21,"./executors/normalization_executor":22,"./executors/reduction_executor":23,"./executors/slice_join_executor":24,"./executors/transformation_executor":25}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../data/compiled_api"),o=e("./executors/utils"),l=e("./op_list/arithmetic.json"),c=e("./op_list/basic_math.json"),f=e("./op_list/control.json"),h=e("./op_list/convolution.json"),d=e("./op_list/creation.json"),m=e("./op_list/graph.json"),y=e("./op_list/image.json"),v=e("./op_list/logical.json"),w=e("./op_list/matrices.json"),x=e("./op_list/normalization.json"),_=e("./op_list/reduction.json"),N=e("./op_list/slice_join.json"),E=e("./op_list/transformation.json"),A=["Switch","Merge","Enter","Exit","NextIteration"],O=function(){function e(){var e=l.default.concat(c.default,f.default,h.default,d.default,v.default,y.default,m.default,w.default,x.default,_.default,N.default,E.default);this.opMappers=e.reduce((function(map,e){return map[e.tfOpName]=e,map}),{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.isControlFlow=function(e){return A.some((function(t){return t===e.op}))},e.prototype.transformGraph=function(e){var t=this,n=e.node,r=!1,l=[],c=n.reduce((function(map,e){return map[e.name]=t.mapNode(e),t.isControlFlow(e)&&(r=!0),"Placeholder"===e.op&&l.push(map[e.name]),map}),{}),f=[],h=[];return Object.keys(c).forEach((function(e){var t=c[e];t.inputNames.forEach((function(e){var n=o.getNodeNameAndIndex(e)[0];t.inputs.push(c[n]),c[n].children.push(t)})),0===t.inputs.length&&f.push(t)})),Object.keys(c).forEach((function(e){var t=c[e];0===t.children.length&&h.push(t)})),{nodes:c,inputs:f,outputs:h,placeholders:l,withControlFlow:r}},e.prototype.mapNode=function(e){var t=this,n=this.opMappers[e.op];if(void 0===n)throw new Error("Tensorflow Op is not supported: "+e.op);var r={name:e.name,op:n.dlOpName,category:n.category,inputNames:(e.input||[]).map((function(input){return input.startsWith("^")?input.substr(1):input})),inputs:[],children:[],params:{}};return n.params&&(r.params=n.params.reduce((function(map,param){var n=param.tfInputIndex,r=param.tfInputParamLength,o=param.type,l=void 0;if(void 0===n)switch(param.type){case"string":void 0===(l=t.getStringParam(e.attr,param.tfParamName,param.defaultValue))&&param.tfParamNameDeprecated&&(l=t.getStringParam(e.attr,param.tfParamNameDeprecated,param.defaultValue));break;case"number":void 0===(l=t.getNumberParam(e.attr,param.tfParamName,param.defaultValue))&&param.tfParamNameDeprecated&&(l=t.getNumberParam(e.attr,param.tfParamNameDeprecated,param.defaultValue));break;case"number[]":void 0===(l=t.getNumericArrayParam(e.attr,param.tfParamName,param.defaultValue))&&param.tfParamNameDeprecated&&(l=t.getNumericArrayParam(e.attr,param.tfParamNameDeprecated,param.defaultValue));break;case"bool":void 0===(l=t.getBoolParam(e.attr,param.tfParamName,param.defaultValue))&&param.tfParamNameDeprecated&&(l=t.getBoolParam(e.attr,param.tfParamNameDeprecated,param.defaultValue));break;case"shape":void 0===(l=t.getTensorShapeParam(e.attr,param.tfParamName,param.defaultValue))&&param.tfParamNameDeprecated&&(l=t.getTensorShapeParam(e.attr,param.tfParamNameDeprecated,param.defaultValue));break;case"dtype":void 0===(l=t.getDtypeParam(e.attr,param.tfParamName,param.defaultValue))&&param.tfParamNameDeprecated&&(l=t.getDtypeParam(e.attr,param.tfParamNameDeprecated,param.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+param.type+" for op: "+e.op)}return map[param.dlParamName]={value:l,inputIndex:n,type:o,inputParamLength:r},map}),{})),r},e.prototype.getStringParam=function(e,t,n,r){void 0===r&&(r=!1);var param=e[t];if(void 0!==param){var o=String.fromCharCode.apply(null,param.s);return r?o:o.toLowerCase()}return n},e.prototype.getBoolParam=function(e,t,n){var param=e[t];return param?param.b:n},e.prototype.getNumberParam=function(e,t,n){var param=e[t],r=param?void 0!==param.f?param.f:param.i:n;return"number"==typeof r?r:r.toInt()},e.prototype.getDtypeParam=function(e,t,n){var param=e[t];if(param&&param.type)switch(param.type){case r.tensorflow.DataType.DT_FLOAT:return"float32";case r.tensorflow.DataType.DT_INT32:return"int32";case r.tensorflow.DataType.DT_BOOL:return"bool";default:return n}return n},e.prototype.getTensorShapeParam=function(e,t,n){var param=e[t];return param&&param.shape?param.shape.dim.map((function(e){return e.size})):n},e.prototype.getNumericArrayParam=function(e,t,n){var param=e[t];return param?(param.list.f&&param.list.f.length?param.list.f:param.list.i).map((function(e){return"number"==typeof e?e:e.toInt()})):n},e}();n.OperationMapper=O},{"../data/compiled_api":8,"./executors/utils":26,"./op_list/arithmetic.json":27,"./op_list/basic_math.json":28,"./op_list/control.json":29,"./op_list/convolution.json":30,"./op_list/creation.json":31,"./op_list/graph.json":32,"./op_list/image.json":33,"./op_list/logical.json":34,"./op_list/matrices.json":35,"./op_list/normalization.json":36,"./op_list/reduction.json":37,"./op_list/slice_join.json":38,"./op_list/transformation.json":39}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.version="0.4.0"},{}],43:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./doc"),l=function(){function e(){}return e.nextFrame=function(){return new Promise((function(e){return requestAnimationFrame((function(){return e()}))}))},r([o.doc({heading:"Performance",subheading:"Timing"})],e,"nextFrame",null),e}();n.BrowserUtil=l},{"./doc":45}],44:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isMobile=function(){var a=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))}},{}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.doc=function(e){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}},{}],46:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("./environment"),c=e("./globals"),f=e("./ops/ops"),h=e("./profiler"),d=e("./tape"),m=e("./tensor"),y=e("./util"),v=function(){function e(e,t){this.backend=e,this.safeMode=t,this.registeredVariables={},this.refCounter=new WeakMap,this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numDataBuffers=0,this.gradientScopeCount=0,this.customGradientDepth=0,this.activeScope={keep:[],track:[]},this.scopeStack=[this.activeScope],this.profiler=new h.Profiler(e)}return e.prototype.runKernel=function(e,t,n){var r,o=this,c=[],f=function(e){return c.push(e),e},h=this.activeScope.name;if(this.customGradientDepth++,r=l.ENV.get("DEBUG")?this.profiler.profileKernel(h,(function(){return e(o.backend,f)})):e(this.backend,f),this.customGradientDepth--,this.shouldRecord()){var d={id:this.nextTapeNodeId++,name:h,inputs:t,output:r};null!=n&&(d.gradient=function(e){return n(e,c)}),this.activeTape.push(d)}return r},e.prototype.registerTensor=function(a){var e=this.refCounter.has(a.dataId)?this.refCounter.get(a.dataId):0;this.numTensors++,0===e&&(this.numDataBuffers++,this.numBytes+=y.sizeFromShape(a.shape)*y.bytesPerElement(a.dtype),this.backend.register(a.dataId,a.shape,a.dtype)),this.refCounter.set(a.dataId,e+1),a instanceof m.Variable||this.track(a)},e.prototype.registerVariable=function(e){if(null!=this.registeredVariables[e.name])throw new Error("Variable with name "+e.name+" was already registered");this.registeredVariables[e.name]=e},e.prototype.disposeTensor=function(a){if(this.refCounter.has(a.dataId)){this.numTensors--;var e=this.refCounter.get(a.dataId);e<=1?(this.refCounter.delete(a.dataId),this.backend.disposeData(a.dataId),this.numDataBuffers--,this.numBytes-=y.sizeFromShape(a.shape)*y.bytesPerElement(a.dtype)):this.refCounter.set(a.dataId,e-1)}},e.prototype.disposeVariables=function(){for(var e in this.registeredVariables){var t=this.registeredVariables[e];this.disposeTensor(t),delete this.registeredVariables[e]}},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.numTensors,e.numDataBuffers=this.numDataBuffers,e.numBytes=this.numBytes,e},e.prototype.shouldRecord=function(){return null!=this.activeTape&&0===this.customGradientDepth},e.prototype.addTapeNode=function(e,t,n){var r={};e.forEach((function(input,e){r[e]=input}));var o={id:this.nextTapeNodeId++,name:this.activeScope.name,inputs:r,output:t,gradient:function(e){var t=n(e),r={};return t.forEach((function(e,t){r[t]=function(){return e}})),r}};this.activeTape.push(o)},e.prototype.keep=function(e){if(1===this.scopeStack.length&&l.ENV.engine.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {...}) to avoid memory leaks.");return this.activeScope.keep.push(e),e},e.prototype.startScope=function(e,t){void 0===t&&(t=!1),t&&0===this.gradientScopeCount&&(this.activeTape=[]),t&&this.gradientScopeCount++;var n={keep:[],track:[]};e&&(n.name=e),this.scopeStack.push(n),this.activeScope=n},e.prototype.endScope=function(e,t){var n=this;void 0===t&&(t=!1),t&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null));var r=this.activeScope.keep,o=y.extractTensorsFromContainer(e);r=r.concat(o);for(var i=0;i<this.activeScope.track.length;i++){var l=this.activeScope.track[i];y.isTensorInList(l,r)||(null!=this.activeTape?o.push(l):l.dispose())}this.scopeStack.pop(),this.activeScope=0===this.scopeStack.length?{keep:[],track:[]}:this.scopeStack[this.scopeStack.length-1],o.forEach((function(e){y.isTensorInList(e,n.activeScope.keep)||n.track(e)}))},e.prototype.dispose=function(){},e.prototype.gradients=function(e,t,n,r){var o=this;return void 0===r&&(r=!1),y.assert(t.length>0,"gradients() received an empty list of xs."),c.tidy("gradients",(function(){var l=e();y.assert(l instanceof m.Tensor,"The result y returned by f() must be a tensor.");var c=d.getFilteredNodesXToY(o.activeTape,t,l);if(!r&&0===c.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");var h={};return h[l.id]=null==n?f.ones(l.shape):n,d.backpropagateGradients(h,c),{value:l,grads:t.map((function(e){return h[e.id]}))}}),!0)},e.prototype.customGrad=function(e){var t=this;return y.assert(y.isFunction(e),"The f passed in customGrad(f) must be a function."),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];y.assert(r.every((function(e){return e instanceof m.Tensor})),"The args passed in customGrad(f)(x1, x2,...) must all be tensors"),t.customGradientDepth++;var l=!0,f=c.tidy(e.name,(function(){var t=e.apply(void 0,r),o=t.value,l=t.gradFunc;return y.assert(o instanceof m.Tensor,"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),y.assert(y.isFunction(l),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n=l,o}),l);if(t.customGradientDepth--,t.shouldRecord()){var h=function(e){var t=n(e),o=Array.isArray(t)?t:[t];return y.assert(o.length===r.length,"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),y.assert(o.every((function(e){return e instanceof m.Tensor})),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."),o};t.addTapeNode(r,f,h)}return f}},e.prototype.write=function(e,t){this.backend.write(e,t)},e.prototype.readSync=function(e){return this.backend.readSync(e)},e.prototype.read=function(e){return this.backend.read(e)},e.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},e.prototype.time=function(e){return r(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=performance.now(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=performance.now()-t,[2,n]}}))}))},e.prototype.track=function(e){if(1===this.scopeStack.length&&this.safeMode)throw new Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {op();...}); to avoid memory leaks.");return this.activeScope.track.push(e),e},e}();n.Engine=v},{"./environment":47,"./globals":48,"./ops/ops":122,"./profiler":144,"./tape":146,"./tensor":147,"./util":153}],47:[function(e,t,n){(function(t){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o,l=e("./device_util"),c=e("./doc"),f=e("./engine"),h=e("./util");function d(e,t){return null!=e.getExtension(t)}function m(e){if(0===e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=document.createElement("canvas");return 1===e?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}function y(e){if(null!=e){var t=e.getExtension("WEBGL_lose_context");if(null==t)throw new Error("Extension WEBGL_lose_context not supported on this browser.");t.loseContext()}}function v(e){var t=m(e);return null!=t&&(y(t),!0)}!function(e){e[e.NUMBER=0]="NUMBER",e[e.BOOLEAN=1]="BOOLEAN",e[e.STRING=2]="STRING"}(o=n.Type||(n.Type={})),n.URL_PROPERTIES=[{name:"DEBUG",type:o.BOOLEAN},{name:"IS_BROWSER",type:o.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",type:o.NUMBER},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:o.BOOLEAN},{name:"WEBGL_VERSION",type:o.NUMBER},{name:"WEBGL_FLOAT_TEXTURE_ENABLED",type:o.BOOLEAN},{name:"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED",type:o.BOOLEAN},{name:"BACKEND",type:o.STRING}];var w=function(){function e(e){this.features={},this.registry={},null!=e&&(this.features=e),this.get("DEBUG")&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}return e.setBackend=function(e,t){if(void 0===t&&(t=!1),!(e in n.ENV.registry))throw new Error("Backend type '"+e+"' not found in registry");n.ENV.initBackend(e,t)},e.getBackend=function(){return n.ENV.initDefaultBackend(),n.ENV.currentBackend},e.disposeVariables=function(){n.ENV.engine.disposeVariables()},e.memory=function(){return n.ENV.engine.memory()},e.prototype.get=function(e){return e in this.features?this.features[e]:(this.features[e]=this.evaluateFeature(e),this.features[e])},e.prototype.set=function(e,t){this.features[e]=t},e.prototype.getBestBackendType=function(){var e=this;if(0===Object.keys(this.registry).length)throw new Error("No backend found in registry.");return Object.keys(this.registry).map((function(t){return{name:t,entry:e.registry[t]}})).sort((function(a,b){return b.entry.priority-a.entry.priority}))[0].name},e.prototype.evaluateFeature=function(e){if("DEBUG"===e)return!1;if("IS_BROWSER"===e)return"undefined"!=typeof window;if("BACKEND"===e)return this.getBestBackendType();if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"===e){var t=this.get("WEBGL_VERSION");return 0===t?0:function(e){if(0===e)return 0;var t,n=m(e);return t=d(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:d(n,"EXT_disjoint_timer_query")?1:0,null!=n&&y(n),t}(t)}if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"===e)return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!l.isMobile();if("WEBGL_VERSION"===e)return v(2)?2:v(1)?1:0;if("WEBGL_FLOAT_TEXTURE_ENABLED"===e)return function(e){if(0===e)return!1;var t=m(e);if(1===e){if(!d(t,"OES_texture_float"))return!1}else if(!d(t,"EXT_color_buffer_float"))return!1;var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);var o=2===e?t.RGBA32F:t.RGBA;t.texImage2D(t.TEXTURE_2D,0,o,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var l=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;t.readPixels(0,0,1,1,t.RGBA,t.FLOAT,new Float32Array(4));var c=t.getError()===t.NO_ERROR;return y(t),l&&c}(this.get("WEBGL_VERSION"));if("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED"===e)return function(e){if(e>0)return!1;if(2!==e)return!1;var t=m(e),n=d(t,"WEBGL_get_buffer_sub_data_async");return y(t),n}(this.get("WEBGL_VERSION"));throw new Error("Unknown feature "+e+".")},e.prototype.setFeatures=function(e){this.features=e},e.prototype.reset=function(){this.features=N(),null!=this.globalEngine&&(this.globalEngine.dispose(),this.globalEngine=null)},e.prototype.initBackend=function(e,t){void 0===t&&(t=!1),this.currentBackend=e,null!=this.globalEngine&&this.globalEngine.dispose();var r=n.ENV.findBackend(e);this.globalEngine=new f.Engine(r,t)},e.prototype.findBackend=function(e){return e in this.registry?this.registry[e].backend:null},e.prototype.registerBackend=function(e,t,n){void 0===n&&(n=1),e in this.registry&&console.warn(e+" backend was already registered");try{var r=t();return this.registry[e]={backend:r,priority:n},!0}catch(e){return console.warn(e.message),!1}},e.prototype.removeBackend=function(e){if(!(e in this.registry))throw new Error(e+" backend not found in registry");this.registry[e].backend.dispose(),delete this.registry[e]},Object.defineProperty(e.prototype,"engine",{get:function(){return this.initDefaultBackend(),this.globalEngine},enumerable:!0,configurable:!0}),e.prototype.initDefaultBackend=function(){null==this.globalEngine&&this.initBackend(n.ENV.get("BACKEND"),!1)},r([c.doc({heading:"Environment"})],e,"setBackend",null),r([c.doc({heading:"Environment"})],e,"getBackend",null),r([c.doc({heading:"Environment"})],e,"disposeVariables",null),r([c.doc({heading:"Performance",subheading:"Memory"})],e,"memory",null),e}();n.Environment=w;var x,_="tfjsflags";function N(){var e={};if("undefined"==typeof window||void 0===window.location)return e;var t=h.getQueryParams(window.location.search);if(_ in t){var r={};t[_].split(",").forEach((function(e){var t=e.split(":"),n=t[0],o=t[1];r[n]=o})),n.URL_PROPERTIES.forEach((function(t){t.name in r&&(console.log("Setting feature override from URL "+t.name+": "+r[t.name]),t.type===o.NUMBER?e[t.name]=+r[t.name]:t.type===o.BOOLEAN?e[t.name]="true"===r[t.name]:t.type===o.STRING?e[t.name]=r[t.name]:console.warn("Unknown URL param: "+t.name+"."))}))}return e}n.ENV=((x=function(){var e;if("undefined"!=typeof window)e=window;else{if(void 0===t)throw new Error("Could not find a global object");e=t}return e}()).ENV=x.ENV||new w(N()),x.ENV)}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./device_util":44,"./doc":45,"./engine":46,"./util":153}],48:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./gradients"),o=e("./tracking");n.tidy=o.Tracking.tidy,n.keep=o.Tracking.keep,n.dispose=o.Tracking.dispose,n.time=o.Tracking.time,n.grad=r.Gradients.grad,n.valueAndGrad=r.Gradients.valueAndGrad,n.grads=r.Gradients.grads,n.valueAndGrads=r.Gradients.valueAndGrads,n.variableGrads=r.Gradients.variableGrads,n.customGrad=r.Gradients.customGrad},{"./gradients":49,"./tracking":150}],49:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./doc"),l=e("./environment"),c=e("./globals"),f=e("./tensor"),h=e("./util"),d=function(){function e(){}return e.gradScope=function(e,t){return c.tidy(e,t,!0)},e.grad=function(e){return h.assert(h.isFunction(e),"The f passed in grad(f) must be a function"),function(t,n){return h.assert(t instanceof f.Tensor,"The x passed in grad(f)(x) must be a tensor"),h.assert(null==n||n instanceof f.Tensor,"The dy passed in grad(f)(x, dy) must be a tensor"),c.tidy((function(){var r=l.ENV.engine.gradients((function(){return e(t)}),[t],n),o=r.value,c=r.grads;return null!=n&&h.assertShapesMatch(o.shape,n.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),m(c),c[0]}))}},e.grads=function(e){return h.assert(h.isFunction(e),"The f passed in grads(f) must be a function"),function(t,n){return h.assert(Array.isArray(t)&&t.every((function(e){return e instanceof f.Tensor})),"The args passed in grads(f)(args) must be an array of tensors"),h.assert(null==n||n instanceof f.Tensor,"The dy passed in grads(f)(args, dy) must be a tensor"),c.tidy((function(){var r=l.ENV.engine.gradients((function(){return e.apply(void 0,t)}),t,n),o=r.value,c=r.grads;return null!=n&&h.assertShapesMatch(o.shape,n.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),m(c),c}))}},e.valueAndGrad=function(e){return h.assert(h.isFunction(e),"The f passed in valueAndGrad(f) must be a function"),function(t,n){h.assert(t instanceof f.Tensor,"The x passed in valueAndGrad(f)(x) must be a tensor"),h.assert(null==n||n instanceof f.Tensor,"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");var r=l.ENV.engine.gradients((function(){return e(t)}),[t],n),o=r.grads,c=r.value;return m(o),{grad:o[0],value:c}}},e.valueAndGrads=function(e){return h.assert(h.isFunction(e),"The f passed in valueAndGrads(f) must be a function"),function(t,n){h.assert(Array.isArray(t)&&t.every((function(e){return e instanceof f.Tensor})),"The args passed in valueAndGrads(f)(args) must be array of tensors"),h.assert(null==n||n instanceof f.Tensor,"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");var r=l.ENV.engine.gradients((function(){return e.apply(void 0,t)}),t,n);return null!=n&&h.assertShapesMatch(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),m(r.grads),r}},e.variableGrads=function(e,t){if(h.assert(h.isFunction(e),"The f passed in variableGrads(f) must be a function"),h.assert(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof f.Variable})),"The varList passed in variableGrads(f, varList) must be an array of variables"),null==t)for(var n in t=[],l.ENV.engine.registeredVariables)t.push(l.ENV.engine.registeredVariables[n]);var r=t.length;t=t.filter((function(e){return e.trainable})),h.assert(t.length>0,"variableGrads() expects at least one of the input variables to be trainable, but none of the "+r+" variables is trainable.");var o=l.ENV.engine.gradients(e,t,null,!0),c=o.value,d=o.grads;h.assert(d.some((function(g){return null!=g})),"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),h.assert(0===c.rank,"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+c.rank+" tensor");var m={};return t.forEach((function(e,i){null!=d[i]&&(m[e.name]=d[i])})),{value:c,grads:m}},e.customGrad=function(e){return l.ENV.engine.customGrad(e)},r([o.doc({heading:"Training",subheading:"Gradients"})],e,"grad",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"grads",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"valueAndGrad",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"valueAndGrads",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"variableGrads",null),r([o.doc({heading:"Training",subheading:"Gradients"})],e,"customGrad",null),e}();function m(e){if(e.filter((function(g){return null==g})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}n.Gradients=d},{"./doc":45,"./environment":47,"./globals":48,"./tensor":147,"./util":153}],50:[function(e,t,n){"use strict";function r(e){for(var p in e)n.hasOwnProperty(p)||(n[p]=e[p])}Object.defineProperty(n,"__esModule",{value:!0}),e("./kernels/backend_webgl"),e("./kernels/backend_cpu");var o=e("./browser_util"),l=e("./environment");n.environment=l;var c=e("./environment"),f=e("./io/io");n.io=f;var h=e("./serialization");n.serialization=h;var d=e("./test_util");n.test_util=d;var m=e("./util");n.util=m;var y=e("./version");n.version_core=y.version;var v=e("./webgl");n.webgl=v;var w=e("./optimizers/adadelta_optimizer");n.AdadeltaOptimizer=w.AdadeltaOptimizer;var x=e("./optimizers/adagrad_optimizer");n.AdagradOptimizer=x.AdagradOptimizer;var _=e("./optimizers/adam_optimizer");n.AdamOptimizer=_.AdamOptimizer;var N=e("./optimizers/adamax_optimizer");n.AdamaxOptimizer=N.AdamaxOptimizer;var E=e("./optimizers/momentum_optimizer");n.MomentumOptimizer=E.MomentumOptimizer;var A=e("./optimizers/optimizer");n.Optimizer=A.Optimizer;var O=e("./optimizers/rmsprop_optimizer");n.RMSPropOptimizer=O.RMSPropOptimizer;var S=e("./optimizers/sgd_optimizer");n.SGDOptimizer=S.SGDOptimizer;var T=e("./tensor");n.Tensor=T.Tensor,n.TensorBuffer=T.TensorBuffer,n.variable=T.variable,n.Variable=T.Variable;var I=e("./types");n.Rank=I.Rank,r(e("./ops/ops"));var k=e("./ops/loss_ops");n.Reduction=k.Reduction,r(e("./train")),r(e("./globals"));var P=e("./environment");n.ENV=P.ENV,n.Environment=P.Environment,n.setBackend=c.Environment.setBackend,n.getBackend=c.Environment.getBackend,n.disposeVariables=c.Environment.disposeVariables,n.memory=c.Environment.memory;var C=e("./doc");n.doc=C.doc,n.nextFrame=o.BrowserUtil.nextFrame},{"./browser_util":43,"./doc":45,"./environment":47,"./globals":48,"./io/io":54,"./kernels/backend_cpu":61,"./kernels/backend_webgl":63,"./ops/loss_ops":115,"./ops/ops":122,"./optimizers/adadelta_optimizer":135,"./optimizers/adagrad_optimizer":136,"./optimizers/adam_optimizer":137,"./optimizers/adamax_optimizer":138,"./optimizers/momentum_optimizer":139,"./optimizers/optimizer":140,"./optimizers/rmsprop_optimizer":142,"./optimizers/sgd_optimizer":143,"./serialization":145,"./tensor":147,"./test_util":149,"./train":151,"./types":152,"./util":153,"./version":154,"./webgl":155}],51:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("./io_utils"),f=e("./router_registry"),h="model",d=".json",m=".weights.bin",y=function(){function e(t){if(!l.ENV.get("IS_BROWSER"))throw new Error("triggerDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t=h),this.modelTopologyFileName=t+d,this.weightDataFileName=t+m}return e.prototype.save=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l,f,h;return o(this,(function(o){if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),e.modelTopology instanceof ArrayBuffer)throw new Error("DownloadTrigger.save() does not support saving model topology in binary formats yet.");return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,weightsManifest:n},l=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(f=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,f.href=l,f.click(),null!=e.weightData&&((h=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,h.href=t,h.click()),[2,{modelArtifactsInfo:c.getModelArtifactsInfoForJSON(e)}]}))}))},e.URL_SCHEME="downloads://",e}();n.BrowserDownloads=y;var v=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return r(this,void 0,void 0,(function(){var e,t,n=this;return o(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,o){var l=new FileReader;l.onload=function(l){var f=JSON.parse(l.target.result),h=f.modelTopology;if(null!=h){0===t.length&&r({modelTopology:h});var d=f.weightsManifest;if(null!=d){var m;try{m=n.checkManifestAndWeightFiles(d,t)}catch(e){return void o(e)}var y=[],v=[],w=[];d.forEach((function(e){e.paths.forEach((function(path){v.push(path),w.push(null)})),y.push.apply(y,e.weights)})),d.forEach((function(e){e.paths.forEach((function(path){var e=new FileReader;e.onload=function(e){var t=e.target.result,n=v.indexOf(path);w[n]=t,-1===w.indexOf(null)&&r({modelTopology:h,weightSpecs:y,weightData:c.concatenateArrayBuffers(w)})},e.onerror=function(e){o("Failed to weights data from file of path '"+path+"'.")},e.readAsArrayBuffer(m[path])}))}))}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},l.onerror=function(t){o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return c.basename(e.name)})),o={},l=0,f=e;l<f.length;l++)f[l].paths.forEach((function(path){var e=c.basename(path);if(-1!==n.indexOf(e))throw new Error("Duplicate file basename found in weights manifest: '"+e+"'");if(n.push(e),-1===r.indexOf(e))throw new Error("Weight file with basename '"+e+"' is not provided.");o[path]=t[r.indexOf(e)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return o},e}();function w(e){return void 0===e&&(e="model"),new y(e)}n.browserDownloadsRouter=function(e){return l.ENV.get("IS_BROWSER")&&e.startsWith(y.URL_SCHEME)?w(e.slice(y.URL_SCHEME.length)):null},f.IORouterRegistry.registerSaveRouter(n.browserDownloadsRouter),n.browserDownloads=w,n.browserFiles=function(e){return new v(e)}},{"../environment":47,"./io_utils":55,"./router_registry":58}],52:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../util"),f=e("./io_utils"),h=e("./router_registry"),d=function(){function e(path,e){if(this.DEFAULT_METHOD="POST",!l.ENV.get("IS_BROWSER"))throw new Error("browserHTTPRequest is not supported outside the web browser.");if(c.assert(null!=path&&path.length>0,"URL path for browserHTTPRequest must not be null, undefined or empty."),this.path=path,null!=e&&null!=e.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e||{}}return e.prototype.save=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l;return o(this,(function(o){switch(o.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,fetch(this.path,t)];case 1:if(200===(l=o.sent()).status)return[2,{modelArtifactsInfo:f.getModelArtifactsInfoForJSON(e),responses:[l]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+l.status+".")}}))}))},e.URL_SCHEMES=["http://","https://"],e}();function m(path,e){return new d(path,e)}n.BrowserHTTPRequest=d,n.httpRequestRouter=function(e){if(l.ENV.get("IS_BROWSER")){for(var t=0,n=d.URL_SCHEMES;t<n.length;t++){var r=n[t];if(e.startsWith(r))return m(e)}return null}return null},h.IORouterRegistry.registerSaveRouter(n.httpRequestRouter),n.browserHTTPRequest=m},{"../environment":47,"../util":153,"./io_utils":55,"./router_registry":58}],53:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("./io_utils"),f=e("./model_management"),h=e("./router_registry"),d="tensorflowjs",m="models_store",y="model_info_store";function v(){if(!l.ENV.get("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function w(e){var t=e.result;t.createObjectStore(m,{keyPath:"modelPath"}),t.createObjectStore(y,{keyPath:"modelPath"})}n.deleteDatabase=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){return e=v(),[2,new Promise((function(t,n){var r=e.deleteDatabase(d);r.onsuccess=function(){return t()},r.onerror=function(e){return n(e)}}))]}))}))};var x=function(){function e(e){if(this.indexedDB=v(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var o=n.indexedDB.open(d,1);o.onupgradeneeded=function(){return w(o)},o.onsuccess=function(){var l=o.result;if(null==t){var f=l.transaction(m,"readonly"),h=f.objectStore(m).get(n.modelPath);h.onsuccess=function(){if(null==h.result)return l.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(h.result.modelArtifacts)},h.onerror=function(e){return l.close(),r(h.error)},f.oncomplete=function(){return l.close()}}else{var d,v=c.getModelArtifactsInfoForJSON(t),w=l.transaction(y,"readwrite"),x=w.objectStore(y),_=x.put({modelPath:n.modelPath,modelArtifactsInfo:v});_.onsuccess=function(){var o=(d=l.transaction(m,"readwrite")).objectStore(m).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:v});o.onsuccess=function(){return e({modelArtifactsInfo:v})},o.onerror=function(e){var t=(x=w.objectStore(y)).delete(n.modelPath);t.onsuccess=function(){return l.close(),r(o.error)},t.onerror=function(e){return l.close(),r(o.error)}}},_.onerror=function(e){return l.close(),r(_.error)},w.oncomplete=function(){null==d?l.close():d.oncomplete=function(){return l.close()}}}},o.onerror=function(e){return r(o.error)}}))},e.URL_SCHEME="indexeddb://",e}();function _(e){return new x(e)}n.BrowserIndexedDB=x,n.indexedDBRouter=function(e){return l.ENV.get("IS_BROWSER")&&e.startsWith(x.URL_SCHEME)?_(e.slice(x.URL_SCHEME.length)):null},h.IORouterRegistry.registerSaveRouter(n.indexedDBRouter),h.IORouterRegistry.registerLoadRouter(n.indexedDBRouter),n.browserIndexedDB=_;var N=function(){function e(){this.indexedDB=v()}return e.prototype.listModels=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open(d,1);r.onupgradeneeded=function(){return w(r)},r.onsuccess=function(){var e=r.result,o=e.transaction(y,"readonly"),l=o.objectStore(y).getAll();l.onsuccess=function(){for(var e={},n=0,r=l.result;n<r.length;n++){var o=r[n];e[o.modelPath]=o.modelArtifactsInfo}t(e)},l.onerror=function(t){return e.close(),n(l.error)},o.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(path){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){var n;return path=(n=path).startsWith(x.URL_SCHEME)?n.slice(x.URL_SCHEME.length):n,[2,new Promise((function(t,n){var r=e.indexedDB.open(d,1);r.onupgradeneeded=function(){return w(r)},r.onsuccess=function(){var e,o=r.result,l=o.transaction(y,"readwrite"),c=l.objectStore(y),f=c.get(path);f.onsuccess=function(){if(null==f.result)return o.close(),n(new Error("Cannot find model with path '"+path+"' in IndexedDB."));var r=c.delete(path),l=function(){var r=(e=o.transaction(m,"readwrite")).objectStore(m).delete(path);r.onsuccess=function(){return t(f.result.modelArtifactsInfo)},r.onerror=function(e){return n(f.error)}};r.onsuccess=l,r.onerror=function(e){return l(),o.close(),n(f.error)}},f.onerror=function(e){return o.close(),n(f.error)},l.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},r.onerror=function(e){return n(r.error)}}))]}))}))},e}();if(n.BrowserIndexedDBManager=N,l.ENV.get("IS_BROWSER"))try{f.ModelStoreManagerRegistry.registerManager(x.URL_SCHEME,new N)}catch(e){}},{"../environment":47,"./io_utils":55,"./model_management":57,"./router_registry":58}],54:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("./indexed_db"),e("./local_storage");var r=e("./browser_files");n.browserFiles=r.browserFiles;var o=e("./browser_http");n.browserHTTPRequest=o.browserHTTPRequest;var l=e("./io_utils");n.decodeWeights=l.decodeWeights,n.encodeWeights=l.encodeWeights;var c=e("./model_management"),f=e("./router_registry"),h=e("./weights_loader");n.loadWeights=h.loadWeights;var d=f.IORouterRegistry.registerSaveRouter;n.registerSaveRouter=d;var m=f.IORouterRegistry.registerLoadRouter;n.registerLoadRouter=m;var y=f.IORouterRegistry.getSaveHandlers;n.getSaveHandlers=y;var v=f.IORouterRegistry.getLoadHandlers;n.getLoadHandlers=v;var w=c.ModelManagement.copyModel;n.copyModel=w;var x=c.ModelManagement.listModels;n.listModels=x;var _=c.ModelManagement.moveModel;n.moveModel=_;var N=c.ModelManagement.removeModel;n.removeModel=N},{"./browser_files":51,"./browser_http":52,"./indexed_db":53,"./io_utils":55,"./local_storage":56,"./model_management":57,"./router_registry":58,"./weights_loader":60}],55:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../ops/array_ops"),c=e("../util"),f=e("./types");function h(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0;e.forEach((function(e){if(e instanceof Float32Array||e instanceof Int32Array)t+=4*e.length;else{if(!(e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name);t+=e.length}}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e.buffer),r),e instanceof Float32Array||e instanceof Int32Array?r+=4*e.length:r+=e.length})),n.buffer}function d(e){return new Blob([e]).size}n.encodeWeights=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l;return o(this,(function(o){switch(o.label){case 0:for(r in t=[],n=[],e){if("float32"!==(l=e[r]).dtype&&"int32"!==l.dtype&&"bool"!==l.dtype)throw new Error("Unsupported dtype in weight '"+r+"': "+l.dtype);t.push({name:r,shape:l.shape,dtype:l.dtype}),n.push(l.data())}return[4,Promise.all(n)];case 1:return[2,{data:h(o.sent()),specs:t}]}}))}))},n.decodeWeights=function(e,t){for(var n={},r=0,o=0,h=t;o<h.length;o++){var d=h[o],m=d.name,y=d.dtype,v=d.shape;if(null!=d.quantization)throw new Error("decodeWeights does not support quantization yet, but encountered weight '"+m+" with quantization.'");var w=c.sizeFromShape(v),x=void 0;if("float32"===y)x=l.ArrayOps.tensor(new Float32Array(e,r,w),v,"float32");else if("int32"===y)x=l.ArrayOps.tensor(new Int32Array(e,r,w),v,"int32");else{if("bool"!==y)throw new Error("Unsupported dtype in weight '"+m+"': "+y);x=l.ArrayOps.tensor(new Uint8Array(e,r,w),v,"bool")}n[m]=x,r+=w*f.DTYPE_VALUE_SIZE_MAP[y]}return n},n.concatenateTypedArrays=h,n.stringByteLength=d,n.arrayBufferToBase64String=function(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))},n.base64StringToArrayBuffer=function(e){for(var s=atob(e),t=new Uint8Array(s.length),i=0;i<s.length;++i)t.set([s.charCodeAt(i)],i);return t.buffer},n.concatenateArrayBuffers=function(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer},n.basename=function(path){for(path=path.trim();path.endsWith("/");)path=path.slice(0,path.length-1);var e=path.split("/");return e[e.length-1]},n.getModelArtifactsInfoForJSON=function(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:d(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:d(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}},{"../ops/array_ops":101,"../util":153,"./types":59}],56:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../util"),f=e("./io_utils"),h=e("./model_management"),d=e("./router_registry"),m="/",y="tensorflowjs_models",v="info",w="model_topology",x="weight_specs",_="weight_data";function N(path){return{info:[y,path,v].join(m),topology:[y,path,w].join(m),weightSpecs:[y,path,x].join(m),weightData:[y,path,_].join(m)}}function E(e){var t=e.split(m);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(m)}n.purgeLocalStorageArtifacts=function(){if(!l.ENV.get("IS_BROWSER")||void 0===window.localStorage)throw new Error("purgeLocalStorageModels() cannot proceed because local storage is unavailable in the current environment.");for(var e=window.localStorage,t=[],i=0;i<e.length;++i){var n=e.key(i),r=y+m;if(n.startsWith(r)&&n.length>r.length){e.removeItem(n);var o=E(n);-1===t.indexOf(o)&&t.push(o)}}return t};var A=function(){function e(e){if(!l.ENV.get("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=N(this.modelPath)}return e.prototype.save=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l;return o(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=f.getModelArtifactsInfoForJSON(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,f.arrayBufferToBase64String(e.weightData)),[2,{modelArtifactsInfo:r}]}catch(e){for(l in this.keys)this.LS.removeItem(this.keys[l]);throw new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,l;return o(this,(function(o){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null==(l=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=f.base64StringToArrayBuffer(l),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}();function O(e){return new A(e)}n.BrowserLocalStorage=A,n.localStorageRouter=function(e){return l.ENV.get("IS_BROWSER")&&e.startsWith(A.URL_SCHEME)?O(e.slice(A.URL_SCHEME.length)):null},d.IORouterRegistry.registerSaveRouter(n.localStorageRouter),d.IORouterRegistry.registerLoadRouter(n.localStorageRouter),n.browserLocalStorage=O;var S=function(){function e(){c.assert(l.ENV.get("IS_BROWSER"),"Current environment is not a web browser"),c.assert(void 0!==window.localStorage,"Current browser does not appear to support localStorage"),this.LS=window.localStorage}return e.prototype.listModels=function(){return r(this,void 0,void 0,(function(){var e,t,n,i,r,l;return o(this,(function(o){for(e={},t=y+m,n=m+v,i=0;i<this.LS.length;++i)(r=this.LS.key(i)).startsWith(t)&&r.endsWith(n)&&(l=E(r),e[l]=JSON.parse(this.LS.getItem(r)));return[2,e]}))}))},e.prototype.removeModel=function(path){return r(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){var r;if(path=(r=path).startsWith(A.URL_SCHEME)?r.slice(A.URL_SCHEME.length):r,e=N(path),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+path+"'");return t=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,t]}))}))},e}();if(n.BrowserLocalStorageManager=S,l.ENV.get("IS_BROWSER"))try{h.ModelStoreManagerRegistry.registerManager(A.URL_SCHEME,new S)}catch(e){}},{"../environment":47,"../util":153,"./io_utils":55,"./model_management":57,"./router_registry":58}],57:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../doc"),f=e("../util"),h=e("./router_registry"),d="://",m=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){f.assert(null!=t,"scheme must not be undefined or null."),t.endsWith(d)&&(t=t.slice(0,t.indexOf(d))),f.assert(t.length>0,"scheme must not be an empty string.");var r=e.getInstance();f.assert(null==r.managers[t],"A model store manager is already registered for scheme '"+t+"'."),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function y(e){if(-1===e.indexOf(d))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+m.getSchemes().join(","));return{scheme:e.split(d)[0],path:e.split(d)[1]}}function v(e,t,n){return void 0===n&&(n=!1),o(this,void 0,void 0,(function(){var r,o,c,d,v,w,x,_,N;return l(this,(function(l){switch(l.label){case 0:return f.assert(e!==t,"Old path and new path are the same: '"+e+"'"),r=h.IORouterRegistry.getLoadHandlers(e),f.assert(r.length>0,"Copying failed because no load handler is found for source URL "+e+"."),f.assert(r.length<2,"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."),o=r[0],c=h.IORouterRegistry.getSaveHandlers(t),f.assert(c.length>0,"Copying failed because no save handler is found for destination URL "+t+"."),f.assert(c.length<2,"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."),d=c[0],v=y(e).scheme,w=y(e).path,x=v===y(e).scheme,[4,o.load()];case 1:return _=l.sent(),n&&x?[4,m.getManager(v).removeModel(w)]:[3,3];case 2:l.sent(),l.label=3;case 3:return[4,d.save(_)];case 4:return N=l.sent(),!n||x?[3,6]:[4,m.getManager(v).removeModel(w)];case 5:l.sent(),l.label=6;case 6:return[2,N.modelArtifactsInfo]}}))}))}n.ModelStoreManagerRegistry=m;var w=function(){function e(){}return e.listModels=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,o,c,path;return l(this,(function(l){switch(l.label){case 0:e=m.getSchemes(),t={},n=0,r=e,l.label=1;case 1:return n<r.length?(o=r[n],[4,m.getManager(o).listModels()]):[3,4];case 2:for(path in c=l.sent())t[o+d+path]=c[path];l.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},e.removeModel=function(e){return o(this,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return t=y(e),[4,m.getManager(t.scheme).removeModel(t.path)];case 1:return[2,n.sent()]}}))}))},e.copyModel=function(e,t){return o(this,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return[4,v(e,t,!1)];case 1:return[2,n.sent()]}}))}))},e.moveModel=function(e,t){return o(this,void 0,void 0,(function(){return l(this,(function(n){switch(n.label){case 0:return[4,v(e,t,!0)];case 1:return[2,n.sent()]}}))}))},r([c.doc({heading:"Models",subheading:"Management"})],e,"listModels",null),r([c.doc({heading:"Models",subheading:"Management"})],e,"removeModel",null),r([c.doc({heading:"Models",subheading:"Management"})],e,"copyModel",null),r([c.doc({heading:"Models",subheading:"Management"})],e,"moveModel",null),e}();n.ModelManagement=w},{"../doc":45,"../util":153,"./router_registry":58}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t){return e.getHandlers(t,"load")},e.getHandlers=function(e,t){var n=[];return("load"===t?this.getInstance().loadRouters:this.getInstance().saveRouters).forEach((function(t){var r=t(e);null!==r&&n.push(r)})),n},e}();n.IORouterRegistry=r},{}],59:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DTYPE_VALUE_SIZE_MAP={float32:4,int32:4,uint16:2,uint8:1,bool:1}},{}],60:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../ops/ops"),c=e("../util"),f=e("./types");n.loadWeights=function(e,t,n,h){return void 0===t&&(t=""),r(this,void 0,void 0,(function(){var r,d,m,y,v,w,x,_,N,E,A;return o(this,(function(o){switch(o.label){case 0:if(r=e.map((function(){return!1})),d={},m=null!=n?n.map((function(){return!1})):[],y=[],e.forEach((function(e,t){var o=0;e.weights.forEach((function(e){var l="quantization"in e?e.quantization.dtype:e.dtype,h=f.DTYPE_VALUE_SIZE_MAP[l]*c.sizeFromShape(e.shape),v=function(){r[t]=!0,null==d[t]&&(d[t]=[]),d[t].push({manifestEntry:e,groupOffset:o,sizeBytes:h})};null!=n?n.forEach((function(t,n){t===e.name&&(v(),m[n]=!0)})):v(),y.push(e.name),o+=h}))})),!m.every((function(e){return e})))throw v=n.filter((function(e,i){return!m[i]})),new Error("Could not find weights in manifest with names: "+v.join(", ")+". \nManifest JSON has weights with names: "+y.join(", ")+".");return w=r.reduce((function(e,t,i){return t&&e.push(i),e}),[]),x=[],w.forEach((function(i){e[i].paths.forEach((function(e){var n=t+(t.endsWith("/")?"":"/")+e;x.push(fetch(n,h))}))})),[4,Promise.all(x)];case 1:return _=o.sent(),[4,Promise.all(_.map((function(e){return e.arrayBuffer()})))];case 2:return N=o.sent(),E={},A=0,w.forEach((function(i){for(var t=e[i].paths.length,n=0,r=0;r<t;r++)n+=N[A+r].byteLength;for(var o=new ArrayBuffer(n),c=new Uint8Array(o),f=0,h=0;h<t;h++){var m=new Uint8Array(N[A+h]);c.set(m,f),f+=m.byteLength}d[i].forEach((function(e){var t,n=o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),r=e.manifestEntry.dtype;if("quantization"in e.manifestEntry){var c=e.manifestEntry.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.manifestEntry.name+" has unknown quantization dtype "+c.dtype+".");var f="uint8"===c.dtype?new Uint8Array(n):new Uint16Array(n);if("float32"===r)t=Float32Array.from(f,(function(e){return e*c.scale+c.min}));else{if("int32"!==r)throw new Error("Weight "+e.manifestEntry.name+" has a dtype not supported by quantization: "+r);t=Int32Array.from(f,(function(e){return Math.round(e*c.scale+c.min)}))}}else if("float32"===r)t=new Float32Array(n);else{if("int32"!==r)throw new Error("Weight "+e.manifestEntry.name+" has unknown dtype "+r+".");t=new Int32Array(n)}var h=e.manifestEntry.name;if(null!=E[h])throw new Error("Duplicate weight with name "+h+". Please make sure weights names are unique in the manifest JSON.");E[h]=l.tensor(t,e.manifestEntry.shape,e.manifestEntry.dtype)})),A+=t})),[2,E]}}))}))}},{"../ops/ops":122,"../util":153,"./types":59}],61:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("seedrandom"),c=e("../environment"),f=e("../ops/axis_util"),h=e("../ops/broadcast_util"),d=e("../ops/concat_util"),m=e("../ops/erf_util"),y=e("../ops/ops"),v=e("../ops/ops"),w=e("../ops/selu_util"),x=e("../ops/slice_util"),_=e("../tensor"),N=e("../types"),E=e("../util"),A=e("./backend_util"),O=function(){function e(){this.data=new WeakMap,"undefined"!=typeof document&&(this.canvas=document.createElement("canvas"))}return e.prototype.register=function(e,t,n){if(this.data.has(e))throw new Error("Data buffer is already registered");this.data.set(e,null)},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendCPU.write(): values can not be null");this.throwIfNoData(e),this.data.set(e,t)},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("MathBackendCPU.writePixels(): pixels can not be null");var n,r;if(e instanceof ImageData)n=e.data;else if(e instanceof HTMLCanvasElement)n=e.getContext("2d").getImageData(0,0,e.width,e.height).data;else{if(!(e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error("pixels is of unknown type: "+e.constructor.name);if(null==this.canvas)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext("2d").drawImage(e,0,0,e.width,e.height),n=this.canvas.getContext("2d").getImageData(0,0,e.width,e.height).data}if(4===t)r=new Int32Array(n);else{var o=e.width*e.height;r=new Int32Array(o*t);for(var i=0;i<o;i++)for(var l=0;l<t;++l)r[i*t+l]=n[4*i+l]}var c=[e.height,e.width,t];return v.tensor3d(r,c,"int32")},e.prototype.read=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,this.readSync(e)]}))}))},e.prototype.readSync=function(e){return this.throwIfNoData(e),this.data.get(e)},e.prototype.disposeData=function(e){this.data.has(e)&&this.data.delete(e)},e.prototype.time=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){return t=performance.now(),e(),[2,{kernelMs:performance.now()-t}]}))}))},e.prototype.memory=function(){return{unreliable:!0}},e.prototype.throwIfNoData=function(e){if(!this.data.has(e))throw new Error("CPU backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},e.prototype.slice=function(e,t,n){for(var r=y.buffer(n,e.dtype),i=0;i<r.size;++i){var o=r.indexToLoc(i),l=o.map((function(e,n){return e+t[n]}));r.set.apply(r,[e.get.apply(e,l)].concat(o))}return r.toTensor()},e.prototype.stridedSlice=function(e,t,n,r,o,l){var c=x.getStridedSlicedInfo(e.shape,t,n,r,o,l),f=c[0],h=c[1];if(h.some((function(e){return 0===e})))return y.tensor([],h);for(var d=y.buffer(h,e.dtype),i=0;i<d.size;i++){for(var m=d.indexToLoc(i),v=new Array(m.length),w=0;w<v.length;w++)v[w]=m[w]*r[w]+f[w];d.set.apply(d,[e.get.apply(e,v)].concat(m))}return d.toTensor()},e.prototype.reverse=function(e,t){for(var n=y.buffer(e.shape,e.dtype),r=e.buffer(),o=function(i){var o=n.indexToLoc(i),l=o.slice();t.forEach((function(t){return l[t]=e.shape[t]-1-l[t]})),n.set.apply(n,[r.get.apply(r,l)].concat(o))},i=0;i<n.size;i++)o(i);return n.toTensor()},e.prototype.concat=function(a,b){var e=d.computeOutShape(a.shape,b.shape,1),t=y.buffer(e,a.dtype);if(1===a.shape[0]&&1===b.shape[0]){var n=a.dataSync(),r=b.dataSync(),o=t.values;return o.set(n,0),o.set(r,a.size),t.toTensor()}for(var i=0;i<e[0];++i){for(var l=0;l<a.shape[1];++l)t.set(a.get(i,l),i,l);for(l=0;l<b.shape[1];++l)t.set(b.get(i,l),i,l+a.shape[1])}return t.toTensor()},e.prototype.neg=function(e){return this.multiply(y.scalar(-1),e)},e.prototype.add=function(a,b){return this.broadcastedBinaryOp(a,b,N.upcastType(a.dtype,b.dtype),(function(e,t){return e+t}))},e.prototype.subtract=function(a,b){return this.broadcastedBinaryOp(a,b,N.upcastType(a.dtype,b.dtype),(function(e,t){return e-t}))},e.prototype.pow=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,(function(e,t){return Math.pow(e,t)}))},e.prototype.matMul=function(a,b,e,t){for(var n=e?a.shape[0]:a.shape[1],r=e?a.shape[1]:a.shape[0],o=t?b.shape[0]:b.shape[1],l=a.dataSync(),c=b.dataSync(),f=e?[1,a.strides[0]]:[a.strides[0],1],h=f[0],d=f[1],m=t?[b.strides[0],1]:[1,b.strides[0]],v=m[0],w=m[1],x=r*h,_=o*v,N=new Float32Array(r*o),E=0,A=0;A<x;A+=h)for(var O=0;O<_;O+=v){for(var S=A,T=O,I=0,k=0;k<n;++k)I+=l[S]*c[T],S+=d,T+=w;N[E++]=I}return y.tensor2d(N,[r,o])},e.prototype.multiply=function(a,b){return this.broadcastedBinaryOp(a,b,N.upcastType(a.dtype,b.dtype),(function(e,t){return e*t}))},e.prototype.divide=function(a,b){var e,t;return"int32"===a.dtype&&"int32"===b.dtype?(t="int32",e=function(a,b){return Math.floor(a/b)}):(t="float32",e=function(a,b){return a/b}),this.broadcastedBinaryOp(a,b,t,e)},e.prototype.sum=function(e,t){f.assertAxesAreInnerMostDims("sum",t,e.rank);for(var n=f.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],l=N.upcastType(e.dtype,"int32"),c=y.zeros(r,l),h=E.sizeFromShape(o),d=c.dataSync(),m=e.dataSync(),i=0;i<d.length;++i){for(var v=i*h,w=0,x=0;x<h;++x)w+=m[v+x];d[i]=w}return c},e.prototype.argMin=function(e,t){var n=[t];f.assertAxesAreInnerMostDims("argMin",n,e.rank);for(var r=f.computeOutAndReduceShapes(e.shape,n),o=r[0],l=r[1],c=y.zeros(o,"int32"),h=E.sizeFromShape(l),d=c.dataSync(),m=e.dataSync(),i=0;i<d.length;++i){for(var v=i*h,w=m[v],x=0,_=0;_<h;++_){var N=m[v+_];N<w&&(w=N,x=_)}d[i]=x}return c},e.prototype.argMax=function(e,t){var n=[t];f.assertAxesAreInnerMostDims("argMax",n,e.rank);for(var r=f.computeOutAndReduceShapes(e.shape,n),o=r[0],l=r[1],c=y.zeros(o,"int32"),h=E.sizeFromShape(l),d=c.dataSync(),m=e.dataSync(),i=0;i<d.length;++i){for(var v=i*h,w=m[v],x=0,_=0;_<h;++_){var N=m[v+_];N>w&&(w=N,x=_)}d[i]=x}return c},e.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var o=N.upcastType(e.dtype,"int32"),l=y.zeros(e.shape,o),c=l.dataSync(),f=e.dataSync(),h=e.shape[e.rank-1],d=r?function(i,e){return i+h-e-1}:function(i,e){return i+e},i=0;i<f.length;i+=h)for(var m=0;m<h;m++){var v=d(i,m);if(0===m)c[v]=n?0:f[v];else{var w=d(i,m-1);c[v]=n?f[w]+c[w]:f[v]+c[w]}}return l},e.prototype.equal=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e===t?1:0}))},e.prototype.notEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e!==t?1:0}))},e.prototype.less=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e<t?1:0}))},e.prototype.lessEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e<=t?1:0}))},e.prototype.greater=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e>t?1:0}))},e.prototype.greaterEqual=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e>=t?1:0}))},e.prototype.logicalNot=function(e){for(var t=e.dataSync(),n=new Int32Array(t.length),i=0;i<t.length;++i)n[i]=t[i]?0:1;return _.Tensor.make(e.shape,{values:n},"bool")},e.prototype.logicalAnd=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e&&t}))},e.prototype.logicalOr=function(a,b){return this.broadcastedBinaryOp(a,b,"bool",(function(e,t){return e||t}))},e.prototype.where=function(e,a,b,t){for(var n=e.dataSync(),r=a.dataSync(),o=b.dataSync(),l=y.zeros(a.shape,t),c=l.dataSync(),f=0,h=0===e.rank||e.rank>1||1===a.rank?1:a.shape[1],i=0;i<n.length;i++)for(var d=0;d<h;d++)1===n[i]?c[f++]=r[i]:c[f++]=o[i];return l},e.prototype.topKValues=function(e,t){return this.topK(e,t).values},e.prototype.topKIndices=function(e,t){return this.topK(e,t).indices},e.prototype.topK=function(e,t){for(var n=e.dataSync(),r=[],i=0;i<n.length;i++)r.push({value:n[i],index:i});r.sort((function(a,b){return b.value-a.value}));var o=E.getTypedArrayFromDType(e.dtype,t),l=new Int32Array(t);for(i=0;i<t;i++)o[i]=r[i].value,l[i]=r[i].index;return{values:y.tensor1d(o,e.dtype),indices:y.tensor1d(l,"int32")}},e.prototype.min=function(e,t){f.assertAxesAreInnerMostDims("min",t,e.rank);for(var n=f.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],l=y.zeros(r,e.dtype),c=E.sizeFromShape(o),h=l.dataSync(),d=e.dataSync(),i=0;i<h.length;++i){for(var m=i*c,v=d[0],w=0;w<c;++w){var x=d[m+w];x<v&&(v=x)}h[i]=v}return l},e.prototype.minimum=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,(function(e,t){return Math.min(e,t)}))},e.prototype.mod=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},e.prototype.max=function(e,t){f.assertAxesAreInnerMostDims("max",t,e.rank);for(var n=f.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],l=y.zeros(r,e.dtype),c=E.sizeFromShape(o),h=l.dataSync(),d=e.dataSync(),i=0;i<h.length;++i){for(var m=i*c,v=d[m],w=0;w<c;++w){var x=d[m+w];x>v&&(v=x)}h[i]=v}return l},e.prototype.maximum=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,(function(e,t){return Math.max(e,t)}))},e.prototype.squaredDifference=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,(function(e,t){var n=e-t;return n*n}))},e.prototype.ceil=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i)n[i]=Math.ceil(t[i]);return _.Tensor.make(e.shape,{values:n})},e.prototype.floor=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i)n[i]=Math.floor(t[i]);return _.Tensor.make(e.shape,{values:n})},e.prototype.sign=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i)t[i]<0?n[i]=-1:t[i]>0?n[i]=1:n[i]=0;return _.Tensor.make(e.shape,{values:n})},e.prototype.round=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i){var base=Math.floor(t[i]);t[i]-base<.5?n[i]=Math.floor(t[i]):t[i]-base>.5?n[i]=Math.ceil(t[i]):n[i]=base%2==0?base:base+1}return _.Tensor.make(e.shape,{values:n})},e.prototype.exp=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i)n[i]=Math.exp(t[i]);return _.Tensor.make(e.shape,{values:n})},e.prototype.expm1=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i)n[i]=Math.expm1(t[i]);return _.Tensor.make(e.shape,{values:n})},e.prototype.log=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i){var r=t[i];n[i]=Math.log(r)}return _.Tensor.make(e.shape,{values:n})},e.prototype.log1p=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i){var r=t[i];n[i]=Math.log1p(r)}return _.Tensor.make(e.shape,{values:n})},e.prototype.sqrt=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i){var r=t[i];n[i]=Math.sqrt(r)}return _.Tensor.make(e.shape,{values:n})},e.prototype.rsqrt=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i){var r=t[i];n[i]=1/Math.sqrt(r)}return _.Tensor.make(e.shape,{values:n})},e.prototype.square=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i){var r=t[i];n[i]=r*r}return _.Tensor.make(e.shape,{values:n})},e.prototype.reciprocal=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),i=0;i<t.length;++i)n[i]=1/t[i];return _.Tensor.make(e.shape,{values:n})},e.prototype.relu=function(e){for(var t=y.zeros(e.shape,e.dtype),n=t.dataSync(),r=e.dataSync(),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return t},e.prototype.elu=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i){var r=n[i];t[i]=r>=0?r:Math.exp(r)-1}return _.Tensor.make(e.shape,{values:t})},e.prototype.eluDer=function(e,t){for(var n=new Float32Array(t.size),r=t.dataSync(),o=e.dataSync(),i=0;i<r.length;++i){var l=r[i];n[i]=l>=1?o[i]:o[i]*(l+1)}return _.Tensor.make(t.shape,{values:n})},e.prototype.selu=function(e){for(var t=w.SELU_SCALEALPHA,n=w.SELU_SCALE,r=new Float32Array(e.size),o=e.dataSync(),i=0;i<o.length;++i){var l=o[i];r[i]=l>=0?n*l:t*(Math.exp(l)-1)}return _.Tensor.make(e.shape,{values:r})},e.prototype.clip=function(e,t,n){for(var r=new Float32Array(e.size),o=e.dataSync(),i=0;i<o.length;++i)r[i]=Math.min(n,Math.max(t,o[i]));return _.Tensor.make(e.shape,{values:r})},e.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.abs(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.int=function(e){for(var t=new Int32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=n[i];return _.Tensor.make(e.shape,{values:t},"int32")},e.prototype.sigmoid=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=1/(1+Math.exp(-n[i]));return _.Tensor.make(e.shape,{values:t})},e.prototype.softplus=function(e){for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=e.dataSync(),i=0;i<r.length;++i){var o=r[i]>-t,l=r[i]<t,c=Math.exp(r[i]),f=void 0;f=l?c:o?r[i]:Math.log(1+c),n[i]=f}return _.Tensor.make(e.shape,{values:n})},e.prototype.sin=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.sin(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.cos=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.cos(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.tan=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.tan(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.asin=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.asin(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.acos=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.acos(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.atan=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.atan(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.atan2=function(a,b){return this.broadcastedBinaryOp(a,b,a.dtype,(function(e,t){return Math.atan2(e,t)}))},e.prototype.sinh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.sinh(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.cosh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.cosh(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.tanh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=E.tanh(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.asinh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.asinh(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.acosh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.acosh(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.atanh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),i=0;i<n.length;++i)t[i]=Math.atanh(n[i]);return _.Tensor.make(e.shape,{values:t})},e.prototype.erf=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),p=m.ERF_P,r=m.ERF_A1,o=m.ERF_A2,l=m.ERF_A3,c=m.ERF_A4,f=m.ERF_A5,i=0;i<n.length;++i){var h=n[i],d=1/(1+p*h);t[i]=1-((((f*d+c)*d+l)*d+o)*d+r)*d*Math.exp(-h*h)}return _.Tensor.make(e.shape,{values:t})},e.prototype.step=function(e,t){void 0===t&&(t=0);for(var n=new Float32Array(e.size),r=e.dataSync(),i=0;i<r.length;++i){var o=r[i];isNaN(o)?n[i]=NaN:n[i]=o>0?1:t}return _.Tensor.make(e.shape,{values:n})},e.prototype.conv2d=function(e,filter,t){for(var n=t.filterHeight,r=t.filterWidth,o=t.dilationHeight,l=t.dilationWidth,c=t.padInfo.left,f=t.padInfo.top,h=y.buffer(t.outShape,e.dtype),b=0;b<t.batchSize;++b)for(var d=0;d<t.outChannels;++d)for(var m=0;m<t.outHeight;++m)for(var v=m*t.strideHeight-c,w=0;w<t.outWidth;++w){for(var x=w*t.strideWidth-f,_=0,N=0;N<n;N++){var E=v+N*o;if(!(E<0||E>=t.inHeight))for(var A=0;A<r;A++){var O=x+A*l;if(!(O<0||O>=t.inWidth))for(var S=0;S<t.inChannels;++S)_+=e.get(b,E,O,S)*filter.get(N,A,S,d)}}h.set(_,b,m,w,d)}return h.toTensor()},e.prototype.conv2dDerInput=function(e,filter,t){for(var n=y.buffer(t.inShape,"float32"),r=n.values,o=n.strides,l=o[0],c=o[1],f=o[2],h=e.dataSync(),d=e.strides,m=d[0],v=d[1],w=d[2],x=filter.dataSync(),_=filter.strides,N=_[0],E=_[1],A=_[2],O=t.batchSize,S=t.filterHeight,T=t.filterWidth,I=t.inChannels,k=t.inHeight,P=t.inWidth,C=t.outChannels,R=t.outHeight,z=t.outWidth,M=t.strideHeight,L=t.strideWidth,D=S-1-t.padInfo.top,V=T-1-t.padInfo.left,b=0;b<O;++b)for(var j=0;j<I;++j)for(var F=0;F<k;++F)for(var B=F-D,U=Math.max(0,Math.ceil(B/M)),G=Math.min(R,(S+B)/M),W=0;W<P;++W){for(var H=W-V,K=Math.max(0,Math.ceil(H/L)),X=Math.min(z,(T+H)/L),Y=0,J=U;J<G;++J)for(var Z=J*M-B,Q=K;Q<X;++Q)for(var $=m*b+v*J+w*Q,ee=N*(S-1-Z)+E*(T-1-(Q*L-H))+A*j,te=0;te<C;++te)Y+=h[$+te]*x[ee+te];r[l*b+c*F+f*W+j]=Y}return n.toTensor()},e.prototype.conv2dDerFilter=function(e,t,n){for(var r=n.strideHeight,o=n.strideWidth,l=n.filterHeight,c=n.filterWidth,f=y.buffer(n.filterShape,"float32"),h=n.padInfo.left,d=n.padInfo.top,m=0;m<l;++m)for(var v=Math.max(0,Math.ceil((d-m)/r)),w=Math.min(n.outHeight,(n.inHeight+d-m)/r),x=0;x<c;++x)for(var _=Math.max(0,Math.ceil((h-x)/o)),N=Math.min(n.outWidth,(n.inWidth+h-x)/o),E=0;E<n.inChannels;++E)for(var A=0;A<n.outChannels;++A){for(var O=0,b=0;b<n.batchSize;++b)for(var S=v;S<w;++S)for(var T=m+S*r-d,I=_;I<N;++I){var k=x+I*o-h;O+=e.get(b,T,k,E)*t.get(b,S,I,A)}f.set(O,m,x,E,A)}return f.toTensor()},e.prototype.depthwiseConv2D=function(e,filter,t){for(var n=t.filterHeight,r=t.filterWidth,o=t.dilationHeight,l=t.dilationWidth,c=t.padInfo.left,f=t.padInfo.top,h=t.outChannels/t.inChannels,d=y.buffer(t.outShape,e.dtype),b=0;b<t.batchSize;++b)for(var m=0;m<t.inChannels;++m)for(var v=0;v<t.outHeight;++v)for(var w=v*t.strideHeight-c,x=0;x<t.outWidth;++x)for(var _=x*t.strideWidth-f,q=0;q<h;++q){for(var N=0,E=0;E<n;++E){var A=w+E*o;if(!(A<0||A>=t.inHeight))for(var O=0;O<r;++O){var S=_+O*l;S<0||S>=t.inWidth||(N+=e.get(b,A,S,m)*filter.get(E,O,m,q))}}d.set(N,b,v,x,m*h+q)}return d.toTensor()},e.prototype.tile=function(e,t){for(var n=new Array(e.rank),i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];var r=y.buffer(n,e.dtype),o=e.buffer();for(i=0;i<r.values.length;++i){for(var l=r.indexToLoc(i),c=new Array(e.rank),f=0;f<c.length;f++)c[f]=l[f]%e.shape[f];var h=o.locToIndex(c);r.values[i]=o.values[h]}return r.toTensor()},e.prototype.pad=function(e,t,n){var r=t.map((function(p,i){return p[0]+e.shape[i]+p[1]})),o=t.map((function(p){return p[0]})),l=e.buffer(),c=y.buffer(r,e.dtype);0!==n&&c.values.fill(n);for(var i=0;i<e.size;i++){var f=l.indexToLoc(i),h=f.map((function(e,i){return e+o[i]}));c.set.apply(c,[e.get.apply(e,f)].concat(h))}return c.toTensor()},e.prototype.transpose=function(e,t){for(var n=new Array(e.rank),i=0;i<n.length;i++)n[i]=e.shape[t[i]];var r=e.dataSync(),o=v.buffer(n,e.dtype),l=e.buffer();for(i=0;i<e.size;++i){for(var c=l.indexToLoc(i),f=new Array(c.length),h=0;h<f.length;h++)f[h]=c[t[h]];var d=o.locToIndex(f);o.values[d]=r[i]}return o.toTensor()},e.prototype.gather=function(e,t,n){var r=e.shape.slice(),o=t.dataSync();r[n]=o.length;for(var l=v.buffer(r,e.dtype),c=e.buffer(),i=0;i<l.size;++i){var f=l.indexToLoc(i),h=f.slice();h[n]=o[f[n]];var d=c.locToIndex(h);l.values[i]=c.values[d]}return l.toTensor()},e.prototype.pool=function(e,t,n){for(var r=t.strideHeight,o=t.strideWidth,l=t.filterHeight,c=t.filterWidth,f=y.buffer(t.outShape,"float32"),h=t.padInfo.top,d=t.padInfo.left,b=0;b<t.batchSize;++b)for(var m=0;m<t.inChannels;++m)for(var v=0;v<t.outHeight;++v)for(var w=v*r-h,x=Math.max(0,w),_=Math.min(t.inHeight,l+w),N=0;N<t.outWidth;++N){for(var E=N*o-d,A=Math.max(0,E),O=Math.min(t.inWidth,c+E),S="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=0,I=0,k=x;k<_;++k){for(var P=A;P<O;++P){var C=e.get(b,k,P,m);"max"===n&&C>S?S=C:"avg"===n&&(T+=C,I++)}if(isNaN(S))break}f.set("avg"===n?T/I:S,b,v,N,m)}return f.toTensor()},e.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},e.prototype.maxPoolPositions=function(e,t){for(var n=y.buffer(t.outShape,"int32"),r=t.strideHeight,o=t.strideWidth,l=t.filterHeight,c=t.filterWidth,f=t.padInfo.top,h=t.padInfo.left,b=0;b<t.batchSize;++b)for(var d=0;d<t.inChannels;++d)for(var m=0;m<t.outHeight;++m)for(var v=m*r-f,w=Math.max(0,v),x=Math.min(t.inHeight,l+v),_=0;_<t.outWidth;++_){for(var N=_*o-h,E=Math.max(0,N),A=Math.min(t.inWidth,c+N),O=Number.NEGATIVE_INFINITY,S=-1,T=w;T<x;++T)for(var I=T-v,k=E;k<A;++k){var P=k-N,C=e.get(b,T,k,d);C>O&&(O=C,S=I*c+P)}n.set(S,b,m,_,d)}return n.toTensor()},e.prototype.maxPoolBackprop=function(e,t,n,r){for(var o=this.maxPoolPositions(t,r),l=r.strideHeight,c=r.strideWidth,f=r.filterHeight,h=r.filterWidth,d=h-1-r.padInfo.left,m=f-1-r.padInfo.top,v=y.buffer(t.shape,"float32"),b=0;b<r.batchSize;++b)for(var w=0;w<r.inChannels;++w)for(var x=0;x<r.inHeight;++x)for(var _=0;_<r.inWidth;++_){for(var N=x-m,E=_-d,A=0,O=0;O<f;++O){var S=(N+O)/l;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var T=0;T<h;++T){var I=(E+T)/c;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var mask=f*h-1-o.get(b,S,I,w)===O*h+T?1:0;0!==mask&&(A+=e.get(b,S,I,w)*mask)}}}v.set(A,b,x,_,w)}return v.toTensor()},e.prototype.avgPoolBackprop=function(e,t,n){for(var r=n.strideHeight,o=n.strideWidth,l=n.filterHeight,c=n.filterWidth,f=c-1-n.padInfo.left,h=l-1-n.padInfo.top,d=y.buffer(t.shape,"float32"),m=1/(l*c),b=0;b<n.batchSize;++b)for(var v=0;v<n.inChannels;++v)for(var w=0;w<n.inHeight;++w)for(var x=0;x<n.inWidth;++x){for(var _=w-h,N=x-f,E=0,A=0;A<l;++A){var O=(_+A)/r;if(!(O<0||O>=n.outHeight||Math.floor(O)!==O))for(var S=0;S<c;++S){var T=(N+S)/o;T<0||T>=n.outWidth||Math.floor(T)!==T||(E+=e.get(b,O,T,v))}}d.set(E*m,b,w,x,v)}return d.toTensor()},e.prototype.cast=function(e,t){return A.castTensor(e,t,this)},e.prototype.reshape=function(e,t){return A.reshapeTensor(e,t)},e.prototype.avgPool=function(e,t){return this.pool(e,t,"avg").toFloat()},e.prototype.resizeBilinear=function(e,t,n,r){for(var o=e.shape,l=o[0],c=o[1],f=o[2],h=o[3],output=y.buffer([l,t,n,h],e.dtype),d=[r&&t>1?c-1:c,r&&n>1?f-1:f],m=[r&&t>1?t-1:t,r&&n>1?n-1:n],b=0;b<l;b++)for(var v=0;v<t;v++)for(var w=0;w<n;w++)for(var x=0;x<h;x++){var _=d[0]*v/m[0],N=d[1]*w/m[1],E=Math.floor(_),A=Math.min(c-1,Math.ceil(_)),O=Math.floor(N),S=Math.min(f-1,Math.ceil(N)),T=e.get(b,E,O,x),I=e.get(b,A,O,x),k=N-O,P=T+(e.get(b,E,S,x)-T)*k,C=P+(I+(e.get(b,A,S,x)-I)*k-P)*(_-E);output.set(C,b,v,w,x)}return output.toTensor()},e.prototype.resizeBilinearBackprop=function(e,t,n){for(var r=t.shape,o=r[0],l=r[1],c=r[2],f=r[3],h=e.shape,d=h[1],m=h[2],output=y.buffer([o,l,c,f],t.dtype),v=[n&&d>1?l-1:l,n&&m>1?c-1:c],w=[n&&d>1?d-1:d,n&&m>1?m-1:m],x=v[0]/w[0],_=v[1]/w[1],b=0;b<o;b++)for(var N=0;N<d;N++)for(var E=N*x,A=Math.floor(E),O=Math.min(Math.ceil(E),l-1),S=E-A,T=1-S,I=0;I<m;I++)for(var k=I*_,P=Math.floor(k),C=Math.min(Math.ceil(k),c-1),R=k-P,z=1-R,M=0;M<f;M++){var L=e.get(b,N,I,M),D=output.get(b,A,P,M);D+=L*T*z,output.set(D,b,A,P,M);var V=output.get(b,A,C,M);V+=L*T*R,output.set(V,b,A,C,M);var j=output.get(b,O,P,M);j+=L*S*z,output.set(j,b,O,P,M);var F=output.get(b,O,C,M);F+=L*S*R,output.set(F,b,O,C,M)}return output.toTensor()},e.prototype.resizeNearestNeighbor=function(e,t,n,r){for(var o=e.shape,l=o[0],c=o[1],f=o[2],h=o[3],output=y.buffer([l,t,n,h],e.dtype),d=r?[c-1,f-1]:[c,f],m=r?[t-1,n-1]:[t,n],b=0;b<l;b++)for(var v=0;v<t;v++)for(var w=0;w<n;w++)for(var x=0;x<h;x++){var _=d[0]*v/m[0],N=d[1]*w/m[1],E=Math.min(c-1,r?Math.round(_):Math.floor(_)),A=Math.min(f-1,r?Math.round(N):Math.floor(N)),O=e.get(b,E,A,x);output.set(O,b,v,w,x)}return output.toTensor()},e.prototype.batchNormalization=function(e,t,n,r,o,l){for(var c=e.dataSync(),f=t.dataSync(),h=n.dataSync(),d=o?o.dataSync():new Float32Array([1]),m=l?l.dataSync():new Float32Array([0]),y=new Float32Array(c.length),i=0;i<c.length;i++)y[i]=m[i%m.length]+(c[i]-f[i%f.length])*d[i%d.length]/Math.sqrt(h[i%h.length]+r);return v.tensor4d(y,e.shape)},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){var output=y.buffer(e.shape,"float32"),l=t,c=output.shape[3]-1;function f(b,t,n,r){for(var o=0,f=Math.max(0,r-l);f<=Math.min(r+l,c);f++){var h=e.get(b,t,n,f);o+=h*h}return o}for(var b=0;b<output.shape[0];b++)for(var h=0;h<=output.shape[1];h++)for(var d=0;d<output.shape[2];d++)for(var m=0;m<output.shape[3];m++){var v=f(b,h,d,m),w=e.get(b,h,d,m)*Math.pow(n+r*v,-o);output.set(w,b,h,d,m)}return output.toTensor()},e.prototype.multinomial=function(e,t,n,r){for(var o=t?e:y.softmax(e),c=o.shape[0],f=o.shape[1],h=y.zeros([c,n],"int32"),d=h.dataSync(),m=o.dataSync(),b=0;b<c;++b){var v=b*f,w=new Float32Array(f-1);w[0]=m[v];for(var x=1;x<w.length;++x)w[x]=w[x-1]+m[v+x];for(var _=l.alea(r.toString()),N=b*n,E=0;E<n;++E){var A=_();d[N+E]=w.length;for(var O=0;O<w.length;O++)if(A<w[O]){d[N+E]=O;break}}}return h},e.prototype.oneHot=function(e,t,n,r){var o=new Float32Array(e.size*t);o.fill(r);for(var l=0;l<e.size;++l)o[l*t+e.get(l)]=n;return y.tensor2d(o,[e.size,t])},e.prototype.broadcastedBinaryOp=function(a,b,e,t){for(var n=h.assertAndGetBroadcastShape(a.shape,b.shape),r=y.buffer(n,e),o=a.dataSync(),l=b.dataSync(),c=h.getBroadcastDims(a.shape,n),f=h.getBroadcastDims(b.shape,n),d=a.buffer(),m=b.buffer(),v=function(i){var e=r.indexToLoc(i),n=e.slice(-a.rank);c.forEach((function(e){return n[e]=0}));var h=d.locToIndex(n),y=e.slice(-b.rank);f.forEach((function(e){return y[e]=0}));var v=m.locToIndex(y);r.values[i]=t(o[h],l[v])},i=0;i<r.values.length;++i)v(i);return r.toTensor()},e.prototype.dispose=function(){},e}();n.MathBackendCPU=O,c.ENV.registerBackend("cpu",(function(){return new O}),1)},{"../environment":47,"../ops/axis_util":102,"../ops/broadcast_util":105,"../ops/concat_util":108,"../ops/erf_util":111,"../ops/ops":122,"../ops/selu_util":128,"../ops/slice_util":130,"../tensor":147,"../types":152,"../util":153,"./backend_util":62,seedrandom:212}],62:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(".."),o=e("../ops/array_ops");n.castTensor=function(e,t,n){if(!r.util.hasEncodingLoss(e.dtype,t))return r.Tensor.make(e.shape,{dataId:e.dataId},t);if("int32"===t)return n.int(e);if("bool"===t)return n.notEqual(e,o.ArrayOps.scalar(0,e.dtype));throw new Error("Error in Cast: unknown dtype argument ("+t+")")},n.reshapeTensor=function(e,t){return r.Tensor.make(t,{dataId:e.dataId},e.dtype)}},{"..":50,"../ops/array_ops":101}],63:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../ops/axis_util"),f=e("../ops/ops"),h=e("../ops/reduce_util"),d=e("../ops/slice_util"),m=e("../tensor"),y=e("../types"),v=e("../util"),w=e("./backend_util"),x=e("./webgl/argminmax_gpu"),_=e("./webgl/avg_pool_backprop_gpu"),N=e("./webgl/batchnorm_gpu"),E=e("./webgl/binaryop_gpu"),A=e("./webgl/binaryop_gpu"),O=e("./webgl/clip_gpu"),S=e("./webgl/concat_gpu"),T=e("./webgl/conv_backprop_gpu"),I=e("./webgl/conv_gpu"),k=e("./webgl/conv_gpu_depthwise"),P=e("./webgl/cumsum_gpu"),C=e("./webgl/from_pixels_gpu"),R=e("./webgl/gather_gpu"),z=e("./webgl/gpgpu_context"),M=e("./webgl/gpgpu_math"),L=e("./webgl/gpgpu_util"),D=e("./webgl/logical_gpu"),V=e("./webgl/lrn_gpu"),j=e("./webgl/max_pool_backprop_gpu"),F=e("./webgl/mulmat_gpu"),B=e("./webgl/multinomial_gpu"),U=e("./webgl/onehot_gpu"),G=e("./webgl/pad_gpu"),W=e("./webgl/pool_gpu"),H=e("./webgl/reduce_gpu"),K=e("./webgl/resize_bilinear_backprop_gpu"),X=e("./webgl/resize_bilinear_gpu"),Y=e("./webgl/resize_nearest_neighbor_gpu"),J=e("./webgl/reverse_gpu"),Z=e("./webgl/slice_gpu"),Q=e("./webgl/strided_slice_gpu"),$=e("./webgl/tex_util"),ee=e("./webgl/texture_manager"),te=e("./webgl/tile_gpu"),ne=e("./webgl/transpose_gpu"),re=e("./webgl/unaryop_gpu"),ae=e("./webgl/unaryop_gpu"),oe=e("./webgl/webgl_util"),ie=function(){function e(e,t){if(void 0===t&&(t=!0),this.gpgpu=e,this.delayedStorage=t,this.texData=new WeakMap,this.uploadWaitMs=0,this.downloadWaitMs=0,this.binaryCache={},this.disposed=!1,l.ENV.get("WEBGL_VERSION")<1)throw new Error("WebGL is not supported on this device");"undefined"!=typeof document&&(this.canvas=document.createElement("canvas")),null==e?(this.gpgpu=new z.GPGPUContext(L.createWebGLContext(this.canvas)),this.gpgpuCreatedLocally=!0):this.gpgpuCreatedLocally=!1,this.textureManager=new ee.TextureManager(this.gpgpu)}return e.prototype.register=function(e,t,n){if(this.texData.has(e))throw new Error("Data buffer is already registered");this.texData.set(e,{shape:t,dtype:n,values:null,texture:null,texShape:null,texType:$.TextureType.FLOAT})},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("MathBackendWebGL.writePixels(): pixels can not be null");var n=[e.height,e.width],r=[e.height,e.width,t];if(e instanceof HTMLVideoElement){if(null==this.canvas)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext("2d").drawImage(e,0,0,e.width,e.height),e=this.canvas}var o=m.Tensor.make(n,{},"int32");this.texData.get(o.dataId).texType=$.TextureType.UNSIGNED_BYTE,this.gpgpu.uploadPixelDataToTexture(this.getTexture(o.dataId),e);var l=new C.FromPixelsProgram(r),c=this.compileAndRun(l,[o]);return o.dispose(),c},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendWebGL.write(): values can not be null");this.throwIfNoData(e);var n=this.texData.get(e),r=n.texture,o=n.texShape,l=n.texType;null!=r&&(this.textureManager.releaseTexture(r,o,l),n.texture=null,n.texShape=null),n.values=t,this.delayedStorage||this.uploadToGPU(e)},e.prototype.readSync=function(e){this.throwIfNoData(e);var t=this.texData.get(e),n=t.texture,r=t.values,o=t.texShape;if(null!=r)return this.cacheOnCPU(e),r;var l,c=null!=this.activeTimers;c&&(l=performance.now());var f=this.gpgpu.downloadMatrixFromTexture(n,o[0],o[1]);return c&&(this.downloadWaitMs+=performance.now()-l),this.cacheOnCPU(e,f),t.values},e.prototype.read=function(e){return r(this,void 0,void 0,(function(){var t,n,r,c,f;return o(this,(function(o){switch(o.label){case 0:return this.throwIfNoData(e),t=this.texData.get(e),n=t.texture,r=t.values,c=t.texShape,null!=r?(this.cacheOnCPU(e),[2,r]):l.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")?[4,this.gpgpu.downloadMatrixFromTextureAsync(n,c[0],c[1])]:[3,2];case 1:return f=o.sent(),this.cacheOnCPU(e,f),[2,t.values];case 2:return 0===l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?[2,this.readSync(e)]:[4,this.gpgpu.runQuery((function(){}))];case 3:return o.sent(),[2,this.readSync(e)]}}))}))},e.prototype.time=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l,c,f;return o(this,(function(o){switch(o.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),l=v.flatten(this.activeTimers),this.activeTimers=t,r&&(this.programTimersStack=null),[4,Promise.all(l).then((function(e){var t=0;return e.forEach((function(e){return t+=e})),t}))];case 1:return c=o.sent(),f={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:c,wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,f]}}))}))},e.prototype.memory=function(){return{unreliable:!1}},e.prototype.startTimer=function(){return l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},e.prototype.endTimer=function(e){return l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),e):(e.endMs=performance.now(),e)},e.prototype.getQueryTime=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){return l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.pollQueryTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},e.prototype.disposeData=function(e){if(this.texData.has(e)){var t=this.texData.get(e),n=t.texture,r=t.texShape,o=t.texType;null!=n&&this.textureManager.releaseTexture(n,r,o),this.texData.delete(e)}},e.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},e.prototype.getTextureData=function(e){return this.uploadToGPU(e),this.texData.get(e)},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.getCanvas=function(){return this.canvas},e.prototype.slice=function(e,t,n){var r=new Z.SliceProgram(n),o=r.getCustomSetupFunc(t);return this.compileAndRun(r,[e],null,o)},e.prototype.stridedSlice=function(e,t,n,r,o,l){var c=d.getStridedSlicedInfo(e.shape,t,n,r,o,l),h=c[0],m=c[1];if(m.some((function(e){return 0===e})))return f.tensor([],m);var y=new Q.StridedSliceProgram(h,r,m);return this.compileAndRun(y,[e])},e.prototype.reverse=function(e,t){var n=new J.ReverseProgram(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.concat=function(a,b){var e=new S.ConcatProgram(a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.neg=function(e){var t=new ae.UnaryOpProgram(e.shape,re.NEG);return this.compileAndRun(t,[e])},e.prototype.matMul=function(a,b,e,t){var n=new F.MatMulProgram(a.shape,b.shape,e,t);return this.compileAndRun(n,[a,b])},e.prototype.multiply=function(a,b){var e=new A.BinaryOpProgram(E.MUL,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,y.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],output)},e.prototype.batchNormalization=function(e,t,n,r,o,l){var c=[e,t,n],f=null;null!=l&&(f=l.shape,c.push(l));var h=null;null!=o&&(h=o.shape,c.push(o));var d=new N.BatchNormProgram(e.shape,t.shape,n.shape,f,h,r);return this.compileAndRun(d,c)},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){var l=new V.LRNProgram(e.shape,t,n,r,o);return this.compileAndRun(l,[e])},e.prototype.tile=function(e,t){var n=new te.TileProgram(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.pad=function(e,t,n){var r=new G.PadProgram(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.transpose=function(e,t){var n=new ne.TransposeProgram(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.gather=function(e,t,n){var r=new R.GatherProgram(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},e.prototype.reduce=function(e,t,n){var r=e.shape[0],o=e.shape[1],l={windowSize:h.computeOptimalWindowSize(o),inSize:o,batchSize:r},c=new H.ReduceProgram(l,t),f=c.outputShape,d=f[0],m=f[1],output=this.makeOutputArray([d,m],n);return this.compileAndRun(c,[e],output),1===output.shape[1]?output:this.reduce(output,t,n)},e.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],o=e.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var l={windowSize:h.computeOptimalWindowSize(o),inSize:o,batchSize:r},c=new x.ArgMinMaxProgram(l,t,null==n),f=c.outputShape,d=f[0],m=f[1],output=this.makeOutputArray([d,m],"int32"),y=[e];return null!=n&&y.push(n),this.compileAndRun(c,y,output),1===output.shape[1]?output:this.argReduce(e,t,output)},e.prototype.sum=function(e,t){c.assertAxesAreInnerMostDims("sum",t,e.rank);var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],l=v.sizeFromShape(o),f=e.as2D(-1,l),h=y.sumOutType(e.dtype);return this.reduce(f,"sum",h).reshape(r)},e.prototype.argMin=function(e,t){var n=[t];c.assertAxesAreInnerMostDims("argMin",n,e.rank);var r=c.computeOutAndReduceShapes(e.shape,n),o=r[0],l=r[1],f=v.sizeFromShape(l),h=e.as2D(-1,f);return this.argReduce(h,"min").reshape(o)},e.prototype.argMax=function(e,t){var n=[t];c.assertAxesAreInnerMostDims("argMax",n,e.rank);var r=c.computeOutAndReduceShapes(e.shape,n),o=r[0],l=r[1],f=v.sizeFromShape(l),h=e.as2D(-1,f);return this.argReduce(h,"max").reshape(o)},e.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var o=new P.CumSumProgram(e.shape,n,r);return this.compileAndRun(o,[e])},e.prototype.equal=function(a,b){var e=new A.BinaryOpProgram(E.EQUAL,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.notEqual=function(a,b){var e=new A.BinaryOpProgram(E.NOT_EQUAL,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.less=function(a,b){var e=new A.BinaryOpProgram(E.LESS,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.lessEqual=function(a,b){var e=new A.BinaryOpProgram(E.LESS_EQUAL,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.greater=function(a,b){var e=new A.BinaryOpProgram(E.GREATER,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.greaterEqual=function(a,b){var e=new A.BinaryOpProgram(E.GREATER_EQUAL,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.logicalNot=function(e){var t=new ae.UnaryOpProgram(e.shape,re.LOGICAL_NOT);return this.compileAndRun(t,[e])},e.prototype.logicalAnd=function(a,b){var e=new A.BinaryOpProgram(E.LOGICAL_AND,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.logicalOr=function(a,b){var e=new A.BinaryOpProgram(E.LOGICAL_OR,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[a,b],output)},e.prototype.where=function(e,a,b,t){var n=new D.WhereProgram(e.rank,a.shape,a.rank),output=this.makeOutputArray(n.outputShape,t);return this.compileAndRun(n,[e,a,b],output)},e.prototype.topKValues=function(e,t){throw new Error("topKValues GPU not yet implemented!")},e.prototype.topKIndices=function(e,t){throw new Error("topKIndices GPU not yet implemented!")},e.prototype.min=function(e,t){c.assertAxesAreInnerMostDims("min",t,e.rank);var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],l=v.sizeFromShape(o),f=e.as2D(-1,l);return this.reduce(f,"min",f.dtype).reshape(r)},e.prototype.minimum=function(a,b){var e=new A.BinaryOpProgram(E.MIN,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.mod=function(a,b){var e=new A.BinaryOpProgram(E.MOD,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.max=function(e,t){c.assertAxesAreInnerMostDims("max",t,e.rank);var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],l=v.sizeFromShape(o),f=e.as2D(-1,l);return this.reduce(f,"max",f.dtype).reshape(r)},e.prototype.maximum=function(a,b){var e=new A.BinaryOpProgram(E.MAX,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.squaredDifference=function(a,b){var e=new A.BinaryOpProgram(E.SQUARED_DIFFERENCE,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.divide=function(a,b){var e,t;"int32"===a.dtype&&"int32"===b.dtype?(e=E.INT_DIV,t="int32"):(e=E.DIV,t="float32");var n=new A.BinaryOpProgram(e,a.shape,b.shape),output=this.makeOutputArray(n.outputShape,t);return this.compileAndRun(n,[a,b],output)},e.prototype.add=function(a,b){var e=new A.BinaryOpProgram(E.ADD,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,y.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],output)},e.prototype.subtract=function(a,b){var e=new A.BinaryOpProgram(E.SUB,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,y.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],output)},e.prototype.pow=function(a,b){var e=new A.BinaryOpProgram(E.POW,a.shape,b.shape),output=this.makeOutputArray(e.outputShape,y.upcastType(a.dtype,b.dtype));return this.compileAndRun(e,[a,b],output)},e.prototype.ceil=function(e){var t=new ae.UnaryOpProgram(e.shape,re.CEIL);return this.compileAndRun(t,[e])},e.prototype.floor=function(e){var t=new ae.UnaryOpProgram(e.shape,re.FLOOR);return this.compileAndRun(t,[e])},e.prototype.sign=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SIGN);return this.compileAndRun(t,[e])},e.prototype.round=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ROUND);return this.compileAndRun(t,[e])},e.prototype.exp=function(e){var t=new ae.UnaryOpProgram(e.shape,re.EXP);return this.compileAndRun(t,[e])},e.prototype.expm1=function(e){var t=new ae.UnaryOpProgram(e.shape,re.EXPM1);return this.compileAndRun(t,[e])},e.prototype.log=function(e){var t=new ae.UnaryOpProgram(e.shape,re.LOG);return this.compileAndRun(t,[e])},e.prototype.log1p=function(e){var t=new ae.UnaryOpProgram(e.shape,re.LOG1P);return this.compileAndRun(t,[e])},e.prototype.sqrt=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SQRT);return this.compileAndRun(t,[e])},e.prototype.rsqrt=function(e){var t=new ae.UnaryOpProgram(e.shape,re.RSQRT);return this.compileAndRun(t,[e])},e.prototype.square=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SQUARE);return this.compileAndRun(t,[e])},e.prototype.reciprocal=function(e){var t=new ae.UnaryOpProgram(e.shape,re.RECIPROCAL);return this.compileAndRun(t,[e])},e.prototype.relu=function(e){var t=new ae.UnaryOpProgram(e.shape,re.RELU);return this.compileAndRun(t,[e])},e.prototype.elu=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ELU);return this.compileAndRun(t,[e])},e.prototype.eluDer=function(e,t){var n=new A.BinaryOpProgram(E.ELU_DER,e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.selu=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SELU);return this.compileAndRun(t,[e])},e.prototype.int=function(e){var t=new ae.UnaryOpProgram(e.shape,re.TO_INT),output=this.makeOutputArray(t.outputShape,"int32");return this.compileAndRun(t,[e],output)},e.prototype.clip=function(e,t,n){var r=new O.ClipProgram(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.abs=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ABS);return this.compileAndRun(t,[e])},e.prototype.sigmoid=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SIGMOID);return this.compileAndRun(t,[e])},e.prototype.softplus=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SOFTPLUS);return this.compileAndRun(t,[e])},e.prototype.sin=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SIN);return this.compileAndRun(t,[e])},e.prototype.cos=function(e){var t=new ae.UnaryOpProgram(e.shape,re.COS);return this.compileAndRun(t,[e])},e.prototype.tan=function(e){var t=new ae.UnaryOpProgram(e.shape,re.TAN);return this.compileAndRun(t,[e])},e.prototype.asin=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ASIN);return this.compileAndRun(t,[e])},e.prototype.acos=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ACOS);return this.compileAndRun(t,[e])},e.prototype.atan=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ATAN);return this.compileAndRun(t,[e])},e.prototype.atan2=function(a,b){var e=new A.BinaryOpProgram(E.ATAN2,a.shape,b.shape);return this.compileAndRun(e,[a,b])},e.prototype.sinh=function(e){var t=new ae.UnaryOpProgram(e.shape,re.SINH);return this.compileAndRun(t,[e])},e.prototype.cosh=function(e){var t=new ae.UnaryOpProgram(e.shape,re.COSH);return this.compileAndRun(t,[e])},e.prototype.tanh=function(e){var t=new ae.UnaryOpProgram(e.shape,re.TANH);return this.compileAndRun(t,[e])},e.prototype.asinh=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ASINH);return this.compileAndRun(t,[e])},e.prototype.acosh=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ACOSH);return this.compileAndRun(t,[e])},e.prototype.atanh=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ATANH);return this.compileAndRun(t,[e])},e.prototype.erf=function(e){var t=new ae.UnaryOpProgram(e.shape,re.ERF);return this.compileAndRun(t,[e])},e.prototype.step=function(e,t){var n=new ae.UnaryOpProgram(e.shape,re.STEP(t));return this.compileAndRun(n,[e])},e.prototype.conv2d=function(e,filter,t){var n=new I.Conv2DProgram(t);return this.compileAndRun(n,[e,filter])},e.prototype.conv2dDerInput=function(e,filter,t){var n=new T.Conv2DDerInputProgram(t);return this.compileAndRun(n,[e,filter])},e.prototype.conv2dDerFilter=function(e,t,n){var r=new T.Conv2DDerFilterProgram(n);return this.compileAndRun(r,[e,t])},e.prototype.depthwiseConv2D=function(e,filter,t){var n=new k.DepthwiseConv2DProgram(t);return this.compileAndRun(n,[e,filter])},e.prototype.maxPool=function(e,t){var n=new W.Pool2DProgram(t,"max",!1),output=this.makeOutputArray(n.outputShape,e.dtype);return this.compileAndRun(n,[e],output)},e.prototype.avgPool=function(e,t){var n=new W.Pool2DProgram(t,"avg",!1),output=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e],output)},e.prototype.maxPoolBackprop=function(e,t,n,r){var o=new W.Pool2DProgram(r,"max",!0),l=this.compileAndRun(o,[t]),c=new j.MaxPool2DBackpropProgram(r),output=this.makeOutputArray(c.outputShape,t.dtype),f=this.compileAndRun(c,[e,l],output);return l.dispose(),f},e.prototype.avgPoolBackprop=function(e,t,n){var r=new _.AvgPool2DBackpropProgram(n),output=this.makeOutputArray(r.outputShape,t.dtype);return this.compileAndRun(r,[e],output)},e.prototype.cast=function(e,t){return w.castTensor(e,t,this)},e.prototype.reshape=function(e,t){return w.reshapeTensor(e,t)},e.prototype.resizeBilinear=function(e,t,n,r){var o=new X.ResizeBilinearProgram(e.shape,t,n,r);return this.compileAndRun(o,[e])},e.prototype.resizeBilinearBackprop=function(e,t,n){var r=new K.ResizeBilinearBackpropProgram(e,t,n);return this.compileAndRun(r,[e])},e.prototype.resizeNearestNeighbor=function(e,t,n,r){var o=new Y.ResizeNearestNeighborProgram(e.shape,t,n,r);return this.compileAndRun(o,[e])},e.prototype.multinomial=function(e,t,n,r){var o=t?e:f.softmax(e),l=o.shape[0],c=o.shape[1],h=new B.MultinomialProgram(l,c,n),output=this.makeOutputArray(h.outputShape,"int32"),d=h.getCustomSetupFunc(r);return this.compileAndRun(h,[o],output,d)},e.prototype.oneHot=function(e,t,n,r){var o=new U.OneHotProgram(e.size,t,n,r);return this.compileAndRun(o,[e])},e.prototype.makeOutputArray=function(e,t){return m.Tensor.make(e,{},t)},e.prototype.compileAndRun=function(e,t,output,n){var r=this;null==output&&(output=this.makeOutputArray(e.outputShape,t[0].dtype));var o=t.map((function(input){return r.uploadToGPU(input.dataId),{tensor:input,texData:r.texData.get(input.dataId)}}));this.uploadToGPU(output.dataId);var l,c={tensor:output,texData:this.texData.get(output.dataId)},f=M.makeShaderKey(e,o,c),h=this.getAndSaveBinary(f,(function(){return M.compileProgram(r.gpgpu,e,o,c)})),d=null!=this.activeTimers;return d&&(l=this.startTimer()),M.runProgram(h,o,c,n),d&&(l=this.endTimer(l),this.activeTimers.push(this.getQueryTime(l))),output},e.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){if(!this.disposed){for(var e in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram);this.textureManager.dispose(),this.canvas.remove(),this.gpgpuCreatedLocally&&this.gpgpu.dispose(),this.disposed=!0}},e.prototype.throwIfNoData=function(e){if(!this.texData.has(e))throw new Error("WebGL backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},e.prototype.uploadToGPU=function(e){this.throwIfNoData(e);var t=this.texData.get(e),n=t.shape,r=t.values,o=t.texture,l=(t.dtype,t.texType);if(null==o){var c,f=null!=this.activeTimers;f&&(c=performance.now());var h=oe.getTextureShapeFromLogicalShape(this.gpgpu.gl,n);t.texShape=h;var a,d=this.textureManager.acquireTexture(h,l);t.texture=d,null!=r&&(this.gpgpu.uploadMatrixToTexture(d,h[0],h[1],(a=r)instanceof Float32Array?a:new Float32Array(a)),t.values=null,f&&(this.uploadWaitMs+=performance.now()-c))}},e.prototype.cacheOnCPU=function(e,t){var n=this.delayedStorage,r=this.texData.get(e),o=r.texture,l=r.texShape,c=r.dtype,f=r.texType;n&&null!=o&&(this.textureManager.releaseTexture(o,l,f),r.texture=null,r.texShape=null),null!=t&&(r.values=function(a,e){if("float32"===e)return a;if("int32"===e||"bool"===e){for(var t="int32"===e?new Int32Array(a.length):new Uint8Array(a.length),i=0;i<t.length;++i)t[i]=Math.round(a[i]);return t}throw new Error("Unknown dtype "+e)}(t,c))},e}();n.MathBackendWebGL=ie,l.ENV.registerBackend("webgl",(function(){return new ie}),2)},{"../environment":47,"../ops/axis_util":102,"../ops/ops":122,"../ops/reduce_util":125,"../ops/slice_util":130,"../tensor":147,"../types":152,"../util":153,"./backend_util":62,"./webgl/argminmax_gpu":64,"./webgl/avg_pool_backprop_gpu":65,"./webgl/batchnorm_gpu":66,"./webgl/binaryop_gpu":67,"./webgl/clip_gpu":68,"./webgl/concat_gpu":69,"./webgl/conv_backprop_gpu":70,"./webgl/conv_gpu":71,"./webgl/conv_gpu_depthwise":72,"./webgl/cumsum_gpu":73,"./webgl/from_pixels_gpu":74,"./webgl/gather_gpu":75,"./webgl/gpgpu_context":76,"./webgl/gpgpu_math":77,"./webgl/gpgpu_util":78,"./webgl/logical_gpu":79,"./webgl/lrn_gpu":80,"./webgl/max_pool_backprop_gpu":81,"./webgl/mulmat_gpu":82,"./webgl/multinomial_gpu":83,"./webgl/onehot_gpu":84,"./webgl/pad_gpu":85,"./webgl/pool_gpu":86,"./webgl/reduce_gpu":87,"./webgl/resize_bilinear_backprop_gpu":88,"./webgl/resize_bilinear_gpu":89,"./webgl/resize_nearest_neighbor_gpu":90,"./webgl/reverse_gpu":91,"./webgl/slice_gpu":93,"./webgl/strided_slice_gpu":94,"./webgl/tex_util":95,"./webgl/texture_manager":96,"./webgl/tile_gpu":97,"./webgl/transpose_gpu":98,"./webgl/unaryop_gpu":99,"./webgl/webgl_util":100}],64:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,l=e.inSize,c=Math.ceil(l/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,c];var f="max"===t?">":"<",h=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = 0;\n        float bestValue = getA(batch, inOffset);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+h+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+f+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};n.ArgMinMaxProgram=r},{}],65:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.top,c=n-1-e.padInfo.left,f=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+l+", "+c+");\n      const float avgMultiplier = float("+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};n.AvgPool2DBackpropProgram=r},{}],66:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../ops/broadcast_util"),o=function(e,t,n,o,l,c){this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=["x","mean","variance"],r.assertAndGetBroadcastShape(e,t),r.assertAndGetBroadcastShape(e,n);var f="0.0";null!=o&&(r.assertAndGetBroadcastShape(e,o),this.variableNames.push("offset"),f="getOffsetAtOutCoords()");var h="1.0";null!=l&&(r.assertAndGetBroadcastShape(e,l),this.variableNames.push("scale"),h="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+f+";\n        float scale = "+h+";\n        float inv = scale * inversesqrt(variance + float("+c+"));\n        setOutput((x - mean) * inv + offset);\n      }\n    "};n.BatchNormProgram=o},{"../../ops/broadcast_util":105}],67:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../ops/broadcast_util"),o="\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n";n.ADD="return a + b;",n.SUB="return a - b;",n.MUL="return a * b;",n.DIV="return a / b;",n.INT_DIV="\n  float resultSign = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  int result = ia / ib;\n  int amodb = ia - ib * result;\n\n  if (resultSign < 0.0 && amodb != 0) {\n    result -= 1;\n  }\n  return float(result);\n",n.POW="\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",n.SQUARED_DIFFERENCE="return (a - b) * (a - b);",n.EQUAL="return float(a == b);",n.NOT_EQUAL="return float(a != b);",n.LESS="return float(a < b);",n.LESS_EQUAL="return float(a <= b);",n.GREATER="return float(a > b);",n.GREATER_EQUAL="return float(a >= b);",n.LOGICAL_AND="return float(a >= 1.0 && b >= 1.0);",n.LOGICAL_OR="return float(a >= 1.0 || b >= 1.0);",n.MAX=o+"\n  return max(a, b);\n",n.MIN=o+"\n  return min(a, b);\n",n.MOD="return mod(a, b);",n.ATAN2=o+"\n  return atan(a, b);\n",n.ELU_DER="return (b >= 1.0) ? a : a * (b + 1.0);";var l=function(e,t,n){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.outputShape=r.assertAndGetBroadcastShape(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "};n.BinaryOpProgram=l},{"../../ops/broadcast_util":105}],68:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){this.variableNames=["A"],this.outputShape=e;var r=t.toFixed(20),o=n.toFixed(20);this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, "+r+", "+o+"));\n      }\n    "};n.ClipProgram=r},{}],69:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../ops/concat_util"),o=function(e,t){this.variableNames=["A","B"],this.outputShape=[],this.outputShape=r.computeOutShape(e,t,1),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        float value = 0.0;\n        if (yC < "+e[1]+") {\n          value = getA(yR, yC);\n        } else {\n          yC -= "+e[1]+";\n          value = getB(yR, yC);\n        }\n\n        setOutput(value);\n      }\n    "};n.ConcatProgram=o},{"../../ops/concat_util":108}],70:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};n.Conv2DDerFilterProgram=r;var o=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.top,c=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2("+l+", "+c+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};n.Conv2DDerInputProgram=o},{}],71:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.top,n=e.padInfo.left,r=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),m=e.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+o+");\n      const ivec2 pads = ivec2("+t+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+f+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===m)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+d+") *\n                getW(wR, wC, "+d+", d2);\n            } else if ("+(2===m)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+d+"),\n                getX(batch, xR, xC, "+d+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===m)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+d+"),\n                getX(batch, xR, xC, "+d+" + 1),\n                getX(batch, xR, xC, "+d+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};n.Conv2DProgram=r},{}],72:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.inHeight,n=e.inWidth,r=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,f=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,m=e.filterWidth,y=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+l+", "+c+");\n      const ivec2 pads = ivec2("+r+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+y+";\n        int q = d2 - d1 * "+y+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+d+"; wR++) {\n          int xR = xRCorner + wR * "+f+";\n\n          if (xR < 0 || xR >= "+t+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+n+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};n.DepthwiseConv2DProgram=r},{}],73:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var o=e.length,c=e[e.length-1],f=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+c+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+r.getCoordsDataType(o)+" coords = getOutputCoords();\n        int end = "+l(o,"coords")+";\n        float val = 0.0;\n        for (int i = "+c+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+f+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+l(o,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(o,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function l(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}n.CumSumProgram=o},{"./shader_compiler":92}],74:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){this.variableNames=["A"];var t=e[0],n=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+n+".0, "+t+".0);\n\n        vec4 values = texture2D(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "};n.FromPixelsProgram=r},{}],75:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t,n){this.variableNames=["A","indices"];var o=e.slice();o[n]=t,this.outputShape=o,this.rank=o.length;var l=r.getCoordsDataType(this.rank),c=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=0;i<e.length;i++)i===t?o.push("int(getIndices("+r[i]+"))"):o.push(""+r[i]);return o.join()}(e,n);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        setOutput(getA("+c+"));\n      }\n    "};n.GatherProgram=o},{"./shader_compiler":92}],76:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../../environment"),c=e("../../util"),f=e("./gpgpu_util"),h=e("./tex_util"),d=e("./webgl_util"),m=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.vertexAttrsAreBound=!1,this.gl=null!=e?e:f.createWebGLContext(),1===l.ENV.get("WEBGL_VERSION")?(this.textureFloatExtension=d.getExtensionOrThrow(this.gl,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float")):this.colorBufferFloatExtension=d.getExtensionOrThrow(this.gl,"EXT_color_buffer_float"),this.loseContextExtension=d.getExtensionOrThrow(this.gl,"WEBGL_lose_context"),l.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&(this.getBufferSubDataAsyncExtension=this.gl.getExtension("WEBGL_get_buffer_sub_data_async")),this.vertexBuffer=f.createVertexBuffer(this.gl),this.indexBuffer=f.createIndexBuffer(this.gl),this.framebuffer=d.createFramebuffer(this.gl)}return e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;d.callAndCheck(t,(function(){return t.finish()})),d.callAndCheck(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),d.callAndCheck(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),d.callAndCheck(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),d.callAndCheck(t,(function(){return t.deleteBuffer(e.vertexBuffer)})),d.callAndCheck(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),d.callAndCheck(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.loseContextExtension.loseContext(),this.disposed=!0}},e.prototype.enableAutomaticDebugValidation=function(e){this.autoDebugValidate=e,d.enableDebugWebGLErrorChecking(e)},e.prototype.createMatrixTexture=function(e,t){return this.throwIfDisposed(),f.createMatrixTexture(this.gl,e,t)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),f.uploadPixelDataToTexture(this.gl,e,t)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),f.createPackedMatrixTexture(this.gl,e,t)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(d.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),d.callAndCheck(this.gl,(function(){return t.gl.deleteTexture(e)}))},e.prototype.uploadMatrixToTexture=function(e,t,n,r){return this.throwIfDisposed(),f.uploadMatrixToTexture(this.gl,e,t,n,r,1)},e.prototype.uploadMatrixToPackedTexture=function(e,t,n,r){return this.throwIfDisposed(),f.uploadMatrixToPackedTexture(this.gl,e,t,n,r)},e.prototype.downloadMatrixFromTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return f.downloadMatrixFromOutputTexture(r.gl,t,n)}))},e.prototype.downloadMatrixFromTextureAsync=function(e,t,n){return r(this,void 0,void 0,(function(){var r=this;return o(this,(function(o){if(null==this.getBufferSubDataAsyncExtension)throw new Error("Cannot download matrix from output texture asynchronously, WEBGL_get_buffer_sub_data_async is not enabled.");return[2,this.downloadMatrixDriverAsync(e,(function(){return f.downloadMatrixFromOutputTextureAsync(r.gl,r.getBufferSubDataAsyncExtension,t,n)}))]}))}))},e.prototype.downloadMatrixFromRGBAColorTexture=function(e,t,n,r){var o=this;return this.downloadMatrixDriver(e,(function(){return f.downloadMatrixFromRGBAColorTexture(o.gl,t,n,r)}))},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return f.downloadMatrixFromPackedOutputTexture(r.gl,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=d.createFragmentShader(t,e),r=f.createVertexShader(t),o=d.createProgram(t);return d.callAndCheck(t,(function(){return t.attachShader(o,r)})),d.callAndCheck(t,(function(){return t.attachShader(o,n)})),d.linkProgram(t,o),this.autoDebugValidate&&d.validateProgram(t,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=f.bindVertexProgramAttributeStreams(t,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&d.callAndCheck(this.gl,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.autoDebugValidate&&d.validateProgram(this.gl,this.program),d.callAndCheck(this.gl,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?d.getProgramUniformLocationOrThrow(this.gl,e,t):d.getProgramUniformLocation(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),d.callAndCheck(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),d.bindTextureToProgramUniformSampler(this.gl,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=h.getPackedMatrixTextureShapeWidthHeight(t,n),o=r[0],l=r[1];this.setOutputMatrixTextureDriver(e,o,l)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&d.validateProgram(this.gl,this.program),d.validateFramebuffer(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.autoDebugValidate&&this.debugValidate(),d.callAndCheck(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),d.callAndCheck(this.gl,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=d.getExtensionOrThrow(this.gl,2===l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.runQuery=function(e){var t=this.beginQuery();return e(),this.endQuery(),this.pollQueryTime(t)},e.prototype.beginQuery=function(){if(2===l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(2!==l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE),l=this.gl.getParameter(r.GPU_DISJOINT_EXT);return o&&!l}return o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),l=this.gl.getParameter(r.GPU_DISJOINT_EXT),o&&!l},e.prototype.pollQueryTime=function(e){var t=this;return new Promise((function(n,r){var o=l.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION");c.repeatedTry((function(){return t.isQueryAvailable(e,o)})).then((function(){return n(t.getQueryTime(e,o))})).catch((function(){console.warn("Disjoint query timer never available."),n(-1)}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.downloadMatrixDriverSetup=function(e){this.throwIfDisposed(),d.bindColorTextureToFramebuffer(this.gl,e,this.framebuffer),this.autoDebugValidate&&d.validateFramebuffer(this.gl)},e.prototype.downloadMatrixDriverTeardown=function(){null!=this.outputTexture?(d.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&d.validateFramebuffer(this.gl)):d.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.downloadMatrixDriverSetup(e);var n=t();return this.downloadMatrixDriverTeardown(),n},e.prototype.downloadMatrixDriverAsync=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return this.downloadMatrixDriverSetup(e),[4,t()];case 1:return n=r.sent(),this.downloadMatrixDriverTeardown(),[2,n]}}))}))},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;d.bindColorTextureToFramebuffer(r,e,this.framebuffer),this.autoDebugValidate&&d.validateFramebuffer(r),this.outputTexture=e,d.callAndCheck(r,(function(){return r.viewport(0,0,t,n)})),d.callAndCheck(r,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var o=this;this.throwIfDisposed(),d.callAndCheck(this.gl,(function(){return o.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();n.GPGPUContext=m},{"../../environment":47,"../../util":153,"./gpgpu_util":78,"./tex_util":95,"./webgl_util":100}],77:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../environment"),o=e("../../util"),l=e("./shader_compiler"),c="NaN";function f(){return!r.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")}function h(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(s,i){var e=s.logicalShape,n=s.texShape,r=t[i].tensor.shape,l=t[i].texData.texShape;if(!o.arraysEqual(e,r))throw Error("Binary was compiled with different shapes than the current args. Shapes "+e+" and "+r+" must match");if(!o.arraysEqual(n,l))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+n+" and "+l+" must match")}))}n.compileProgram=function(e,t,n,output){for(var r=t.userCode,o=n.map((function(input,i){var e={logicalShape:input.tensor.shape,texShape:input.texData.texShape};return{name:t.variableNames[i],shapeInfo:e}})),h=o.map((function(e){return e.shapeInfo})),d={logicalShape:output.tensor.shape,texShape:output.texData.texShape},source=l.makeShader(o,d,r,!0===t.supportsBroadcasting),m=e.createProgram(source),y={},i=0;i<t.variableNames.length;i++){var v=t.variableNames[i];y[v]=e.getUniformLocation(m,v)}return f()&&(y[c]=e.getUniformLocation(m,c,!1)),{program:t,source:source,webGLProgram:m,uniformLocations:y,gpgpu:e,inShapeInfos:h,outShapeInfo:d}},n.runProgram=function(e,t,output,n){h(e.inShapeInfos,t),h([e.outShapeInfo],[output]);var r=output.texData.texture,o=output.texData.texShape,l=e.gpgpu;l.setOutputMatrixTexture(r,o[0],o[1]),l.setProgram(e.webGLProgram),t.forEach((function(input,i){var t=input.texData.texture,n=e.program.variableNames[i],r=e.uniformLocations[n];l.setInputMatrixTexture(t,r,i)})),f()&&l.gl.uniform1f(e.uniformLocations[c],NaN),null!=n&&n(l,e.webGLProgram),l.executeProgram()},n.makeShaderKey=function(e,t,output){var n="";t.concat(output).forEach((function(e){n+=e.tensor.shape+"_"+e.texData.texShape}));var r=e.userCode,o=(!0===e.supportsBroadcasting).toString(),l=e.constructor.name;return l+="_"+o+"_"+n+"_"+r}},{"../../environment":47,"../../util":153,"./shader_compiler":92}],78:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../../environment"),c=e("./tex_util"),f=e("./webgl_util");function h(){return{alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}}function d(e,t){return l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===l.ENV.get("WEBGL_VERSION")?4===t?e.RGBA:e.RED:e.RGBA}function m(e){return l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?e.FLOAT:e.UNSIGNED_BYTE}function y(e,t,n,r){f.validateTextureSize(e,t,n);var o=f.createTexture(e),c=e.TEXTURE_2D,h=function(e,t){return l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===l.ENV.get("WEBGL_VERSION")?4===t?e.RGBA32F:e.R32F:e.RGBA}(e,r),y=d(e,r);return f.callAndCheck(e,(function(){return e.bindTexture(c,o)})),f.callAndCheck(e,(function(){return e.texParameteri(c,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),f.callAndCheck(e,(function(){return e.texParameteri(c,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),f.callAndCheck(e,(function(){return e.texParameteri(c,e.TEXTURE_MIN_FILTER,e.NEAREST)})),f.callAndCheck(e,(function(){return e.texParameteri(c,e.TEXTURE_MAG_FILTER,e.NEAREST)})),f.callAndCheck(e,(function(){return e.texImage2D(c,0,h,t,n,0,y,m(e),null)})),f.callAndCheck(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),o}function v(e,t,n,r,data,o){var l=d(e,o);f.validateTextureSize(e,n,r),f.callAndCheck(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),f.callAndCheck(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,l,m(e),data)})),f.callAndCheck(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function w(e,t,n){return l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?new Float32Array(c.getUnpackedArraySizeFromMatrixSize(e*t,n)):new Uint8Array(e*t*n)}function x(e,t,n,r){if(l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var o=new Float32Array(t*n);return c.decodeMatrixFromUnpackedArray(e,o,r),o}return c.decodeToFloatArray(e)}n.getWebGLContextAttributes=h,n.createWebGLContext=function(canvas){var e,t={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};return e=null!=canvas?f.createWebGLRenderingContextFromCanvas(canvas,t):f.createWebGLRenderingContext(t),f.callAndCheck(e,(function(){return e.disable(e.DEPTH_TEST)})),f.callAndCheck(e,(function(){return e.disable(e.STENCIL_TEST)})),f.callAndCheck(e,(function(){return e.disable(e.BLEND)})),f.callAndCheck(e,(function(){return e.disable(e.DITHER)})),f.callAndCheck(e,(function(){return e.disable(e.POLYGON_OFFSET_FILL)})),f.callAndCheck(e,(function(){return e.disable(e.SAMPLE_COVERAGE)})),f.callAndCheck(e,(function(){return e.enable(e.SCISSOR_TEST)})),f.callAndCheck(e,(function(){return e.enable(e.CULL_FACE)})),f.callAndCheck(e,(function(){return e.cullFace(e.BACK)})),e},n.createVertexShader=function(e){return f.createVertexShader(e,"\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")},n.createVertexBuffer=function(e){var t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return f.createStaticVertexBuffer(e,t)},n.createIndexBuffer=function(e){var t=new Uint16Array([0,1,2,2,1,3]);return f.createStaticIndexBuffer(e,t)},n.createMatrixTexture=function(e,t,n){var r=c.getUnpackedMatrixTextureShapeWidthHeight(t,n);return y(e,r[0],r[1],1)},n.createColorMatrixTexture=function(e,t,n){var r=c.getColorMatrixTextureShapeWidthHeight(t,n);return y(e,r[0],r[1],4)},n.createPackedMatrixTexture=function(e,t,n){var r=c.getPackedMatrixTextureShapeWidthHeight(t,n);return y(e,r[0],r[1],4)},n.bindVertexProgramAttributeStreams=function(e,t,n){return f.callAndCheck(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),f.bindVertexBufferToProgramAttribute(e,t,"clipSpacePos",n,3,20,0)&&f.bindVertexBufferToProgramAttribute(e,t,"uv",n,2,20,12)},n.uploadPixelDataToTexture=function(e,t,n){f.callAndCheck(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),f.callAndCheck(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),f.callAndCheck(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},n.uploadMatrixToTexture=function(e,t,n,r,o,h){var d,m=c.getUnpackedMatrixTextureShapeWidthHeight(n,r),y=m[0],w=m[1];if(l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var x=1===h?f.getChannelsPerTexture():h;1===x?d=o:(d=new Float32Array(c.getUnpackedArraySizeFromMatrixSize(o.length,x)),c.encodeMatrixToUnpackedArray(o,d,x))}else d=c.encodeFloatArray(o);v(e,t,y,w,d,h)},n.uploadMatrixToPackedTexture=function(e,t,n,r,o){var l=c.getPackedMatrixTextureShapeWidthHeight(n,r),f=l[0],h=l[1],d=new Float32Array(c.getPackedRGBAArraySizeFromMatrixShape(n,r));c.encodeMatrixToPackedRGBA(o,n,r,d),v(e,t,f,h,d,4)},n.downloadMatrixFromOutputTextureAsync=function(e,t,n,l){return r(this,void 0,void 0,(function(){var r,c,h,d,y;return o(this,(function(o){switch(o.label){case 0:return r=e,h=w(n,l,c=4),d=h instanceof Float32Array?4*h.length:h,y=e.createBuffer(),f.callAndCheck(e,(function(){return e.bindBuffer(r.PIXEL_PACK_BUFFER,y)})),f.callAndCheck(e,(function(){return e.bufferData(r.PIXEL_PACK_BUFFER,d,e.STATIC_DRAW)})),f.callAndCheck(e,(function(){return r.readPixels(0,0,l,n,e.RGBA,m(e),0)})),[4,t.getBufferSubDataAsync(r.PIXEL_PACK_BUFFER,0,h)];case 1:return o.sent(),[2,x(h,n,l,c)]}}))}))},n.downloadMatrixFromOutputTexture=function(e,t,n){var r=c.getUnpackedMatrixTextureShapeWidthHeight(t,n),o=r[0],l=r[1],h=w(t,n,4);return f.callAndCheck(e,(function(){return e.readPixels(0,0,o,l,e.RGBA,m(e),h)})),x(h,t,n,4)},n.downloadMatrixFromRGBAColorTexture=function(e,t,n,r){var o=t*n*4,l=new Uint8Array(o);f.callAndCheck(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.UNSIGNED_BYTE,l)}));for(var h=new Float32Array(o),i=0;i<l.length;i++)h[i]=l[i];var d=new Float32Array(t*n*r);return c.decodeMatrixFromUnpackedColorRGBAArray(h,d,r),d},n.downloadMatrixFromPackedOutputTexture=function(e,t,n){var r=c.getPackedMatrixTextureShapeWidthHeight(t,n),o=r[0],l=r[1],h=new Float32Array(c.getPackedRGBAArraySizeFromMatrixShape(t,n));f.callAndCheck(e,(function(){return e.readPixels(0,0,o,l,e.RGBA,m(e),h)}));var d=new Float32Array(t*n);return c.decodeMatrixFromPackedRGBA(h,t,n,d)}},{"../../environment":47,"./tex_util":95,"./webgl_util":100}],79:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t,n){var o,l;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)l="resRC",o="resRC";else{for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],f=[],h=[],i=0;i<t.length;i++)h.push(""+c[i]),i<e&&f.push(""+c[i]);o=f.join(),l=h.join()}var d=r.getCoordsDataType(n);this.userCode="\n      void main() {\n        "+d+" resRC = getOutputCoords();\n        float cVal = getC("+o+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+l+"));\n        } else {\n          setOutput(getB("+l+"));\n        }\n      }\n    "};n.WhereProgram=o},{"./shader_compiler":92}],80:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var l,c=t,f=e[3]-1;this.outputShape=e;var h="float("+n+") + float("+r+") * sum";l=.5===o?"inversesqrt("+h+")":1===o?"1.0/("+h+")":"exp(log("+h+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+c+"; j <= "+c+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+f+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+l+";\n        setOutput(val);\n      }\n    "};n.LRNProgram=r},{}],81:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.top,c=n-1-e.padInfo.left,f=t*n-1;this.userCode="\n      const ivec2 pads = ivec2("+l+", "+c+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+f+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "};n.MaxPool2DBackpropProgram=r},{}],82:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.variableNames=["matrixA","matrixB"];var o=n?e[1]:e[0],l=r?t[0]:t[1],c=n?e[0]:e[1];this.outputShape=[o,l];var f=function(e,t){return n?t+" + "+e+", aRow":"aRow, "+t+" + "+e},h=function(e,t){return r?"bCol, "+t+" + "+e:t+" + "+e+", bCol"},d=4*Math.floor(c/4),m=c%4;this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+d+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+f(0,"i")+"),\n          getMatrixA("+f(1,"i")+"),\n          getMatrixA("+f(2,"i")+"),\n          getMatrixA("+f(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+h(0,"i")+"),\n          getMatrixB("+h(1,"i")+"),\n          getMatrixB("+h(2,"i")+"),\n          getMatrixB("+h(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1===m)+") {\n        result += getMatrixA("+f(0,d)+") *\n          getMatrixB("+h(0,d)+");\n      } else if ("+(2===m)+") {\n        vec2 a = vec2(\n          getMatrixA("+f(0,d)+"),\n          getMatrixA("+f(1,d)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+h(0,d)+"),\n          getMatrixB("+h(1,d)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3===m)+") {\n        vec3 a = vec3(\n          getMatrixA("+f(0,d)+"),\n          getMatrixA("+f(1,d)+"),\n          getMatrixA("+f(2,d)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+h(0,d)+"),\n          getMatrixB("+h(1,d)+"),\n          getMatrixB("+h(2,d)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "};n.MatMulProgram=r},{}],83:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}();n.MultinomialProgram=r},{}],84:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "};n.OneHotProgram=r},{}],85:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(p,i){return p[0]+e[i]+p[1]}));var o=e.length,l=r.getCoordsDataType(o),c=t.map((function(p){return p[0]})).join(","),f=t.map((function(p,i){return p[0]+e[i]})).join(","),h=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);this.userCode=1!==o?"\n      "+l+" start = "+l+"("+c+");\n      "+l+" end = "+l+"("+f+");\n\n      void main() {\n        "+l+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+l+" coords = outC - start;\n          setOutput(getX("+h+"));\n        }\n      }\n    ":"\n        int start = "+c+";\n        int end = "+f+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "};n.PadProgram=o},{"./shader_compiler":92}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterHeight,o=e.filterWidth,l=e.strideHeight,c=e.strideWidth,f=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,m="0.0";if(d||(m="-1.0 / 0.0"),n)this.userCode="\n        const ivec2 strides = ivec2("+l+", "+c+");\n        const ivec2 pads = ivec2("+f+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+r+"; wR++) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+o+"; wC++) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+o+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var v=4*Math.floor(o/4),w=o%4,x="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+l+", "+c+");\n      const ivec2 pads = ivec2("+f+", "+h+");\n      const float initializationValue = "+m+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+m+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+r+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC;\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              getValue(batch, xR, xC + 3, d)\n            );\n\n            "+x+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===w)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+x+"\n          } else if ("+(2===w)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+x+"\n          } else if ("+(3===w)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              initializationValue\n            );\n\n            "+x+"\n          }\n        }\n        setOutput("+y+");\n      }\n    "}};n.Pool2DProgram=r},{}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,l=Math.ceil(o/n);this.outputShape=[r,l];var c="sum"===t,f="0.0";c||(f="min"===t?"1.0 / 0.0":"-1.0 / 0.0");var h="min"===t?"min":"max",d=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t&&(d="sumValue");var m=4*Math.floor(n/4),y=n%4,v="\n      if ("+c+") {\n        sumValue += dot(values, ones);\n      } else {\n        minMaxValue = "+h+"(values, minMaxValue);\n      }\n    ",w="";o%n>0&&(w="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+w+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+f+");\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+m+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+v+"\n        }\n\n        int inIdx = inOffset + "+m+";\n        if ("+(1===y)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n          "+v+"\n        } else if ("+(2===y)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n          "+v+"\n        } else if ("+(3===y)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n          "+v+"\n        }\n        setOutput("+d+");\n      }\n    "};n.ReduceProgram=r},{}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],l=r[2],c=e.shape,f=c[1],h=c[2],d=[n&&f>1?o-1:o,n&&h>1?l-1:l],m=[n&&f>1?f-1:f,n&&h>1?h-1:h],y=d[0]/m[0],v=d[1]/m[1],w=1/y,x=1/v,_=2*Math.ceil(w)+2,N=2*Math.ceil(x)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+y+");\n        const float widthScale = float("+v+");\n\n        const float invHeightScale = float("+w+");\n        const float invWidthScale = float("+x+");\n\n        const int winHeight = int("+_+");\n        const int winWidth = int("+N+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+f+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+h+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(l-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "};n.ResizeBilinearBackpropProgram=r},{}],89:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],l=e[1],c=e[2],f=e[3];this.outputShape=[o,t,n,f];var h=[r&&t>1?l-1:l,r&&n>1?c-1:c],d=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+h[0]/d[0]+",\n          "+h[1]/d[1]+");\n      const vec2 inputShapeRC = vec2("+l+".0, "+c+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "};n.ResizeBilinearProgram=r},{}],90:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],l=e[1],c=e[2],f=e[3];this.outputShape=[o,t,n,f];var h=r?[l-1,c-1]:[l,c],d=r?[t-1,n-1]:[t,n],m=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+h[0]/d[0]+",\n          "+h[1]/d[1]+");\n      const vec2 inputShapeRC = vec2("+l+".0, "+c+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+m+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "};n.ResizeNearestNeighborProgram=r},{}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var o=e.map((function(n,i){return function(i){return-1!==t.indexOf(i)&&1!==e[i]?e[i]+" - coords["+i+"] - 1":"coords["+i+"]"}(i)})).join(","),l=r.getCoordsDataType(n);this.userCode="\n      void main() {\n        "+l+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "};n.ReverseProgram=o},{"./shader_compiler":92}],92:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../environment"),o=e("../../util"),l=e("../../ops/broadcast_util"),c=e("./tex_util");function f(e){var t,n=e.shapeInfo.logicalShape;switch(n.length){case 0:return"\n    float get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1)+"() {\n      return sampleTexture("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);return"\n    float "+n+"(int index) {\n      return "+n+"Flat(index);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.shapeInfo.texShape,r=e.name,l="get"+r.charAt(0).toUpperCase()+r.slice(1),c=n[0],h=n[1];if(o.arraysEqual(t,n))return"\n    float "+l+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+h+".0, "+c+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var d=o.squeezeShape(t),m=d.newShape,y=d.keptDims,v=m;if(v.length<t.length){var _=w(e,v);return"\n      "+f(_)+"\n      float "+l+"(int row, int col) {\n        return "+l+"("+x(["row","col"],y)+");\n      }\n    "}return 1===h?"\n    float "+l+"(int row, int col) {\n      int index = row * "+t[1]+" + col;\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / "+c+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===c?"\n    float "+l+"(int row, int col) {\n      int index = row * "+t[1]+" + col;\n      vec2 uv = vec2((float(index) + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+l+"(int row, int col) {\n    vec2 uv = UVfrom2D("+c+", "+h+", "+t[1]+", row, col);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.texShape,n=e.shapeInfo.logicalShape,r=e.name,l="get"+r.charAt(0).toUpperCase()+r.slice(1),c=t[0],h=t[1],d=n[1]*n[2],m=n[2],y=o.squeezeShape(n),v=y.newShape,_=y.keptDims,N=v;if(N.length<n.length){var E=w(e,N);return"\n        "+f(E)+"\n        float "+l+"(int row, int col, int depth) {\n          return "+l+"("+x(["row","col","depth"],_)+");\n        }\n      "}return h===d?"\n        float "+l+"(int row, int col, int depth) {\n          int texR = row;\n          int texC = col * "+m+" + depth;\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+h+".0, "+c+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":h===m?"\n    float "+l+"(int row, int col, int depth) {\n      int texR = row * "+n[1]+" + col;\n      int texC = depth;\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+h+".0, "+c+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+l+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+c+", "+h+", "+d+", "+m+", row, col, depth);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.shapeInfo.texShape,r=e.name,l="get"+r.charAt(0).toUpperCase()+r.slice(1),c=n[0],h=n[1],d=t[3],m=t[2]*d,y=t[1]*m,v=o.squeezeShape(t),_=v.newShape,N=v.keptDims;if(_.length<t.length){var E=w(e,_);return"\n      "+f(E)+"\n      float "+l+"(int row, int col, int depth, int depth2) {\n        return "+l+"("+x(["row","col","depth","depth2"],N)+");\n      }\n    "}return h===y?"\n      float "+l+"(int row, int col, int depth, int depth2) {\n        int texR = row;\n        int texC = col * "+m+" + depth * "+d+" + depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+h+".0, "+c+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":h===d?"\n      float "+l+"(int row, int col, int depth, int depth2) {\n        int texR = row * "+t[1]*t[2]+" + col * "+t[2]+" + depth;\n        int texC = depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+h+".0, "+c+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+l+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+c+", "+h+", "+y+", "+m+",\n          "+d+", row, col, depth, depth2);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}n.makeShader=function(e,t,n,c){var w=r.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?m:h,x=r.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?y:d,_=e.map((function(e){return"uniform sampler2D "+e.name+";"})).join("\n"),N=e.map((function(e){return function(e,t,n){var r,c,h,d,m,y,v=(c=(r=e).name,h=r.shapeInfo.texShape,d="get"+c.charAt(0).toUpperCase()+c.slice(1)+"Flat",m=h[0],1===(y=h[1])&&1===m?"\n      float "+d+"(int index) {\n        return sampleTexture("+c+", halfCR);\n      }\n    ":1===y?"\n      float "+d+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+m+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":1===m?"\n      float "+d+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+y+".0, 0.5);\n        return sampleTexture("+c+", uv);\n      }\n    ":"\n    float "+d+"(int index) {\n      vec2 uv = UVfrom1D("+m+", "+y+", index);\n      return sampleTexture("+c+", uv);\n    }\n  ");return v+=f(e),(n||o.arraysEqual(e.shapeInfo.logicalShape,t.logicalShape))&&(v+=function(e,t,n){var r=e.shapeInfo.texShape,c=e.name,f=c.charAt(0).toUpperCase()+c.slice(1),h="get"+f+"AtOutCoords",d=l.getBroadcastDims(e.shapeInfo.logicalShape,t.logicalShape),m=e.shapeInfo.logicalShape.length,y=t.logicalShape.length,v=n&&(y>m||d.length>0),w=l.broadcastDimsAreOuter(d);if(v&&!w)return function(e,t,n,r){var o=e.shapeInfo.logicalShape.length,c=t.logicalShape.length,f="int";2===c?f="ivec2":3===c?f="ivec3":4===c&&(f="ivec4");var h,d=l.getBroadcastDims(e.shapeInfo.logicalShape,t.logicalShape),m=c-o;h=0===o?"":c<2&&d.length>=1?"coords = 0;":d.map((function(e){return"coords["+(e+m)+"] = 0;"})).join("\n");var y="";return y=c<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(s,i){return"coords["+(i+m)+"]"})).join(", "),"\n    float "+r+"() {\n      "+f+" coords = getOutputCoords();\n      "+h+"\n      return get"+n+"("+y+");\n    }\n  "}(e,t,f,h);var x=t.texShape;if(o.arraysEqual(r,x))return"\n      float "+h+"() {\n        return sampleTexture("+c+", resultUV);\n      }\n    ";var _=o.sizeFromShape(r),N="";return v&&w&&(N="\n        int mainPart = index / "+_+";\n        index -= mainPart * "+_+";\n      "),"\n    float "+h+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+x[0]+", "+x[1]+"));\n      int index = resTexRC.x * "+x[1]+" + resTexRC.y;\n      "+N+"\n      int texR = index / "+r[1]+";\n      int texC = index - texR * "+r[1]+";\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+r[1]+".0, "+r[0]+".0);\n\n      return sampleTexture("+c+", uv);\n    }\n  "}(e,t,n)),v}(e,t,c)})).join("\n"),E=t.texShape,A=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return o.arraysEqual(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return r=t,l=(n=e)[1]*n[2],c=n[2],"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+r[0]+", "+r[1]+"));\n      int index = resTexRC.x * "+r[1]+" + resTexRC.y;\n      int r = index / "+l+";\n      index -= r * "+l+";\n      int c = index / "+c+";\n      int d = index - c * "+c+";\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=e[3],r=e[2]*n,o=e[1]*r;return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      int r = index / "+o+";\n      index -= r * "+o+";\n\n      int c = index / "+r+";\n      index -= c * "+r+";\n\n      int d = index / "+n+";\n      int d2 = index - d * "+n+";\n\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r,l,c}(t.logicalShape,E);return[v,w,x,_,A,N,n].join("\n")};var h="\n  uniform float NaN;\n\n  const vec4 floatDeltas = vec4(\n      1.0,\n      1.0 / 255.0,\n      1.0 / (255.0 * 255.0),\n      1.0 / (255.0 * 255.0 * 255.0)\n  );\n  const float minValue = "+c.FLOAT_MIN+".0;\n  const float maxValue = "+c.FLOAT_MAX+".0;\n  const float range = (maxValue - minValue) / 255.0;\n  const vec2 dotRange = vec2(1.0, range);\n\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    vec4 sampleValue = texture2D(textureSampler, uv);\n    if (all(equal(sampleValue, vec4("+c.BYTE_NAN_VALUE+")))) {\n      return NaN;\n    }\n\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\n    float decodedValue = dot(encValue, floatDeltas);\n    return dot(vec2(minValue, decodedValue), dotRange);\n  }\n",d="\n  const vec4 floatPowers = vec4(\n    1.0,\n    255.0,\n    255.0 * 255.0,\n    255.0 * 255.0 * 255.0\n  );\n  const vec2 recipRange = vec2(1.0/range);\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\n\n  void setOutput(float decodedValue) {\n    if (isNaN(decodedValue)) {\n      gl_FragColor = vec4("+c.BYTE_NAN_VALUE+");\n      return;\n    }\n\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\n    float b = fract(a) * 255.0;\n    float c = fract(b) * 255.0;\n    float d = fract(c) * 255.0;\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\n\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\n    // than the version below. Benchmark to determine if the accuracy is worth\n    // the cost.\n\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\n    // vec4 f = normValue * floatPowers;\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\n  }\n",m="\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    return texture2D(textureSampler, uv).r;\n  }\n",y="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n",v="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  bool isNaN(float val) {\n    float v1 = val * val;\n    float v2 = val * val;\n    return v1 == v2 ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  //Based on the work of Dave Hoskins\n  //https://www.shadertoy.com/view/4djSRW\n  #define HASHSCALE1 443.8975\n  float random(float seed){\n    vec2 p = resultUV * seed;\n    vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n  }\n\n  \nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n";function w(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function x(e,t){return t.map((function(t){return e[t]})).join(", ")}n.getCoordsDataType=function(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";throw Error("GPU for rank "+e+" is not yet supported")}},{"../../environment":47,"../../ops/broadcast_util":105,"../../util":153,"./tex_util":95}],93:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t=r.getCoordsDataType(this.rank),n=function(e){if(1===e)return"sourceLoc";if(2===e)return"sourceLoc.x, sourceLoc.y";if(3===e)return"sourceLoc.x, sourceLoc.y, sourceLoc.z";if(4===e)return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w";throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);this.userCode="\n      uniform "+t+" start;\n\n      void main() {\n        "+t+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+n+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){if(null!=t.startLoc||(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null!=t.startLoc))if(1===t.rank)n.gl.uniform1i(t.startLoc,e[0]);else if(2===t.rank)n.gl.uniform2i(t.startLoc,e[0],e[1]);else if(3===t.rank)n.gl.uniform3i(t.startLoc,e[0],e[1],e[2]);else{if(4!==t.rank)throw Error("Slicing for rank "+t.rank+" is not yet supported");n.gl.uniform4i(t.startLoc,e[0],e[1],e[2],e[3])}}},e}();n.SliceProgram=o},{"./shader_compiler":92}],94:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t,n){this.variableNames=["x"],this.outputShape=n,this.rank=n.length;var o=r.getCoordsDataType(this.rank),l="";l=1===this.rank?"coords * strides + begin":n.map((function(e,i){return"coords["+i+"] * strides["+i+"] + begin["+i+"]"})).join(","),this.userCode="\n      "+o+" begin = "+o+"("+e+");\n      "+o+" strides = "+o+"("+t+");\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+l+"));\n      }\n    "};n.StridedSliceProgram=o},{"./shader_compiler":92}],95:[function(e,t,n){"use strict";function r(e,t){return e*t}function o(e,t){if(e%t!=0)throw new Error("unpackedSize ("+e+") must be a multiple of "+t);return e/t}Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.FLOAT=0]="FLOAT",e[e.UNSIGNED_BYTE=1]="UNSIGNED_BYTE"}(n.TextureType||(n.TextureType={})),n.getUnpackedMatrixTextureShapeWidthHeight=function(e,t){return[t,e]},n.getUnpackedArraySizeFromMatrixSize=r,n.getColorMatrixTextureShapeWidthHeight=function(e,t){return[4*t,e]},n.getMatrixSizeFromUnpackedArraySize=o,n.encodeMatrixToUnpackedArray=function(e,t,n){var o=r(e.length,n);if(t.length<o)throw new Error("unpackedArray length ("+t.length+") must be >= "+o);for(var l=0,c=0;c<e.length;++c)t[l]=e[c],l+=n},n.FLOAT_MAX=2e4,n.FLOAT_MIN=-n.FLOAT_MAX;var l=(n.FLOAT_MAX-n.FLOAT_MIN)/255,c=[1,1/255,1/65025,1/16581375],f=[1,255,65025];function h(e,t){return[Math.ceil(t/2),Math.ceil(e/2)]}function d(e,t){var n=h(e,t);return n[0]*n[1]*4}n.BYTE_NAN_VALUE=0,n.encodeFloatArray=function(e){for(var t=new Uint8Array(4*e.length),r=function(i){var r=e[i/4];if(isNaN(r))return t[i]=n.BYTE_NAN_VALUE,t[i+1]=n.BYTE_NAN_VALUE,t[i+2]=n.BYTE_NAN_VALUE,t[i+3]=n.BYTE_NAN_VALUE,"continue";var o=(r-n.FLOAT_MIN)/l,c=f.map((function(e){return e*o})).map((function(e){return Math.floor(e%1*255)}));t[i]=Math.floor(o),t[i+1]=c[0],t[i+2]=c[1],t[i+3]=c[2]},i=0;i<t.length;i+=4)r(i);return t},n.decodeToFloatArray=function(e){for(var t=new Float32Array(e.length/4),r=function(i){if(e[i]===n.BYTE_NAN_VALUE&&e[i+1]===n.BYTE_NAN_VALUE&&e[i+2]===n.BYTE_NAN_VALUE&&e[i+3]===n.BYTE_NAN_VALUE)return t[i/4]=NaN,"continue";var r=0;c.forEach((function(t,n){r+=t*e[i+n]}));var o=r*l+n.FLOAT_MIN;t[i/4]=o},i=0;i<e.length;i+=4)r(i);return t},n.decodeMatrixFromUnpackedArray=function(e,t,n){var r=o(e.length,n);if(t.length<r)throw new Error("matrix length ("+t.length+") must be >= "+r);for(var l=0,c=0;c<e.length;c+=n)t[l++]=e[c]},n.decodeMatrixFromUnpackedColorRGBAArray=function(e,t,n){var r=e.length*n/4;if(t.length<r)throw new Error("matrix length ("+t.length+") must be >= "+r);for(var o=0,l=0;l<e.length;l+=4)for(var c=0;c<n;c++)t[o++]=e[l+c]},n.getPackedMatrixTextureShapeWidthHeight=h,n.getPackedRGBAArraySizeFromMatrixShape=d,n.encodeMatrixToPackedRGBA=function(e,t,n,r){var o=d(t,n);if(r.length<o)throw new Error("packedRGBA length ("+r.length+") must be >= "+o);for(var l=h(t,n),c=l[0],f=l[1],m=n%2==1,y=t%2==1,v=Math.floor(n/2),w=Math.floor(t/2),x=m?4:0,_=n,N=0,E=0;E<w;++E){for(var A=2*E*n,O=0;O<v;++O){var S=A+2*O;r[N]=e[S],r[N+1]=e[S+1],r[N+2]=e[S+_],r[N+3]=e[S+_+1],N+=4}N+=x}if(m){S=n-1,N=4*(c-1);var T=2*n;for(x=4*c,E=0;E<w;++E)r[N]=e[S],r[N+2]=e[S+n],S+=T,N+=x}if(y)for(S=(t-1)*n,N=(f-1)*c*4,O=0;O<v;++O)r[N++]=e[S++],r[N++]=e[S++],N+=2;return m&&y&&(r[r.length-4]=e[e.length-1]),r},n.decodeMatrixFromPackedRGBA=function(e,t,n,r){var o=t*n;if(o<r.length)throw new Error("matrix length ("+r.length+") must be >= "+o);for(var l=n%2==1,c=t%2==1,f=Math.floor(n/2),d=Math.floor(t/2),m=h(t,n),y=m[0],v=m[1],w=l?4:0,x=n+(l?1:0),_=0,N=0,E=n,A=0;A<d;++A){for(var O=0;O<f;++O)r[N++]=e[_++],r[N++]=e[_++],r[E++]=e[_++],r[E++]=e[_++];_+=w,N+=x,E+=x}if(l){_=4*(y-1);var S=n-1;for(w=4*y,x=2*n,A=0;A<d;++A)r[S]=e[_],r[S+n]=e[_+2],_+=w,S+=x}if(c)for(_=(v-1)*y*4,S=(t-1)*n,O=0;O<f;++O)r[S++]=e[_++],r[S++]=e[_++],_+=2;return l&&c&&(r[r.length-1]=e[e.length-4]),r}},{}],96:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./tex_util"),o=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.allocatedTextures=[],this.usedTextureCount={}}return e.prototype.acquireTexture=function(e,t){void 0===t&&(t=r.TextureType.FLOAT);var n=l(e,t);if(n in this.freeTextures||(this.freeTextures[n]=[]),n in this.usedTextureCount||(this.usedTextureCount[n]=0),this.usedTextureCount[n]++,this.freeTextures[n].length>0)return this.numFreeTextures--,this.numUsedTextures++,this.log(),this.freeTextures[n].shift();this.numUsedTextures++,this.log();var o=this.gpgpu.createMatrixTexture(e[0],e[1]);return this.allocatedTextures.push(o),o},e.prototype.releaseTexture=function(e,t,n){void 0===n&&(n=r.TextureType.FLOAT);var o=l(t,n);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--,this.usedTextureCount[o]--,this.log()},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;null!=this.allocatedTextures&&(this.allocatedTextures.forEach((function(t){e.gpgpu.deleteMatrixTexture(t)})),this.freeTextures=null,this.allocatedTextures=null,this.usedTextureCount=null,this.numUsedTextures=0,this.numFreeTextures=0)},e}();function l(e,t){return e[0]+"_"+e[1]+"_"+t}n.TextureManager=o},{"./tex_util":95}],97:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;var o=r.getCoordsDataType(this.rank),l=function(e){var t=e.length;if(t>4)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],i=0;i<e.length;i++)r.push("imod("+n[i]+", "+e[i]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+l+"));\n      }\n    "};n.TileProgram=o},{"./shader_compiler":92}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./shader_compiler"),o=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;var o=r.getCoordsDataType(this.rank),l=function(e){var t=e.length;if(t>4)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=new Array(t),i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+l+"));\n    }\n    "};n.TransposeProgram=o},{"./shader_compiler":92}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../ops/erf_util"),o=e("../../ops/selu_util"),l=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "};n.UnaryOpProgram=l;var c="if (isNaN(x)) return x;";n.ABS="return abs(x);",n.RELU=c+"\n  return (x < 0.0) ? 0.0 : x;\n",n.ELU="return (x >= 0.0) ? x : (exp(x) - 1.0);",n.SELU="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+o.SELU_SCALEALPHA+";\n  float scale = "+o.SELU_SCALE+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",n.STEP=function(e){return void 0===e&&(e=0),c+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "},n.NEG="return -x;",n.CEIL="return ceil(x);",n.FLOOR="return floor(x);",n.SIGN="\n  if (isNaN(x)) { return 0.0; }\n  return sign(x);\n",n.ROUND="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",n.EXP="return exp(x);",n.EXPM1="return exp(x) - 1.0;",n.LOG="return log(x);",n.LOG1P="return log(1.0 + x);",n.SQRT="return sqrt(x);",n.RSQRT="return inversesqrt(x);",n.SIGMOID="return 1.0 / (1.0 + exp(-1.0 * x));",n.SOFTPLUS="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",n.SIN="return sin(x);",n.COS="return cos(x);",n.TAN="return tan(x);",n.ASIN="return asin(x);",n.ACOS="return acos(x);",n.ATAN=c+"\n  return atan(x);\n",n.SINH="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",n.COSH="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",n.TANH="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",n.ASINH="return log(x + sqrt(x * x + 1.0));",n.ACOSH="return log(x + sqrt(x * x - 1.0));",n.ATANH="return (log(1.0 + x) - log(1.0 - x)) / 2.0;",n.ERF='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '+r.ERF_P+";\n  float a1 = "+r.ERF_A1+";\n  float a2 = "+r.ERF_A2+";\n  float a3 = "+r.ERF_A3+";\n  float a4 = "+r.ERF_A4+";\n  float a5 = "+r.ERF_A5+";\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n",n.SQUARE="return x * x;",n.RECIPROCAL="return 1.0 / x;",n.LOGICAL_NOT="return float(!(x >= 1.0));",n.TO_INT="return float(int(x));"},{"../../ops/erf_util":111,"../../ops/selu_util":128}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=null,o=e("../../util"),l=e("../../environment");function c(canvas,e){var t,n=l.ENV.get("WEBGL_VERSION");if(2===n?t=canvas.getContext("webgl2",e):1===n&&(t=canvas.getContext("webgl",e)||canvas.getContext("experimental-webgl",e)),0===n||null==t)throw new Error("This browser does not support WebGL.");return t}function f(e,t){var n=t();return d(e),n}n.createWebGLRenderingContext=function(e){var canvas=document.createElement("canvas");return canvas.width=1,canvas.height=1,c(canvas,e)},n.createWebGLRenderingContextFromCanvas=c,n.callAndCheck=f;var h=!1;function d(e){if(h){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+m(e,t))}}function m(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}n.enableDebugWebGLErrorChecking=function(e){h=e},n.checkWebGLError=d,n.getWebGLErrorMessage=m,n.getExtensionOrThrow=function(e,t){return _(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')},n.createVertexShader=function(e,t){var n=_(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(f(e,(function(){return e.shaderSource(n,t)})),f(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n},n.createFragmentShader=function(e,t){var n=_(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(f(e,(function(){return e.shaderSource(n,t)})),f(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=y.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],l=e.split("\n"),c=l.length.toString().length+2,f=l.map((function(line,e){return o.rightPad((e+1).toString(),c)+line})),h=0,i=0;i<f.length;i++)h=Math.max(f[i].length,h);var d=f.slice(0,r-1),m=f.slice(r-1,r),v=f.slice(r);console.log(d.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+o.rightPad(m[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(v.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n};var y=/ERROR: [0-9]+:([0-9]+):/g;function v(e){return null!=r?r:r=f(e,(function(){return e.getParameter(e.MAX_TEXTURE_SIZE)}))}function w(e,t,n){N(e,n),f(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),f(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}function x(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function _(e,t,n){var r=f(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function N(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}n.createProgram=function(e){return _(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")},n.linkProgram=function(e,t){if(f(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")},n.validateProgram=function(e,t){if(f(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")},n.createStaticVertexBuffer=function(e,data){var t=_(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return f(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,t)})),f(e,(function(){return e.bufferData(e.ARRAY_BUFFER,data,e.STATIC_DRAW)})),t},n.createStaticIndexBuffer=function(e,data){var t=_(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return f(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t)})),f(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,data,e.STATIC_DRAW)})),t},n.queryMaxTextureSize=v,n.getChannelsPerTexture=function(){return l.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===l.ENV.get("WEBGL_VERSION")?1:4},n.createTexture=function(e){return _(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")},n.validateTextureSize=function(e,t,n){var r=v(e);if(t<=0||n<=0){var o="["+t+"x"+n+"]";throw new Error("Requested texture size "+o+" is invalid.")}if(t>r||n>r)throw o="["+t+"x"+n+"]",new Error("Requested texture size "+o+" greater than WebGL maximum on this browser / GPU ["+r+"x"+r+"].")},n.createFramebuffer=function(e){return _(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")},n.bindVertexBufferToProgramAttribute=function(e,t,n,r,o,l,c){var h=e.getAttribLocation(t,n);return-1!==h&&(f(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),f(e,(function(){return e.vertexAttribPointer(h,o,e.FLOAT,!1,l,c)})),f(e,(function(){return e.enableVertexAttribArray(h)})),!0)},n.bindTextureUnit=w,n.unbindTextureUnit=function(e,t){N(e,t),f(e,(function(){return e.activeTexture(e.TEXTURE0+t)})),f(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},n.getProgramUniformLocationOrThrow=function(e,t,n){return _(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')},n.getProgramUniformLocation=function(e,t,n){return e.getUniformLocation(t,n)},n.bindTextureToProgramUniformSampler=function(e,t,n,r,o){f(e,(function(){return w(e,n,o)})),f(e,(function(){return e.uniform1i(r,o)}))},n.bindCanvasToFramebuffer=function(e){f(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),f(e,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),f(e,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},n.bindColorTextureToFramebuffer=function(e,t,n){f(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),f(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))},n.unbindColorTextureFromFramebuffer=function(e,t){f(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),f(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))},n.validateFramebuffer=function(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+x(e,t))},n.getFramebufferErrorMessage=x,n.getTextureShapeFromLogicalShape=function(e,t){2!==t.length&&(t=o.squeezeShape(t).newShape);var n=v(e),r=o.sizeFromShape(t);return t.length<=1&&r<=n?[r,1]:2===t.length&&t[0]<=n&&t[1]<=n?t:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?[t[0],t[1]*t[2]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n?[t[0],t[1]*t[2]*t[3]]:o.sizeToSquarishShape(r)}},{"../../environment":47,"../../util":153}],101:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../doc"),f=e("../environment"),h=e("../tensor"),d=e("../tensor_util"),m=e("../util"),y=e("./axis_util"),v=e("./concat"),w=e("./operation"),x=e("./rand"),_=e("./reduction_ops"),N=function(){function e(){}return e.tensor=function(e,t,n){void 0===n&&(n="float32");var r=m.inferShape(e);return null!=t&&1!==r.length&&m.assertShapesMatch(t,r,"Error creating a new Tensor. Inferred shape ("+r+") does not match the provided shape ("+t+"). "),m.isTypedArray(e)||Array.isArray(e)||(e=[e]),t=t||r,h.Tensor.make(t,{values:A(e,n)},n)},e.scalar=function(t,n){if(void 0===n&&(n="float32"),m.isTypedArray(t)||Array.isArray(t))throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean)");return e.tensor(t,[],n)},e.tensor1d=function(t,n){void 0===n&&(n="float32");var r=m.inferShape(t);if(1!==r.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return e.tensor(t,r,n)},e.tensor2d=function(t,n,r){if(void 0===r&&(r="float32"),null!=n&&2!==n.length)throw new Error("tensor2d() requires shape to have two numbers");var o=m.inferShape(t);if(2!==o.length&&1!==o.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return n=n||o,e.tensor(t,n,r)},e.tensor3d=function(t,n,r){if(void 0===r&&(r="float32"),null!=n&&3!==n.length)throw new Error("tensor3d() requires shape to have three numbers");var o=m.inferShape(t);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return n=n||o,e.tensor(t,n,r)},e.tensor4d=function(t,n,r){if(void 0===r&&(r="float32"),null!=n&&4!==n.length)throw new Error("tensor4d() requires shape to have four numbers");var o=m.inferShape(t);if(4!==o.length&&1!==o.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===o.length&&null==n)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return n=n||o,e.tensor(t,n,r)},e.ones=function(e,t){void 0===t&&(t="float32");var n=function(e,t){for(var n=E(e,t),i=0;i<n.length;i++)n[i]=1;return n}(m.sizeFromShape(e),t);return h.Tensor.make(e,{values:n},t)},e.zeros=function(e,t){void 0===t&&(t="float32");var n=E(m.sizeFromShape(e),t);return h.Tensor.make(e,{values:n},t)},e.fill=function(e,t,n){void 0===n&&(n="float32");var r=m.getTypedArrayFromDType(n,m.sizeFromShape(e));return r.fill(t),h.Tensor.make(e,{values:r},n)},e.onesLike=function(t){return m.assertArgumentsAreTensors({x:t},"onesLike"),e.ones(t.shape,t.dtype)},e.zerosLike=function(t){return m.assertArgumentsAreTensors({x:t},"zerosLike"),e.zeros(t.shape,t.dtype)},e.clone=function(e){return m.assertArgumentsAreTensors({x:e},"clone"),f.ENV.engine.runKernel((function(t){return h.Tensor.make(e.shape,{dataId:e.dataId},e.dtype)}),{x:e},(function(e){return{x:function(){return e.toFloat()}}}))},e.eye=function(t,n,r,o){void 0===o&&(o="float32"),null==n&&(n=t);for(var l=e.buffer([t,n],o),c=t<=n?t:n,i=0;i<c;++i)l.set(1,i,i);var f=l.toTensor().as2D(t,n);if(null==r)return f;if(1===r.length)return e.tile(e.expandDims(f,0),[r[0],1,1]);if(2===r.length)return e.tile(e.expandDims(e.expandDims(f,0),0),[r[0],r[1],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+r.length+"D.")},e.randomNormal=function(t,n,r,o,l){if(void 0===n&&(n=0),void 0===r&&(r=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);for(var c=new x.MPRandGauss(n,r,o,!1,l),f=e.buffer(t,o),i=0;i<f.values.length;i++)f.values[i]=c.nextValue();return f.toTensor()},e.truncatedNormal=function(t,n,r,o,l){if(void 0===n&&(n=0),void 0===r&&(r=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);for(var c=new x.MPRandGauss(n,r,o,!0,l),f=e.buffer(t,o),i=0;i<f.values.length;i++)f.values[i]=c.nextValue();return f.toTensor()},e.randomUniform=function(t,n,r,o){void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o="float32");for(var l=e.buffer(t,o),i=0;i<l.values.length;i++)l.values[i]=m.randUniform(n,r);return l.toTensor()},e.rand=function(e,t,n){var r=m.sizeFromShape(e),o=null;if(null==n||"float32"===n)o=new Float32Array(r);else if("int32"===n)o=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return h.Tensor.make(e,{values:o},n)},e.multinomial=function(e,t,n,r){void 0===r&&(r=!1),m.assertArgumentsAreTensors({logits:e},"multinomial");var o=e.size,l=e.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+l);n=n||Math.random();var c=1===l?e.as2D(1,-1):e,h=f.ENV.engine.runKernel((function(e){return e.multinomial(c,r,t,n)}),{logits2D:c});return 1===l?h.as1D():h},e.oneHot=function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),m.assert("int32"===e.dtype,"Indices must be of dtype `int32`"),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);return f.ENV.engine.runKernel((function(o){return o.oneHot(e,t,n,r)}),{indices:e})},e.fromPixels=function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return f.ENV.engine.fromPixels(e,t)},e.toPixels=function(img,canvas){return o(this,void 0,void 0,(function(){var e,t,n,r,o,c,f,h,data,d,y,i,v,g,b,a,w,x,_;return l(this,(function(l){switch(l.label){case 0:if(m.assertArgumentsAreTensors({img:img},"toPixels"),2!==img.rank&&3!==img.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+img.rank+".");if(e=img.shape.slice(0,2),t=e[0],n=e[1],(r=2===img.rank?1:img.shape[2])>4||2===r)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+r);return o=img.min(),c=img.max(),[4,o.data()];case 1:return f=l.sent()[0],[4,c.data()];case 2:if(h=l.sent()[0],o.dispose(),c.dispose(),"float32"===img.dtype){if(f<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+h+"].")}else{if("int32"!==img.dtype)throw new Error("Unsupported type for toPixels: "+img.dtype+". Please use float32 or int32 tensors.");if(f<0||h>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+h+"].")}return[4,img.data()];case 3:for(data=l.sent(),d="float32"===img.dtype?255:1,y=new Uint8ClampedArray(n*t*4),i=0;i<t*n;++i)v=void 0,g=void 0,b=void 0,a=void 0,1===r?(v=data[i]*d,g=data[i]*d,b=data[i]*d,a=255):3===r?(v=data[3*i]*d,g=data[3*i+1]*d,b=data[3*i+2]*d,a=255):4===r&&(v=data[4*i]*d,g=data[4*i+1]*d,b=data[4*i+2]*d,a=data[4*i+3]*d),y[0+(w=4*i)]=Math.round(v),y[w+1]=Math.round(g),y[w+2]=Math.round(b),y[w+3]=Math.round(a);return null!=canvas&&(canvas.width=n,canvas.height=t,x=canvas.getContext("2d"),_=new ImageData(y,n,t),x.putImageData(_,0,0)),[2,y]}}))}))},e.reshape=function(e,t){return m.assertArgumentsAreTensors({x:e},"reshape"),t=m.inferFromImplicitShape(t,e.size),m.assert(e.size===m.sizeFromShape(t),"new shape and old shape must have the same number of elements."),f.ENV.engine.runKernel((function(n){return n.reshape(e,t)}),{x:e},(function(t){return{x:function(){return t.reshape(e.shape)}}}))},e.squeeze=function(t,n){return m.assertArgumentsAreTensors({x:t},"squeeze"),e.reshape(t,m.squeezeShape(t.shape,n).newShape)},e.cast=function(e,t){return m.assertArgumentsAreTensors({x:e},"cast"),f.ENV.engine.runKernel((function(n){return n.cast(e,t)}),{x:e},(function(e){return{x:function(){return e.clone()}}}))},e.tile=function(t,n){return m.assertArgumentsAreTensors({x:t},"tile"),m.assert(t.rank===n.length,"Error in transpose: rank of input "+t.rank+" must match length of reps "+n+"."),f.ENV.engine.runKernel((function(e){return e.tile(t,n)}),{x:t},(function(r){return{x:function(){var o=e.zerosLike(t);if(1===t.rank)for(var i=0;i<n[0];++i)o=o.add(r.slice([i*t.shape[0]],[t.shape[0]]));else if(2===t.rank)for(i=0;i<n[0];++i)for(var l=0;l<n[1];++l)o=o.add(r.slice([i*t.shape[0],l*t.shape[1]],[t.shape[0],t.shape[1]]));else if(3===t.rank)for(i=0;i<n[0];++i)for(l=0;l<n[1];++l)for(var c=0;c<n[2];++c)o=o.add(r.slice([i*t.shape[0],l*t.shape[1],c*t.shape[2]],[t.shape[0],t.shape[1],t.shape[2]]));else{if(4!==t.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+t.rank+" tensors yet.");for(i=0;i<n[0];++i)for(l=0;l<n[1];++l)for(c=0;c<n[2];++c)for(var f=0;f<n[3];++f)o=o.add(r.slice([i*t.shape[0],l*t.shape[1],c*t.shape[2],f*t.shape[3]],[t.shape[0],t.shape[1],t.shape[2],t.shape[3]]))}return o}}}))},e.gather=function(e,t,n){return void 0===n&&(n=0),m.assertArgumentsAreTensors({x:e,indices:t},"gather"),m.assert("int32"===t.dtype,"Indices must be of dtype `int32`"),n=y.parseAxisParam(n,e.shape)[0],f.ENV.engine.runKernel((function(r){return r.gather(e,t,n)}),{x:e},(function(r){return{x:function(){return _.ReductionOps.unsortedSegmentSum(r,t,e.shape[n],n)}}}))},e.pad1d=function(t,n,r){return void 0===r&&(r=0),m.assert(2===n.length,"Invalid number of paddings. Must be length of 2."),e.pad(t,[n],r)},e.pad2d=function(t,n,r){return void 0===r&&(r=0),m.assert(2===n.length&&2===n[0].length&&2===n[1].length,"Invalid number of paddings. Must be length of 2 each."),e.pad(t,n,r)},e.pad3d=function(t,n,r){return void 0===r&&(r=0),m.assert(3===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length,"Invalid number of paddings. Must be length of 2 each."),e.pad(t,n,r)},e.pad4d=function(t,n,r){return void 0===r&&(r=0),m.assert(4===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length&&2===n[3].length,"Invalid number of paddings. Must be length of 2 each."),e.pad(t,n,r)},e.pad=function(e,t,n){if(void 0===n&&(n=0),m.assertArgumentsAreTensors({x:e},"pad"),0===e.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var r=t.map((function(p){return p[0]}));return f.ENV.engine.runKernel((function(r){return r.pad(e,t,n)}),{x:e},(function(t){return{x:function(){return t.slice(r,e.shape)}}}))},e.stack=function(e,t){if(void 0===t&&(t=0),m.assertArgumentsAreTensors({tensors:e},"stack"),m.assert(e.length>=1,"Pass at least one tensor to tf.stack"),1===e.length)return e[0].expandDims(t);var n=e[0].rank,r=e[0].shape,o=e[0].dtype;m.assert(t<=n,"Axis must be <= rank of the tensor"),e.forEach((function(e){m.assertShapesMatch(r,e.shape,"All tensors passed to stack must have matching shapes")})),e.forEach((function(e){m.assert(o===e.dtype,"All tensors passed to stack must have matching dtypes")}));var l=e.map((function(e){return e.expandDims(t)}));return v.ConcatOps.concat(l,t)},e.unstack=function(e,t){void 0===t&&(t=0);for(var n,r=e.shape[t],o=Array(e.rank-1).fill(0),l=0,i=0;i<e.rank;i++)i!==t&&(o[l]=e.shape[i],l++);n=Array(r).fill(1);var c=Array(e.rank).fill(0),f=e.shape.slice();return n.map((function(s){f[t]=s;var n=e.slice(c,f);return c[t]+=s,n.reshape(o)}))},e.split=function(e,t,n){var r;void 0===n&&(n=0),m.assertArgumentsAreTensors({x:e},"split"),n=y.parseAxisParam(n,e.shape)[0],"number"==typeof t?(m.assert(e.shape[n]%t==0,"Number of splits must evenly divide the axis."),r=Array(t).fill(e.shape[n]/t)):(m.assert(e.shape[n]===t.reduce((function(a,b){return a+b})),"The sum of sizes must match the size of the axis dimension."),r=t);var o=Array(e.rank).fill(0),l=e.shape.slice();return r.map((function(s){l[n]=s;var t=e.slice(o,l);return o[n]+=s,t}))},e.cumsum=function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1),m.assertArgumentsAreTensors({x:e},"cumsum"),t|=0;var o=y.getAxesPermutation([t],e.rank),l=e;null!=o&&(l=e.transpose(o));var c=y.getInnerMostAxes(1,e.rank)[0],h=f.ENV.engine.runKernel((function(e){return e.cumsum(l,c,n,r)}),{permutedX:l},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=o&&(h=h.transpose(o)),h},e.expandDims=function(t,n){void 0===n&&(n=0),m.assertArgumentsAreTensors({x:t},"expandDims"),m.assert(n<=t.rank,"Axis must be <= rank of the tensor");var r=t.shape.slice();return r.splice(n,0,1),e.reshape(t,r)},e.linspace=function(t,n,r){if(0===r)throw new Error("Cannot request zero samples");var o=(n-t)/(r-1),l=E(r,"float32");l[0]=t;for(var i=1;i<l.length;i++)l[i]=l[i-1]+o;return e.tensor1d(l,"float32")},e.range=function(t,n,r,o){if(void 0===r&&(r=1),void 0===o&&(o="float32"),0===r)throw new Error("Cannot have a step of zero");if(t===n||t<n&&r<0||n<t&&r>1)return e.zeros([0],o);var l=E(Math.abs(Math.ceil((n-t)/r)),o);n<t&&1===r&&(r=-1),l[0]=t;for(var i=1;i<l.length;i++)l[i]=l[i-1]+r;return e.tensor1d(l,o)},e.buffer=function(e,t,n){return void 0===t&&(t="float32"),new h.TensorBuffer(e,t,n)},e.print=function(e,t){void 0===t&&(t=!1),console.log(d.tensorToString(e,t))},r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"scalar",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor1d",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor2d",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor3d",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"tensor4d",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"ones",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"zeros",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"fill",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"onesLike",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"zerosLike",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"clone",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"eye",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"randomNormal",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"truncatedNormal",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"randomUniform",null),r([w.operation],e,"rand",null),r([w.operation],e,"multinomial",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"oneHot",null),r([c.doc({heading:"Tensors",subheading:"Creation"}),w.operation],e,"fromPixels",null),r([c.doc({heading:"Visualization"})],e,"toPixels",null),r([c.doc({heading:"Tensors",subheading:"Transformations"}),w.operation],e,"reshape",null),r([c.doc({heading:"Tensors",subheading:"Transformations"})],e,"squeeze",null),r([c.doc({heading:"Tensors",subheading:"Transformations"}),w.operation],e,"cast",null),r([c.doc({heading:"Tensors",subheading:"Slicing and Joining"}),w.operation],e,"tile",null),r([c.doc({heading:"Tensors",subheading:"Slicing and Joining"}),w.operation],e,"gather",null),r([c.doc({heading:"Tensors",subheading:"Transformations"}),w.operation],e,"pad",null),r([c.doc({heading:"Tensors",subheading:"Slicing and Joining"}),w.operation],e,"stack",null),r([c.doc({heading:"Tensors",subheading:"Slicing and Joining"}),w.operation],e,"unstack",null),r([c.doc({heading:"Tensors",subheading:"Slicing and Joining"}),w.operation],e,"split",null),r([c.doc({heading:"Operations",subheading:"Scan"})],e,"cumsum",null),r([c.doc({heading:"Tensors",subheading:"Transformations"}),w.operation],e,"expandDims",null),r([w.operation,c.doc({heading:"Tensors",subheading:"Creation"})],e,"linspace",null),r([w.operation,c.doc({heading:"Tensors",subheading:"Creation"})],e,"range",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"buffer",null),r([c.doc({heading:"Tensors",subheading:"Creation"})],e,"print",null),e}();function E(e,t){if(null==t||"float32"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type $ {dtype}")}function A(a,e){return function(a,e){return a instanceof Float32Array&&"float32"===e||a instanceof Int32Array&&"int32"===e||a instanceof Uint8Array&&"bool"===e}(a,e)?a:(Array.isArray(a)&&(a=m.flatten(a)),m.copyTypedArray(a,e))}n.ArrayOps=N},{"../doc":45,"../environment":47,"../tensor":147,"../tensor_util":148,"../util":153,"./axis_util":102,"./concat":107,"./operation":121,"./rand":124,"./reduction_ops":126}],102:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../util");function o(e,t){for(var i=0;i<e.length;++i)if(e[e.length-i-1]!==t-1-i)return!1;return!0}function l(e,t,n){for(var r=e.length+t.length,o=[],l=0,c=0,f=0;f<r;f++)-1===n.indexOf(f)?o.push(e[l++]):o.push(t[c++]);return o}n.axesAreInnerMostDims=o,n.combineLocations=l,n.computeOutAndReduceShapes=function(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((function(t){return e[t]}))]},n.expandShapeToKeepDim=function(e,t){return l(e,t.map((function(e){return 1})),t)},n.parseAxisParam=function(e,t){var n=t.length;return e=null==e?t.map((function(s,i){return i})):[].concat(e),r.assert(e.every((function(e){return e>=-n&&e<n})),"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e),r.assert(e.every((function(e){return r.isInt(e)})),"All values in axis param must be integers but got axis "+e),e.map((function(a){return a<0?n+a:a}))},n.assertAxesAreInnerMostDims=function(e,t,n){r.assert(o(t,n),e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input.")},n.getAxesPermutation=function(e,t){if(o(e,t))return null;for(var n=[],i=0;i<t;++i)-1===e.indexOf(i)&&n.push(i);return e.forEach((function(e){return n.push(e)})),n},n.getUndoAxesPermutation=function(e){return e.map((function(e,i){return[i,e]})).sort((function(a,b){return a[1]-b[1]})).map((function(e){return e[0]}))},n.getInnerMostAxes=function(e,t){for(var n=[],i=t-e;i<t;++i)n.push(i);return n}},{"../util":153}],103:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./array_ops"),h=e("./broadcast_util"),d=e("./operation"),m=e("./ops"),y=function(){function e(){}return e.batchNormalization2d=function(t,n,r,o,l,f){return void 0===o&&(o=.001),c.assert(2===t.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+t.rank+"."),c.assert(2===n.rank||1===n.rank,"Error in batchNormalization2D: mean must be rank 2 or rank 1 but got rank "+n.rank+"."),c.assert(2===r.rank||1===r.rank,"Error in batchNormalization2D: variance must be rank 2 or rank 1 but got rank "+r.rank+"."),null!=l&&c.assert(2===l.rank||1===l.rank,"Error in batchNormalization2D: scale must be rank 2 or rank 1 but got rank "+l.rank+"."),null!=f&&c.assert(2===f.rank||1===f.rank,"Error in batchNormalization2D: offset must be rank 2 or rank 1 but got rank "+f.rank+"."),e.batchNormalization(t,n,r,o,l,f)},e.batchNormalization3d=function(t,n,r,o,l,f){return void 0===o&&(o=.001),c.assert(3===t.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+t.rank+"."),c.assert(3===n.rank||1===n.rank,"Error in batchNormalization3D: mean must be rank 3 or rank 1 but got rank "+n.rank+"."),c.assert(3===r.rank||1===r.rank,"Error in batchNormalization3D: variance must be rank 3 or rank 1 but got rank "+r.rank+"."),null!=l&&c.assert(3===l.rank||1===l.rank,"Error in batchNormalization3D: scale must be rank 3 or rank 1 but got rank "+l.rank+"."),null!=f&&c.assert(3===f.rank||1===f.rank,"Error in batchNormalization3D: offset must be rank 3 or rank 1 but got rank "+f.rank+"."),e.batchNormalization(t,n,r,o,l,f)},e.batchNormalization4d=function(t,n,r,o,l,f){return void 0===o&&(o=.001),c.assert(4===t.rank,"Error in batchNormalization4D: x must be rank 4 but got rank "+t.rank+"."),c.assert(4===n.rank||1===n.rank,"Error in batchNormalization4D: mean must be rank 4 or rank 1 but got rank "+n.rank+"."),c.assert(4===r.rank||1===r.rank,"Error in batchNormalization4D: variance must be rank 4 or rank 1 but got rank "+r.rank+"."),null!=l&&c.assert(4===l.rank||1===l.rank,"Error in batchNormalization4D: scale must be rank 4 or rank 1 but got rank "+l.rank+"."),null!=f&&c.assert(4===f.rank||1===f.rank,"Error in batchNormalization4D: offset must be rank 4 or rank 1 but got rank "+f.rank+"."),e.batchNormalization(t,n,r,o,l,f)},e.batchNormalization=function(e,t,n,r,o,d){var y;return void 0===r&&(r=.001),c.assertArgumentsAreTensors({x:e,mean:t,variance:n},"batchNormalization"),null!=o&&c.assertArgumentsAreTensors({scale:o},"batchNormalization"),null!=d&&c.assertArgumentsAreTensors({offset:d},"batchNormalization"),c.assert(t.rank===n.rank,"Batch normalization gradient requires mean and variance to have equal ranks."),c.assert(null==d||t.rank===d.rank,"Batch normalization gradient requires mean and offset to have equal ranks."),c.assert(null==o||t.rank===o.rank,"Batch normalization gradient requires mean and scale to have equal ranks."),y=0===e.rank||1===e.rank?e.as4D(1,1,1,e.size):2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e,l.ENV.engine.runKernel((function(e){return e.batchNormalization(y,v(t),v(n),r,v(o),v(d))}),{x:e,mean:t,variance:n,scale:o,offset:d},(function(l){var c=null==o?f.ArrayOps.scalar(1):o,d=h.getReductionAxes(t.shape,y.shape),v=[];if(1===t.rank){for(var i=0;i<y.shape.length-1;++i)v.push(y.shape[i]);v.push(1)}var w=e.sub(t),x=l.mul(c),_=m.rsqrt(n.add(f.ArrayOps.scalar(r))),N=_.mul(_).mul(_).mul(f.ArrayOps.scalar(-.5));return{x:function(){return 1===t.rank?l.mul(f.ArrayOps.tile(_.as4D(1,1,1,t.shape[0]),v)).mul(c).reshape(e.shape):l.mul(_).mul(c).reshape(e.shape)},mean:function(){var e=_.mul(f.ArrayOps.scalar(-1)).mul(x);return 1===t.rank&&(e=e.sum(d)),e.reshape(t.shape)},variance:function(){var e=N.mul(w).mul(x);return 1===t.rank&&(e=e.sum(d)),e.reshape(t.shape)},scale:function(){var e=w.mul(_),n=l.mul(e);return 1===t.rank&&(n=n.sum(d)),n.reshape(t.shape)},offset:function(){var e=l;return 1===t.rank&&(e=e.sum(d)),e.reshape(t.shape)}}})).reshape(e.shape)},r([d.operation],e,"batchNormalization2d",null),r([d.operation],e,"batchNormalization3d",null),r([d.operation],e,"batchNormalization4d",null),r([o.doc({heading:"Operations",subheading:"Normalization"})],e,"batchNormalization",null),e}();function v(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}n.BatchNormOps=y},{"../doc":45,"../environment":47,"../util":153,"./array_ops":101,"./broadcast_util":105,"./operation":121,"./ops":122}],104:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../types"),f=e("../util"),h=e("./broadcast_util"),d=e("./operation"),m=e("./ops"),y=function(){function e(){}return e.add=function(a,b){f.assertArgumentsAreTensors({a:a,b:b},"add"),f.assertTypesMatch(a,b);var e=h.assertAndGetBroadcastShape(a.shape,b.shape);return l.ENV.engine.runKernel((function(e){return e.add(a,b)}),{a:a,b:b},(function(t){return{a:function(){var n=t,r=h.getReductionAxes(a.shape,e);return r.length>0&&(n=n.sum(r)),n.reshape(a.shape)},b:function(){var n=t,r=h.getReductionAxes(b.shape,e);return r.length>0&&(n=n.sum(r)),n.reshape(b.shape)}}}))},e.addStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in addStrict: "),a.add(b)},e.sub=function(a,b){f.assertArgumentsAreTensors({a:a,b:b},"sub"),f.assertTypesMatch(a,b);var e=h.assertAndGetBroadcastShape(a.shape,b.shape);return l.ENV.engine.runKernel((function(e){return e.subtract(a,b)}),{a:a,b:b},(function(t){return{a:function(){var n=t,r=h.getReductionAxes(a.shape,e);return r.length>0&&(n=n.sum(r)),n.reshape(a.shape)},b:function(){var n=t,r=h.getReductionAxes(b.shape,e);return r.length>0&&(n=n.sum(r)),n.neg().reshape(b.shape)}}}))},e.subStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in subStrict: "),a.sub(b)},e.pow=function(base,e){f.assertArgumentsAreTensors({base:base,exp:e},"pow");var t=h.assertAndGetBroadcastShape(base.shape,e.shape);return base=base.cast(c.upcastType(base.dtype,e.dtype)),e=e.cast(c.upcastType(base.dtype,e.dtype)),l.ENV.engine.runKernel((function(t,n){return n(t.pow(base,e))}),{base:base,exp:e},(function(n,r){var o=r[0];return{base:function(){var r=n.mul(e.toFloat().mul(o.div(base))),l=h.getReductionAxes(base.shape,t);return l.length>0&&(r=r.sum(l)),r.reshape(base.shape)},exp:function(){var r=n.mul(o.mul(base.log()).toFloat()),l=h.getReductionAxes(e.shape,t);return l.length>0&&(r=r.sum(l)),r.reshape(e.shape)}}}))},e.powStrict=function(base,e){return f.assertShapesMatch(base.shape,e.shape,"Error in powStrict: "),base.pow(e)},e.mul=function(a,b){f.assertArgumentsAreTensors({a:a,b:b},"mul"),f.assertTypesMatch(a,b);var e=h.assertAndGetBroadcastShape(a.shape,b.shape);return l.ENV.engine.runKernel((function(e){return e.multiply(a,b)}),{a:a,b:b},(function(t){return{a:function(){var n=t.mul(b.toFloat()),r=h.getReductionAxes(a.shape,e);return r.length>0?n.sum(r).reshape(a.shape):n},b:function(){var n=t.mul(a.toFloat()),r=h.getReductionAxes(b.shape,e);return r.length>0?n.sum(r).reshape(b.shape):n}}}))},e.mulStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in multiplyStrict: "),a.mul(b)},e.div=function(a,b){f.assertArgumentsAreTensors({a:a,b:b},"div"),f.assertTypesMatch(a,b);var e=h.assertAndGetBroadcastShape(a.shape,b.shape);return l.ENV.engine.runKernel((function(e){return e.divide(a,b)}),{a:a,b:b},(function(t){return{a:function(){var n=t.div(b.toFloat()),r=h.getReductionAxes(a.shape,e);return r.length>0?n.sum(r).reshape(a.shape):n},b:function(){var n=t.mul(a.toFloat()),r=h.getReductionAxes(b.shape,e);r.length>0&&(n=n.sum(r).reshape(b.shape));var o=b.square();return n.div(o.toFloat()).neg()}}}))},e.divStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in divideStrict: "),a.div(b)},e.mod=function(a,b){f.assertArgumentsAreTensors({a:a,b:b},"mod"),f.assertTypesMatch(a,b);var e=h.assertAndGetBroadcastShape(a.shape,b.shape);return l.ENV.engine.runKernel((function(e){return e.mod(a,b)}),{a:a,b:b},(function(t){return{a:function(){var n=h.getReductionAxes(a.shape,e);return n.length>0?t.sum(n).reshape(a.shape):t},b:function(){var n=t.mul(a.div(b).floor().neg()),r=h.getReductionAxes(b.shape,e);return r.length>0?n.sum(r).reshape(b.shape):n}}}))},e.modStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in modStrict: "),a.mod(b)},e.minimum=function(a,b){return f.assertArgumentsAreTensors({a:a,b:b},"minimum"),f.assertTypesMatch(a,b),"bool"===a.dtype&&(a=a.toInt()),"bool"===b.dtype&&(b=b.toInt()),h.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.minimum(a,b)}),{a:a,b:b},(function(e){return{a:function(){return e.mul(a.lessEqual(b).toFloat())},b:function(){return e.mul(a.greater(b).toFloat())}}}))},e.minimumStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in minimumStrict: "),a.minimum(b)},e.maximum=function(a,b){return f.assertArgumentsAreTensors({a:a,b:b},"maximum"),f.assertTypesMatch(a,b),"bool"===a.dtype&&(a=a.toInt()),"bool"===b.dtype&&(b=b.toInt()),h.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.maximum(a,b)}),{a:a,b:b},(function(e){return{a:function(){return e.mul(a.greaterEqual(b).toFloat())},b:function(){return e.mul(a.less(b).toFloat())}}}))},e.maximumStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in minimumStrict: "),a.maximum(b)},e.squaredDifference=function(a,b){return f.assertArgumentsAreTensors({a:a,b:b},"squaredDifference"),f.assertTypesMatch(a,b),h.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.squaredDifference(a,b)}),{a:a,b:b},(function(e){var t=m.scalar(2);return{a:function(){return e.mul(a.sub(b).mul(t))},b:function(){return e.mul(b.sub(a).mul(t))}}}))},e.squaredDifferenceStrict=function(a,b){return f.assertShapesMatch(a.shape,b.shape,"Error in squaredDifferenceStrict: "),a.squaredDifference(b)},e.atan2=function(a,b){f.assertArgumentsAreTensors({a:a,b:b},"atan2"),f.assertTypesMatch(a,b);var t=h.assertAndGetBroadcastShape(a.shape,b.shape);return l.ENV.engine.runKernel((function(e){return e.atan2(a,b)}),{a:a,b:b},(function(n){return{a:function(){var r=e.add(m.square(a),m.square(b)),o=n.mul(b.div(r)),l=h.getReductionAxes(a.shape,t);return l.length>0&&(o=o.sum(l)),o.reshape(a.shape)},b:function(){var r=e.add(m.square(a),m.square(b)),o=m.neg(n.mul(a.div(r))),l=h.getReductionAxes(b.shape,t);return l.length>0&&(o=o.sum(l)),o.reshape(b.shape)}}}))},r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"add",null),r([d.operation],e,"addStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"sub",null),r([d.operation],e,"subStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"pow",null),r([d.operation],e,"powStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"mul",null),r([d.operation],e,"mulStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"div",null),r([d.operation],e,"divStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"mod",null),r([d.operation],e,"modStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"minimum",null),r([d.operation],e,"minimumStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"maximum",null),r([d.operation],e,"maximumStrict",null),r([o.doc({heading:"Operations",subheading:"Arithmetic"}),d.operation],e,"squaredDifference",null),r([d.operation],e,"squaredDifferenceStrict",null),r([d.operation],e,"atan2",null),e}();n.BinaryOps=y},{"../doc":45,"../environment":47,"../types":152,"../util":153,"./broadcast_util":105,"./operation":121,"./ops":122}],105:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getBroadcastDims=function(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var o=n-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r},n.getReductionAxes=function(e,t){for(var n=[],i=0;i<t.length;i++){var r=e[e.length-i-1],o=t.length-i-1,l=t[o];(null==r||1===r&&l>1)&&n.unshift(o)}return n},n.broadcastDimsAreOuter=function(e){for(var i=0;i<e.length;i++)if(e[i]!==i)return!1;return!0},n.assertAndGetBroadcastShape=function(e,t){for(var n=[],r="Operands could not be broadcast together with shapes "+e+" and "+t+".",o=Math.max(e.length,t.length),i=0;i<o;i++){var a=e[e.length-i-1]||1,b=t[t.length-i-1]||1;if(a>1&&b>1&&a!==b)throw Error(r);n.unshift(Math.max(a,b))}return n}},{}],106:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./broadcast_util"),h=e("./operation"),d=function(){function e(){}return e.notEqual=function(a,b){return c.assertArgumentsAreTensors({a:a,b:b},"notEqual"),c.assertTypesMatch(a,b),f.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.notEqual(a,b)}),{a:a,b:b})},e.notEqualStrict=function(a,b){return c.assertShapesMatch(a.shape,b.shape,"Error in notEqualStrict: "),a.notEqual(b)},e.less=function(a,b){return c.assertArgumentsAreTensors({a:a,b:b},"less"),c.assertTypesMatch(a,b),f.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.less(a,b)}),{a:a,b:b})},e.lessStrict=function(a,b){return c.assertShapesMatch(a.shape,b.shape,"Error in lessStrict: "),a.less(b)},e.equal=function(a,b){return c.assertArgumentsAreTensors({a:a,b:b},"equal"),c.assertTypesMatch(a,b),f.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.equal(a,b)}),{a:a,b:b})},e.equalStrict=function(a,b){return c.assertShapesMatch(a.shape,b.shape,"Error in equalStrict: "),a.equal(b)},e.lessEqual=function(a,b){return c.assertArgumentsAreTensors({a:a,b:b},"lessEqual"),c.assertTypesMatch(a,b),f.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.lessEqual(a,b)}),{a:a,b:b})},e.lessEqualStrict=function(a,b){return c.assertShapesMatch(a.shape,b.shape,"Error in lessEqualStrict: "),a.lessEqual(b)},e.greater=function(a,b){return c.assertArgumentsAreTensors({a:a,b:b},"greater"),c.assertTypesMatch(a,b),f.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.greater(a,b)}),{a:a,b:b})},e.greaterStrict=function(a,b){return c.assertShapesMatch(a.shape,b.shape,"Error in greaterStrict: "),a.greater(b)},e.greaterEqual=function(a,b){return c.assertArgumentsAreTensors({a:a,b:b},"greaterEqual"),c.assertTypesMatch(a,b),f.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.greaterEqual(a,b)}),{a:a,b:b})},e.greaterEqualStrict=function(a,b){return c.assertShapesMatch(a.shape,b.shape,"Error in greaterEqualStrict: "),a.greaterEqual(b)},r([o.doc({heading:"Operations",subheading:"Logical"}),h.operation],e,"notEqual",null),r([h.operation],e,"notEqualStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),h.operation],e,"less",null),r([h.operation],e,"lessStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),h.operation],e,"equal",null),r([h.operation],e,"equalStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),h.operation],e,"lessEqual",null),r([h.operation],e,"lessEqualStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),h.operation],e,"greater",null),r([h.operation],e,"greaterStrict",null),r([o.doc({heading:"Operations",subheading:"Logical"}),h.operation],e,"greaterEqual",null),r([h.operation],e,"greaterEqualStrict",null),e}();n.CompareOps=d},{"../doc":45,"../environment":47,"../util":153,"./broadcast_util":105,"./operation":121}],107:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./axis_util"),h=e("./concat_util"),d=e("./operation"),m=function(){function e(){}return e.concat1d=function(t){return e.concat(t,0)},e.concat2d=function(t,n){return e.concat(t,n)},e.concat3d=function(t,n){return e.concat(t,n)},e.concat4d=function(t,n){return e.concat(t,n)},e.concat=function(e,t){void 0===t&&(t=0),c.assert(e.length>=1,"Pass at least one tensor to concat"),c.assertArgumentsAreTensors({tensors:e},"concat");var n=e[0];if(1===e.length)return n;for(var r=f.parseAxisParam(t,n.shape),i=1;i<e.length;++i)n=y(n,e[i],r[0]);return n},r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),d.operation],e,"concat",null),e}();function y(a,b,e){h.assertParams(a.shape,b.shape,e);var t=h.computeOutShape(a.shape,b.shape,e),n=a.as2D(-1,c.sizeFromShape(a.shape.slice(e))),r=b.as2D(-1,c.sizeFromShape(b.shape.slice(e))),o=h.computeGradientSliceShapes(n.shape,r.shape),f=o.aBegin,d=o.aSize,m=o.bBegin,y=o.bSize;return l.ENV.engine.runKernel((function(e){return e.concat(n,r)}),{a:n,b:r},(function(e){return{a:function(){return e.slice(f,d)},b:function(){return e.slice(m,y)}}})).reshape(t)}n.ConcatOps=m},{"../doc":45,"../environment":47,"../util":153,"./axis_util":102,"./concat_util":108,"./operation":121}],108:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../util");n.assertParams=function(e,t,n){var o=e.length,l=t.length;r.assert(e.length===t.length,"Error in concat"+o+"D: rank of x1 ("+o+") and x2 ("+l+") must be the same."),r.assert(n>=0&&n<o,"Error in concat"+o+"D: axis must be between 0 and "+(o-1)+".");for(var i=0;i<o;i++)r.assert(i===n||e[i]===t[i],"Error in concat"+o+"D: Shape ("+e+") does not match ("+t+") along the non-concatenated axis "+i+".")},n.computeOutShape1D=function(e,t){r.assert(1===e.length&&1===t.length,"x1 and x2 should be 1d array.");var n=e.slice();return n[0]+=t[0],n},n.computeOutShape=function(e,t,n){r.assert(e.length===t.length,"x1 and x2 should have the same rank.");var o=e.slice();return o[n]+=t[n],o},n.computeGradientSliceShapes=function(e,t){return{aBegin:[0,0],aSize:e,bBegin:[0,e[1]],bSize:t}}},{"../util":153}],109:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./conv_util"),h=e("./operation"),d=function(){function e(){}return e.conv1d=function(t,filter,n,r,o,l,f){void 0===o&&(o="NWC"),void 0===l&&(l=1),c.assertArgumentsAreTensors({x:t,filter:filter},"conv1d");var h=t,d=!1;2===t.rank&&(d=!0,h=t.as3D(1,t.shape[0],t.shape[1])),c.assert(3===h.rank,"Error in conv1d: input must be rank 3, but got rank "+h.rank+"."),c.assert(3===filter.rank,"Error in conv1d: filter must be rank 3, but got rank "+filter.rank+"."),null!=f&&c.assert(c.isInt(r),"Error in conv1d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+r+"."),c.assert(h.shape[2]===filter.shape[1],"Error in conv1d: depth of input ("+h.shape[2]+") must match input depth for filter "+filter.shape[1]+"."),c.assert(y(n,l),"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+l+"'"),c.assert("NWC"===o,"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported.");var m=filter.as4D(1,filter.shape[0],filter.shape[1],filter.shape[2]),v=h.as4D(h.shape[0],1,h.shape[1],h.shape[2]),w=[1,n],x=[1,l],_=e.conv2d(v,m,w,r,"NHWC",x,f);return d?_.as2D(_.shape[2],_.shape[3]):_.as3D(_.shape[0],_.shape[2],_.shape[3])},e.conv2d=function(t,filter,n,r,o,h,d){void 0===o&&(o="NHWC"),void 0===h&&(h=[1,1]),c.assertArgumentsAreTensors({x:t,filter:filter},"conv2d");var v=t,w=!1;3===t.rank&&(w=!0,v=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),c.assert(4===v.rank,"Error in conv2d: input must be rank 4, but got rank "+v.rank+"."),c.assert(4===filter.rank,"Error in conv2d: filter must be rank 4, but got rank "+filter.rank+"."),null!=d&&c.assert(c.isInt(r),"Error in conv2d: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+r+"."),c.assert(v.shape[3]===filter.shape[2],"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+filter.shape[2]+"."),c.assert(y(n,h),"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+h+"'"),c.assert("NHWC"===o,"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported.");var x=f.computeConv2DInfo(v.shape,filter.shape,n,h,r,d),_=l.ENV.engine.runKernel((function(e){return e.conv2d(v,filter,x)}),{x:v,filter:filter},(function(t){return c.assert(m(h),"Error in gradient of conv2D: dilation rates greater than 1 are notyet supported in gradients. Got dilations '"+h+"'"),{x:function(){return e.conv2dDerInput(v.shape,t,filter,n,r)},filter:function(){return e.conv2dDerFilter(v,t,filter.shape,n,r)}}}));return w?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_},e.conv2dDerInput=function(e,t,filter,n,r,o){c.assertArgumentsAreTensors({dy:t,filter:filter},"conv2dDerInput"),c.assert(e.length===t.rank,"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match");var h=e,d=t,m=!1;3===t.rank&&(m=!0,d=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),h=[1,e[0],e[1],e[2]]);var y=h[3],v=d.shape[3];c.assert(4===h.length,"Error in conv2dDerInput: inShape must be length 4, but got length "+h.length+"."),c.assert(4===d.rank,"Error in conv2dDerInput: dy must be rank 4, but got rank "+d.rank),c.assert(4===filter.rank,"Error in conv2dDerInput: filter must be rank 4, but got rank "+filter.rank),c.assert(y===filter.shape[2],"Error in conv2dDerInput: depth of input ("+y+") must match input depth for filter "+filter.shape[2]+"."),c.assert(v===filter.shape[3],"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+filter.shape[3]+"."),null!=o&&c.assert(c.isInt(r),"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+".");var w=f.computeConv2DInfo(h,filter.shape,n,1,r,o),x=l.ENV.engine.runKernel((function(e){return e.conv2dDerInput(d,filter,w)}),{dy4D:d});return m?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x},e.conv2dDerFilter=function(e,t,n,r,o,h){c.assertArgumentsAreTensors({x:e,dy:t},"conv2dDerFilter");var d=e;3===e.rank&&(d=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var m=t;3===m.rank&&(m=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),c.assert(4===d.rank,"Error in conv2dDerFilter: input must be rank 4, but got shape "+d.shape+"."),c.assert(4===m.rank,"Error in conv2dDerFilter: dy must be rank 4, but got shape "+m.shape+"."),c.assert(4===n.length,"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."),c.assert(d.shape[3]===n[2],"Error in conv2dDerFilter: depth of input "+d.shape[3]+") must match input depth in filter ("+n[2]+"."),c.assert(m.shape[3]===n[3],"Error in conv2dDerFilter: depth of dy ("+m.shape[3]+") must match output depth for filter ("+n[3]+")."),null!=h&&c.assert(c.isInt(o),"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+h+" but got pad "+o+".");var y=f.computeConv2DInfo(d.shape,n,r,1,o,h);return l.ENV.engine.runKernel((function(e){return e.conv2dDerFilter(d,m,y)}),{x4D:d,dy4D:m})},e.conv2dTranspose=function(t,filter,n,r,o,l){return c.assertArgumentsAreTensors({x:t,filter:filter},"conv2dTranspose"),e.conv2dDerInput(n,t,filter,r,o,l)},e.depthwiseConv2d=function(e,filter,t,n,r,o,h){void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),c.assertArgumentsAreTensors({x:e,filter:filter},"depthwiseConv2d");var d=e,m=!1;3===e.rank&&(m=!0,d=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),c.assert(4===d.rank,"Error in depthwiseConv2D: input must be rank 4, but got rank "+d.rank+"."),c.assert(4===filter.rank,"Error in depthwiseConv2D: filter must be rank 4, but got rank "+filter.rank+"."),c.assert(d.shape[3]===filter.shape[2],"Error in depthwiseConv2D: number of input channels ("+d.shape[3]+") must match the inChannels dimension in filter "+filter.shape[2]+"."),null==o&&(o=[1,1]),c.assert(y(t,o),"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"),null!=h&&c.assert(c.isInt(n),"Error in depthwiseConv2D: pad must be an integer when using, dimRoundingMode "+h+" but got pad "+n+".");var v=f.computeConv2DInfo(d.shape,filter.shape,t,o,n,h,!0),w=l.ENV.engine.runKernel((function(e){return e.depthwiseConv2D(d,filter,v)}),{x4D:d,filter:filter});return m?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w},e.separableConv2d=function(t,n,r,o,l,f,h){void 0===f&&(f=[1,1]),void 0===h&&(h="NHWC"),c.assertArgumentsAreTensors({x:t,depthwiseFilter:n,pointwiseFilter:r},"separableConv2d");var d=t,m=!1;if(3===t.rank&&(m=!0,d=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),"NCHW"===h)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");c.assert(4===d.rank,"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."),c.assert(4===n.rank,"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+n.rank+"."),c.assert(4===r.rank,"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+n.rank+"."),c.assert(1===r.shape[0],"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+r.shape[0]+"."),c.assert(1===r.shape[1],"Error in separableConv2d: the second dimension of pointwise filter  must be 1, but got "+r.shape[1]+".");var y=n.shape[2],v=n.shape[3];c.assert(r.shape[2]===y*v,"Error in separableConv2d: the third dimension of pointwise filter must be "+y*v+", but got "+r.shape[2]+".");var w=e.depthwiseConv2d(d,n,o,l,h,f),x=e.conv2d(w,r,1,"valid",h);return m?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x},r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"conv1d",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"conv2d",null),r([h.operation],e,"conv2dDerInput",null),r([h.operation],e,"conv2dDerFilter",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"conv2dTranspose",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"depthwiseConv2d",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"separableConv2d",null),e}();function m(param){var e=function(param){return"number"==typeof param?[param,param]:param}(param),t=e[0],n=e[1];return 1===t&&1===n}function y(e,t){return m(e)||m(t)}n.ConvOps=d},{"../doc":45,"../environment":47,"../util":153,"./conv_util":110,"./operation":121}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../util");function o(e,t,n,o,d,m,y,v){void 0===y&&(y=!1),void 0===v&&(v="channelsLast");var w=[-1,-1,-1,-1],x=w[0],_=w[1],N=w[2],E=w[3];if("channelsLast"===v)x=e[0],_=e[1],N=e[2],E=e[3];else{if("channelsFirst"!==v)throw new Error("Unknown dataFormat "+v);x=e[0],E=e[1],_=e[2],N=e[3]}var A,O=t[0],S=t[1],T=t[3],I=c(n),k=I[0],P=I[1],C=c(o),R=C[0],z=C[1],M=function(e,t,n,o,c,f,d,m){var y,v,w;if("number"==typeof e){y={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var x=function(e,t,n,o,c,f){null==c&&(c=l(e,t,o));var d=e[0],m=e[1],y=h((d-t+2*c)/o+1,f);r.assert(r.isInt(y),"The output # of rows ("+y+") must be an integer. Change the stride and/or zero pad parameters");var v=h((m-t+2*c)/o+1,f);return r.assert(r.isInt(v),"The output # of columns ("+v+") must be an integer. Change the stride and/or zero pad parameters"),[y,v,n]}([t,n,1],f,1,o,e,m);v=x[0],w=x[1]}else if("same"===e){v=Math.ceil(t/o),w=Math.ceil(n/c);var _=(v-1)*o+f-t,N=(w-1)*c+d-n,E=Math.floor(_/2),A=_-E,O=Math.floor(N/2);y={top:E,bottom:A,left:O,right:N-O,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);y={top:0,bottom:0,left:0,right:0,type:"VALID"},v=Math.ceil((t-f+1)/o),w=Math.ceil((n-d+1)/c)}return{padInfo:y,outHeight:v,outWidth:w}}(d,_,N,k,P,f(O,R),f(S,z),m),L=M.padInfo,D=M.outHeight,V=M.outWidth,j=y?T*E:T;return"channelsFirst"===v?A=[x,j,D,V]:"channelsLast"===v&&(A=[x,D,V,j]),{batchSize:x,dataFormat:v,inHeight:_,inWidth:N,inChannels:E,outHeight:D,outWidth:V,outChannels:j,padInfo:L,strideHeight:k,strideWidth:P,filterHeight:O,filterWidth:S,dilationHeight:R,dilationWidth:z,inShape:e,outShape:A,filterShape:t}}function l(e,t,n,r){void 0===r&&(r=1);var o=f(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function c(param){return"number"==typeof param?[param,param]:param}function f(e,t){return t<=1?e:e+(e-1)*(t-1)}function h(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}n.computePool2DInfo=function(e,t,n,r,l,f){void 0===f&&(f="channelsLast");var h,d=c(t),m=d[0],y=d[1];if("channelsLast"===f)h=[m,y,e[3],e[3]];else{if("channelsFirst"!==f)throw new Error("Unknown dataFormat "+f);h=[m,y,e[1],e[1]]}return o(e,h,n,1,r,l,!1,f)},n.computeConv2DInfo=o,n.computeDefaultPad=l},{"../util":153}],111:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ERF_P=.3275911,n.ERF_A1=.254829592,n.ERF_A2=-.284496736,n.ERF_A3=1.421413741,n.ERF_A4=-1.453152027,n.ERF_A5=1.061405429},{}],112:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./operation"),h=function(){function e(){}return e.resizeBilinear=function(e,t,n){void 0===n&&(n=!1),c.assertArgumentsAreTensors({images:e},"resizeBilinear"),c.assert(3===e.rank||4===e.rank,"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+e.rank+"."),c.assert(2===t.length,"Error in resizeBilinear: new shape must 2D, but got shape "+t+".");var r=e,o=!1;3===e.rank&&(o=!0,r=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var f=t[0],h=t[1],d=l.ENV.engine.runKernel((function(e,t){return e.resizeBilinear(r,f,h,n)}),{batchImages:r},(function(e,t){return{batchImages:function(){return l.ENV.engine.runKernel((function(t){return t.resizeBilinearBackprop(e,r,n)}),{})}}}));return o?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d},e.resizeNearestNeighbor=function(e,t,n){void 0===n&&(n=!1),c.assertArgumentsAreTensors({images:e},"resizeNearestNeighbor"),c.assert(3===e.rank||4===e.rank,"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+e.rank+"."),c.assert(2===t.length,"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."),c.assert("float32"===e.dtype||"int32"===e.dtype,"`images` must have `int32` or `float32` as dtype");var r=e,o=!1;3===e.rank&&(o=!0,r=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var f=t[0],h=t[1],d=l.ENV.engine.runKernel((function(e){return e.resizeNearestNeighbor(r,f,h,n)}),{batchImages:r});return o?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d},r([o.doc({heading:"Operations",subheading:"Images",namespace:"image"}),f.operation],e,"resizeBilinear",null),r([o.doc({heading:"Operations",subheading:"Images",namespace:"image"}),f.operation],e,"resizeNearestNeighbor",null),e}();n.ImageOps=h},{"../doc":45,"../environment":47,"../util":153,"./operation":121}],113:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../tracking"),c=e("../util"),f=e("./operation"),h=e("./ops"),d=function(){function e(){}return e.gramSchmidt=function(e){var t;if(Array.isArray(e)){t=!1,c.assert(null!=e&&e.length>0,"Gram-Schmidt process: input must not be null, undefined, or empty");for(var n=e[0].shape[0],i=1;i<e.length;++i)c.assert(e[i].shape[0]===n,"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[i].shape[0]+" vs. "+n+")")}else t=!0,e=h.split(e,e.shape[0],0).map((function(e){return h.squeeze(e,[0])}));c.assert(e.length<=e[0].shape[0],"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+").");var r=[],o=e,f=function(i){r.push(l.Tracking.tidy((function(){var e=o[i];if(i>0)for(var t=0;t<i;++t){var n=h.sum(r[t].mulStrict(e)).mul(r[t]);e=e.sub(n)}return e.div(h.norm(e,"euclidean"))})))};for(i=0;i<e.length;++i)f(i);return t?h.stack(r,0):r},r([o.doc({heading:"Operations",subheading:"Linear Algebra"}),f.operation],e,"gramSchmidt",null),e}();n.LinalgOps=d},{"../doc":45,"../tracking":150,"../util":153,"./operation":121,"./ops":122}],114:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../types"),f=e("../util"),h=e("./broadcast_util"),d=e("./operation"),m=function(){function e(){}return e.logicalNot=function(e){return f.assertArgumentsAreTensors({x:e},"logicalNot"),f.assert("bool"===e.dtype,"Error Array must be of type bool."),l.ENV.engine.runKernel((function(t){return t.logicalNot(e)}),{x:e})},e.logicalAnd=function(a,b){return f.assertArgumentsAreTensors({a:a,b:b},"logicalAnd"),f.assert("bool"===a.dtype&&"bool"===b.dtype,"Error Array must be of type bool."),h.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.logicalAnd(a,b)}),{a:a,b:b})},e.logicalOr=function(a,b){return f.assertArgumentsAreTensors({a:a,b:b},"logicalOr"),f.assert("bool"===a.dtype&&"bool"===b.dtype,"Error Array must be of type bool."),h.assertAndGetBroadcastShape(a.shape,b.shape),l.ENV.engine.runKernel((function(e){return e.logicalOr(a,b)}),{a:a,b:b})},e.logicalXor=function(a,b){return f.assertArgumentsAreTensors({a:a,b:b},"logicalXor"),f.assert("bool"===a.dtype&&"bool"===b.dtype,"Error Array must be of type bool."),h.assertAndGetBroadcastShape(a.shape,b.shape),e.logicalOr(a,b).logicalAnd(e.logicalAnd(a,b).logicalNot())},e.where=function(e,a,b){f.assertArgumentsAreTensors({condition:e,a:a,b:b},"where"),f.assert("bool"===e.dtype||"bool"===a.dtype||"bool"===b.dtype,"Error Array must be of type bool."),f.assertShapesMatch(a.shape,b.shape,"Error in where: "),1===e.rank?f.assert(e.shape[0]===a.shape[0],"The first dimension of `a` must match the size of `condition`."):f.assertShapesMatch(e.shape,b.shape,"Error in where: ");var t=c.upcastType(a.dtype,b.dtype);return l.ENV.engine.runKernel((function(n){return n.where(e,a,b,t)}),{condition:e,a:a,b:b})},r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalNot",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalAnd",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalOr",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"logicalXor",null),r([o.doc({heading:"Operations",subheading:"Logical"}),d.operation],e,"where",null),e}();n.LogicalOps=m},{"../doc":45,"../environment":47,"../types":152,"../util":153,"./broadcast_util":105,"./operation":121}],115:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o,l=e("../doc"),c=e("../util"),f=e("./operation"),h=e("./ops");!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(o=n.Reduction||(n.Reduction={}));var d=function(){function e(){}return e.computeWeightedLoss=function(e,t,n){void 0===n&&(n=o.SUM_BY_NONZERO_WEIGHTS),c.assertArgumentsAreTensors({losses:e},"computeWeightedLoss"),null!=t&&c.assertArgumentsAreTensors({weights:t},"computeWeightedLoss");var r=null==t?e:e.mul(t);if(n===o.NONE)return r;if(n===o.SUM)return r.sum();if(n===o.MEAN)return null==t?r.mean():r.sum().div(t.sum());if(n===o.SUM_BY_NONZERO_WEIGHTS){if(null==t)return r.sum().div(h.scalar(e.size));var l=t.notEqual(h.scalar(0)).sum().toFloat();return r.sum().div(l)}throw Error("Unknown reduction: "+n)},e.absoluteDifference=function(t,n,r,l){void 0===l&&(l=o.SUM_BY_NONZERO_WEIGHTS),c.assertArgumentsAreTensors({labels:t,predictions:n},"absoluteDifference"),null!=r&&c.assertArgumentsAreTensors({weights:r},"absoluteDifference"),c.assertShapesMatch(t.shape,n.shape,"Error in absoluteDifference: ");var f=t.sub(n).abs();return e.computeWeightedLoss(f,r,l)},e.meanSquaredError=function(t,n,r,l){void 0===l&&(l=o.SUM_BY_NONZERO_WEIGHTS),c.assertArgumentsAreTensors({labels:t,predictions:n},"meanSquaredError"),null!=r&&c.assertArgumentsAreTensors({weights:r},"meanSquaredError"),c.assertShapesMatch(t.shape,n.shape,"Error in meanSquaredError: ");var f=t.squaredDifference(n);return e.computeWeightedLoss(f,r,l)},e.cosineDistance=function(t,n,r,l,f){void 0===f&&(f=o.SUM_BY_NONZERO_WEIGHTS),c.assertArgumentsAreTensors({labels:t,predictions:n},"cosineDistance"),null!=l&&c.assertArgumentsAreTensors({weights:l},"cosineDistance"),c.assertShapesMatch(t.shape,n.shape,"Error in cosineDistance: ");var d=h.scalar(1).sub(t.mul(n).sum(r,!0));return e.computeWeightedLoss(d,l,f)},e.hingeLoss=function(t,n,r,l){void 0===l&&(l=o.SUM_BY_NONZERO_WEIGHTS),c.assertArgumentsAreTensors({labels:t,predictions:n},"hingeLoss"),null!=r&&c.assertArgumentsAreTensors({weights:r},"hingeLoss"),c.assertShapesMatch(t.shape,n.shape,"Error in hingeLoss: ");var f=h.scalar(1);t=h.scalar(2).mul(t).sub(f);var d=f.sub(t.mul(n)).relu();return e.computeWeightedLoss(d,r,l)},e.logLoss=function(t,n,r,l,f){void 0===l&&(l=1e-7),void 0===f&&(f=o.SUM_BY_NONZERO_WEIGHTS),c.assertArgumentsAreTensors({labels:t,predictions:n},"logLoss"),null!=r&&c.assertArgumentsAreTensors({weights:r},"logLoss"),c.assertShapesMatch(t.shape,n.shape,"Error in logLoss: ");var d=h.scalar(1),m=h.scalar(l),y=t.mul(n.add(m).log()).neg().sub(d.sub(t).mul(d.sub(n).add(m).log()));return e.computeWeightedLoss(y,r,f)},r([l.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),f.operation],e,"computeWeightedLoss",null),r([l.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),f.operation],e,"absoluteDifference",null),r([l.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),f.operation],e,"meanSquaredError",null),r([l.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),f.operation],e,"cosineDistance",null),r([l.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),f.operation],e,"hingeLoss",null),r([l.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),f.operation],e,"logLoss",null),e}();n.LossOps=d},{"../doc":45,"../util":153,"./operation":121,"./ops":122}],116:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./operation"),h=function(){function e(){}return e.localResponseNormalization=function(e,t,n,r,o){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5),c.assertArgumentsAreTensors({x:e},"localResponseNormalization"),c.assert(4===e.rank||3===e.rank,"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+e.rank+"."),c.assert(c.isInt(t),"Error in localResponseNormalization3D: radius must be an integer\n                     but got radius "+t+".");var f=e,h=!1;3===e.rank&&(h=!0,f=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var d=l.ENV.engine.runKernel((function(e){return e.localResponseNormalization4D(f,t,n,r,o)}),{x4D:f});return h?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d},r([o.doc({heading:"Operations",subheading:"Normalization"}),f.operation],e,"localResponseNormalization",null),e}();n.LRNOps=h},{"../doc":45,"../environment":47,"../util":153,"./operation":121}],117:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../util"),c=e("./operation"),f=function(){function e(){}return e.multiRNNCell=function(e,data,t,n){l.assertArgumentsAreTensors({data:data,c:t,h:n},"multiRNNCell");for(var input=data,r=[],i=0;i<e.length;i++){var output=e[i](input,t[i],n[i]);r.push(output[0]),r.push(output[1]),input=output[1]}var o=[],c=[];for(i=0;i<r.length;i+=2)o.push(r[i]),c.push(r[i+1]);return[o,c]},e.basicLSTMCell=function(e,t,n,data,r,o){l.assertArgumentsAreTensors({forgetBias:e,lstmKernel:t,lstmBias:n,data:data,c:r,h:o},"basicLSTMCell");var c=data.concat(o,1).matMul(t).add(n),f=c.shape[0],h=c.shape[1]/4,d=[f,h],i=c.slice([0,0],d),m=c.slice([0,h],d),y=c.slice([0,2*h],d),v=c.slice([0,3*h],d),w=i.sigmoid().mulStrict(m.tanh()).addStrict(r.mulStrict(e.add(y).sigmoid())),x=w.tanh().mulStrict(v.sigmoid());return[w,x]},r([o.doc({heading:"Operations",subheading:"RNN"}),c.operation],e,"multiRNNCell",null),r([o.doc({heading:"Operations",subheading:"RNN"}),c.operation],e,"basicLSTMCell",null),e}();n.LSTMOps=f},{"../doc":45,"../util":153,"./operation":121}],118:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./operation"),h=function(){function e(){}return e.matMul=function(a,b,e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),c.assertArgumentsAreTensors({a:a,b:b},"matMul");var n=e?a.shape[0]:a.shape[1],r=t?b.shape[1]:b.shape[0];return c.assert(2===a.rank&&2===b.rank,"Error in matMul: inputs must be rank 2, got ranks "+a.rank+" and "+b.rank+"."),c.assert(n===r,"Error in matMul: inner shapes ("+n+") and ("+r+") of Tensors with shapes "+a.shape+" and "+b.shape+" and transposeA="+e+" and transposeB="+t+" must match."),l.ENV.engine.runKernel((function(n){return n.matMul(a,b,e,t)}),{a:a,b:b},(function(n){return e||t?!e&&t?{a:function(){return n.matMul(b.toFloat(),!1,!1)},b:function(){return n.matMul(a.toFloat(),!0,!1)}}:e&&!t?{a:function(){return b.toFloat().matMul(n,!1,!0)},b:function(){return a.toFloat().matMul(n,!1,!1)}}:{a:function(){return b.toFloat().matMul(n,!0,!0)},b:function(){return n.matMul(a.toFloat(),!0,!0)}}:{a:function(){return n.matMul(b.toFloat(),!1,!0)},b:function(){return a.toFloat().matMul(n,!0,!1)}}}))},e.vectorTimesMatrix=function(e,t){return c.assert(1===e.rank,"Error in vectorTimesMatrix: first input must be rank 1, but got rank "+e.rank+"."),c.assert(2===t.rank,"Error in vectorTimesMatrix: second input must be rank 2, but got rank "+t.rank+"."),c.assert(e.size===t.shape[0],"Error in vectorTimesMatrix: size of vector ("+e.size+") must match first dimension of matrix ("+t.shape[0]+")"),e.as2D(1,-1).matMul(t).as1D()},e.matrixTimesVector=function(e,t){return c.assert(1===t.rank,"Error in matrixTimesVector: second input must rank 1, but got rank "+t.rank+"."),c.assert(2===e.rank,"Error in matrixTimesVector: first input must be a rank 2, but got rank "+e.rank+"."),c.assert(t.size===e.shape[1],"Error in matrixTimesVector: size of first rank 1 input "+t.size+" must match inner dimension of second rank 2 input, but got shape "+e.shape+"."),e.matMul(t.as2D(-1,1)).as1D()},e.dotProduct=function(e,t){return c.assert(1===e.rank&&1===t.rank,"Error in dotProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+t.rank+"."),c.assert(e.size===t.size,"Error in dotProduct: size of inputs ("+e.size+") and ("+t.size+") must match."),e.as2D(1,-1).matMul(t.as2D(-1,1)).asScalar()},e.outerProduct=function(e,t){return c.assert(1===e.rank&&1===t.rank,"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+t.rank+"."),e.as2D(-1,1).matMul(t.as2D(1,-1))},r([o.doc({heading:"Operations",subheading:"Matrices"}),f.operation],e,"matMul",null),r([f.operation],e,"vectorTimesMatrix",null),r([f.operation],e,"matrixTimesVector",null),r([f.operation],e,"dotProduct",null),r([o.doc({heading:"Operations",subheading:"Matrices"}),f.operation],e,"outerProduct",null),e}();n.MatmulOps=h},{"../doc":45,"../environment":47,"../util":153,"./operation":121}],119:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../util"),c=e("./array_ops"),f=e("./binary_ops"),h=e("./operation"),d=function(){function e(){}return e.movingAverage=function(e,t,n,r,o){void 0===o&&(o=!0),l.assertArgumentsAreTensors({v:e,x:t},"movingAverage"),l.assertTypesMatch(e,t),l.assert(l.arraysEqual(e.shape,t.shape),"Shape mismatch in v and x");var h=c.ArrayOps.scalar(1);n="number"==typeof n?c.ArrayOps.scalar(n):n;var d=h.sub(n),m=t.sub(e).mul(d);return o&&(l.assert(null!=r,"When using zeroDebias: true, step is required."),r="number"==typeof r?c.ArrayOps.scalar(r):r,m=m.div(h.sub(f.BinaryOps.pow(n,r)))),e.add(m)},r([o.doc({heading:"Operations",subheading:"Moving Average"}),h.operation],e,"movingAverage",null),e}();n.MovingAverageOps=d},{"../doc":45,"../util":153,"./array_ops":101,"./binary_ops":104,"./operation":121}],120:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../util"),c=e("./axis_util"),f=e("./operation"),h=e("./ops"),d=function(){function e(){}return e.norm=function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1),l.assertArgumentsAreTensors({x:e},"norm");var o=function e(t,p,n){if(void 0===n&&(n=null),0===t.rank)return t.abs();if(1!==t.rank&&null===n)return e(t.reshape([-1]),p,n);if(1===t.rank||"number"==typeof n||n instanceof Array&&1===n.length){if(1===p)return t.abs().sum(n);if(p===1/0)return t.abs().max(n);if(p===-1/0)return t.abs().min(n);if("euclidean"===p||2===p)return t.abs().pow(h.scalar(2,"int32")).sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+p)}if(n instanceof Array&&2===n.length){if(1===p)return t.abs().sum(n[0]).max(n[1]-1);if(p===1/0)return t.abs().sum(n[1]).max(n[0]);if(p===-1/0)return t.abs().sum(n[1]).min(n[0]);if("fro"===p||"euclidean"===p)return t.square().sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+p)}throw new Error("Error in norm: invalid axis: "+n)}(e,t,n),f=o.shape;if(r){var d=c.parseAxisParam(n,e.shape);f=c.expandShapeToKeepDim(o.shape,d)}return o.reshape(f)},r([o.doc({heading:"Operations",subheading:"Matrices"}),f.operation],e,"norm",null),e}();n.NormOps=d},{"../doc":45,"../util":153,"./axis_util":102,"./operation":121,"./ops":122}],121:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../globals");n.operation=function(e,t,n){var o=n.value;return n.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r.tidy(t,(function(){return o.apply(void 0,e)}))},n}},{"../globals":48}],122:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./array_ops"),o=e("./batchnorm"),l=e("./binary_ops"),c=e("./compare"),f=e("./concat"),h=e("./conv"),d=e("./image_ops"),m=e("./linalg_ops"),y=e("./logical_ops"),v=e("./loss_ops"),w=e("./lrn"),x=e("./lstm"),_=e("./matmul"),N=e("./moving_average"),E=e("./norm"),A=e("./pool"),O=e("./reduction_ops"),S=e("./reverse"),T=e("./slice"),I=e("./softmax"),k=e("./strided_slice"),P=e("./transpose"),C=e("./unary_ops");n.batchNormalization=o.BatchNormOps.batchNormalization,n.batchNormalization2d=o.BatchNormOps.batchNormalization2d,n.batchNormalization3d=o.BatchNormOps.batchNormalization3d,n.batchNormalization4d=o.BatchNormOps.batchNormalization4d,n.concat=f.ConcatOps.concat,n.concat1d=f.ConcatOps.concat1d,n.concat2d=f.ConcatOps.concat2d,n.concat3d=f.ConcatOps.concat3d,n.concat4d=f.ConcatOps.concat4d,n.conv1d=h.ConvOps.conv1d,n.conv2d=h.ConvOps.conv2d,n.conv2dTranspose=h.ConvOps.conv2dTranspose,n.depthwiseConv2d=h.ConvOps.depthwiseConv2d,n.separableConv2d=h.ConvOps.separableConv2d,n.matMul=_.MatmulOps.matMul,n.matrixTimesVector=_.MatmulOps.matrixTimesVector,n.outerProduct=_.MatmulOps.outerProduct,n.vectorTimesMatrix=_.MatmulOps.vectorTimesMatrix,n.avgPool=A.PoolOps.avgPool,n.maxPool=A.PoolOps.maxPool,n.transpose=P.TransposeOps.transpose,n.reverse=S.ReverseOps.reverse,n.reverse1d=S.ReverseOps.reverse1d,n.reverse2d=S.ReverseOps.reverse2d,n.reverse3d=S.ReverseOps.reverse3d,n.reverse4d=S.ReverseOps.reverse4d,n.slice=T.SliceOps.slice,n.slice1d=T.SliceOps.slice1d,n.slice2d=T.SliceOps.slice2d,n.slice3d=T.SliceOps.slice3d,n.slice4d=T.SliceOps.slice4d,n.stridedSlice=k.StridedSliceOps.stridedSlice,n.argMax=O.ReductionOps.argMax,n.argMin=O.ReductionOps.argMin,n.logSumExp=O.ReductionOps.logSumExp,n.max=O.ReductionOps.max,n.mean=O.ReductionOps.mean,n.min=O.ReductionOps.min,n.moments=O.ReductionOps.moments,n.sum=O.ReductionOps.sum,n.unsortedSegmentSum=O.ReductionOps.unsortedSegmentSum,n.equal=c.CompareOps.equal,n.equalStrict=c.CompareOps.equalStrict,n.greater=c.CompareOps.greater,n.greaterStrict=c.CompareOps.greaterStrict,n.greaterEqual=c.CompareOps.greaterEqual,n.greaterEqualStrict=c.CompareOps.greaterEqualStrict,n.less=c.CompareOps.less,n.lessStrict=c.CompareOps.lessStrict,n.lessEqual=c.CompareOps.lessEqual,n.lessEqualStrict=c.CompareOps.lessEqualStrict,n.notEqual=c.CompareOps.notEqual,n.notEqualStrict=c.CompareOps.notEqualStrict,n.logicalNot=y.LogicalOps.logicalNot,n.logicalAnd=y.LogicalOps.logicalAnd,n.logicalOr=y.LogicalOps.logicalOr,n.logicalXor=y.LogicalOps.logicalXor,n.where=y.LogicalOps.where,n.abs=C.UnaryOps.abs,n.acos=C.UnaryOps.acos,n.acosh=C.UnaryOps.acosh,n.asin=C.UnaryOps.asin,n.asinh=C.UnaryOps.asinh,n.atan=C.UnaryOps.atan,n.atanh=C.UnaryOps.atanh,n.ceil=C.UnaryOps.ceil,n.clipByValue=C.UnaryOps.clipByValue,n.cos=C.UnaryOps.cos,n.cosh=C.UnaryOps.cosh,n.elu=C.UnaryOps.elu,n.exp=C.UnaryOps.exp,n.expm1=C.UnaryOps.expm1,n.floor=C.UnaryOps.floor,n.sign=C.UnaryOps.sign,n.leakyRelu=C.UnaryOps.leakyRelu,n.log=C.UnaryOps.log,n.log1p=C.UnaryOps.log1p,n.logSigmoid=C.UnaryOps.logSigmoid,n.neg=C.UnaryOps.neg,n.prelu=C.UnaryOps.prelu,n.relu=C.UnaryOps.relu,n.reciprocal=C.UnaryOps.reciprocal,n.round=C.UnaryOps.round,n.selu=C.UnaryOps.selu,n.sigmoid=C.UnaryOps.sigmoid,n.sin=C.UnaryOps.sin,n.sinh=C.UnaryOps.sinh,n.softplus=C.UnaryOps.softplus,n.sqrt=C.UnaryOps.sqrt,n.rsqrt=C.UnaryOps.rsqrt,n.square=C.UnaryOps.square,n.step=C.UnaryOps.step,n.tan=C.UnaryOps.tan,n.tanh=C.UnaryOps.tanh,n.erf=C.UnaryOps.erf,n.add=l.BinaryOps.add,n.addStrict=l.BinaryOps.addStrict,n.atan2=l.BinaryOps.atan2,n.div=l.BinaryOps.div,n.divStrict=l.BinaryOps.divStrict,n.maximum=l.BinaryOps.maximum,n.maximumStrict=l.BinaryOps.maximumStrict,n.minimum=l.BinaryOps.minimum,n.minimumStrict=l.BinaryOps.minimumStrict,n.mod=l.BinaryOps.mod,n.modStrict=l.BinaryOps.modStrict,n.mul=l.BinaryOps.mul,n.mulStrict=l.BinaryOps.mulStrict,n.pow=l.BinaryOps.pow,n.powStrict=l.BinaryOps.powStrict,n.sub=l.BinaryOps.sub,n.subStrict=l.BinaryOps.subStrict,n.squaredDifference=l.BinaryOps.squaredDifference,n.squaredDifferenceStrict=l.BinaryOps.squaredDifferenceStrict,n.norm=E.NormOps.norm,n.cast=r.ArrayOps.cast,n.clone=r.ArrayOps.clone,n.fromPixels=r.ArrayOps.fromPixels,n.toPixels=r.ArrayOps.toPixels,n.ones=r.ArrayOps.ones,n.onesLike=r.ArrayOps.onesLike,n.zeros=r.ArrayOps.zeros,n.zerosLike=r.ArrayOps.zerosLike,n.eye=r.ArrayOps.eye,n.rand=r.ArrayOps.rand,n.randomNormal=r.ArrayOps.randomNormal,n.truncatedNormal=r.ArrayOps.truncatedNormal,n.randomUniform=r.ArrayOps.randomUniform,n.multinomial=r.ArrayOps.multinomial,n.reshape=r.ArrayOps.reshape,n.squeeze=r.ArrayOps.squeeze,n.tile=r.ArrayOps.tile,n.gather=r.ArrayOps.gather,n.oneHot=r.ArrayOps.oneHot,n.linspace=r.ArrayOps.linspace,n.range=r.ArrayOps.range,n.buffer=r.ArrayOps.buffer,n.fill=r.ArrayOps.fill,n.tensor=r.ArrayOps.tensor,n.scalar=r.ArrayOps.scalar,n.tensor1d=r.ArrayOps.tensor1d,n.tensor2d=r.ArrayOps.tensor2d,n.tensor3d=r.ArrayOps.tensor3d,n.tensor4d=r.ArrayOps.tensor4d,n.print=r.ArrayOps.print,n.expandDims=r.ArrayOps.expandDims,n.stack=r.ArrayOps.stack,n.unstack=r.ArrayOps.unstack,n.split=r.ArrayOps.split,n.cumsum=r.ArrayOps.cumsum,n.pad=r.ArrayOps.pad,n.pad1d=r.ArrayOps.pad1d,n.pad2d=r.ArrayOps.pad2d,n.pad3d=r.ArrayOps.pad3d,n.pad4d=r.ArrayOps.pad4d,n.movingAverage=N.MovingAverageOps.movingAverage,n.basicLSTMCell=x.LSTMOps.basicLSTMCell,n.multiRNNCell=x.LSTMOps.multiRNNCell,n.softmax=I.SoftmaxOps.softmax,n.localResponseNormalization=w.LRNOps.localResponseNormalization,n.linalg=m.LinalgOps;var R=e("./operation");n.operation=R.operation;var z=e("../tensor"),M=e("../types");z.Tensor,M.Rank,v.Reduction,n.losses={absoluteDifference:v.LossOps.absoluteDifference,computeWeightedLoss:v.LossOps.computeWeightedLoss,cosineDistance:v.LossOps.cosineDistance,hingeLoss:v.LossOps.hingeLoss,logLoss:v.LossOps.logLoss,meanSquaredError:v.LossOps.meanSquaredError,softmaxCrossEntropy:I.SoftmaxOps.softmaxCrossEntropy},n.image={resizeBilinear:d.ImageOps.resizeBilinear,resizeNearestNeighbor:d.ImageOps.resizeNearestNeighbor}},{"../tensor":147,"../types":152,"./array_ops":101,"./batchnorm":103,"./binary_ops":104,"./compare":106,"./concat":107,"./conv":109,"./image_ops":112,"./linalg_ops":113,"./logical_ops":114,"./loss_ops":115,"./lrn":116,"./lstm":117,"./matmul":118,"./moving_average":119,"./norm":120,"./operation":121,"./pool":123,"./reduction_ops":126,"./reverse":127,"./slice":129,"./softmax":131,"./strided_slice":132,"./transpose":133,"./unary_ops":134}],123:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./conv_util"),h=e("./operation"),d=function(){function e(){}return e.maxPool=function(t,n,r,o,h){c.assertArgumentsAreTensors({x:t},"maxPool");var d=t,m=!1;3===t.rank&&(m=!0,d=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),c.assert(4===d.rank,"Error in maxPool: input must be rank 4 but got rank "+d.rank+"."),null!=h&&c.assert(c.isInt(o),"Error in maxPool: pad must be an integer when using, dimRoundingMode "+h+" but got pad "+o+".");var y=f.computePool2DInfo(d.shape,n,r,o,h),v=l.ENV.engine.runKernel((function(e,t){return t(e.maxPool(d,y))}),{x:d},(function(t,l){var c=l[0];return{x:function(){return e.maxPoolBackprop(t,d,c,n,r,o)}}}));return m?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v},e.maxPoolBackprop=function(e,input,output,t,n,r,o){c.assertArgumentsAreTensors({dy:e,input:input,output:output},"maxPoolBackprop"),c.assert(input.rank===e.rank,"Rank of input ("+input.rank+") does not match rank of dy ("+e.rank+")"),c.assert(4===e.rank,"Error in maxPoolBackprop: dy must be rank 4 but got rank "+e.rank+"."),c.assert(4===input.rank,"Error in maxPoolBackprop: input must be rank 4 but got rank "+input.rank+"."),null!=o&&c.assert(c.isInt(r),"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+".");var h=f.computePool2DInfo(input.shape,t,n,r,o);return l.ENV.engine.runKernel((function(t){return t.maxPoolBackprop(e,input,output,h)}),{dy:e,input:input})},e.avgPool=function(t,n,r,o,h){c.assertArgumentsAreTensors({x:t},"avgPool"),c.assert("float32"===t.dtype,"The input dtype to avgPool must be float32");var d=t,m=!1;3===t.rank&&(m=!0,d=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),c.assert(4===d.rank,"Error in avgPool: x must be rank 4 but got rank "+d.rank+"."),null!=h&&c.assert(c.isInt(o),"Error in avgPool: pad must be an integer when using, dimRoundingMode "+h+" but got pad "+o+".");var y=f.computePool2DInfo(d.shape,n,r,o),v=l.ENV.engine.runKernel((function(e){return e.avgPool(d,y)}),{x:d},(function(t){return{x:function(){return e.avgPoolBackprop(t,d,n,r,o)}}}));return v=v.cast(t.dtype),m?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v},e.avgPoolBackprop=function(e,input,t,n,r){c.assertArgumentsAreTensors({dy:e,input:input},"avgPoolBackprop"),c.assert(input.rank===e.rank,"Rank of input ("+input.rank+") does not match rank of dy ("+e.rank+")");var o=input,h=e,d=!1;3===input.rank&&(d=!0,o=input.as4D(1,input.shape[0],input.shape[1],input.shape[2]),h=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),c.assert(4===h.rank,"Error in avgPoolBackprop: dy must be rank 4 but got rank "+h.rank+"."),c.assert(4===o.rank,"Error in avgPoolBackprop: input must be rank 4 but got rank "+o.rank+".");var m=f.computePool2DInfo(o.shape,t,n,r),y=l.ENV.engine.runKernel((function(e){return e.avgPoolBackprop(h,o,m)}),{dy4D:h,input4D:o});return d?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y},r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"maxPool",null),r([h.operation],e,"maxPoolBackprop",null),r([o.doc({heading:"Operations",subheading:"Convolution"}),h.operation],e,"avgPool",null),r([h.operation],e,"avgPoolBackprop",null),e}();n.PoolOps=d},{"../doc":45,"../environment":47,"../util":153,"./conv_util":110,"./operation":121}],124:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("seedrandom"),o=function(){function e(e,t,n,o,l){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var c=l||Math.random();this.random=r.alea(c.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var o=void 0,l=void 0,s=void 0;do{s=(o=2*this.random()-1)*o+(l=2*this.random()-1)*l}while(s>=1||0===s);var c=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*o*c,n=this.mean+this.stdDev*l*c,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}();n.MPRandGauss=o},{seedrandom:212}],125:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PARALLELIZE_THRESHOLD=30,n.computeOptimalWindowSize=function(e){return e<=n.PARALLELIZE_THRESHOLD?e:function(e,t){for(var i=t;i<e;++i)if(e%i==0)return i;return e}(e,Math.floor(Math.sqrt(e)))}},{}],126:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../globals"),f=e("../util"),h=e("./axis_util"),d=e("./operation"),m=e("./ops"),y=function(){function e(){}return e.logSumExp=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),f.assertArgumentsAreTensors({x:e},"logSumExp");var r=h.parseAxisParam(t,e.shape),o=e.max(r,!0),l=e.sub(o).exp().sum(r).log(),c=o.reshape(l.shape).add(l);if(n){var d=h.expandShapeToKeepDim(c.shape,r);return c.reshape(d)}return c},e.sum=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),f.assertArgumentsAreTensors({x:e},"sum"),"bool"===e.dtype&&(e=e.toInt());var r=h.parseAxisParam(t,e.shape);return c.customGrad((function(e){var t=h.getAxesPermutation(r,e.rank),o=r,c=e;null!=t&&(c=e.transpose(t),o=h.getInnerMostAxes(o.length,e.rank));var f=l.ENV.engine.runKernel((function(e){return e.sum(c,o)}),{permutedX:c});if(n){var d=h.expandShapeToKeepDim(f.shape,r);f=f.reshape(d)}return{value:f,gradFunc:function(t){var n=e.shape.slice();return r.forEach((function(e){n[e]=1})),t.reshape(n).mul(m.ones(e.shape,"float32"))}}}))(e)},e.mean=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),f.assertArgumentsAreTensors({x:e},"mean");var r=h.parseAxisParam(t,e.shape),o=h.computeOutAndReduceShapes(e.shape,r)[1],l=f.sizeFromShape(o);return c.customGrad((function(e){var o=m.scalar(l);return{value:(o.dtype===e.dtype?e:e.cast(o.dtype)).div(o).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return r.forEach((function(e){n[e]=1})),t.reshape(n).mul(m.ones(e.shape,"float32")).div(o)}}}))(e)},e.min=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),f.assertArgumentsAreTensors({x:e},"min");var r=h.parseAxisParam(t,e.shape),o=r,c=h.getAxesPermutation(o,e.rank);null!=c&&(e=e.transpose(c),o=h.getInnerMostAxes(o.length,e.rank));var d=l.ENV.engine.runKernel((function(t){return t.min(e,o)}),{x:e});if(n){var m=h.expandShapeToKeepDim(d.shape,r);return d.reshape(m)}return d},e.max=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),f.assertArgumentsAreTensors({x:e},"max");var r=h.parseAxisParam(t,e.shape),o=r,c=h.getAxesPermutation(o,e.rank);null!=c&&(e=e.transpose(c),o=h.getInnerMostAxes(o.length,e.rank));var d=l.ENV.engine.runKernel((function(t){return t.max(e,o)}),{x:e});if(n){var m=h.expandShapeToKeepDim(d.shape,r);return d.reshape(m)}return d},e.argMin=function(e,t){void 0===t&&(t=0),f.assertArgumentsAreTensors({x:e},"argMin"),null==t&&(t=0);var n=h.parseAxisParam(t,e.shape),r=h.getAxesPermutation(n,e.rank);return null!=r&&(e=e.transpose(r),n=h.getInnerMostAxes(n.length,e.rank)),l.ENV.engine.runKernel((function(t){return t.argMin(e,n[0])}),{x:e})},e.argMax=function(e,t){void 0===t&&(t=0),f.assertArgumentsAreTensors({x:e},"argMax"),null==t&&(t=0);var n=h.parseAxisParam(t,e.shape),r=h.getAxesPermutation(n,e.rank);return null!=r&&(e=e.transpose(r),n=h.getInnerMostAxes(n.length,e.rank)),l.ENV.engine.runKernel((function(t){return t.argMax(e,n[0])}),{x:e})},e.moments=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),f.assertArgumentsAreTensors({x:e},"moments");var r=h.parseAxisParam(t,e.shape),o=e.mean(r,n),l=o.shape;n||(l=h.expandShapeToKeepDim(o.shape,r));var c=e.toFloat().sub(o.reshape(l)).square();return{mean:o,variance:c.mean(r,n)}},e.unsortedSegmentSum=function(e,t,n,r){void 0===r&&(r=0),f.assertArgumentsAreTensors({x:e,segmentIds:t},"unsortedSegmentSum"),f.assert("int32"===t.dtype,"Segment Ids must be of dtype `int32`"),r=h.parseAxisParam(r,e.shape)[0];for(var o=[],l=t.shape[0],c=[],i=0;i<e.shape.length;i++)i===r?c.push(l):c.push(1);var d=m.reshape(t,c);for(i=0;i<n;i++){var y=m.scalar(i,"int32"),v=m.equal(y,d).asType("float32").mul(e).sum(r);o.push(v)}return m.stack(o,r)},r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"logSumExp",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"sum",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"mean",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"min",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"max",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"argMin",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"argMax",null),r([o.doc({heading:"Operations",subheading:"Normalization"}),d.operation],e,"moments",null),r([o.doc({heading:"Operations",subheading:"Reduction"}),d.operation],e,"unsortedSegmentSum",null),e}();n.ReductionOps=y},{"../doc":45,"../environment":47,"../globals":48,"../util":153,"./axis_util":102,"./operation":121,"./ops":122}],127:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./axis_util"),h=e("./operation"),d=function(){function e(){}return e.reverse1d=function(t){return c.assert(1===t.rank,"Error in reverse1D: x must be rank 1 but got\n             rank "+t.rank+"."),e.reverse(t,0)},e.reverse2d=function(t,n){return c.assert(2===t.rank,"Error in reverse2D: x must be rank 2 but got\n             rank "+t.rank+"."),e.reverse(t,n)},e.reverse3d=function(t,n){return c.assert(3===t.rank,"Error in reverse3D: x must be rank 3 but got\n             rank "+t.rank+"."),e.reverse(t,n)},e.reverse4d=function(t,n){return c.assert(4===t.rank,"Error in reverse4D: x must be rank 4 but got\n             rank "+t.rank+"."),e.reverse(t,n)},e.reverse=function(e,t){if(c.assertArgumentsAreTensors({x:e},"reverse"),0===e.rank)return e.clone();var n=f.parseAxisParam(t,e.shape);return l.ENV.engine.runKernel((function(t){return t.reverse(e,n)}),{x:e},(function(e){return{x:function(){return e.reverse(n)}}})).reshapeAs(e)},r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),h.operation],e,"reverse",null),e}();n.ReverseOps=d},{"../doc":45,"../environment":47,"../util":153,"./axis_util":102,"./operation":121}],128:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SELU_SCALEALPHA=1.7580993408473768,n.SELU_SCALE=1.0507009873554805},{}],129:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./operation"),h=e("./slice_util"),d=function(){function e(){}return e.slice1d=function(t,n,r){return c.assert(1===t.rank,"slice1d expects a rank-1 tensor, but got a rank-"+t.rank+" tensor"),e.slice(t,[n],[r])},e.slice2d=function(t,n,r){return c.assert(2===t.rank,"slice1d expects a rank-2 tensor, but got a rank-"+t.rank+" tensor"),e.slice(t,n,r)},e.slice3d=function(t,n,r){return c.assert(3===t.rank,"slice1d expects a rank-3 tensor, but got a rank-"+t.rank+" tensor"),e.slice(t,n,r)},e.slice4d=function(t,n,r){return c.assert(4===t.rank,"slice1d expects a rank-4 tensor, but got a rank-"+t.rank+" tensor"),e.slice(t,n,r)},e.slice=function(e,t,n){if(c.assertArgumentsAreTensors({x:e},"slice"),0===e.rank)throw new Error("Slicing scalar is not possible");var r,o;r="number"==typeof t?[t].concat(new Array(e.rank-1).fill(0)):t.length<e.rank?t.concat(new Array(e.rank-t.length).fill(0)):t,o=(o=null==n?new Array(e.rank).fill(-1):"number"==typeof n?[n].concat(new Array(e.rank-1).fill(-1)):n.length<e.rank?n.concat(new Array(e.rank-n.length).fill(-1)):n).map((function(t,i){return t>=0?t:(c.assert(-1===t,"Bad value in size"),e.shape[i]-r[i])})),h.assertParamsValid(e,r,o);var f=e.shape;return l.ENV.engine.runKernel((function(t){return t.slice(e,r,o)}),{x:e},(function(e){for(var t=[],i=0;i<e.rank;i++)t.push([r[i],f[i]-r[i]-o[i]]);return{x:function(){return e.pad(t)}}}))},r([o.doc({heading:"Tensors",subheading:"Slicing and Joining"}),f.operation],e,"slice",null),e}();n.SliceOps=d},{"../doc":45,"../environment":47,"../util":153,"./operation":121,"./slice_util":130}],130:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../util");function o(e,t,n,o,l){var c=t[l];e&1<<l&&(c=n[l]>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var f=o[l];return c<0&&(c+=f),c=r.clamp(0,c,f-1)}function l(e,t,n,o,l){var c=t[l];e&1<<l&&(c=n[l]>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var f=o[l];return c<0&&(c+=f),c=n[l]>0?r.clamp(0,c,f):r.clamp(-1,c,f-1)}n.assertParamsValid=function(input,e,t){r.assert(input.rank===e.length,"Error in slice"+input.rank+"D: Length of begin "+e+" must match the rank of the array ("+input.rank+")."),r.assert(input.rank===t.length,"Error in slice"+input.rank+"D: Length of size "+t+" must match the rank of the array ("+input.rank+").");for(var i=0;i<input.rank;++i)r.assert(e[i]+t[i]<=input.shape[i],"Error in slice"+input.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+t[i])+") would overflow input.shape["+i+"] ("+input.shape[i]+")")},n.getStridedSlicedInfo=function(e,t,n,r,c,f){void 0===c&&(c=0),void 0===f&&(f=0);for(var h=[],d=[],i=0;i<e.length;i++)h[i]=o(c,t,r,e,i),d[i]=l(f,n,r,e,i);var m=new Array(e.length).fill(0);return m=m.map((function(e,i){for(var t=0,n=h[i];!(r[i]>0?n>=d[i]:n<=d[i]);n+=r[i])t+=1;return t})),[h,m]},n.startForAxis=o,n.stopForAxis=l},{"../util":153}],131:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../globals"),c=e("../util"),f=e("./axis_util"),h=e("./operation"),d=e("./ops"),m=function(){function e(){}return e.softmax=function(e,t){if(void 0===t&&(t=-1),c.assertArgumentsAreTensors({logits:e},"softmax"),-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return l.customGrad((function(e){var n=e.logSumExp([t],!0),r=e.toFloat().sub(n).exp();return{value:r,gradFunc:function(e){var n=e.mul(r);return n.sub(n.sum([t],!0).mul(r))}}}))(e)},e.softmaxCrossEntropy=function(e,t,n){if(void 0===n&&(n=-1),c.assertArgumentsAreTensors({labels:e,logits:t},"softmaxCrossEntropy"),c.assertShapesMatch(e.shape,t.shape,"Error in softmaxCrossEntropy: "),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return l.customGrad((function(e,t){var r=t.softmax(n);return{value:d.scalar(1e-5).add(r).log().mul(e).neg().sum([n]),gradFunc:function(t){var o=f.expandShapeToKeepDim(t.shape,[n]);return[t.reshape(o).mul(e.toFloat().sub(r)),t.reshape(o).mul(r.sub(e.toFloat()))]}}}))(e,t)},r([o.doc({heading:"Operations",subheading:"Normalization"}),h.operation],e,"softmax",null),r([o.doc({heading:"Training",subheading:"Losses",namespace:"losses"}),h.operation],e,"softmaxCrossEntropy",null),e}();n.SoftmaxOps=m},{"../doc":45,"../globals":48,"../util":153,"./axis_util":102,"./operation":121,"./ops":122}],132:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./operation"),h=function(){function e(){}return e.stridedSlice=function(e,t,n,r,o,f){return void 0===o&&(o=0),void 0===f&&(f=0),c.assertArgumentsAreTensors({x:e},"stridedSlice"),l.ENV.engine.runKernel((function(l){return l.stridedSlice(e,t,n,r,o,f)}),{x:e})},r([o.doc({heading:"Operations",subheading:"Slicing and Joining"}),f.operation],e,"stridedSlice",null),e}();n.StridedSliceOps=h},{"../doc":45,"../environment":47,"../util":153,"./operation":121}],133:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./axis_util"),h=e("./operation"),d=function(){function e(){}return e.transpose=function(e,t){return c.assertArgumentsAreTensors({x:e},"transpose"),null==t&&(t=e.shape.map((function(s,i){return i})).reverse()),c.assert(e.rank===t.length,"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."),t.forEach((function(n){c.assert(n>=0&&n<e.rank,"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t)})),e.rank<=1?e.clone():l.ENV.engine.runKernel((function(n){return n.transpose(e,t)}),{x:e},(function(e){var n=f.getUndoAxesPermutation(t);return{x:function(){return e.transpose(n)}}}))},r([o.doc({heading:"Operations",subheading:"Matrices"}),h.operation],e,"transpose",null),e}();n.TransposeOps=d},{"../doc":45,"../environment":47,"../util":153,"./axis_util":102,"./operation":121}],134:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("../environment"),c=e("../util"),f=e("./operation"),h=e("./ops"),d=e("./ops"),m=e("./selu_util"),y=function(){function e(){}return e.neg=function(e){return c.assertArgumentsAreTensors({x:e},"neg"),l.ENV.engine.runKernel((function(t){return t.neg(e)}),{x:e},(function(e){return{x:function(){return e.neg()}}}))},e.ceil=function(e){return c.assertArgumentsAreTensors({x:e},"ceil"),l.ENV.engine.runKernel((function(t){return t.ceil(e)}),{x:e},(function(e){return{x:function(){return h.zerosLike(e)}}}))},e.floor=function(e){return c.assertArgumentsAreTensors({x:e},"floor"),l.ENV.engine.runKernel((function(t){return t.floor(e)}),{x:e},(function(e){return{x:function(){return h.zerosLike(e)}}}))},e.sign=function(e){return c.assertArgumentsAreTensors({x:e},"sign"),l.ENV.engine.runKernel((function(t){return t.sign(e)}),{x:e},(function(e){return{x:function(){return h.zerosLike(e)}}}))},e.round=function(e){return c.assertArgumentsAreTensors({x:e},"round"),l.ENV.engine.runKernel((function(t){return t.round(e)}),{x:e},(function(e){return{x:function(){return h.zerosLike(e)}}}))},e.exp=function(e){return c.assertArgumentsAreTensors({x:e},"exp"),l.ENV.engine.runKernel((function(t,n){return n(t.exp(e))}),{x:e},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n)}}}))},e.expm1=function(e){return c.assertArgumentsAreTensors({x:e},"expm1"),l.ENV.engine.runKernel((function(t){return t.expm1(e)}),{x:e},(function(t){return{x:function(){return t.mulStrict(e.exp())}}}))},e.log=function(e){return c.assertArgumentsAreTensors({x:e},"log"),l.ENV.engine.runKernel((function(t){return t.log(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(e.toFloat())}}}))},e.log1p=function(e){return c.assertArgumentsAreTensors({x:e},"log1p"),l.ENV.engine.runKernel((function(t){return t.log1p(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(e.add(h.scalar(1)))}}}))},e.sqrt=function(e){return c.assertArgumentsAreTensors({x:e},"sqrt"),l.ENV.engine.runKernel((function(t){return t.sqrt(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(e.toFloat().sqrt().mul(h.scalar(2)))}}}))},e.rsqrt=function(e){return c.assertArgumentsAreTensors({x:e},"rsqrt"),l.ENV.engine.runKernel((function(t){return t.rsqrt(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(e.pow(h.scalar(1.5)).mul(h.scalar(2))).neg()}}}))},e.square=function(e){return c.assertArgumentsAreTensors({x:e},"square"),l.ENV.engine.runKernel((function(t){return t.square(e)}),{x:e},(function(t){return{x:function(){return t.mulStrict(e.toFloat().mul(h.scalar(2)))}}}))},e.reciprocal=function(e){return c.assertArgumentsAreTensors({x:e},"reciprocal"),l.ENV.engine.runKernel((function(t){return t.reciprocal(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(e.square().neg())}}}))},e.abs=function(e){return c.assertArgumentsAreTensors({x:e},"abs"),l.ENV.engine.runKernel((function(t){return t.abs(e)}),{x:e},(function(t){return{x:function(){return t.mulStrict(e.toFloat().step(-1))}}}))},e.clipByValue=function(e,t,n){return c.assertArgumentsAreTensors({x:e},"clipByValue"),c.assert(t<=n,"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."),l.ENV.engine.runKernel((function(r){return r.clip(e,t,n)}),{x:e},(function(r){return{x:function(){return r.where(e.greater(h.scalar(t)).logicalAnd(e.less(h.scalar(n))),d.zerosLike(r))}}}))},e.relu=function(e){return c.assertArgumentsAreTensors({x:e},"relu"),"bool"===e.dtype?e.toInt():l.ENV.engine.runKernel((function(t){return t.relu(e)}),{x:e},(function(t){var n=e.step();return{x:function(){return t.mulStrict(n.toFloat())}}}))},e.elu=function(e){return c.assertArgumentsAreTensors({x:e},"elu"),l.ENV.engine.runKernel((function(t,n){return n(t.elu(e))}),{x:e},(function(e,t){var n=t[0];return{x:function(){return l.ENV.engine.runKernel((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))},e.selu=function(e){return c.assertArgumentsAreTensors({x:e},"selu"),l.ENV.engine.runKernel((function(t){return t.selu(e)}),{x:e},(function(t){return{x:function(){var mask=e.greater(h.scalar(0)),n=h.scalar(m.SELU_SCALEALPHA),r=h.scalar(m.SELU_SCALE),o=t.mul(r),l=t.mul(n).mul(e.toFloat().exp());return h.where(mask,o,l)}}}))},e.leakyRelu=function(e,t){return void 0===t&&(t=.2),c.assertArgumentsAreTensors({x:e},"leakyRelu"),h.maximum(h.scalar(t).mul(e),e)},e.prelu=function(e,t){c.assertArgumentsAreTensors({x:e,alpha:t},"prelu");var n=h.scalar(0);return h.maximum(n,e).add(t.mul(h.minimum(n,e)))},e.sigmoid=function(e){return c.assertArgumentsAreTensors({x:e},"sigmoid"),l.ENV.engine.runKernel((function(t,n){return n(t.sigmoid(e))}),{x:e},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.mul(h.scalar(1).sub(n)))}}}))},e.logSigmoid=function(e){return c.assertArgumentsAreTensors({x:e},"logSigmoid"),l.ENV.engine.runKernel((function(t){return t.softplus(e.neg()).neg()}),{x:e},(function(t){return{x:function(){return t.mulStrict(e.neg().sigmoid())}}}))},e.softplus=function(e){return c.assertArgumentsAreTensors({x:e},"softplus"),l.ENV.engine.runKernel((function(t){return t.softplus(e)}),{x:e},(function(t){return{x:function(){return t.mulStrict(e.sigmoid())}}}))},e.sin=function(e){return c.assertArgumentsAreTensors({x:e},"sin"),l.ENV.engine.runKernel((function(t){return t.sin(e)}),{x:e},(function(t){return{x:function(){return e.toFloat().cos().mulStrict(t)}}}))},e.cos=function(e){return c.assertArgumentsAreTensors({x:e},"cos"),l.ENV.engine.runKernel((function(t){return t.cos(e)}),{x:e},(function(t){return{x:function(){return e.toFloat().sin().neg().mulStrict(t)}}}))},e.tan=function(e){return c.assertArgumentsAreTensors({x:e},"tan"),l.ENV.engine.runKernel((function(t){return t.tan(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(e.cos().square())}}}))},e.asin=function(t){return c.assertArgumentsAreTensors({x:t},"asin"),l.ENV.engine.runKernel((function(e){return e.asin(t)}),{x:t},(function(n){return{x:function(){return n.divStrict(e.sqrt(h.scalar(1).sub(t.toFloat().square())))}}}))},e.acos=function(t){return c.assertArgumentsAreTensors({x:t},"acos"),l.ENV.engine.runKernel((function(e){return e.acos(t)}),{x:t},(function(n){return{x:function(){return n.divStrict(e.sqrt(h.scalar(1).sub(t.toFloat().square()))).neg()}}}))},e.atan=function(e){return c.assertArgumentsAreTensors({x:e},"atan"),l.ENV.engine.runKernel((function(t){return t.atan(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(h.scalar(1).add(e.toFloat().square()))}}}))},e.sinh=function(e){return c.assertArgumentsAreTensors({x:e},"sinh"),l.ENV.engine.runKernel((function(t){return t.sinh(e)}),{x:e},(function(t){return{x:function(){return e.toFloat().cosh().mulStrict(t)}}}))},e.cosh=function(e){return c.assertArgumentsAreTensors({x:e},"cosh"),l.ENV.engine.runKernel((function(t){return t.cosh(e)}),{x:e},(function(t){return{x:function(){return e.toFloat().sinh().mulStrict(t)}}}))},e.tanh=function(e){return c.assertArgumentsAreTensors({x:e},"tanh"),l.ENV.engine.runKernel((function(t,n){return n(t.tanh(e))}),{x:e},(function(e,t){var n=t[0];return{x:function(){return h.scalar(1).sub(n.square()).mulStrict(e)}}}))},e.asinh=function(t){return c.assertArgumentsAreTensors({x:t},"asinh"),l.ENV.engine.runKernel((function(e){return e.asinh(t)}),{x:t},(function(n){return{x:function(){return n.divStrict(e.sqrt(h.scalar(1).add(t.toFloat().square())))}}}))},e.acosh=function(t){return c.assertArgumentsAreTensors({x:t},"acosh"),l.ENV.engine.runKernel((function(e){return e.acosh(t)}),{x:t},(function(n){return{x:function(){return n.divStrict(e.sqrt(t.toFloat().square().sub(h.scalar(1))))}}}))},e.atanh=function(e){return c.assertArgumentsAreTensors({x:e},"atanh"),l.ENV.engine.runKernel((function(t){return t.atanh(e)}),{x:e},(function(t){return{x:function(){return t.divStrict(h.scalar(1).sub(e.toFloat().square()))}}}))},e.erf=function(e){return c.assert("int32"===e.dtype||"float32"===e.dtype,"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=e.toFloat()),l.ENV.engine.runKernel((function(t){return t.erf(e)}),{x:e},(function(t){return{x:function(){return t.mulStrict(h.scalar(2/Math.sqrt(Math.PI)).mul(e.square().neg().exp()))}}}))},e.step=function(e,t){return void 0===t&&(t=0),c.assertArgumentsAreTensors({x:e},"step"),l.ENV.engine.runKernel((function(n){return n.step(e,t)}),{x:e},(function(e){return{x:function(){return h.zerosLike(e)}}}))},r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"neg",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"ceil",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"floor",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"sign",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"round",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"exp",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"expm1",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"log",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"log1p",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"sqrt",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"rsqrt",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"square",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"reciprocal",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"abs",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"clipByValue",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"relu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"elu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"selu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"leakyRelu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"prelu",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"sigmoid",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"logSigmoid",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"softplus",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"sin",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"cos",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"tan",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"asin",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"acos",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"atan",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"sinh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"cosh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"tanh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"asinh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"acosh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"atanh",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"erf",null),r([o.doc({heading:"Operations",subheading:"Basic math"}),f.operation],e,"step",null),e}();n.UnaryOps=y},{"../doc":45,"../environment":47,"../util":153,"./operation":121,"./ops":122,"./selu_util":128}],135:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t,n,r){void 0===r&&(r=1e-8);var o=e.call(this)||this;return o.learningRate=t,o.rho=n,o.epsilon=r,o.accumulatedGrads={},o.accumulatedUpdates={},o.c=c.keep(f.scalar(-t)),o.epsilonScalar=c.keep(f.scalar(r)),o.rhoScalar=c.keep(f.scalar(n)),o.oneMinusRho=c.keep(f.scalar(1-n)),o}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=l.ENV.engine.registeredVariables[n];null==r.accumulatedGrads[n]&&c.tidy((function(){t.accumulatedGrads[n]=f.zerosLike(o).variable(!1)})),null==r.accumulatedUpdates[n]&&c.tidy((function(){t.accumulatedUpdates[n]=f.zerosLike(o).variable(!1)}));var h=e[n],d=r.accumulatedGrads[n],m=r.accumulatedUpdates[n];c.tidy((function(){var e=t.rhoScalar.mul(d).add(t.oneMinusRho.mul(h.square())),r=m.add(t.epsilonScalar).sqrt().div(d.add(t.epsilonScalar).sqrt()).mul(h),l=t.rhoScalar.mul(m).add(t.oneMinusRho.mul(r.square()));t.accumulatedGrads[n].assign(e),t.accumulatedUpdates[n].assign(l);var c=t.c.mul(r).add(o);o.assign(c)}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilonScalar.dispose(),this.rhoScalar.dispose(),this.oneMinusRho.dispose(),null!=this.accumulatedUpdates&&(Object.keys(this.accumulatedUpdates).forEach((function(t){return e.accumulatedUpdates[t].dispose()})),Object.keys(this.accumulatedGrads).forEach((function(t){return e.accumulatedGrads[t].dispose()})))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="AdadeltaOptimizer",t}(e("./optimizer").Optimizer);n.AdadeltaOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./optimizer":140}],136:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads={},r.c=c.keep(f.scalar(-t)),r.epsilon=c.keep(f.scalar(1e-8)),r}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=l.ENV.engine.registeredVariables[n];null==r.accumulatedGrads[n]&&c.tidy((function(){t.accumulatedGrads[n]=f.fill(o.shape,t.initialAccumulatorValue).variable(!1)}));var h=e[n],d=r.accumulatedGrads[n];c.tidy((function(){var e=d.add(h.square());t.accumulatedGrads[n].assign(e);var r=t.c.mul(h.div(e.add(t.epsilon).sqrt())).add(o);o.assign(r)}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){var e=this;this.epsilon.dispose(),this.c.dispose(),null!=this.accumulatedGrads&&Object.keys(this.accumulatedGrads).forEach((function(t){return e.accumulatedGrads[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="AdagradOptimizer",t}(e("./optimizer").Optimizer);n.AdagradOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./optimizer":140}],137:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t,n,r,o){void 0===o&&(o=1e-8);var l=e.call(this)||this;return l.learningRate=t,l.beta1=n,l.beta2=r,l.epsilon=o,l.accumulatedFirstMoment={},l.accumulatedSecondMoment={},l.c=c.keep(f.scalar(-t)),l.epsScalar=c.keep(f.scalar(o)),l.beta1Scalar=c.keep(f.scalar(n)),l.beta2Scalar=c.keep(f.scalar(r)),c.tidy((function(){l.accBeta1=f.scalar(n).variable(),l.accBeta2=f.scalar(r).variable()})),l.oneMinusBeta1=c.keep(f.scalar(1-n)),l.oneMinusBeta2=c.keep(f.scalar(1-r)),l.one=c.keep(f.scalar(1)),l}return o(t,e),t.prototype.applyGradients=function(e){var t=this;c.tidy((function(){var n=t.one.sub(t.accBeta1),r=t.one.sub(t.accBeta2);for(var o in e){var c=l.ENV.engine.registeredVariables[o];if(null==t.accumulatedFirstMoment[o]){var h=!1;t.accumulatedFirstMoment[o]=f.zerosLike(c).variable(h)}null==t.accumulatedSecondMoment[o]&&(h=!1,t.accumulatedSecondMoment[o]=f.zerosLike(c).variable(h));var d=e[o],m=t.accumulatedFirstMoment[o],y=t.accumulatedSecondMoment[o],v=t.beta1Scalar.mul(m).add(t.oneMinusBeta1.mul(d)),w=t.beta2Scalar.mul(y).add(t.oneMinusBeta2.mul(d.square())),x=v.div(n),_=w.div(r);t.accumulatedFirstMoment[o].assign(v),t.accumulatedSecondMoment[o].assign(w);var N=t.c.mul(x.div(t.epsScalar.add(_.sqrt()))).add(c);c.assign(N)}t.accBeta1.assign(t.accBeta1.mul(t.beta1Scalar)),t.accBeta2.assign(t.accBeta2.mul(t.beta2Scalar))}))},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsScalar.dispose(),this.beta1Scalar.dispose(),this.beta2Scalar.dispose(),this.accBeta1.dispose(),this.accBeta2.dispose(),this.oneMinusBeta1.dispose(),this.oneMinusBeta2.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach((function(t){return e.accumulatedFirstMoment[t].dispose()})),null!=this.accumulatedSecondMoment&&Object.keys(this.accumulatedSecondMoment).forEach((function(t){return e.accumulatedSecondMoment[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="AdamOptimizer",t}(e("./optimizer").Optimizer);n.AdamOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./optimizer":140}],138:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t,n,r,o,l){void 0===o&&(o=1e-8),void 0===l&&(l=0);var h=e.call(this)||this;return h.learningRate=t,h.beta1=n,h.beta2=r,h.epsilon=o,h.decay=l,h.accumulatedFirstMoment={},h.accumulatedWeightedInfNorm={},h.c=c.keep(f.scalar(-t)),h.epsScalar=c.keep(f.scalar(o)),h.beta1Scalar=c.keep(f.scalar(n)),h.beta2Scalar=c.keep(f.scalar(r)),h.decayScalar=c.keep(f.scalar(l)),c.tidy((function(){h.iteration=f.scalar(0).variable(),h.accBeta1=f.scalar(n).variable()})),h.oneMinusBeta1=c.keep(f.scalar(1-n)),h.one=c.keep(f.scalar(1)),h}return o(t,e),t.prototype.applyGradients=function(e){var t=this;c.tidy((function(){var n=t.one.sub(t.accBeta1),r=t.c.div(t.one.add(t.decayScalar.mul(t.iteration)));for(var o in e){var c=l.ENV.engine.registeredVariables[o];if(null==t.accumulatedFirstMoment[o]){var h=!1;t.accumulatedFirstMoment[o]=f.zerosLike(c).variable(h)}null==t.accumulatedWeightedInfNorm[o]&&(h=!1,t.accumulatedWeightedInfNorm[o]=f.zerosLike(c).variable(h));var d=e[o],m=t.accumulatedFirstMoment[o],y=t.accumulatedWeightedInfNorm[o],v=t.beta1Scalar.mul(m).add(t.oneMinusBeta1.mul(d)),w=t.beta2Scalar.mul(y),x=d.abs(),_=w.maximum(x);t.accumulatedFirstMoment[o].assign(v),t.accumulatedWeightedInfNorm[o].assign(_);var N=r.div(n).mul(v.div(t.epsScalar.add(_))).add(c);c.assign(N)}t.iteration.assign(t.iteration.add(t.one)),t.accBeta1.assign(t.accBeta1.mul(t.beta1Scalar))}))},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsScalar.dispose(),this.accBeta1.dispose(),this.beta1Scalar.dispose(),this.beta2Scalar.dispose(),this.oneMinusBeta1.dispose(),this.decayScalar.dispose(),this.iteration.dispose(),this.one.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach((function(t){return e.accumulatedFirstMoment[t].dispose()})),null!=this.accumulatedWeightedInfNorm&&Object.keys(this.accumulatedWeightedInfNorm).forEach((function(t){return e.accumulatedWeightedInfNorm[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="AdamaxOptimizer",t}(e("./optimizer").Optimizer);n.AdamaxOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./optimizer":140}],139:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.learningRate=t,o.momentum=n,o.useNesterov=r,o.m=f.scalar(o.momentum),o.accumulations={},o}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=l.ENV.engine.registeredVariables[n];null==r.accumulations[n]&&c.tidy((function(){t.accumulations[n]=f.zerosLike(o).variable(!1)}));var h=r.accumulations[n],d=e[n];c.tidy((function(){var e,r=t.m.mul(h).add(d);e=t.useNesterov?t.c.mul(d.add(r.mul(t.m))).add(o):t.c.mul(r).add(o),t.accumulations[n].assign(r),o.assign(e)}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){if(e.prototype.dispose.call(this),this.m.dispose(),null!=this.accumulations)for(var t in this.accumulations)this.accumulations[t].dispose()},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="MomentumOptimizer",t}(e("./sgd_optimizer").SGDOptimizer);n.MomentumOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./sgd_optimizer":143}],140:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../doc"),f=e("../globals"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),o=r.value,l=r.grads;return this.applyGradients(l),Object.keys(l).forEach((function(e){return l[e].dispose()})),t?o:(o.dispose(),null)},t.prototype.computeGradients=function(e,t){return f.variableGrads(e,t)},l([c.doc({heading:"Training",subheading:"Optimizers"})],t.prototype,"minimize",null),t=l([c.doc({heading:"Training",subheading:"Classes",namespace:"train"})],t)}(e("../serialization").Serializable);n.Optimizer=h},{"../doc":45,"../globals":48,"../serialization":145}],141:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../doc"),l=e("./adadelta_optimizer"),c=e("./adagrad_optimizer"),f=e("./adam_optimizer"),h=e("./adamax_optimizer"),d=e("./momentum_optimizer"),m=e("./rmsprop_optimizer"),y=e("./sgd_optimizer"),v=function(){function e(){}return e.sgd=function(e){return new y.SGDOptimizer(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new d.MomentumOptimizer(e,t,n)},e.rmsprop=function(e,t,n,r,o){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=1e-8),void 0===o&&(o=!1),new m.RMSPropOptimizer(e,t,n,r,o)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=1e-8),new f.AdamOptimizer(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=1e-8),new l.AdadeltaOptimizer(e,t,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=1e-8),void 0===o&&(o=0),new h.AdamaxOptimizer(e,t,n,r,o)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new c.AdagradOptimizer(e,t)},r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"sgd",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"momentum",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"rmsprop",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adam",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adadelta",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adamax",null),r([o.doc({heading:"Training",subheading:"Optimizers",namespace:"train"})],e,"adagrad",null),e}();n.OptimizerConstructors=v},{"../doc":45,"./adadelta_optimizer":135,"./adagrad_optimizer":136,"./adam_optimizer":137,"./adamax_optimizer":138,"./momentum_optimizer":139,"./rmsprop_optimizer":142,"./sgd_optimizer":143}],142:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t,n,r,o,l){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=1e-8),void 0===l&&(l=!1);var h=e.call(this)||this;return h.learningRate=t,h.decay=n,h.momentum=r,h.epsilon=o,h.accumulatedMeanSquares={},h.accumulatedMeanGrads={},h.accumulatedMoments={},h.c=c.keep(f.scalar(t)),h.epsilonScalar=c.keep(f.scalar(o)),h.decayScalar=c.keep(f.scalar(n)),h.momentumScalar=c.keep(f.scalar(r)),h.oneMinusDecay=c.keep(f.scalar(1-n)),h.centered=l,h}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var o=l.ENV.engine.registeredVariables[n];null==r.accumulatedMeanSquares[n]&&c.tidy((function(){t.accumulatedMeanSquares[n]=f.zerosLike(o).variable(!1)})),null==r.accumulatedMeanGrads[n]&&r.centered&&c.tidy((function(){t.accumulatedMeanGrads[n]=f.zerosLike(o).variable(!1)})),null==r.accumulatedMoments[n]&&c.tidy((function(){t.accumulatedMoments[n]=f.zerosLike(o).variable(!1)}));var h=r.accumulatedMeanSquares[n],d=r.accumulatedMeanGrads[n],m=r.accumulatedMoments[n],y=e[n];c.tidy((function(){var e=t.decayScalar.mul(h).add(t.oneMinusDecay.mul(y.square()));if(t.centered){var r=t.decayScalar.mul(d).add(t.oneMinusDecay.mul(y)),l=t.momentumScalar.mul(m).add(t.c.mul(y).div(e.sub(r.square().add(t.epsilonScalar)).sqrt()));t.accumulatedMeanSquares[n].assign(e),t.accumulatedMeanGrads[n].assign(r),t.accumulatedMoments[n].assign(l);var c=o.sub(l);o.assign(c)}else{var f=t.decayScalar.mul(h).add(t.oneMinusDecay.mul(y.square()));l=t.momentumScalar.mul(m).add(t.c.mul(y).div(f.add(t.epsilonScalar).sqrt())),t.accumulatedMeanSquares[n].assign(f),t.accumulatedMoments[n].assign(l),c=o.sub(l),o.assign(c)}}))},r=this;for(var o in e)n(o)},t.prototype.dispose=function(){var e=this;this.c.dispose(),this.epsilonScalar.dispose(),this.decayScalar.dispose(),this.momentumScalar.dispose(),this.oneMinusDecay.dispose(),null!=this.accumulatedMeanSquares&&Object.keys(this.accumulatedMeanSquares).forEach((function(t){return e.accumulatedMeanSquares[t].dispose()})),null!=this.accumulatedMeanGrads&&this.centered&&Object.keys(this.accumulatedMeanGrads).forEach((function(t){return e.accumulatedMeanGrads[t].dispose()})),null!=this.accumulatedMoments&&Object.keys(this.accumulatedMoments).forEach((function(t){return e.accumulatedMoments[t].dispose()}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSPropOptimizer",t}(e("./optimizer").Optimizer);n.RMSPropOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./optimizer":140}],143:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("../environment"),c=e("../globals"),f=e("../ops/ops"),h=e("../serialization"),d=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return o(t,e),t.prototype.applyGradients=function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],o=l.ENV.engine.registeredVariables[n];c.tidy((function(){var e=t.c.mul(r).add(o);o.assign(e)}))}))},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=c.keep(f.scalar(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGDOptimizer",t}(e("./optimizer").Optimizer);n.SGDOptimizer=d,h.SerializationMap.register(d)},{"../environment":47,"../globals":48,"../ops/ops":122,"../serialization":145,"./optimizer":140}],144:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),o=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new l)}return e.prototype.profileKernel=function(e,t){var n,o=this,l=this.backendTimer.time((function(){n=t()})),c=n.dataSync();return r.checkForNaN(c,n.dtype,e),l.then((function(t){o.logger.logKernelProfile(e,n,c,t.kernelMs)})),n},e}();n.Profiler=o;var l=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,o){var time=r.rightPad(o+"ms",9),l=r.rightPad(e,25),c=t.rank,f=t.size,h=r.rightPad(t.shape.toString(),14);console.log("%c"+l+"\t%c"+time+"\t%c"+c+"D "+h+"\t%c"+f,"font-weight:bold","color:red","color:blue","color: orange")},e}();n.Logger=l},{"./util":153}],145:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}();n.Serializable=r;var o=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(e){this.getMap().classNameMap[e.className]=[e,e.fromConfig]},e}();n.SerializationMap=o},{}],146:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util");n.getFilteredNodesXToY=function(e,t,n){for(var r={},o={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var l=(w=e[i]).inputs;for(var c in l){for(var input=l[c],f=!1,h=0;h<t.length;h++)if(r[input.id]){r[w.output.id]=!0,f=!0,o[w.id]=!0;break}if(f)break}}var d={};d[n.id]=!0;var m={};for(i=e.length-1;i>=0;i--){l=(w=e[i]).inputs;var y=[];for(y.push(w.output),h=0;h<y.length;h++)if(d[y[h].id]){for(var c in l)d[l[c].id]=!0,m[w.id]=!0;break}}var v=[];for(i=0;i<e.length;i++){var w;if(o[(w=e[i]).id]&&m[w.id]){var x={};for(var c in w.inputs){var _=w.inputs[c];r[_.id]&&(x[c]=_)}var N=Object.assign({},w);N.inputs=x,N.output=w.output,v.push(N)}}return v},n.backpropagateGradients=function(e,t){for(var i=t.length-1;i>=0;i--){var n=t[i],o=e[n.output.id];if(null==n.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+n.name+".");var l=n.gradient(o);for(var c in n.inputs){if(!(c in l))throw new Error("Cannot backprop through input "+c+". Available gradients found: "+Object.keys(l)+".");var f=l[c](),h=n.inputs[c];if(!r.arraysEqual(f.shape,h.shape))throw new Error("Error in gradient for op "+n.name+". The gradient of input '"+c+"' has shape '"+f.shape+"', which does not match the shape of the input '"+h.shape+"'");if(null==e[h.id])e[h.id]=f;else{var d=e[h.id];e[h.id]=d.add(f),d.dispose()}}}}},{"./util":153}],147:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},f=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var h=e("./doc"),d=e("./environment"),m=e("./ops/ops"),y=e("./tensor_util"),v=e("./util"),w=function(){function e(e,t,n){if(this.dtype=t,null!=n){var r=n.length,o=v.sizeFromShape(e);v.assert(r===o,"Length of values '"+r+"' does not match the size inferred by the shape '"+o+"'")}this.shape=e.slice(),this.values=n||v.getTypedArrayFromDType(t,v.sizeFromShape(e)),this.strides=E(e),this.size=v.sizeFromShape(e)}return e.prototype.set=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];0===t.length&&(t=[0]),v.assert(t.length===this.rank,"The number of provided coordinates ("+t.length+") must match the rank ("+this.rank+")");var r=this.locToIndex(t);this.values[r]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=e[e.length-1],i=0;i<e.length-1;++i)n+=this.strides[i]*e[i];return this.values[n]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],i=0;i<e.length-1;++i)t+=this.strides[i]*e[i];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),i=0;i<t.length-1;++i)t[i]=Math.floor(e/this.strides[i]),e-=t[i]*this.strides[i];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return x.make(this.shape,{values:this.values},this.dtype)},l([h.doc({heading:"Tensors",subheading:"Creation"})],e.prototype,"set",null),l([h.doc({heading:"Tensors",subheading:"Creation"})],e.prototype,"get",null),l([h.doc({heading:"Tensors",subheading:"Creation"})],e.prototype,"toTensor",null),e=l([h.doc({heading:"Tensors",subheading:"Classes"})],e)}();n.TensorBuffer=w;var x=function(){function e(e,n,r,o){this.isDisposed=!1,this.size=v.sizeFromShape(e),null!=r&&v.assert(this.size===r.length,"Constructing tensor of shape ("+this.size+") should match the length of values ("+r.length+")"),this.shape=e.slice(),this.dtype=n||"float32",this.strides=E(e),this.dataId=null!=o?o:{},this.id=t.nextId++,this.rankType=this.rank<5?this.rank.toString():"higher",d.ENV.engine.registerTensor(this),null!=r&&d.ENV.engine.write(this.dataId,r)}return t=e,e.make=function(e,data,n){return new t(e,n,data.values,data.dataId)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),v.assert(1===this.size,"The array must have only 1 element."),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.asType=function(e){return this.throwIfDisposed(),m.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v.assert(e.length===this.rank,"Number of coordinates in get() must match the rank of the tensor"),this.throwIfDisposed(),0===e.length&&(e=[0]);for(var n=e[e.length-1],i=0;i<e.length-1;++i)n+=this.strides[i]*e[i];return this.dataSync()[n]},e.prototype.buffer=function(){return m.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.data=function(){return c(this,void 0,void 0,(function(){return f(this,(function(e){return this.throwIfDisposed(),[2,d.ENV.engine.read(this.dataId)]}))}))},e.prototype.dataSync=function(){return this.throwIfDisposed(),d.ENV.engine.readSync(this.dataId)},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,d.ENV.engine.disposeTensor(this))},e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),m.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),m.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),m.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),m.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),m.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),m.clone(this)},e.prototype.toString=function(e){return void 0===e&&(e=!1),y.tensorToString(this,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),m.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),m.gather(this,e,t)},e.prototype.matMul=function(b,e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.throwIfDisposed(),m.matMul(this,b,e,t)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),m.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),m.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),m.reverse(this,e)},e.prototype.concat=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),m.concat([this,e],t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),m.stack([this,e],t)},e.prototype.unstack=function(e,t){return void 0===t&&(t=0),m.unstack(this,t)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),m.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),this.throwIfDisposed(),m.batchNormalization(this,e,t,n,r,o)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),m.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),m.sum(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),m.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),m.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),m.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),m.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),m.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),m.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),m.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),m.addStrict(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),m.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),m.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),m.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),m.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),m.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),m.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),m.div(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),m.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),m.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),m.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),m.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),m.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),m.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),m.modStrict(this,e)},e.prototype.squaredDifference=function(e){return this.throwIfDisposed(),m.squaredDifference(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),m.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),m.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),m.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),m.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),m.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),m.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),m.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),m.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),m.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),m.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),m.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),m.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),m.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),m.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),m.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),m.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),m.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),m.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),m.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),m.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),m.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),m.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),m.sign(this)},e.prototype.exp=function(){return this.throwIfDisposed(),m.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),m.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),m.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),m.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),m.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),m.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),m.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),m.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),m.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),m.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),m.relu(this)},e.prototype.elu=function(){return this.throwIfDisposed(),m.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),m.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),m.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),m.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),m.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),m.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),m.softplus(this)},e.prototype.sin=function(){return this.throwIfDisposed(),m.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),m.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),m.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),m.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),m.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),m.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),m.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),m.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),m.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),m.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),m.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),m.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),m.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),m.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),m.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),m.softmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),m.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),m.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(filter,e,t,n,r,o){return void 0===n&&(n="NWC"),void 0===r&&(r=1),this.throwIfDisposed(),m.conv1d(this,filter,e,t,n,r,o)},e.prototype.conv2d=function(filter,e,t,n,r,o){return void 0===n&&(n="NHWC"),void 0===r&&(r=[1,1]),this.throwIfDisposed(),m.conv2d(this,filter,e,t,n,r,o)},e.prototype.conv2dTranspose=function(filter,e,t,n,r){return this.throwIfDisposed(),m.conv2dTranspose(this,filter,e,t,n,r)},e.prototype.depthwiseConv2D=function(filter,e,t,n,r,o){return void 0===n&&(n="NHWC"),void 0===r&&(r=[1,1]),this.throwIfDisposed(),m.depthwiseConv2d(this,filter,e,t,n,r,o)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),m.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),m.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),m.localResponseNormalization(this,e,t,n,r)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),_.variable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t,n){return void 0===n&&(n=0),this.throwIfDisposed(),m.unsortedSegmentSum(this,e,t,n)},e.nextId=0,l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"flatten",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"asScalar",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as1D",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as2D",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as3D",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"as4D",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"asType",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"buffer",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"data",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"dataSync",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"dispose",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toFloat",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toInt",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toBool",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"print",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"reshape",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"reshapeAs",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"expandDims",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"cumsum",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"squeeze",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"clone",null),l([h.doc({heading:"Tensors",subheading:"Classes"})],e.prototype,"toString",null),e=t=l([h.doc({heading:"Tensors",subheading:"Classes"})],e);var t}();n.Tensor=x;var _=function(e){function t(t,r,o){void 0===r&&(r=!0);var l=e.call(this,t.shape,t.dtype,null,t.dataId)||this;return l.trainable=r,l.name=o,null==l.name&&(l.name=n.nextVarId.toString(),n.nextVarId++),d.ENV.engine.registerVariable(l),l}return o(t,e),n=t,t.variable=function(e,t,r,o){return void 0===t&&(t=!0),null!=o&&o!==e.dtype&&(e=e.asType(o)),new n(e,t,r)},t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!v.arraysEqual(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");d.ENV.engine.disposeTensor(this),this.dataId=e.dataId,d.ENV.engine.registerTensor(this)},t.nextVarId=0,l([h.doc({heading:"Tensors",subheading:"Classes"})],t.prototype,"assign",null),l([h.doc({heading:"Tensors",subheading:"Creation"})],t,"variable",null),t=n=l([h.doc({heading:"Tensors",subheading:"Classes"})],t);var n}(x);n.Variable=_;var N=_.variable;function E(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var i=t-3;i>=0;--i)n[i]=n[i+1]*e[i+1];return n}n.variable=N},{"./doc":45,"./environment":47,"./ops/ops":122,"./tensor_util":148,"./util":153}],148:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),o=20,l=3,c=7;function f(e,t){return r.rightPad(parseFloat(e.toFixed(c)).toString(),t)}n.tensorToString=function(e,t){var n=e.dataSync(),r=function(e){var t=e.dataSync(),n=e.size,r=e.strides[e.strides.length-1],o=new Array(r).fill(0);if(e.rank>1)for(var l=0;l<n/r;l++)for(var c=l*r,h=0;h<r;h++)o[h]=Math.max(o[h],f(t[c+h],0).length);return o}(e),c=function e(t,n,r,c,h){void 0===h&&(h=!0);var d=n[0],m=n.length;if(0===m)return[t[0].toString()];if(1===m){if(d>o){var y=Array.from(t.subarray(0,l)),v=Array.from(t.subarray(d-l,d));return["["+y.map((function(e,i){return f(e,c[i])})).join(", ")+", ..., "+v.map((function(e,i){return f(e,c[d-l+i])})).join(", ")+"]"]}return["["+Array.from(t).map((function(e,i){return f(e,c[i])})).join(", ")+"]"]}var w=n.slice(1),x=r.slice(1),_=r[0],N=[];if(d>o){for(var i=0;i<l;i++){var E=(A=i*_)+_;N.push.apply(N,e(t.subarray(A,E),w,x,c,!1))}for(N.push("..."),i=d-l;i<d;i++)E=(A=i*_)+_,N.push.apply(N,e(t.subarray(A,E),w,x,c,i===d-1))}else for(i=0;i<d;i++){var A;E=(A=i*_)+_,N.push.apply(N,e(t.subarray(A,E),w,x,c,i===d-1))}var O=2===m?",":"";for(N[0]="["+N[0]+O,i=1;i<N.length-1;i++)N[i]=" "+N[i]+O;var S=",\n";for(i=2;i<m;i++)S+="\n";return N[N.length-1]=" "+N[N.length-1]+"]"+(h?"":S),N}(n,e.shape,e.strides,r),h=["Tensor"];return t&&(h.push("  dtype: "+e.dtype),h.push("  rank: "+e.rank),h.push("  shape: ["+e.shape+"]"),h.push("  values:")),h.push(c.map((function(e){return"    "+e})).join("\n")),h.join("\n")}},{"./util":153}],149:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./tensor"),o=e("./util");function l(e,t,l){if(void 0===l&&(l=n.TEST_EPSILON),e instanceof r.Tensor||t instanceof r.Tensor){if(e instanceof r.Tensor&&t instanceof r.Tensor){if(e.dtype!==t.dtype)throw new Error("Arrays are of different type actual: "+e.dtype+" vs expected: "+t.dtype+".");if(!o.arraysEqual(e.shape,t.shape))throw new Error("Arrays are of different shape actual: "+e.shape+" vs expected: "+t.shape+".")}}else{var f=e.constructor.name,h=t.constructor.name;if(f!==h)throw new Error("Arrays are of different type actual: "+f+" vs expected: "+h)}var d,m;if(d=e instanceof r.Tensor?e.dataSync():e,m=t instanceof r.Tensor?t.dataSync():t,d.length!==m.length)throw new Error("Arrays have different lengths actual: "+d.length+" vs expected: "+m.length+".\nActual:   "+d+".\nExpected: "+m+".");for(var i=0;i<m.length;++i){var a=d[i],y=m[i];if(!c(a,Number(y),l))throw new Error("Arrays differ: actual["+i+"] = "+a+", expected["+i+"] = "+y+".\nActual:   "+d+".\nExpected: "+m+".")}}function c(a,e,t){return!(!isNaN(a)||!isNaN(e))||!(isNaN(a)||isNaN(e)||Math.abs(a-e)>t)}n.WEBGL_ENVS={BACKEND:"test-webgl"},n.CPU_ENVS={BACKEND:"test-cpu"},n.ALL_ENVS={},n.TEST_EPSILON=.001,n.expectArraysClose=l,n.expectPromiseToFail=function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},n.expectArraysEqual=function(e,t){return l(e,t,0)},n.expectNumbersClose=function(a,e,t){if(void 0===t&&(t=n.TEST_EPSILON),!c(a,e,t))throw new Error("Numbers differ: actual === "+a+", expected === "+e)},n.expectValuesInRange=function(e,t,n){var o;o=e instanceof r.Tensor?e.dataSync():e;for(var i=0;i<o.length;i++)if(o[i]<t||o[i]>n)throw new Error("Value out of range:"+o[i]+" low: "+t+", high: "+n)}},{"./tensor":147,"./util":153}],150:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./doc"),l=e("./environment"),c=e("./util"),f=function(){function e(){}return e.tidy=function(e,t,n){void 0===n&&(n=!1);var r=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}l.ENV.engine.startScope(r,n);var o=t();return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),l.ENV.engine.endScope(o,n),o},e.dispose=function(e){c.extractTensorsFromAny(e).forEach((function(e){return e.dispose()}))},e.keep=function(e){return l.ENV.engine.keep(e)},e.time=function(e){return l.ENV.engine.time(e)},r([o.doc({heading:"Performance",subheading:"Memory"})],e,"tidy",null),r([o.doc({heading:"Performance",subheading:"Memory"})],e,"keep",null),r([o.doc({heading:"Performance",subheading:"Timing"})],e,"time",null),e}();n.Tracking=f},{"./doc":45,"./environment":47,"./util":153}],151:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./optimizers/adadelta_optimizer"),o=e("./optimizers/adagrad_optimizer"),l=e("./optimizers/adam_optimizer"),c=e("./optimizers/adamax_optimizer"),f=e("./optimizers/momentum_optimizer"),h=e("./optimizers/optimizer_constructors"),d=e("./optimizers/rmsprop_optimizer"),m=e("./optimizers/sgd_optimizer");f.MomentumOptimizer,m.SGDOptimizer,r.AdadeltaOptimizer,o.AdagradOptimizer,d.RMSPropOptimizer,c.AdamaxOptimizer,l.AdamOptimizer,n.train={sgd:h.OptimizerConstructors.sgd,momentum:h.OptimizerConstructors.momentum,adadelta:h.OptimizerConstructors.adadelta,adagrad:h.OptimizerConstructors.adagrad,rmsprop:h.OptimizerConstructors.rmsprop,adamax:h.OptimizerConstructors.adamax,adam:h.OptimizerConstructors.adam}},{"./optimizers/adadelta_optimizer":135,"./optimizers/adagrad_optimizer":136,"./optimizers/adam_optimizer":137,"./optimizers/adamax_optimizer":138,"./optimizers/momentum_optimizer":139,"./optimizers/optimizer_constructors":141,"./optimizers/rmsprop_optimizer":142,"./optimizers/sgd_optimizer":143}],152:[function(e,t,n){"use strict";var r,o,l;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.float32="float32",e.int32="int32",e.bool="bool"}(n.DType||(n.DType={})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4"}(n.Rank||(n.Rank={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool"}(o||(o={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32"}(l||(l={}));var c={float32:l,int32:r,bool:o};function f(e,t){return c[e][t]}n.upcastType=f,n.sumOutType=function(e){return f(e,"int32")}},{}],153:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./tensor");function o(e,t,n){c(e instanceof r.Tensor,"Argument '"+t+"' passed to '"+n+"' must be a Tensor, but got "+typeof e+".")}function l(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function c(e,t){if(!e)throw new Error(t)}function f(e,t){if(void 0===t&&(t=[]),Array.isArray(e))for(var i=0;i<e.length;++i)f(e[i],t);else t.push(e);return t}function h(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function d(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function m(a){return a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array}function y(e){if(null==e)return[];if(e instanceof r.Tensor)return[e];var t,n=[],o=e;if(t=o,!Array.isArray(t)&&"object"!=typeof t)return[];for(var l in o){var c=f(o[l]).filter((function(e){return e instanceof r.Tensor}));n.push.apply(n,c)}return n}n.assertArgumentsAreTensors=function(e,t){var n=function(n){var r=e[n];Array.isArray(r)?r.forEach((function(e,i){o(e,n+"["+i+"]",t)})):o(r,n,t)};for(var r in e)n(r)},n.shuffle=l,n.clamp=function(e,t,n){return Math.max(e,Math.min(t,n))},n.randUniform=function(a,b){return Math.random()*(b-a)+a},n.distSquared=function(a,b){for(var e=0,i=0;i<a.length;i++){var t=Number(a[i])-Number(b[i]);e+=t*t}return e},n.assert=c,n.assertShapesMatch=function(e,t,n){void 0===n&&(n=""),c(h(e,t),n+" Shapes "+e+" and "+t+" must match")},n.assertTypesMatch=function(a,b){c(a.dtype===b.dtype," The dtypes of the first("+a.dtype+") and second("+b.dtype+") input must match")},n.flatten=f,n.inferShape=function(e){if(m(e))return[e.length];if(!Array.isArray(e))return[];for(var t=[];e instanceof Array;)t.push(e.length),e=e[0];return t},n.sizeFromShape=function(e){if(0===e.length)return 1;for(var t=e[0],i=1;i<e.length;i++)t*=e[i];return t},n.isScalarShape=function(e){return 0===e.length},n.arraysEqual=h,n.isInt=function(a){return a%1==0},n.tanh=function(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)},n.sizeToSquarishShape=function(e){for(var a=Math.floor(Math.sqrt(e));a>1;--a)if(e%a==0)return[a,e/a];return[1,e]},n.createShuffledIndices=function(e){for(var t=new Uint32Array(e),i=0;i<e;++i)t[i]=i;return l(t),t},n.rightPad=function(a,e){return e<=a.length?a:a+" ".repeat(e-a.length)},n.repeatedTry=function(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,o){var l=0,c=function(){if(e())r();else{var f=t(++l);null!=n&&l>=n?o():setTimeout(c,f)}};setTimeout(c,0)}))},n.getQueryParams=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(s){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return d(t,e[0],e[1]),e.join("=")})),t},n.inferFromImplicitShape=function(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found - 1 at dim "+r+" and dim "+i);r=i}else if(e[i]<=0)throw Error("Shapes can not be <= 0. Found "+e[i]+" at dim "+i);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var o=e.slice();return o[r]=t/n,o},n.squeezeShape=function(e,t){for(var n=[],r=[],o=0,i=0;i<e.length;++i){if(null!=t){if(t[o]===i&&e[i]>1)throw new Error("Can't squeeze axis "+i+" since its dim '"+e[i]+"' is not 1");(null==t[o]||t[o]>i)&&1===e[i]&&(n.push(e[i]),r.push(i)),t[o]<=i&&o++}e[i]>1&&(n.push(e[i]),r.push(i))}return{newShape:n,keptDims:r}},n.getTypedArrayFromDType=function(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n},n.isTensorInList=function(e,t){for(var i=0;i<t.length;i++)if(t[i].id===e.id)return!0;return!1},n.checkForNaN=function(e,t,n){if("float32"===t)for(var i=0;i<e.length;i++)if(isNaN(e[i]))throw Error("The result of the '"+n+"' has NaNs.")},n.flattenNameArrayMap=function(e,t){var n=[];if(e instanceof r.Tensor)n.push(e);else for(var o=e,i=0;i<t.length;i++)n.push(o[t[i]]);return n},n.unflattenToNameArrayMap=function(e,t){if(e.length!==t.length)throw new Error("Cannot unflatten Tensor[], keys and arrays are not of same length.");for(var n={},i=0;i<e.length;i++)n[e[i]]=t[i];return n},n.hasEncodingLoss=function(e,t){return!("float32"===t||"int32"===t&&"float32"!==e||"bool"===t&&"bool"===e)},n.copyTypedArray=function(e,t){if(null==t||"float32"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),i=0;i<n.length;++i)0!==Math.round(e[i])&&(n[i]=1);return n}throw new Error("Unknown data type "+t)},n.isTypedArray=m,n.bytesPerElement=function(e){if("float32"===e||"int32"===e)return 4;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)},n.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},n.extractTensorsFromContainer=function(e){return y(e)},n.extractTensorsFromAny=y},{"./tensor":147}],154:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.version="0.11.1"},{}],155:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./kernels/webgl/webgl_util");n.webgl_util=r;var o=e("./kernels/webgl/gpgpu_util");n.gpgpu_util=o;var l=e("./kernels/backend_webgl");n.MathBackendWebGL=l.MathBackendWebGL;var c=e("./kernels/webgl/gpgpu_context");n.GPGPUContext=c.GPGPUContext},{"./kernels/backend_webgl":63,"./kernels/webgl/gpgpu_context":76,"./kernels/webgl/gpgpu_util":78,"./kernels/webgl/webgl_util":100}],156:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("./backend/tfjs_backend"),h=e("./utils/generic_utils"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getConfig=function(){return{}},t}(c.serialization.Serializable);n.Activation=d;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e,t){return void 0===t&&(t=1),f.elu(e,t)},t.className="elu",t}(d);n.Elu=m,c.serialization.SerializationMap.register(m);var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return l.selu(e)},t.className="selu",t}(d);n.Selu=y,c.serialization.SerializationMap.register(y);var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return l.relu(e)},t.className="relu",t}(d);n.Relu=v,c.serialization.SerializationMap.register(v);var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return c.tidy((function(){return l.minimum(f.getScalar(6),l.relu(e))}))},t.className="relu6",t}(d);n.Relu6=w,c.serialization.SerializationMap.register(w);var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return e},t.className="linear",t}(d);n.Linear=x,c.serialization.SerializationMap.register(x);var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return l.sigmoid(e)},t.className="sigmoid",t}(d);n.Sigmoid=_,c.serialization.SerializationMap.register(_);var N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return f.hardSigmoid(e)},t.className="hardSigmoid",t}(d);n.HardSigmoid=N,c.serialization.SerializationMap.register(N);var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return l.softplus(e)},t.className="softplus",t}(d);n.Softplus=E,c.serialization.SerializationMap.register(E);var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return f.softsign(e)},t.className="softsign",t}(d);n.Softsign=A,c.serialization.SerializationMap.register(A);var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return l.tanh(e)},t.className="tanh",t}(d);n.Tanh=O,c.serialization.SerializationMap.register(O);var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e,t){return void 0===t&&(t=-1),l.softmax(e,t)},t.className="softmax",t}(d);function T(e,t){return void 0===t&&(t={}),h.deserializeKerasObject(e,c.serialization.SerializationMap.getMap().classNameMap,t,"activation")}n.Softmax=S,c.serialization.SerializationMap.register(S),n.serializeActivation=function(e){return e.getClassName()},n.deserializeActivation=T,n.getActivation=function(e){return null==e?T({className:"linear",config:{}}):"string"==typeof e?T({className:e,config:{}}):e instanceof d?e:T(e)}},{"./backend/tfjs_backend":158,"./utils/generic_utils":188,"@tensorflow/tfjs-core":50}],157:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=1e-7;n.epsilon=function(){return r},n.setEpsilon=function(e){r=e},n.imageDataFormat=function(){return"channelsLast"}},{}],158:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("@tensorflow/tfjs-core"),l=e("../common"),c=e("../errors"),f=e("../utils/math_utils"),h=e("../variables"),d=e("./common"),m=e("./common"),y="webgl",v="float32";function w(){for(var e in x)for(var t in x[e])x[e][t].dispose(),delete x[e][t]}n.disposeScalarCache=w,n.setBackend=function(e){r.setBackend(e),y=e,w()},n.getBackend=function(){return y};var x={float32:{},int32:{}};function _(e,t){return void 0===t&&(t=v),null==x[t][e]&&(x[t][e]=o.scalar(e,t),r.keep(x[t][e])),x[t][e]}function N(e){return e.shape}function E(e,t){void 0===t&&(t=-1);var n=N(e).slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function A(e,t,n){return o.tidy((function(){switch(e.rank){case 1:return r.slice1d(e,t,n);case 2:return r.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return r.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return r.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);default:throw new c.ValueError("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}))}function O(e,t,n){return o.tidy((function(){switch(e.rank){case 1:return r.slice1d(e,t,n);case 2:return r.slice2d(e,[0,t],[e.shape[0],n]);case 3:return r.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return r.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new c.ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}}))}function S(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new c.ValueError("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return r.tile(e,t)}function T(e,t){return r.mul(e,t)}function I(e,t){return r.add(e,t)}function k(e){return o.tidy((function(){var t=o.zerosLike(e),n=o.onesLike(e);return o.where(r.equal(e,t),t,o.where(r.greater(e,o.zerosLike(e)),n,T(_(-1),n)))}))}n.getScalar=_,n.epsilon=d.epsilon,n.isBackendSymbolic=function(){return!1},n.shape=N,n.intShape=function(e){return e.shape},n.dtype=function(e){return e instanceof o.Tensor?v:e.dtype},n.countParams=function(e){var t=e.shape;return t.length>0?t.reduce((function(a,b){return a*b})):1},n.cast=function(e,t){return e.asType(t)},n.expandDims=E,n.repeat=function(e,t){return o.tidy((function(){if(2!==e.shape.length)throw new c.ValueError("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return S(E(e,1),[1,t,1])}))},n.flatten=function(e){var t=[f.arrayProd(e.shape)];return e.reshape(t)},n.batchFlatten=function(e){if(e.rank<=1)throw new c.ValueError("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],f.arrayProd(e.shape,1)];return e.reshape(t)},n.sliceAlongFirstAxis=A,n.sliceAlongLastAxis=O,n.sliceAlongAxis=function(e,t,n,l){return o.tidy((function(){switch(e.rank){case 1:return r.slice1d(e,t,n);case 2:switch(l){case 1:return A(e,t,n);case 2:return O(e,t,n);default:throw new c.ValueError("The axis is not within the rank of the tensor "+l)}case 3:switch(l){case 1:return A(e,t,n);case 2:return r.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return O(e,t,n);default:throw new c.ValueError("The axis is not within the rank of the tensor "+l)}case 4:switch(l){case 1:return A(e,t,n);case 2:return r.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return r.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return O(e,t,n);default:throw new c.ValueError("The axis is not within the rank of the tensor "+l)}default:throw new c.ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}}))},n.concatenate=function(e,t){var n;return void 0===t&&(t=-1),t<0&&(t=0!==(n=e[0].rank)?n:0),t===e[0].rank&&(t=-1),r.concat(e,t)},n.concatAlongFirstAxis=function(a,b){switch(a.rank){case 1:return r.concat1d([a,b]);case 2:return r.concat2d([a,b],0);case 3:return r.concat3d([a,b],0);case 4:return r.concat4d([a,b],0);default:throw new c.ValueError("concatAlongFirstAxis() received an unsupported tensor rank: "+a.rank)}},n.tile=S,n.identity=function(e){return e.clone()},n.eyeVariable=function(e,t,n){return new h.LayerVariable(r.eye(e,e,null,t),t,n)},n.scalarTimesArray=T,n.scalarPlusArray=I,n.randomNormal=function(e,t,n,o,l){return void 0===t&&(t=0),void 0===n&&(n=1),r.randomNormal(e,t,n,o,l)},n.dot=function(e,t){if(2!==t.rank)throw new c.NotImplementedError("dot support for y other than rank 2 is not yet implemented: y shape = "+N);if(2===e.rank)return r.matMul(e,t);if(3===e.rank){var n=e.shape[0],o=e.shape[1],l=e.shape[2];return e=e.reshape([n*o,l]),r.matMul(e,t).reshape([n,o,t.shape[1]])}throw new c.NotImplementedError("dot support for x of rank "+e.rank+" is not yet implemented: x shape = "+N)},n.sign=k,n.qr=function(e){var t=o.tidy((function(){if(2!==e.shape.length)throw new c.ValueError("qr() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");if(e.shape[0]<e.shape[1])throw new c.ValueError("qr() requires x.shape[0] >= x.shape[1], but got shape: ["+e.shape+"]");for(var t=e.shape[0],n=e.shape[1],q=r.eye(t),l=e.clone(),f=o.tensor2d([[1]],[1,1]),h=f.clone(),d=function(e){var c,d=l,m=h,y=q;c=o.tidy((function(){var o=l.slice([e,e],[t-e,1]),c=r.norm(o),d=l.slice([e,e],[1,1]),s=r.neg(k(d)),m=d.sub(r.mul(s,c)),y=r.div(o,m);h=1===y.shape[0]?f.clone():f.concat(y.slice([1,0],[y.shape[0]-1,y.shape[1]]),0);var v=r.neg(r.div(r.matMul(s,m),c)),w=l.slice([e,0],[t-e,n]),x=v.mul(h);l=0===e?w.sub(x.matMul(h.transpose().matMul(w))):l.slice([0,0],[e,n]).concat(w.sub(x.matMul(h.transpose().matMul(w))),0);var _=q.slice([0,e],[t,q.shape[1]-e]);return q=0===e?_.sub(_.matMul(h).matMul(x.transpose())):q.slice([0,0],[t,e]).concat(_.sub(_.matMul(h).matMul(x.transpose())),1),[h,l,q]})),h=c[0],l=c[1],q=c[2],o.dispose([d,m,y])},m=0;m<n;++m)d(m);return[q,l]}));return[t[0],t[1]]},n.oneHot=function(e,t){return o.tidy((function(){if(1!==e.rank)throw new Error("Only 1D one-hot tensors are supported in the deeplearn backend, at present.");return e=e.toInt(),r.oneHot(e,t).toFloat()}))},n.gather=function(e,t,n){return o.tidy((function(){return t=Array.isArray(t)?o.tensor1d(t,"int32"):t.toInt(),r.gather(e,t,n)}))},n.square=function(e){return r.mulStrict(e,e)},n.pow=function(e,a){return o.tidy((function(){if("number"==typeof a&&(a=o.scalar(Math.round(a),"int32")),"int32"!==a.dtype)throw new c.NotImplementedError("Non-int32 dtype ("+a.dtype+") is not supported by pow() yet");return r.pow(e,a)}))},n.biasAdd=function(e,t,n){return o.tidy((function(){if(null==n&&(n=m.imageDataFormat()),l.checkDataFormat(n),1!==t.rank&&t.rank!==e.rank)throw new c.ValueError("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e.rank);var r,o=t.shape;if(5===e.rank)"channelsFirst"===n?r=1===o.length?e.add(t.reshape([1,o[0],1,1,1])):e.add(t.reshape([1,o[3],o[0],o[1],o[2]])):"channelsLast"===n&&(r=1===o.length?e.add(t.reshape([1,1,1,1,o[0]])):e.add(t.reshape([1].concat(o))));else if(4===e.rank)"channelsFirst"===n?r=1===o.length?e.add(t.reshape([1,o[0],1,1])):e.add(t.reshape([1,o[2],o[0],o[1]])):"channelsLast"===n&&(r=1===o.length?e.add(t.reshape([1,1,1,o[0]])):e.add(t.reshape([1].concat(o))));else if(3===e.rank)"channelsFirst"===n?r=1===o.length?e.add(t.reshape([1,o[0],1])):e.add(t.reshape([1,o[1],o[0]])):"channelsLast"===n&&(r=1===o.length?e.add(t.reshape([1,1,o[0]])):e.add(t.reshape([1].concat(o))));else{if(!(e.rank<3))throw new c.ValueError("Unsupported input rank by biasAdd: "+e.rank);r=e.add(t)}return r}))},n.elu=function(e,t){if(void 0===t&&(t=1),1!==t)throw new c.NotImplementedError("Support for alpha values other than 1 ("+t+") is not implemented yet.");return r.elu(e)},n.softsign=function(e){return o.tidy((function(){return r.div(e,r.add(_(1),r.abs(e)))}))},n.dropout=function(e,t,n,l){return o.tidy((function(){if(null!=n&&!o.util.arraysEqual(e.shape,n))throw new c.NotImplementedError("Non-default noise shape is not implemented yet: "+JSON.stringify(n));if(null!=l)throw new c.NotImplementedError("seed is not implemented for dropout yet.");var f=r.step(r.add(r.neg(t),r.randomUniform(e.shape,0,1,"float32")));return f=r.mul(r.div(_(1),r.sub(_(1),t)),f),r.mul(e,f)}))},n.nameScope=function(e,t){return l.nameScope(e,t)},n.floatx=function(){return"float32"};var P={};n.getUid=function(e){return void 0===e&&(e=""),e in P||(P[e]=0),P[e]+=1,e+P[e].toString()},n.hardSigmoid=function(e){return o.tidy((function(){var t=I(_(.5),T(_(.2),e));return r.clipByValue(t,0,1)}))},n.inTrainPhase=function(e,t,n){return void 0===n&&(n=!1),n?e():t()},n.gradients=function(e,t){var n=t.map((function(e){return e.read()})),r=o.variableGrads(e,n);return t.map((function(e){return r.grads[e.name]}))}},{"../common":160,"../errors":165,"../utils/math_utils":189,"../variables":191,"./common":157,"@tensorflow/tfjs-core":50}],159:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var f=e("@tensorflow/tfjs-core"),h=e("./backend/tfjs_backend"),d=e("./utils/generic_utils"),m=function(){function e(){this.validationData=null,this.model=null}return e.prototype.setParams=function(e){this.params=e},e.prototype.setModel=function(e){this.model=e},e.prototype.onEpochBegin=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))},e.prototype.onEpochEnd=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))},e.prototype.onBatchBegin=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))},e.prototype.onBatchEnd=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))},e.prototype.onTrainBegin=function(e){return l(this,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))},e.prototype.onTrainEnd=function(e){return l(this,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))},e}();n.Callback=m;var y=function(){function e(e,t){void 0===t&&(t=10),null==e&&(e=[]),this.callbacks=e,this.queueLength=t}return e.prototype.append=function(e){this.callbacks.push(e)},e.prototype.setParams=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setParams(e)},e.prototype.setModel=function(e){for(var t=0,n=this.callbacks;t<n.length;t++)n[t].setModel(e)},e.prototype.onEpochBegin=function(e,t){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onEpochEnd=function(e,t){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onBatchBegin=function(e,t){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onBatchEnd=function(e,t){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(o){switch(o.label){case 0:null==t&&(t={}),n=0,r=this.callbacks,o.label=1;case 1:return n<r.length?[4,r[n].onBatchEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onTrainBegin=function(e){return l(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:null==e&&(e={}),t=0,n=this.callbacks,r.label=1;case 1:return t<n.length?[4,n[t].onTrainBegin(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.onTrainEnd=function(e){return l(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:null==e&&(e={}),t=0,n=this.callbacks,r.label=1;case 1:return t<n.length?[4,n[t].onTrainEnd(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e}();n.CallbackList=y;var v=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.onEpochBegin=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(e){return this.seen=0,this.totals={},[2]}))}))},t.prototype.onBatchEnd=function(e,t){return l(this,void 0,void 0,(function(){var e,n,r,o,l=this;return c(this,(function(c){for(o in null==t&&(t={}),e=null==t.size?0:t.size,this.seen+=e,n=function(n){var o=t[n];"number"==typeof o?(r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+o*e):(r.totals.hasOwnProperty(n)||(r.totals[n]=h.getScalar(0)),f.tidy((function(){l.totals[n]=h.scalarPlusArray(l.totals[n],f.mul(o,h.getScalar(e))),f.keep(l.totals[n])})))},r=this,t)n(o);return[2]}))}))},t.prototype.onEpochEnd=function(e,t){return l(this,void 0,void 0,(function(){var e,n,r,o,l,d=this;return c(this,(function(c){if(null!=t)for(e=function(e){if(null==n.totals[e])return"continue";"number"==typeof n.totals[e]?t[e]=n.totals[e]/n.seen:f.tidy((function(){t[e]=h.scalarTimesArray(f.div(h.getScalar(1),h.getScalar(d.seen)),d.totals[e]),f.keep(t[e])}))},n=this,r=0,o=this.params.metrics;r<o.length;r++)l=o[r],e(l);return[2]}))}))},t}(m);function w(e){return l(this,void 0,void 0,(function(){var t,n,r,o,l,f,i;return c(this,(function(c){switch(c.label){case 0:if(null==e)return[2];for(r in t=[],n=[],e)"number"!=typeof(o=e[r])&&(l=o,t.push(l.data()),n.push(r));return[4,Promise.all(t)];case 1:for(f=c.sent(),i=0;i<f.length;++i)e[n[i]]=f[i][0];return[2]}}))}))}n.BaseLogger=v,n.resolveScalarsInLogs=w,n.disposeTensorsInLogs=function(e){if(null!=e)for(var t in e){var n=e[t];"number"!=typeof n&&n.dispose()}};var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onTrainBegin=function(e){return l(this,void 0,void 0,(function(){return c(this,(function(e){return this.epoch=[],this.history={},[2]}))}))},t.prototype.onEpochEnd=function(e,t){return l(this,void 0,void 0,(function(){var n;return c(this,(function(r){for(n in null==t&&(t={}),this.epoch.push(e),t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n]);return[2]}))}))},t.prototype.syncData=function(){return l(this,void 0,void 0,(function(){var e,t,n,r,o,i,l,f,h;return c(this,(function(c){switch(c.label){case 0:for(r in e=[],t=[],n=[],this.history)for(o=this.history[r],i=0;i<o.length;++i)"number"!=typeof o[i]&&(l=o[i],e.push(l.data()),t.push(r),n.push(i));return[4,Promise.all(e)];case 1:for(f=c.sent(),h=0;h<f.length;++h)this.history[t[h]][n[h]].dispose(),this.history[t[h]][n[h]]=f[h][0];return[2]}}))}))},t}(m);n.History=x;var _=function(e){function t(t){var n=e.call(this)||this;return n.trainBegin=t.onTrainBegin,n.trainEnd=t.onTrainEnd,n.epochBegin=t.onEpochBegin,n.epochEnd=t.onEpochEnd,n.batchBegin=t.onBatchBegin,n.batchEnd=t.onBatchEnd,n}return o(t,e),t.prototype.onEpochBegin=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return null==this.epochBegin?[3,3]:[4,w(t)];case 1:return n.sent(),[4,this.epochBegin(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onEpochEnd=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return null==this.epochEnd?[3,3]:[4,w(t)];case 1:return n.sent(),[4,this.epochEnd(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onBatchBegin=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,w(t)];case 1:return n.sent(),[4,this.batchBegin(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onBatchEnd=function(e,t){return l(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return null==this.batchEnd?[3,3]:[4,w(t)];case 1:return n.sent(),[4,this.batchEnd(e,t)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onTrainBegin=function(e){return l(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return null==this.trainBegin?[3,3]:[4,w(e)];case 1:return t.sent(),[4,this.trainBegin(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t.prototype.onTrainEnd=function(e){return l(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return null==this.trainEnd?[3,3]:[4,w(e)];case 1:return t.sent(),[4,this.trainEnd(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t}(m);n.CustomCallback=_,n.standardizeCallbacks=function(e){return null==e?null:e instanceof m?[e]:Array.isArray(e)&&e[0]instanceof m?e:d.toList(e).map((function(e){return new _(e)}))}},{"./backend/tfjs_backend":158,"./utils/generic_utils":188,"@tensorflow/tfjs-core":50}],160:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./utils/generic_utils"),o=new Map;n.VALID_DATA_FORMAT_VALUES=["channelsFirst","channelsLast"],n.checkDataFormat=function(e){r.checkStringTypeUnionValue(n.VALID_DATA_FORMAT_VALUES,"DataFormat",e)},n.VALID_PADDING_MODE_VALUES=["valid","same","causal"],n.checkPaddingMode=function(e){r.checkStringTypeUnionValue(n.VALID_PADDING_MODE_VALUES,"PaddingMode",e)},n.VALID_POOL_MODE_VALUES=["max","avg"],n.checkPoolMode=function(e){r.checkStringTypeUnionValue(n.VALID_POOL_MODE_VALUES,"PoolMode",e)};var l=[],c="/";n.nameScope=function(e,t){l.push(e);try{var n=t();return l.pop(),n}catch(e){throw l.pop(),e}},n.getScopedTensorName=function(e){if(!h(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===l.length?"":l.join(c)+c)+e},n.getUniqueTensorName=function(e){if(!h(e))throw new Error("Not a valid tensor name: '"+e+"'");o.has(e)||o.set(e,0);var t=o.get(e);if(o.set(e,o.get(e)+1),t>0){var n=e+"_"+t;return o.set(n,1),n}return e};var f=new RegExp(/^[A-Za-z][A-Za-z0-9\._\/]*$/);function h(e){return!!e.match(f)}n.isValidTensorName=h},{"./utils/generic_utils":188}],161:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs-core"),f=e("@tensorflow/tfjs-core"),h=e("./backend/tfjs_backend"),d=e("./utils/generic_utils");function m(e,t){return f.tidy((function(){return c.sqrt(c.sum(h.square(e),t,!0))}))}var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getConfig=function(){return{}},t=l([f.doc({heading:"Constraints",subheading:"Classes",namespace:"constraints"})],t)}(f.serialization.Serializable);n.Constraint=y;var v=function(e){function t(t){var n=e.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=t.maxValue?t.maxValue:n.defaultMaxValue,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return o(t,e),t.prototype.apply=function(e){var t=this;return f.tidy((function(){var n=m(e,t.axis),r=c.clipByValue(n,0,t.maxValue);return c.mul(e,c.div(r,h.scalarPlusArray(h.getScalar(h.epsilon()),n)))}))},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(y);n.MaxNorm=v,f.serialization.SerializationMap.register(v);var w=function(e){function t(t){var n=e.call(this)||this;return n.defaultAxis=0,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return o(t,e),t.prototype.apply=function(e){var t=this;return f.tidy((function(){return c.div(e,h.scalarPlusArray(h.getScalar(h.epsilon()),m(e,t.axis)))}))},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(y);n.UnitNorm=w,f.serialization.SerializationMap.register(w);var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e){return c.relu(e)},t.className="NonNeg",t}(y);n.NonNeg=x,f.serialization.SerializationMap.register(x);var _=function(e){function t(t){var n=e.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=t.minValue?t.minValue:n.defaultMinValue,n.maxValue=null!=t.maxValue?t.maxValue:n.defaultMaxValue,n.rate=null!=t.rate?t.rate:n.defaultRate,n.axis=null!=t.axis?t.axis:n.defaultAxis,n}return o(t,e),t.prototype.apply=function(e){var t=this;return f.tidy((function(){var n=m(e,t.axis),r=c.add(h.scalarTimesArray(h.getScalar(t.rate),c.clipByValue(n,t.minValue,t.maxValue)),h.scalarTimesArray(h.getScalar(1-t.rate),n));return c.mul(e,c.div(r,h.scalarPlusArray(h.getScalar(h.epsilon()),n)))}))},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(y);function N(e,t){return void 0===t&&(t={}),d.deserializeKerasObject(e,f.serialization.SerializationMap.getMap().classNameMap,t,"constraint")}n.MinMaxNorm=_,f.serialization.SerializationMap.register(_),n.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"},n.serializeConstraint=function(e){return d.serializeKerasObject(e)},n.deserializeConstraint=N,n.getConstraint=function(e){return null==e?null:"string"==typeof e?N({className:e in n.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP?n.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e,config:{}}):e instanceof y?e:N(e)}},{"./backend/tfjs_backend":158,"./utils/generic_utils":188,"@tensorflow/tfjs-core":50}],162:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../errors"),o=e("./topology"),l=function(){function e(t){if(this.id2Value={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n];else{if(null==t)return;for(var r=0,o=t;r<o.length;r++){var l=o[r];this.add(l.key,l.value)}}}return e.prototype.add=function(e,t){if(function(e,t){if(null!=e.dtype&&e.dtype!==t.dtype)throw new r.ValueError("The dtype of the feed ("+t.dtype+") is incompatible with that of the key '"+e.name+"' ("+e.dtype+").");if(null!=e.shape){if(e.shape.length!==t.shape.length)throw new r.ValueError("The rank of feed ("+t.shape.length+") does not match the rank of the key ("+e.shape.length+").");for(var i=0;i<e.shape.length;++i)if(null!=e.shape[i]&&e.shape[i]!==t.shape[i])throw new r.ValueError("The "+i+"-th dimension of the feed ("+t.shape[i]+") is incompatible with that of the key ("+e.shape[i]+").")}}(e,t),null!=this.id2Value[e.id])throw new r.ValueError("Duplicate key: name="+e.name+", id="+e.id);return this.id2Value[e.id]=t,this},e.prototype.addFeed=function(e){this.add(e.key,e.value)},e.prototype.hasKey=function(e){return null!=this.id2Value[e.id]},e.prototype.getValue=function(e){if(null==this.id2Value[e.id])throw new r.ValueError("Nonexistent key: "+JSON.stringify(e));return this.id2Value[e.id]},e}();function c(e,t,n){if(t.hasKey(e))return t.getValue(e);if(e.sourceLayer instanceof o.InputLayer)throw new r.ValueError("Missing a feed value for SymbolicTensor from InputLayer '"+o.InputLayer.name+"'");for(var l=[],f=0,h=e.inputs;f<h.length;f++){var d=c(h[f],t,n);l.push(d)}var output=e.sourceLayer.apply(l,n);Array.isArray(output)||(output=[output]);for(var m=function(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,i=0;i<e.sourceLayer.inboundNodes.length;++i)for(var r=0,o=e.sourceLayer.inboundNodes[i].outputTensors;r<o.length;r++)if(o[r].id===e.id){n=i;break}t=e.sourceLayer.getOutputAt(n)}return t}(e),y=Array.isArray(m)?m:[m],i=0;i<y.length;++i)t.add(y[i],output[i]);return 1===output.length?output[0]:output[e.outputTensorIndex]}n.FeedDict=l,n.execute=function(e,t,n){for(var r=Array.isArray(e),o=r?e:[e],f=[],h=new l(t),d=0,m=o;d<m.length;d++){var y=m[d];f.push(c(y,h,n))}return r?f:f[0]}},{"../errors":165,"./topology":163}],163:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs-core"),f=e("../backend/tfjs_backend"),h=e("../errors"),d=e("../layers/serialization"),m=e("../types"),y=e("../utils/generic_utils"),v=e("../utils/serialization_utils"),w=e("../variables"),x=e("../version"),_=function(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}};n.InputSpec=_;var N=0,E=function(){function e(e,t){this.callArgs=t,this.id=N++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(var n=0,r=e.inboundLayers;n<r.length;n++){var o=r[n];null!=o&&o.outboundNodes.push(this)}e.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var e=[],t=0,n=this.inboundLayers;t<n.length;t++){var r=n[t];null!=r?e.push(r.name):e.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}();n.Node=E;var A=0,O=function(e){function t(t){var n=e.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=A++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=t.name;if(!r){var o=n.getClassName();r=y.toSnakeCase(o)+"_"+f.getUid(o)}if(n.name=r,n.trainable=null==t.trainable||t.trainable,n.updatable=null==t.updatable||t.updatable,null!=t.inputShape||null!=t.batchInputShape){var l=void 0;if(null!=t.batchInputShape)l=t.batchInputShape;else if(null!=t.inputShape){var c=null;null!=t.batchSize&&(c=t.batchSize),l=[c].concat(t.inputShape)}n.batchInputShape=l;var h=t.dtype;null==h&&(h=t.inputDType),null==h&&(h=f.floatx()),n.dtype=h}return null!=t.weights?n.initialWeights=t.weights:n.initialWeights=null,n}return o(t,e),t.nodeKey=function(e,t){return e.name+"_ib-"+t.toString()},t.prototype.getNodeAtIndex=function(e,t){if(0===this.inboundNodes.length)throw new h.RuntimeError("The layer has never been called and thus has no defined "+t+".");if(this.inboundNodes.length<=e)throw new h.ValueError("Asked to get "+t+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},t.prototype.getInputAt=function(e){return y.singletonOrArray(this.getNodeAtIndex(e,"input").inputTensors)},t.prototype.getOutputAt=function(e){return y.singletonOrArray(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new h.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new h.AttributeError("Layer "+this.name+" is not connected, no input to return.");return y.singletonOrArray(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new h.AttributeError("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new h.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return y.singletonOrArray(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map((function(e){return e()}))},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this._trainableWeights:[]},set:function(e){this._trainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._nonTrainableWeights:this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.assertInputCompatibility=function(e){if(e=y.toList(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=y.toList(this.inputSpec);if(e.length!==t.length)throw new h.ValueError("Layer "+this.name+" expects "+t.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(var n=0;n<e.length;n++){var r=e[n],o=t[n];if(null!=o){var l=r.rank;if(null!=o.ndim&&l!==o.ndim)throw new h.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+l);if(null!=o.maxNDim&&l>o.maxNDim)throw new h.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+l);if(null!=o.minNDim&&l<o.minNDim)throw new h.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+l+".");if(null!=o.dtype&&f.dtype(r)!==o.dtype){var c=f.dtype(r);throw new h.ValueError("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+c+".")}if(o.axes){var d=f.intShape(r);for(var m in o.axes){var v=Number(m),w=o.axes[m],x=v>=0?d[v]:d[d.length+v];if(null!=w&&-1===[w,null].indexOf(x))throw new h.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected axis "+v+" of input shape to have value "+w+" but got shape "+d+".")}}if(null!=o.shape){d=f.intShape(r);for(var i=0;i<o.shape.length;++i){var _=o.shape[i],N=d[i];if(null!=_&&null!=N&&_!==N)throw new h.ValueError("Input "+n+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape=${xShape}.")}}}}}},t.prototype.call=function(e,t){return e},t.prototype.invokeCallHook=function(e,t){null!=this._callHook&&this._callHook(e,t)},t.prototype.setCallHook=function(e){this._callHook=e},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(e,t){var n=this;t=t||{};for(var r=y.toList(e),o=!0,l=0,c=r;l<c.length;l++)if(!(c[l]instanceof m.SymbolicTensor)){o=!1;break}for(var d=!0,v=0,w=r;v<w.length;v++)if(w[v]instanceof m.SymbolicTensor){d=!1;break}if(o===d)throw new h.ValueError("Arguments to apply() must be all SymbolicTensors or all Tensors");return f.nameScope(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);for(var o=[],l=0,c=y.toList(e);l<c.length;l++){var v=c[l];o.push(f.intShape(v))}n.build(y.singletonOrArray(o)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights)}if(n.assertInputCompatibility(e),d){for(var output=n.call(e,t),w=[],x=0,_=y.toList(output);x<_.length;x++){var N=_[x];-1!==r.indexOf(N)&&(N=f.identity(N)),w.push(N)}if(output=y.singletonOrArray(w),null!=n.activityRegularizer)throw new h.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return output}var E=function(e){e=y.toList(e);for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];t.push(f.intShape(o))}return y.singletonOrArray(t)}(e),A=n.computeOutputShape(E);if(output=void 0,output=null!=A&&A.length>0&&Array.isArray(A[0])?A.map((function(r,o){return new m.SymbolicTensor("float32",r,n,y.toList(e),t,n.name,o)})):new m.SymbolicTensor("float32",A,n,y.toList(e),t,n.name),n.addInboundNode(e,output,null,null,E,A,t),null!=n.activityRegularizer)throw new h.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return output}))},t.prototype.build=function(e){this.built=!0},t.prototype.getWeights=function(e){return void 0===e&&(e=!1),w.batchGetValue(e?this.trainableWeights:this.weights)},t.prototype.setWeights=function(e){var t=this;c.tidy((function(){var n=t.weights;if(n.length!==e.length)throw new h.ValueError('You called setWeights(weights) on layer "'+t.name+'" with a weight list of length '+e.length+", but the layer was expecting "+n.length+" weights. Provided weights: "+e+"...");if(0!==n.length){for(var r=[],o=w.batchGetValue(n),i=0;i<o.length;++i){var l=o[i],p=n[i],f=e[i];if(!c.util.arraysEqual(l.shape,f.shape))throw new h.ValueError("Layer weight shape "+l.shape+" not compatible with provided weight shape "+f.shape);r.push([p,f])}w.batchSetValue(r)}}))},t.prototype.addWeight=function(e,t,n,r,o,l,c){if(-1!==this._addedWeightNames.indexOf(e))throw new h.ValueError("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),null==n&&(n=f.floatx());var d=new w.LayerVariable(r.apply(t,n),n,e,l,c);return null!=o&&this.addLoss((function(){return o.apply(d.read())})),null==l&&(l=!0),l?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d},t.prototype.addLoss=function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=y.toList(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,e))},t.prototype.computeOutputShape=function(e){return e},t.prototype.computeMask=function(e,mask){var t=this;if(!this.supportsMasking){if(null!=mask){if(!Array.isArray(mask))throw new TypeError("Layer "+this.name+" does not support masking,but was passed an inputMask.");mask.forEach((function(e){if(null!=e)throw new TypeError("Layer "+t.name+" does not support masking,but was passed an inputMask.")}))}return null}return mask},t.prototype.addInboundNode=function(e,t,n,r,o,l,c){void 0===c&&(c=null);var f=y.toList(e);t=y.toList(t),n=y.toList(n),r=y.toList(r),o=y.normalizeShapeList(o),l=y.normalizeShapeList(l);for(var h=[],d=[],m=[],v=0,w=f;v<w.length;v++){var x=w[v];h.push(x.sourceLayer),d.push(x.nodeIndex),m.push(x.tensorIndex)}new E({outboundLayer:this,inboundLayers:h,nodeIndices:d,tensorIndices:m,inputTensors:f,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:o,outputShapes:l},c);for(var i=0;i<t.length;i++)t[i].sourceLayer=this,t[i].nodeIndex=this.inboundNodes.length-1,t[i].tensorIndex=i},t.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e},l([c.doc({heading:"Models",subheading:"Classes"})],t.prototype,"apply",null),t=l([c.doc({heading:"Layers",subheading:"Classes",namespace:"layers"})],t)}(c.serialization.Serializable);n.Layer=O;var S=function(e){function t(t){var n=e.call(this,{dtype:t.dtype,name:null!=t.name?t.name:f.getUid("input").toString()})||this;if(null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new h.ValueError("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=t.batchInputShape;if(null==r){if(null==t.inputShape)throw new h.ValueError("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new h.ValueError("Cannot specify batchSize if batchInputShape isspecified when creating an InputLayer.");var o=t.dtype||f.floatx();n.batchInputShape=r,n.dtype=o,n.inputSpec=[{shape:r}];var l=new m.SymbolicTensor(n.dtype,n.batchInputShape,n,[],{},n.name);return l.nodeIndex=0,l.tensorIndex=0,new E({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[l],outputTensors:[l],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return o(t,e),t.prototype.apply=function(e,t){throw new h.ValueError("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(O);n.InputLayer=S,c.serialization.SerializationMap.register(S),n.Input=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new h.ValueError("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n=f.floatx()),new S({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]};var T=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var o=r.getClassName().toLowerCase();r.name=f.getUid(o)}if(r.supportsMasking=!1,r.trainable=!0,r.updatable=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],y.unique(r.inputs).length!==r.inputs.length)throw new h.ValueError("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map((function(e){return e.name})));y.unique(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map((function(e){return e.name}))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[];for(var l=0,c=r.outputs;l<c.length;l++){var d=(D=c[l]).sourceLayer,m=D.nodeIndex,v=D.tensorIndex;r.outputLayers.push(d),r.outputLayersNodeIndices.push(m),r.outputLayersTensorIndices.push(v)}for(var w=0,x=r.inputs;w<x.length;w++)d=(D=x[w]).sourceLayer,m=D.nodeIndex,v=D.tensorIndex,y.assert(0===m,"input layer has >1 nodes"),y.assert(0===v,"input layer has >1 tensors"),r.inputLayers.push(d),r.inputLayersNodeIndices.push(m),r.inputLayersTensorIndices.push(v);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var i=0;i<r.inputLayers.length;i++){if(!((d=r.inputLayers[i])instanceof S))throw new TypeError("Input layers to a Model must be InputLayer objects. Received inputs: "+n.inputs+". Input "+i+" (0-based) originates from layer type "+d.getClassName()+".");r.inputNames.push(d.name),r.feedInputShapes.push(d.batchInputShape),r.feedInputNames.push(d.name)}for(var _=0,N=r.outputLayers;_<N.length;_++)d=N[_],r.outputNames.push(d.name);r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));for(var A={},O={},T={},I={},k={},P=[],C=function(e,n,o,l,c,f){null!=l&&null!=c&&null!=f||(l=e.sourceLayer,c=e.nodeIndex,f=e.tensorIndex);var d=l.inboundNodes[c];if(-1!==o.indexOf(d))throw new h.RuntimeError("The tensor "+e.name+' at layer "'+l.name+'" is part of a cycle.');if(-1===n.indexOf(d)){r.containerNodes.add(t.nodeKey(l,c)),l.id in k||(k[l.id]=Object.keys(k).length),-1===o.indexOf(d)&&o.push(d);for(var m=d.inboundLayers.length,i=0;i<m;i++){var y=d.inputTensors[i],v=d.inboundLayers[i],w=d.nodeIndices[i],x=d.tensorIndices[i];C(y,n,o,v,w,x)}for(n.push(d);o.indexOf(d)>=0;)o.splice(o.indexOf(d),1);P.push(d)}},R=[],z=[],M=0,L=r.outputs;M<L.length;M++){var D=L[M];C(D,R,z)}for(var V=0,j=P.slice().reverse();V<j.length;V++){O[(ue=j[V]).id]=ue,ue.id in A||(A[ue.id]=0);var F=A[ue.id],B=null==T[ue.outboundLayer.id]?0:T[ue.outboundLayer.id];for(F=Math.max(F,B),T[ue.outboundLayer.id]=F,I[ue.outboundLayer.id]=ue.outboundLayer,A[ue.id]=F,i=0;i<ue.inboundLayers.length;i++){var U=ue.inboundLayers[i],G=(m=ue.nodeIndices[i],U.inboundNodes[m]),W=null==A[G.id]?0:A[G.id];A[G.id]=Math.max(F+1,W),O[G.id]=G}}var H={};for(var K in A)(F=A[K])in H||(H[F]=[]),H[F].push(O[K]);var X={};for(var Y in T)(F=T[Y])in X||(X[F]=[]),X[F].push(I[Y]);var J=Object.keys(X).map((function(e){return parseInt(e,10)})).sort(y.reverseNumberCompare);r.layers=[];for(var Z=0,Q=J;Z<Q.length;Z++){var $=X[F=Q[Z]];$.sort((function(a,b){var e=k[a.id],t=k[b.id];return e<t?-1:e>t?1:0}));for(var ee=0,te=$;ee<te.length;ee++)d=te[ee],r.layers.push(d)}r.layersByDepth=X,J=Object.keys(H).map((function(e){return parseInt(e,10)})).sort(y.reverseNumberCompare);for(var ne=r.inputs.slice(),re=[],ae=0,oe=J;ae<oe.length;ae++)for(var ie=0,se=H[F=oe[ae]];ie<se.length;ie++){var ue;if(null!=(d=(ue=se[ie]).outboundLayer)){for(var le=0,ce=ue.inputTensors;le<ce.length;le++)if(D=ce[le],-1===ne.indexOf(D))throw new h.RuntimeError("Graph disconnected: cannot obtain value for tensor "+D+' at layer "'+d.name+'". The following previous layers were accessed without issue: '+re);for(var pe=0,fe=ue.outputTensors;pe<fe.length;pe++)D=fe[pe],ne.push(D);re.push(d.name)}}r.nodesByDepth=H;for(var he=r.layers.map((function(e){return e.name})),de=function(e){var t=he.filter((function(t){return t===e})).length;if(1!==t)throw new h.RuntimeError('The name "'+e+'" is used '+t+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(he))},me=0,ge=he;me<ge.length;me++)de(ge[me]);return r.outboundNodes=[],r.inboundNodes=[],new E({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r}return o(t,e),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new h.ValueError("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var e=[],t=0,n=this.layers;t<n.length;t++){var r=n[t];e=e.concat(r.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var e=[],t=0,n=this.layers;t<n.length;t++){var r=n[t];e.push.apply(e,r.nonTrainableWeights)}if(!this.trainable){for(var o=[],l=0,c=this.layers;l<c.length;l++)r=c[l],o.push.apply(o,r.trainableWeights);return o.concat(e)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),n?k(e,this.layers):P(e,this.layers,t)},t.prototype.updatedConfig=function(){var e=this.getConfig();return{className:this.getClassName(),config:e,kerasVersion:"tfjs-layers "+x.version,backend:"TensorFlow.js"}},t.prototype.toJSON=function(e,t){void 0===t&&(t=!0);var n=v.convertTsToPythonic(this.updatedConfig());return t?JSON.stringify(n):n},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var r;return e=y.toList(e),r="mask"in t?y.toList(t.mask):y.pyListRepeat(null,e.length),n.runInternalGraph(e,r)[0]}))},t.prototype.computeMask=function(e,mask){var t=this;return c.tidy((function(){var n;return e=y.toList(e),n=null==mask?y.pyListRepeat(null,e.length):y.toList(mask),t.runInternalGraph(e,n)[1]}))},t.prototype.computeOutputShape=function(e){var t=y.normalizeShapeList(e);if(t.length!==this.inputLayers.length)throw new h.ValueError("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},i=0;i<t.length;i++){var r=this.inputLayers[i],o=t[i];n[C=r.name+"_0_0"]=o}var l=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(y.reverseNumberCompare);if(l.length>1)for(var c=0,f=l;c<f.length;c++)for(var d=f[c],m=0,v=this.nodesByDepth[d];m<v.length;m++){var w=v[m];if(r=w.outboundLayer,-1===this.inputLayers.map((function(e){return e.id})).indexOf(r.id)){for(var x=[],_=0;_<w.inboundLayers.length;_++){var N=w.inboundLayers[_],E=w.nodeIndices[_],A=w.tensorIndices[_],O=n[C=N.name+"_"+E+"_"+A];x.push(O)}var S=r.computeOutputShape(y.singletonOrArray(x)),T=y.normalizeShapeList(S),I=r.inboundNodes.indexOf(w);for(_=0;_<T.length;_++)n[C=r.name+"_"+I+"_"+_]=T[_]}}var k=[],P=[];for(i=0;i<this.outputLayers.length;i++){r=this.outputLayers[i],I=this.outputLayersNodeIndices[i],A=this.outputLayersTensorIndices[i];var C=r.name+"_"+I+"_"+A;P.push(C)}for(i=0;i<P.length;i++){var R=P[i];y.assert(R in n),k.push(n[R])}return y.singletonOrArray(k)},t.prototype.runInternalGraph=function(e,t){null==t&&(t=y.pyListRepeat(null,e.length));for(var n={},i=0;i<this.inputs.length;++i){var r=this.inputs[i],o=e[i],mask=t[i];n[r.id]=[o,mask]}for(var l=0,c=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(y.reverseNumberCompare);l<c.length;l++)for(var f=c[l],d=0,m=this.nodesByDepth[f];d<m.length;d++){for(var v=m[d],w=v.outboundLayer,x=v.inputTensors,_=v.outputTensors,N=new Array,E=0,A=x;E<A.length;E++)(r=A[E]).id in n&&N.push(n[r.id]);if(N.length===x.length){var O={},S=void 0,T=void 0,I=void 0,k=void 0;if(null!=v.callArgs&&(O=v.callArgs),1===N.length){var P=N[0],C=P[0],R=P[1];null==O.mask&&(O.mask=R),I=y.toList(w.call(C,O)),k=y.toList(w.computeMask(C,R)),S=[C],T=[R]}else S=N.map((function(e){return e[0]})),T=N.map((function(e){return e[1]})),null==O.mask&&(O.mask=T),I=y.toList(w.call(S,O)),k=y.toList(w.computeMask(S,T));if(w.activityRegularizer)throw new h.NotImplementedError("Model invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(i=0;i<_.length;++i)r=_[i],o=I[i],mask=k[i],n[r.id]=[o,mask]}}for(var z=[],M=[],L=[],D=0,V=this.outputs;D<V.length;D++){r=V[D],y.assert(r.id in n,"Could not compute output "+r.name+" : "+r.id);var j=n[r.id],F=j[0];mask=j[1],L.push(F.shape),z.push(F),M.push(mask)}return[z,M,L]},t.prototype.buildNodeConversionMap=function(e){for(var n,r={},o=0,l=this.layers;o<l.length;o++){var c=l[o];n=c instanceof t?1:0;for(var f=0;f<c.inboundNodes.length;f++){var h=t.nodeKey(c,f);h in this.containerNodes&&(r[h]=n,n+=1)}}return r},t.prototype.getLayer=function(e,t){if(null!=t){if(this.layers.length<=t)throw new h.ValueError("Was asked to retrieve layer at index "+t+", but model only has "+this.layers.length+" layer(s).");return this.layers[t]}if(null==e)throw new h.ValueError("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var o=r[n];if(o.name===e)return o}throw new h.ValueError("No such layer: "+e)},t.prototype.calculateLosses=function(){var e=this;return c.tidy((function(){for(var n=[],r=0,o=e.layers;r<o.length;r++)for(var l=o[r],c=0;c<l.inboundNodes.length;++c){var f=t.nodeKey(l,c);e.containerNodes.has(f)&&n.push.apply(n,l.calculateLosses())}return n}))},t.prototype.getConfig=function(){for(var e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],o=0,l=this.layers;o<l.length;o++){for(var c=(A=l[o]).getClassName(),f=A.getConfig(),h=[],d=0;d<A.inboundNodes.length;d++){var m=A.inboundNodes[d],y=t.nodeKey(A,d),v={};if(this.containerNodes.has(y)&&(m.callArgs&&(-1===JSON.stringify(m.callArgs).indexOf("undefined")?v=m.callArgs:(console.warn("Layer "+A.name+" was passed non-serializable keyword arguments: "+m.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),v={})),m.inboundLayers.length>0)){for(var w=[],i=0;i<m.inboundLayers.length;i++){var x=m.inboundLayers[i],_=m.nodeIndices[i],N=m.tensorIndices[i];null==(S=n[t.nodeKey(x,_)])&&(S=0),w.push([x.name,S,N,v])}h.push(w)}}r.push({name:A.name,className:c,config:f,inboundNodes:h})}e.layers=r;var E=[];for(i=0;i<this.inputLayers.length;i++){var A=this.inputLayers[i];_=this.inputLayersNodeIndices[i],y=t.nodeKey(A,_),this.containerNodes.has(y)&&(null==(S=n[y])&&(S=0),N=this.inputLayersTensorIndices[i],E.push([A.name,S,N]))}e.inputLayers=E;var O=[];for(i=0;i<this.outputLayers.length;i++){var S;if(A=this.outputLayers[i],_=this.outputLayersNodeIndices[i],y=t.nodeKey(A,_),this.containerNodes.has(y))null==(S=n[y])&&(S=0),N=this.outputLayersTensorIndices[i],O.push([A.name,S,N])}return e.outputLayers=O,e},t.fromConfig=function(e,t){var n={},r={};function o(e,t){e.name in r?r[e.name].push(t):r[e.name]=[t]}function l(e,t){for(var r,l=[],c=0,f=t;c<f.length;c++){var d=f[c],m=d[0],v=d[1],w=d[2];if(3===d.length)r={};else{if(4!==d.length)throw new h.ValueError("Improperly formatted model config for layer "+JSON.stringify(e)+": "+JSON.stringify(d));r=d[3]}if(!(m in n))return void o(e,t);var x=n[m];if(x.inboundNodes.length<=v)return void o(e,t);var _=x.inboundNodes[v];l.push(_.outputTensors[w])}l.length>0&&e.apply(y.singletonOrArray(l),r)}function c(e){var r=e.name,l=d.deserialize(e,null!=t.customObjects?t.customObjects:{});n[r]=l;for(var c=0,f=e.inboundNodes;c<f.length;c++){var m=f[c];if(!(m instanceof Array))throw new h.ValueError("Corrupted configuration, expected array for nodeData: "+m);o(l,m)}}for(var f=t.name,m=t.layers,v=0,w=m;v<w.length;v++)c(N=w[v]);for(;!y.isObjectEmpty(r);)for(var x=0,_=m;x<_.length;x++){var N=_[x];if((L=n[N.name]).name in r){for(var E=0,A=r[L.name];E<A.length;E++)l(L,A[E]);delete r[L.name]}}for(var O=[],S=[],T=0,I=t.inputLayers;T<I.length;T++){var k=(N=I[T])[0],P=N[1],C=N[2];y.assert(k in n);var R=(L=n[k]).inboundNodes[P].outputTensors;O.push(R[C])}for(var z=0,M=t.outputLayers;z<M.length;z++){var L;k=(N=M[z])[0],P=N[1],C=N[2],y.assert(k in n),R=(L=n[k]).inboundNodes[P].outputTensors,S.push(R[C])}return new e({inputs:O,outputs:S,name:f})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new h.ValueError("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var e=0,t=this.layers;e<t.length;e++)if(t[e].stateful)return!0;return!1},enumerable:!0,configurable:!0}),l([c.doc({heading:"Layers",subheading:"Classes",namespace:"layers",subclasses:["Model"]})],t.prototype,"getLayer",null),t}(O);function I(e,t,n,r){if(!n.startsWith("2."))throw new h.ValueError("Unsupported Keras version in weights being loaded: "+n);return t}function k(e,t){for(var n={},r=0,o=0,l=t;o<l.length;o++)for(var c=0,f=l[o].weights;c<f.length;c++){var d=f[c];if(null!=n[d.originalName])throw new h.ValueError("Duplicate weight name: "+d.originalName);n[d.originalName]=d,r++}var m=[];for(var y in e)m.push([n[y],e[y]]),delete n[y];var v=[];for(var x in n)v.push(x);if(v.length>0)throw new h.ValueError(v.length+" of "+r+" weights are not set: "+v);w.batchSetValue(m)}function P(e,t,n){void 0===n&&(n=!1);for(var r=e.keras_version,o=(e.backend,t.map((function(e){return e.name}))),l={},f=0,d=t;f<d.length;f++)null!=(z=d[f]).name&&(null==l[z.name]&&(l[z.name]=[]),l[z.name].push(z));for(var m,v,x,_,N=e.weights,E=[],A=0;A<o.length;++A){var O=o[A],S=N[O];null==S&&(S=[]);for(var T=[],k=0;k<S.length;++k){var P=S[k];T.push(new w.LayerVariable((m=P.dtype,v=P.shape,x=P.value,_=void 0,_=y.stringToDType(m),c.Tensor.make(v,{values:0===v.length?x:c.util.flatten(x)},_))))}for(var C=0,R=l[O];C<R.length;C++){var z,M=(z=R[C]).weights;if((T=I(0,T,r)).length!==M.length){if(!n)throw new h.ValueError("Layer #"+A+' (named "'+z.name+'") expects '+M.length+" weight(s), but the saved weights have "+T.length+" element(s).");console.warn("Skipping loading of weights of layer "+z.name+" due to mismatch in number of weights: ("+T.length+" vs "+M.length+").")}for(var i=0;i<T.length;++i)!n||c.util.arraysEqual(M[i].shape,T[i].shape)?E.push([M[i],T[i].read()]):console.warn("Skipping loading of weights for layer "+z.name+" due to mismatch in shape ("+M[i].shape+" vs "+T[i].shape+")")}}w.batchSetValue(E)}n.Container=T,n.getSourceInputs=function e(t,n,r){if((null==n||null!=r&&r>0)&&(n=t.sourceLayer,r=t.nodeIndex),0===n.inboundNodes.length)return[t];var o=n.inboundNodes[r];if(0===o.inboundLayers.length)return o.inputTensors;for(var l=[],i=0;i<o.inboundLayers.length;i++)for(var c=0,f=e(o.inputTensors[i],o.inboundLayers[i],o.nodeIndices[i]);c<f.length;c++){var h=f[c];-1===l.indexOf(h)&&l.push(h)}return l},n.loadWeightsFromNamedTensorMap=k,n.loadWeightsFromJson=P},{"../backend/tfjs_backend":158,"../errors":165,"../layers/serialization":179,"../types":186,"../utils/generic_utils":188,"../utils/serialization_utils":190,"../variables":191,"../version":192,"@tensorflow/tfjs-core":50}],164:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},f=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var h=e("@tensorflow/tfjs-core"),d=e("@tensorflow/tfjs-core"),m=e("../backend/tfjs_backend"),y=e("../callbacks"),v=e("../errors"),w=e("../losses"),x=e("../metrics"),_=e("../optimizers"),N=e("../utils/generic_utils"),E=e("../utils/math_utils"),A=e("./executor"),O=e("./topology");function S(e){return e instanceof d.Tensor}function T(e){return Array.isArray(e)}function I(e){return!S(e)&&!T(e)}function k(data,e,t,n,r){if(void 0===n&&(n=!0),void 0===r&&(r=""),null==e||0===e.length){if(null!=data){var o=!1;if(T(data)&&data.length>0)o=!0;else if(I(data)){for(var l in data)if(data.hasOwnProperty(l)){o=!0;break}}else o=!0;if(o)throw new v.ValueError("Error when checking model "+r+" expected no data, but got "+data)}return[]}if(null==data)return e.map((function(e){return null}));var c;if(I(data)){data=data,c=[];for(var f=0,h=e;f<h.length;f++){var d=h[f];if(null==data[d])throw new v.ValueError('No data provided for "'+d+'". Need data for each key in: '+e);c.push(data[d])}}else if(T(data)){if((data=data).length!==e.length)throw new v.ValueError("Error when checking model "+r+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+data);c=data}else{if(data=data,e.length>1)throw new v.ValueError("The model "+r+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+data.shape);c=[data]}for(var i=0;i<e.length;++i)1===(y=c[i]).shape.length&&(c[i]=m.expandDims(y,1));if(null!=t)for(i=0;i<e.length;++i)if(null!=t[i]){var y;if((y=c[i]).shape.length!==t[i].length)throw new v.ValueError("Error when checking "+r+": expected "+e[i]+" to have "+t[i].length+" dimension(s). but got array with shape "+y.shape);for(var w=0;w<t[i].length;++w)if(0!==w||n){var x=y.shape[w],_=t[i][w];if(null!=_&&_>=0&&x!==_)throw new v.ValueError("Error when checking "+r+": expected "+e[i]+" to have shape ["+t[i]+"], but got array with shape ["+y.shape+"].")}}return c}function P(e,t,n){var r=N.unique(e.map((function(input){return input.shape[0]})));r.sort();var o=N.unique(t.map((function(e){return e.shape[0]})));if(o.sort(),r.length>1)throw new v.ValueError("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(input){return input.shape}))));if(o.length>1)throw new v.ValueError("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map((function(e){return e.shape}))));if(r.length>0&&o.length>0&&!d.util.arraysEqual(r,o))throw new v.ValueError("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+o[0]+" target sample(s).")}function C(e,t){for(var output=[],n=0,r=null;n<e;)(r=n+t)>=e&&(r=e),output.push([n,r]),n=r;return output}function R(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return m.sliceAlongFirstAxis(e,t,n-t)})):m.sliceAlongFirstAxis(e,t,n-t)}function z(e,t){return null==e?null:Array.isArray(e)?e.map((function(e){return z(e,t)})):m.gather(e,"int32"===t.dtype?t:t.toInt())}function M(data,e,t,n,r){var o;if(void 0===n&&(n=!0),void 0===r&&(r=""),Array.isArray(data)){if(data.length!==e.length)throw new v.ValueError("Error when checking model "+r+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+data.length+" Tensors(s).");o=data}else{if(e.length>1)throw new v.ValueError("The model expects "+e.length+" "+r+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(data.shape)+".");o=[data]}if(null!=t)for(var i=0;i<e.length;++i)if(null!=t[i]){var l=o[i];if(l.shape.length!==t[i].length)throw new v.ValueError("Error when checking "+r+": expected "+e[i]+" to have "+t[i].length+" dimension(s), but got array with shape "+JSON.stringify(l.shape));for(var c=0;c<t[i].length;++c)if(0!==c||n){var f=l.shape[c],h=t[i][c];if(null!=h&&h!==f)throw new v.ValueError("Error when checking "+r+": expected "+e[i]+" to have shape "+JSON.stringify(t[i])+" but got array with shape "+JSON.stringify(l.shape)+".")}}}n.isDataTensor=S,n.isDataArray=T,n.isDataDict=I,n.standardizeInputData=k,n.checkArrayLengths=P,n.makeBatches=C,n.sliceArraysByIndices=z,function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(n.ModelLoggingVerbosity||(n.ModelLoggingVerbosity={}));var L=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.compile=function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer=_.getOptimizer(e.optimizer);else{if(!(e.optimizer instanceof d.Optimizer))throw new v.ValueError("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer=e.optimizer}var n=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new v.ValueError("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+e.loss+".");var r=e.loss;n=r.map((function(e){return w.get(e)}))}else{var o=w.get(e.loss);this.outputs.map((function(e){n.push(o)}))}else{for(var l in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(l))throw new v.ValueError('Unknown entry in loss dictionary: "'+l+'". Only expect the following keys: '+this.outputNames);for(var c in this.outputNames)null==e.loss[c]&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),n.push(w.get(e.loss[c]))}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var i=0;i<this.outputs.length;++i){var f=this.internalOutputShapes[i],h=this.outputNames[i];this.feedOutputNames.push(h),this.feedOutputShapes.push(f),this.feedLossFns.push(this.lossFunctions[i])}var y=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],m.nameScope("loss",(function(){for(var i=0;i<t.outputs.length;++i)if(-1===y.indexOf(i)){var e=t.lossFunctions[i];t.outputs.length>1&&(t.metricsTensors.push([e,i]),t.metricsNames.push(t.outputNames[i]+"_loss"))}}));var N=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));if(Array.isArray(e))return t.map((function(t){return e}));if(null!=e){for(var n=[],r=0,o=t;r<o.length;r++){var l=o[r],c=e.hasOwnProperty(l)?e[l]:[];Array.isArray(c)||(c=[c]),n.push(c)}return n}throw new TypeError("Type of metrics argument not understood. Expected an Array or Object, found: "+e)}(e.metrics,this.outputNames);m.nameScope("metric",(function(){for(var e=function(i){if(-1!==y.indexOf(i))return"continue";!function(e){for(var n,r,o,l=function(e){if(-1!==["accuracy","acc","crossentropy","ce"].indexOf(e)){var l=t.internalOutputShapes[i];1===l[l.length-1]||t.lossFunctions[i]===w.binaryCrossentropy?-1!==["accuracy","acc"].indexOf(e)?r=x.binaryAccuracy:-1!==["crossentropy","ce"].indexOf(e)&&(r=x.binaryCrossentropy):t.lossFunctions[i]===w.sparseCategoricalCrossentropy?-1!==["accuracy","acc"].indexOf(e)?r=x.sparseCategoricalAccuracy:-1!==["crossentropy","ce"].indexOf(e)&&(r=x.sparseCategoricalCrossentropy):-1!==["accuracy","acc"].indexOf(e)?r=x.categoricalAccuracy:-1!==["crossentropy","ce"].indexOf(e)&&(r=x.categoricalCrossentropy);var c=void 0;-1!==["accuracy","acc"].indexOf(e)?c="acc":-1!==["crossentropy","ce"].indexOf(e)&&(c="ce"),o=r,n=""+c}else{var f=x.get(e);o=f,n=""+e}var h;m.nameScope(n,(function(){h=o})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(i,n,h)},c=0,f=e;c<f.length;c++)l(f[c])}(N[i])},i=0;i<t.outputs.length;++i)e(i)})),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(e,t,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize,o=this.standardizeUserData(e,t,!0,r),ins=o[0].concat(o[1]);this.makeTestFunction();var l=this.testFunction,c=this.testLoop(l,ins,r,n.verbose,n.steps);return N.singletonOrArray(c)},t.prototype.checkNumSamples=function(ins,e,t,n){var r;if(void 0===n&&(n="steps"),null!=t){if(r=null,null!=e)throw new v.ValueError("If "+n+" is set, batchSize must be null or undefined.Got batchSize = "+e)}else{if(null==ins)throw new v.ValueError("Either the input data should have a defined shape, or "+n+" shoud be specified.");r=Array.isArray(ins)?ins[0].shape[0]:ins.shape[0]}return r},t.prototype.predictLoop=function(ins,e,t){var n=this;void 0===e&&(e=32),void 0===t&&(t=!1);var r=this.checkNumSamples(ins);if(t)throw new v.NotImplementedError("Verbose predictLoop() is not implemented yet.");for(var o=C(r,e),l=[],c=function(e){var t=h.tidy((function(){var t=o[e][0],r=o[e][1],l=R(ins,t,r),c=[];if(Array.isArray(l))for(var i=0;i<l.length;++i)c.push({key:n.inputs[i],value:l[i]});else c.push({key:n.inputs[0],value:l});var f=new A.FeedDict(c);return A.execute(n.outputs,f)}));if(0===e)for(var r=0,c=t;r<c.length;r++){var f=c[r];l.push(f)}else for(var i=0;i<t.length;++i)l[i]=m.concatAlongFirstAxis(l[i],t[i])},f=0;f<o.length;++f)c(f);return N.singletonOrArray(l)},t.prototype.predict=function(e,t){void 0===t&&(t={}),M(e,this.inputNames,this.feedInputShapes,!1);var n=null==t.batchSize?32:t.batchSize;return this.predictLoop(e,n)},t.prototype.predictOnBatch=function(e){return M(e,this.inputNames,this.feedInputShapes,!0),this.predictLoop(e,e.shape[0])},t.prototype.standardizeUserData=function(e,t,n,r){if(void 0===n&&(n=!0),null==this.optimizer)throw new v.RuntimeError("You must compile a model before training/testing. Use Model.compile(modelCompileConfig).");for(var o=[],i=0;i<this.feedOutputShapes.length;++i){var l=this.feedOutputShapes[i];this.feedLossFns[i]===w.sparseCategoricalCrossentropy?o.push(l.slice(0,l.length-1).concat([1])):o.push(l)}if(P(e=k(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=k(t,this.feedOutputNames,o,!1,"target")),function(e,t,n){for(var r=[w.meanSquaredError,w.binaryCrossentropy,w.categoricalCrossentropy],i=0;i<e.length;++i){var o=e[i],l=t[i],c=n[i];if(null!=l){if(l===w.categoricalCrossentropy&&1===o.shape[o.shape.length-1])throw new v.ValueError("You are passing a target array of shape "+o.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(l))for(var f=o.shape.slice(1),h=c.slice(1),d=0;d<f.length;++d){var m=f[d],y=h[d];if(null!=y&&m!==y)throw new v.ValueError("A target Tensor with shape "+o.shape+" was passed for an output of shape "+c+", while using a loss function that expects targets to have the same shape as the output.")}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&e[0].shape[0]%r!=0)throw new v.ValueError("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+e[0].shape[0]+" sample(s).");return[e,t,null]},t.prototype.fitLoop=function(e,ins,t,n,r,o,l,w,x,_,N,A,O,S){return void 0===A&&(A=0),c(this,void 0,void 0,(function(){var c,T,I,k,P,R,M=this;return f(this,(function(L){switch(L.label){case 0:if(null==n&&(n=32),null==r&&(r=1),null==_&&(_=!0),null==A&&(A=0),c=!1,null!=w&&null!=x&&(c=!0),null!=S&&(c=!0,null==O))throw new v.ValueError("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");if(null!=(T=this.checkNumSamples(ins,n,O,"steps_per_epoch"))&&(I=E.range(0,T)),this.history=new y.History,l=(l=null==l?[new y.BaseLogger]:[new y.BaseLogger].concat(l)).concat([this.history]),o>0)throw new v.NotImplementedError("Verbose mode is not implemented yet.");return(k=new y.CallbackList(l)).setModel(this),k.setParams({epochs:r,steps:O,verbose:o,doValidation:c,metrics:N}),[4,k.onTrainBegin()];case 1:L.sent(),P=function(r){var o,l,N,E,A;return f(this,(function(S){switch(S.label){case 0:return[4,k.onEpochBegin(r)];case 1:if(S.sent(),o={},null==O)return[3,2];throw new v.NotImplementedError("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===_)throw new v.NotImplementedError("batch shuffling is not implemneted yet");_&&d.util.shuffle(I),l=d.tensor1d(I),N=C(T,n),E=function(r){var d;return f(this,(function(f){switch(f.label){case 0:return d={},[4,k.onBatchBegin(r,d)];case 1:return f.sent(),h.tidy((function(){var f=N[r][0],y=N[r][1],v=m.sliceAlongFirstAxis(l,f,y-f);d.batch=r,d.size=y-f;for(var _=z(ins,v),E=e(_),i=0;i<t.length;++i){var label=t[i],A=E[i];d[label]=A,h.keep(A)}if(r===N.length-1&&c){var O=M.testLoop(w,x,n);for(i=0;i<t.length;++i)label=t[i],A=O[i],h.keep(A),o["val_"+label]=A}})),[4,k.onBatchEnd(r,d)];case 2:return f.sent(),y.disposeTensorsInLogs(d),[2]}}))},A=0,S.label=3;case 3:return A<N.length?[5,E(A)]:[3,6];case 4:S.sent(),S.label=5;case 5:return++A,[3,3];case 6:l.dispose(),S.label=7;case 7:return[4,k.onEpochEnd(r,o)];case 8:return S.sent(),[2]}}))},R=A,L.label=2;case 2:return R<r?[5,P(R)]:[3,5];case 3:L.sent(),L.label=4;case 4:return++R,[3,2];case 5:return[4,k.onTrainEnd()];case 6:return L.sent(),[4,this.history.syncData()];case 7:return L.sent(),[2,this.history]}}))}))},t.prototype.testLoop=function(e,ins,t,n,r){void 0===n&&(n=0);var o=this.checkNumSamples(ins,t,r,"steps"),l=[];if(1===n)throw new v.NotImplementedError("Verbose mode is not implemented yet.");if(null!=r)throw new v.NotImplementedError("steps mode in testLoop() is not implemented yet");for(var c=C(o,t),f=d.tensor1d(E.range(0,o)),y=0;y<c.length;++y){var w=c[y][0],x=c[y][1],_=e(z(ins,m.sliceAlongFirstAxis(f,w,x-w)));if(0===y)for(var i=0;i<_.length;++i)l.push(m.getScalar(0));for(i=0;i<_.length;++i){var N=_[i];l[i]=h.add(l[i],m.scalarTimesArray(m.getScalar(x-w),N))}}for(i=0;i<l.length;++i)l[i]=h.div(l[i],m.getScalar(o));return l},t.prototype.getDedupedMetricsNames=function(){for(var e=this.metricsNames,t=[],i=0;i<e.length;++i){var label=e[i],n=label;N.count(e,label)>1&&(n+="_"+N.count(e.slice(0,i),label)),t.push(n)}return t},t.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(data){return h.tidy((function(){for(var t,n=[],r=data.slice(0,e.inputs.length),o=data.slice(e.inputs.length,e.inputs.length+e.outputs.length),l=[],i=0;i<e.inputs.length;++i)l.push({key:e.inputs[i],value:r[i]});var c=new A.FeedDict(l),f=A.execute(e.outputs,c);for(i=0;i<e.lossFunctions.length;++i){var d=e.lossFunctions[i],m=h.mean(d(o[i],f[i]));t=0===i?m:h.add(t,m),n.push(t)}for(i=0;i<e.metricsTensors.length;++i){var y=e.metricsTensors[i][0],v=e.metricsTensors[i][1],w=h.mean(y(o[v],f[v]));n.push(w)}return n}))}},t.prototype.fit=function(e,t,n){return void 0===n&&(n={}),c(this,void 0,void 0,(function(){var r,o,l,c,d,m,w,x,_,N,E,ins,O,S,T,I,k,P=this;return f(this,(function(f){if(r=null==n.batchSize?32:n.batchSize,o=this.standardizeUserData(e,t,!1,r),l=o[0],c=o[1],d=!1,null!=n.validationData&&n.validationData.length>0){if(d=!0,2!==n.validationData.length)throw 3===n.validationData.length?new v.NotImplementedError("validationData including sample weights is not supported yet."):new v.ValueError("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+n.validationData+" is invalid.");m=n.validationData[0],w=n.validationData[1],_=this.standardizeUserData(m,w,!0,r),m=_[0],w=_[1],x=m.concat(w)}else null!=n.validationSplit&&n.validationSplit>0&&n.validationSplit<1?(d=!0,N=Math.floor(l[0].shape[0]*(1-n.validationSplit)),E=l[0].shape[0],m=R(l,N,E),l=R(l,0,N),w=R(c,N,E),c=R(c,0,N),x=m.concat(w)):null!=n.validationSteps&&(d=!0);return ins=l.concat(c),this.checkTrainableWeightsConsistency(),O=function(data){var e=[],t=[],n=data.slice(0,P.inputs.length),r=data.slice(P.inputs.length,P.inputs.length+P.outputs.length),o=[],l=P.collectedTrainableWeights.map((function(param){return param.read()}));return[P.optimizer.minimize((function(){for(var l=[],i=0;i<P.inputs.length;++i)l.push({key:P.inputs[i],value:n[i]});var c,f=new A.FeedDict(l),d=A.execute(P.outputs,f,{training:!0});for(i=0;i<P.lossFunctions.length;++i){var m=(0,P.lossFunctions[i])(r[i],d[i]);e.push(m);var y=h.mean(m);t.push(y),c=0===i?m:h.add(c,m)}for(i=0;i<P.metricsTensors.length;++i){var v=P.metricsTensors[i][0],w=P.metricsTensors[i][1],x=h.mean(v(r[w],d[w]));h.keep(x),o.push(x)}return c=h.mean(c),P.calculateLosses().forEach((function(e){c=h.add(c,e)})),c}),!0,l)].concat(o)},S=this.getDedupedMetricsNames(),d?(this.makeTestFunction(),T=this.testFunction,I=S.slice().concat(S.map((function(e){return"val_"+e})))):(T=null,x=[],I=S.slice()),k=y.standardizeCallbacks(n.callbacks),[2,this.fitLoop(O,ins,S,r,n.epochs,n.verbose,k,T,x,n.shuffle,I,null,null,null)]}))}))},t.prototype.getNamedWeights=function(e){for(var t={},n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,o=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||(t[r[i].originalName]=o[i]);return t},t.prototype.save=function(e,t){return c(this,void 0,void 0,(function(){var n,r,o;return f(this,(function(l){switch(l.label){case 0:if("string"==typeof e){if(0===(n=d.io.getSaveHandlers(e)).length)throw new v.ValueError("Cannot find any save handlers for URL '"+e+"'");if(n.length>1)throw new v.ValueError("Found more than one ("+n.length+") save handlers for URL '"+e+"'");e=n[0]}if(null==e.save)throw new v.ValueError("Model.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,d.io.encodeWeights(this.getNamedWeights(t))];case 1:return r=l.sent(),o=this.toJSON(null,!1),[2,e.save({modelTopology:o,weightData:r.data,weightSpecs:r.specs})]}}))}))},t.className="Model",l([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[0]})],t.prototype,"compile",null),l([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"evaluate",null),l([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[1]})],t.prototype,"predict",null),l([d.doc({heading:"Models",subheading:"Classes"})],t.prototype,"predictOnBatch",null),l([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"fit",null),t=l([d.doc({heading:"Models",subheading:"Classes"})],t)}(O.Container);n.Model=L,d.serialization.SerializationMap.register(L)},{"../backend/tfjs_backend":158,"../callbacks":159,"../errors":165,"../losses":181,"../metrics":182,"../optimizers":184,"../utils/generic_utils":188,"../utils/math_utils":189,"./executor":162,"./topology":163,"@tensorflow/tfjs-core":50}],165:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);n.AttributeError=l;var c=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);n.RuntimeError=c;var f=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);n.ValueError=f;var h=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);n.NotImplementedError=h;var d=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);n.AssertionError=d;var m=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return o(t,e),t}(Error);n.IndexError=m},{}],166:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("@tensorflow/tfjs-core"),l=e("./constraints"),c=e("./engine/topology"),f=e("./engine/training"),h=e("./initializers"),d=e("./layers/advanced_activations"),m=e("./layers/convolutional"),y=e("./layers/convolutional_depthwise"),v=e("./layers/core"),w=e("./layers/embeddings"),x=e("./layers/merge"),_=e("./layers/normalization"),N=e("./layers/padding"),E=e("./layers/pooling"),A=e("./layers/recurrent"),O=e("./layers/wrappers"),S=e("./losses"),T=e("./metrics"),I=e("./models"),k=e("./regularizers"),P=function(){function e(){}return e.model=function(e){return new f.Model(e)},e.sequential=function(e){return new I.Sequential(e)},e.loadModel=function(e){return I.loadModelInternal(e)},e.input=function(e){return c.Input(e)},r([o.doc({heading:"Models",subheading:"Creation",configParamIndices:[0]})],e,"model",null),r([o.doc({heading:"Models",subheading:"Creation",configParamIndices:[0]})],e,"sequential",null),r([o.doc({heading:"Models",subheading:"Loading",useDocsFrom:"loadModelInternal"})],e,"loadModel",null),r([o.doc({heading:"Models",subheading:"Inputs",useDocsFrom:"Input",configParamIndices:[0]})],e,"input",null),e}();n.ModelExports=P;var C=function(){function e(){}return e.inputLayer=function(e){return new c.InputLayer(e)},e.elu=function(e){return new d.ELU(e)},e.leakyReLU=function(e){return new d.LeakyReLU(e)},e.softmax=function(e){return new d.Softmax(e)},e.thresholdedReLU=function(e){return new d.ThresholdedReLU(e)},e.conv1d=function(e){return new m.Conv1D(e)},e.conv2d=function(e){return new m.Conv2D(e)},e.conv2dTranspose=function(e){return new m.Conv2DTranspose(e)},e.separableConv2d=function(e){return new m.SeparableConv2D(e)},e.cropping2D=function(e){return new m.Cropping2D(e)},e.depthwiseConv2d=function(e){return new y.DepthwiseConv2D(e)},e.activation=function(e){return new v.Activation(e)},e.dense=function(e){return new v.Dense(e)},e.dropout=function(e){return new v.Dropout(e)},e.flatten=function(e){return new v.Flatten(e)},e.repeatVector=function(e){return new v.RepeatVector(e)},e.reshape=function(e){return new v.Reshape(e)},e.embedding=function(e){return new w.Embedding(e)},e.add=function(e){return new x.Add(e)},e.average=function(e){return new x.Average(e)},e.concatenate=function(e){return new x.Concatenate(e)},e.maximum=function(e){return new x.Maximum(e)},e.minimum=function(e){return new x.Minimum(e)},e.multiply=function(e){return new x.Multiply(e)},e.batchNormalization=function(e){return new _.BatchNormalization(e)},e.zeroPadding2d=function(e){return new N.ZeroPadding2D(e)},e.averagePooling1d=function(e){return new E.AveragePooling1D(e)},e.avgPool1d=function(t){return e.averagePooling1d(t)},e.avgPooling1d=function(t){return e.averagePooling1d(t)},e.averagePooling2d=function(e){return new E.AveragePooling2D(e)},e.avgPool2d=function(t){return e.averagePooling2d(t)},e.avgPooling2d=function(t){return e.averagePooling2d(t)},e.globalAveragePooling1d=function(e){return new E.GlobalAveragePooling1D(e)},e.globalAveragePooling2d=function(e){return new E.GlobalAveragePooling2D(e)},e.globalMaxPooling1d=function(e){return new E.GlobalMaxPooling1D(e)},e.globalMaxPooling2d=function(e){return new E.GlobalMaxPooling2D(e)},e.maxPooling1d=function(e){return new E.MaxPooling1D(e)},e.maxPooling2d=function(e){return new E.MaxPooling2D(e)},e.gru=function(e){return new A.GRU(e)},e.gruCell=function(e){return new A.GRUCell(e)},e.lstm=function(e){return new A.LSTM(e)},e.lstmCell=function(e){return new A.LSTMCell(e)},e.simpleRNN=function(e){return new A.SimpleRNN(e)},e.simpleRNNCell=function(e){return new A.SimpleRNNCell(e)},e.rnn=function(e){return new A.RNN(e)},e.stackedRNNCells=function(e){return new A.StackedRNNCells(e)},e.bidirectional=function(e){return new O.Bidirectional(e)},e.timeDistributed=function(e){return new O.TimeDistributed(e)},e.Layer=c.Layer,e.RNN=A.RNN,e.RNNCell=A.RNNCell,e.input=P.input,r([o.doc({heading:"Layers",subheading:"Inputs",namespace:"layers",useDocsFrom:"InputLayer",configParamIndices:[0]})],e,"inputLayer",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ELU",configParamIndices:[0]})],e,"elu",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"LeakyReLU",configParamIndices:[0]})],e,"leakyReLU",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"Softmax",configParamIndices:[0]})],e,"softmax",null),r([o.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ThresholdedReLU",configParamIndices:[0]})],e,"thresholdedReLU",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv1D",configParamIndices:[0]})],e,"conv1d",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2D",configParamIndices:[0]})],e,"conv2d",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2DTranspose",configParamIndices:[0]})],e,"conv2dTranspose",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"SeparableConv2D",configParamIndices:[0]})],e,"separableConv2d",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Cropping2D",configParamIndices:[0]})],e,"cropping2D",null),r([o.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"DepthwiseConv2D",configParamIndices:[0]})],e,"depthwiseConv2d",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Activation",configParamIndices:[0]})],e,"activation",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dense",configParamIndices:[0]})],e,"dense",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dropout",configParamIndices:[0]})],e,"dropout",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Flatten",configParamIndices:[0]})],e,"flatten",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"RepeatVector",configParamIndices:[0]})],e,"repeatVector",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Reshape",configParamIndices:[0]})],e,"reshape",null),r([o.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Embedding",configParamIndices:[0]})],e,"embedding",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Add",configParamIndices:[0]})],e,"add",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Average",configParamIndices:[0]})],e,"average",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Concatenate",configParamIndices:[0]})],e,"concatenate",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Maximum",configParamIndices:[0]})],e,"maximum",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Minimum",configParamIndices:[0]})],e,"minimum",null),r([o.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Multiply",configParamIndices:[0]})],e,"multiply",null),r([o.doc({heading:"Layers",subheading:"Normalization",namespace:"layers",useDocsFrom:"BatchNormalization",configParamIndices:[0]})],e,"batchNormalization",null),r([o.doc({heading:"Layers",subheading:"Padding",namespace:"layers",useDocsFrom:"ZeroPadding2D",configParamIndices:[0]})],e,"zeroPadding2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AveragePooling1D",configParamIndices:[0]})],e,"averagePooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AveragePooling2D",configParamIndices:[0]})],e,"averagePooling2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling1D",configParamIndices:[0]})],e,"globalAveragePooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling2D",configParamIndices:[0]})],e,"globalAveragePooling2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling1D",configParamIndices:[0]})],e,"globalMaxPooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling2D",configParamIndices:[0]})],e,"globalMaxPooling2d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling1D",configParamIndices:[0]})],e,"maxPooling1d",null),r([o.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling2D",configParamIndices:[0]})],e,"maxPooling2d",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRU",configParamIndices:[0]})],e,"gru",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRUCell",configParamIndices:[0]})],e,"gruCell",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTM",configParamIndices:[0]})],e,"lstm",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTMCell",configParamIndices:[0]})],e,"lstmCell",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNN",configParamIndices:[0]})],e,"simpleRNN",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNNCell",configParamIndices:[0]})],e,"simpleRNNCell",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],e,"rnn",null),r([o.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],e,"stackedRNNCells",null),r([o.doc({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"Bidirectional",configParamIndices:[0]})],e,"bidirectional",null),r([o.doc({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"TimeDistributed",configParamIndices:[0]})],e,"timeDistributed",null),e}();n.LayerExports=C;var R=function(){function e(){}return e.maxNorm=function(e){return new l.MaxNorm(e)},e.unitNorm=function(e){return new l.UnitNorm(e)},e.nonNeg=function(){return new l.NonNeg},e.minMaxNorm=function(e){return new l.MinMaxNorm(e)},r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"MaxNorm",configParamIndices:[0]})],e,"maxNorm",null),r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"UnitNorm",configParamIndices:[0]})],e,"unitNorm",null),r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"NonNeg"})],e,"nonNeg",null),r([o.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"MinMaxNormConfig",configParamIndices:[0]})],e,"minMaxNorm",null),e}();n.ConstraintExports=R;var z=function(){function e(){}return e.zeros=function(){return new h.Zeros},e.ones=function(){return new h.Ones},e.constant=function(e){return new h.Constant(e)},e.randomUniform=function(e){return new h.RandomUniform(e)},e.randomNormal=function(e){return new h.RandomNormal(e)},e.truncatedNormal=function(e){return new h.TruncatedNormal(e)},e.identity=function(e){return new h.Identity(e)},e.varianceScaling=function(e){return new h.VarianceScaling(e)},e.glorotUniform=function(e){return new h.GlorotUniform(e)},e.glorotNormal=function(e){return new h.GlorotNormal(e)},e.heNormal=function(e){return new h.HeNormal(e)},e.leCunNormal=function(e){return new h.LeCunNormal(e)},e.orthogonal=function(e){return new h.Orthogonal(e)},r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Zeros"})],e,"zeros",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Ones"})],e,"ones",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Constant",configParamIndices:[0]})],e,"constant",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomUniform",configParamIndices:[0]})],e,"randomUniform",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomNormal",configParamIndices:[0]})],e,"randomNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"TruncatedNormal",configParamIndices:[0]})],e,"truncatedNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Identity",configParamIndices:[0]})],e,"identity",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"VarianceScaling",configParamIndices:[0]})],e,"varianceScaling",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotUniform",configParamIndices:[0]})],e,"glorotUniform",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotNormal",configParamIndices:[0]})],e,"glorotNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"HeNormal",configParamIndices:[0]})],e,"heNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"LeCunNormal",configParamIndices:[0]})],e,"leCunNormal",null),r([o.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Orthogonal",configParamIndices:[0]})],e,"orthogonal",null),e}();n.InitializerExports=z;var M=function(){function e(){}return e.binaryAccuracy=function(e,t){return T.binaryAccuracy(e,t)},e.binaryCrossentropy=function(e,t){return T.binaryCrossentropy(e,t)},e.categoricalAccuracy=function(e,t){return T.categoricalAccuracy(e,t)},e.categoricalCrossentropy=function(e,t){return S.categoricalCrossentropy(e,t)},e.cosineProximity=function(e,t){return S.cosineProximity(e,t)},e.prototype.meanAbsoluteError=function(e,t){return S.meanAbsoluteError(e,t)},e.prototype.meanAbsolutePercentageError=function(e,t){return S.meanAbsolutePercentageError(e,t)},e.prototype.MAPE=function(e,t){return S.meanAbsolutePercentageError(e,t)},e.prototype.mape=function(e,t){return S.meanAbsolutePercentageError(e,t)},e.meanSquaredError=function(e,t){return S.meanSquaredError(e,t)},e.MSE=function(e,t){return S.meanSquaredError(e,t)},e.mse=function(e,t){return S.meanSquaredError(e,t)},r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanAbsoluteError"})],e.prototype,"meanAbsoluteError",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanAbsolutePercentageError"})],e.prototype,"meanAbsolutePercentageError",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"binaryAccuracy"})],e,"binaryAccuracy",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"binaryCrossentropy"})],e,"binaryCrossentropy",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"categoricalAccuracy"})],e,"categoricalAccuracy",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"categoricalCrossentropy"})],e,"categoricalCrossentropy",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"cosineProximity"})],e,"cosineProximity",null),r([o.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanSquaredError"})],e,"meanSquaredError",null),e}();n.MetricExports=M;var L=function(){function e(){}return e.l1l2=function(e){return new k.L1L2(e)},e.l1=function(e){return k.l1(e)},e.l2=function(e){return k.l2(e)},r([o.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l1l2",null),r([o.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l1",null),r([o.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l2",null),e}();n.RegularizerExports=L},{"./constraints":161,"./engine/topology":163,"./engine/training":164,"./initializers":168,"./layers/advanced_activations":169,"./layers/convolutional":170,"./layers/convolutional_depthwise":171,"./layers/core":172,"./layers/embeddings":173,"./layers/merge":174,"./layers/normalization":175,"./layers/padding":176,"./layers/pooling":177,"./layers/recurrent":178,"./layers/wrappers":180,"./losses":181,"./metrics":182,"./models":183,"./regularizers":185,"@tensorflow/tfjs-core":50}],167:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./exports"),o=e("./callbacks");n.Callback=o.Callback,n.CallbackList=o.CallbackList,n.CustomCallback=o.CustomCallback;var l=e("./engine/training");n.Model=l.Model;var c=e("./layers/recurrent");n.RNN=c.RNN;var f=e("./models");n.Sequential=f.Sequential;var h=e("./types");n.SymbolicTensor=h.SymbolicTensor;var d=e("./version");n.version_layers=d.version,n.model=r.ModelExports.model,n.sequential=r.ModelExports.sequential,n.loadModel=r.ModelExports.loadModel,n.input=r.ModelExports.input,n.layers=r.LayerExports,n.constraints=r.ConstraintExports,n.initializers=r.InitializerExports,n.metrics=r.MetricExports,n.regularizers=r.RegularizerExports},{"./callbacks":159,"./engine/training":164,"./exports":166,"./layers/recurrent":178,"./models":183,"./types":186,"./version":192}],168:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs-core"),f=e("./backend/tfjs_backend"),h=e("./common"),d=e("./errors"),m=e("./utils/generic_utils"),y=e("./utils/math_utils");function v(e){m.checkStringTypeUnionValue(n.VALID_FAN_MODE_VALUES,"FanMode",e)}function w(e){m.checkStringTypeUnionValue(n.VALID_DISTRIBUTION_VALUES,"Distribution",e)}n.VALID_FAN_MODE_VALUES=["fanIn","fanOut","fanAvg"],n.checkFanMode=v,n.VALID_DISTRIBUTION_VALUES=["normal","uniform"],n.checkDistribution=w;var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t=l([c.doc({heading:"Initializers",subheading:"Classes",namespace:"initializers"})],t)}(c.serialization.Serializable);n.Initializer=x;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e,t){return c.zeros(e,t)},t.className="Zeros",t}(x);n.Zeros=_,c.serialization.SerializationMap.register(_);var N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e,t){return c.ones(e,t)},t.className="Ones",t}(x);n.Ones=N,c.serialization.SerializationMap.register(N);var E=function(e){function t(t){var n=e.call(this)||this;return n.value=t.value,n}return o(t,e),t.prototype.apply=function(e,t){var n=this;return c.tidy((function(){return f.scalarTimesArray(c.scalar(n.value),c.ones(e,t))}))},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(x);n.Constant=E,c.serialization.SerializationMap.register(E);var A=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=t.minval||n.DEFAULT_MINVAL,n.maxval=t.maxval||n.DEFAULT_MAXVAL,n.seed=t.seed,n}return o(t,e),t.prototype.apply=function(e,t){return c.randomUniform(e,this.minval,this.maxval,t)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(x);n.RandomUniform=A,c.serialization.SerializationMap.register(A);var O=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return o(t,e),t.prototype.apply=function(e,t){if("bool"===t)throw new d.NotImplementedError("randomNormal does not support dType bool.");return f.randomNormal(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(x);n.RandomNormal=O,c.serialization.SerializationMap.register(O);var S=function(e){function t(t){var n=e.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=t.mean||n.DEFAULT_MEAN,n.stddev=t.stddev||n.DEFAULT_STDDEV,n.seed=t.seed,n}return o(t,e),t.prototype.apply=function(e,t){if("bool"===t)throw new d.NotImplementedError("truncatedNormal does not support dType bool.");return c.truncatedNormal(e,this.mean,this.stddev,t,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(x);n.TruncatedNormal=S,c.serialization.SerializationMap.register(S);var T=function(e){function t(t){var n=e.call(this)||this;return n.gain=null!=t.gain?c.scalar(t.gain):f.getScalar(1),n}return o(t,e),t.prototype.apply=function(e,t){var n=this;return c.tidy((function(){if(2!==e.length||e[0]!==e[1])throw new d.ValueError("Identity matrix initializer can only be used for 2D square matrices.");return f.scalarTimesArray(n.gain,c.eye(e[0]))}))},t.prototype.getConfig=function(){return{gain:this.gain.get()}},t.className="Identity",t}(x);n.Identity=T,c.serialization.SerializationMap.register(T);var I=function(e){function t(t){var n=e.call(this)||this;if(t.scale<0)throw new d.ValueError("scale must be a positive float. Got: "+t.scale);return n.scale=null==t.scale?1:t.scale,n.mode=t.mode,v(n.mode),n.distribution=t.distribution,w(n.distribution),n.seed=t.seed,n}return o(t,e),t.prototype.apply=function(e,t){var n=function(e,t){var n,r;if(void 0===t&&(t="channelsLast"),h.checkDataFormat(t),2===e.length)n=e[0],r=e[1];else if(-1!==[3,4,5].indexOf(e.length))if("channelsFirst"===t){var o=y.arrayProd(e,2);n=e[1]*o,r=e[0]*o}else"channelsLast"===t&&(o=y.arrayProd(e,0,e.length-2),n=e[e.length-2]*o,r=e[e.length-1]*o);else{var l=y.arrayProd(e);n=Math.sqrt(l),r=Math.sqrt(l)}return[n,r]}(e),r=n[0],o=n[1],l=this.scale;if("fanIn"===this.mode?l/=Math.max(1,r):"fanOut"===this.mode?l/=Math.max(1,o):l/=Math.max(1,(r+o)/2),"normal"===this.distribution){var f=Math.sqrt(l);if("bool"===t)throw new d.NotImplementedError(this.getClassName()+" does not support dType bool.");return c.truncatedNormal(e,0,f,t,this.seed)}var m=Math.sqrt(3*l);return c.randomUniform(e,-m,m,t)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(x);n.VarianceScaling=I,c.serialization.SerializationMap.register(I);var k=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})||this}return o(t,e),t.prototype.getClassName=function(){return I.className},t}(I);n.GlorotUniform=k;var P=function(e){function t(t){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})||this}return o(t,e),t.prototype.getClassName=function(){return I.className},t}(I);n.GlorotNormal=P;var C=function(e){function t(t){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})||this}return o(t,e),t.prototype.getClassName=function(){return I.className},t}(I);n.HeNormal=C;var R=function(e){function t(t){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})||this}return o(t,e),t.prototype.getClassName=function(){return I.className},t}(I);n.LeCunNormal=R;var z=function(e){function t(t){var n=e.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==t.gain?n.DEFAULT_GAIN:t.gain,n.seed=t.seed,null!=n.seed)throw new d.NotImplementedError("Random seed is not implemented for Orthogonal Initializer yet.");return n}return o(t,e),t.prototype.apply=function(e,t){var n=this;return c.tidy((function(){if(2!==e.length)throw new d.NotImplementedError("The Orthogonal Initializer does not support non-2D shapes yet.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+e[0]*e[1]+") elements: Slowness may result.");var t=e[0]>e[1]?[e[1],e[0]]:e,a=f.randomNormal(t,0,1,"float32"),q=c.linalg.gramSchmidt(a);return e[0]>e[1]&&(q=q.transpose()),f.scalarTimesArray(f.getScalar(n.gain),q)}))},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(x);function M(e,t){return void 0===t&&(t={}),m.deserializeKerasObject(e,c.serialization.SerializationMap.getMap().classNameMap,t,"initializer")}n.Orthogonal=z,c.serialization.SerializationMap.register(z),n.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",identity:"Identity",leCunNormal:"LeCunNormal",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"},n.serializeInitializer=function(e){return m.serializeKerasObject(e)},n.getInitializer=function(e){if("string"==typeof e){var t=e in n.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?n.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e;return"GlorotUniform"===t?new k:"GlorotNormal"===t?new P:"HeNormal"===t?new C:"LeCunNormal"===t?new R:M({className:t,config:{}})}return e instanceof x?e:M(e)}},{"./backend/tfjs_backend":158,"./common":160,"./errors":165,"./utils/generic_utils":188,"./utils/math_utils":189,"@tensorflow/tfjs-core":50}],169:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("../activations"),f=e("../backend/tfjs_backend"),h=e("../backend/tfjs_backend"),d=e("../engine/topology"),m=e("../errors"),y=e("../utils/generic_utils"),v=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_ALPHA=.3,null==t&&(t={}),n.alpha=null==t.alpha?n.DEFAULT_ALPHA:t.alpha,n}return o(t,e),t.prototype.call=function(e,t){var n=y.getExactlyOneTensor(e);return l.leakyRelu(n,this.alpha)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={alpha:this.alpha},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="LeakyReLU",t}(d.Layer);n.LeakyReLU=v,l.serialization.SerializationMap.register(v);var w=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;if(n.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==n.DEFAULT_ALPHA)throw new m.NotImplementedError("Non-default alpha value ("+t.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==t.alpha?n.DEFAULT_ALPHA:t.alpha,n}return o(t,e),t.prototype.call=function(e,t){var n=y.getExactlyOneTensor(e);return l.elu(n)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={alpha:this.alpha},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ELU",t}(d.Layer);n.ELU=w,l.serialization.SerializationMap.register(w);var x=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_THETA=1,null==t&&(t={}),n.theta=null==t.theta?n.DEFAULT_THETA:t.theta,n.thetaTensor=h.getScalar(n.theta),n}return o(t,e),t.prototype.call=function(e,t){var n=y.getExactlyOneTensor(e);return n.mul(f.cast(n.greater(this.thetaTensor),"float32"))},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={theta:this.theta},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ThresholdedReLU",t}(d.Layer);n.ThresholdedReLU=x,l.serialization.SerializationMap.register(x);var _=function(e){function t(t){var n=e.call(this,null==t?{}:t)||this;return n.DEFAULT_AXIS=1,null==t&&(t={}),n.softmax=(new c.Softmax).apply,n.axis=null==t.axis?n.DEFAULT_AXIS:t.axis,n}return o(t,e),t.prototype.call=function(e,t){var n=y.getExactlyOneTensor(e);return this.softmax(n,this.axis)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var t={axis:this.axis},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Softmax",t}(d.Layer);n.Softmax=_,l.serialization.SerializationMap.register(_)},{"../activations":156,"../backend/tfjs_backend":158,"../engine/topology":163,"../errors":165,"../utils/generic_utils":188,"@tensorflow/tfjs-core":50}],170:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../activations"),h=e("../backend/common"),d=e("../backend/tfjs_backend"),m=e("../common"),y=e("../constraints"),v=e("../engine/topology"),w=e("../errors"),x=e("../initializers"),_=e("../regularizers"),N=e("../utils/conv_utils"),E=e("../utils/generic_utils");function A(e,t){return c.tidy((function(){return m.checkDataFormat(t),"channelsFirst"===t?l.transpose(e,[0,2,3,1]):e}))}function O(e,t,n,r,o,f,y){return void 0===r&&(r=1),void 0===o&&(o="valid"),void 0===y&&(y=1),c.tidy((function(){if(null==f&&(f=h.imageDataFormat()),m.checkDataFormat(f),3!==e.shape.length)throw new w.ValueError("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(3!==t.shape.length)throw new w.ValueError("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new w.ValueError("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if("channelsFirst"===f&&(e=l.transpose(e,[0,2,1])),"causal"===o)throw new w.NotImplementedError("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var c=l.conv1d(e,t,r,"same"===o?"same":"valid","NWC",y);return null!=n&&(c=d.biasAdd(c,n)),c}))}function S(e,t,n,r,o,f,y){return void 0===r&&(r=[1,1]),void 0===o&&(o="valid"),c.tidy((function(){if(null==f&&(f=h.imageDataFormat()),m.checkDataFormat(f),3!==e.rank&&4!==e.rank)throw new w.ValueError("conv2dWithBias expects input to be of rank 3 or 4, but received "+e.rank+".");if(3!==t.rank&&4!==t.rank)throw new w.ValueError("conv2dWithBias expects kernel to be of rank 3 or 4, but received "+e.rank+".");var c=A(e,f);if("causal"===o)throw new w.NotImplementedError("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=l.conv2d(c,t,r,"same"===o?"same":"valid","NHWC",y),null!=n&&(c=d.biasAdd(c,n)),"channelsFirst"===f&&(c=l.transpose(c,[0,3,1,2])),c}))}n.preprocessConv2DInput=A,n.conv1dWithBias=O,n.conv1d=function(e,t,n,r,o,l){return void 0===n&&(n=1),void 0===r&&(r="valid"),void 0===l&&(l=1),c.tidy((function(){return m.checkDataFormat(o),O(e,t,null,n,r,o,l)}))},n.conv2d=function(e,t,n,r,o,l){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),c.tidy((function(){return m.checkDataFormat(o),S(e,t,null,n,r,o,l)}))},n.conv2dWithBias=S;var T=function(e){function t(t,n){var r=e.call(this,n)||this;if(r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.rank=t,1!==r.rank&&2!==r.rank)throw new w.NotImplementedError("Convolution layer for rank other than 1 or 2 ("+r.rank+") is not implemented yet.");if(r.filters=n.filters,r.kernelSize=N.normalizeArray(n.kernelSize,t,"kernelSize"),r.strides=N.normalizeArray(null==n.strides?1:n.strides,t,"strides"),r.padding=null==n.padding?"valid":n.padding,m.checkPaddingMode(r.padding),r.dataFormat=null==n.dataFormat?"channelsLast":n.dataFormat,m.checkDataFormat(r.dataFormat),r.dilationRate=null==n.dilationRate?1:n.dilationRate,1===r.rank&&Array.isArray(r.dilationRate)&&1!==r.dilationRate.length)throw new w.ValueError("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(r.dilationRate));if(2===r.rank)if("number"==typeof r.dilationRate)r.dilationRate=[r.dilationRate,r.dilationRate];else if(2!==r.dilationRate.length)throw new w.ValueError("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(r.dilationRate));return r.activation=f.getActivation(n.activation),r.useBias=null==n.useBias||n.useBias,r.kernelInitializer=x.getInitializer(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=x.getInitializer(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=y.getConstraint(n.kernelConstraint),r.biasConstraint=y.getConstraint(n.biasConstraint),r.kernelRegularizer=_.getRegularizer(n.kernelRegularizer),r.biasRegularizer=_.getRegularizer(n.biasRegularizer),r.activityRegularizer=_.getRegularizer(n.activityRegularizer),r}return o(t,e),t.prototype.build=function(e){e=E.getExactlyOneShape(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new w.ValueError("The channel dimension of the input should be defined. Found "+e[t]);var n,r=e[t],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(n={},n[t]=r,n)}],this.built=!0},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var t;e=E.getExactlyOneTensor(e);var r=null==n.bias?null:n.bias.read();if(1===n.rank)t=O(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate);else if(2===n.rank)t=S(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else if(3===n.rank)throw new w.NotImplementedError("3D convolution is not implemented yet.");return null!=n.activation&&(t=n.activation.apply(t)),t}))},t.prototype.computeOutputShape=function(e){e=E.getExactlyOneShape(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),i=0;i<n.length;++i){var r=N.convOutputLength(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);t.push(r)}var o=[e[0]];return"channelsLast"===this.dataFormat?(o=o.concat(t)).push(this.filters):(o.push(this.filters),o=o.concat(t)),o},t.prototype.getConfig=function(){var t={rank:this.rank,filters:this.filters,kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:f.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:y.serializeConstraint(this.kernelConstraint),biasConstraint:y.serializeConstraint(this.biasConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(v.Layer);n.Conv=T;var I=function(e){function t(t){return e.call(this,2,t)||this}return o(t,e),t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,t},t.className="Conv2D",t}(T);n.Conv2D=I,c.serialization.SerializationMap.register(I);var k=function(e){function t(t){var n=e.call(this,t)||this;if(n.inputSpec=[new v.InputSpec({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new w.ValueError("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return o(t,e),t.prototype.build=function(e){if(4!==(e=E.getExactlyOneShape(e)).length)throw new w.ValueError("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new w.ValueError("The channel dimension of the inputs should be defined. Found `None`.");var n,r=e[t],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new v.InputSpec({ndim:4,axes:(n={},n[t]=r,n)})],this.built=!0},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){var input=E.getExactlyOneTensor(e);if(4!==input.shape.length)throw new w.ValueError("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+input.shape.length);var t,r,o=input.shape,c=o[0];"channelsFirst"===n.dataFormat?(t=2,r=3):(t=1,r=2);var f=o[t],h=o[r],m=n.kernelSize[0],y=n.kernelSize[1],v=n.strides[0],x=n.strides[1],_=[c,N.deconvLength(f,v,m,n.padding),N.deconvLength(h,x,y,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(input=l.transpose(input,[0,2,3,1]));var A=l.conv2dTranspose(input,n.kernel.read(),_,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(A=l.transpose(A,[0,3,1,2])),null!=n.bias&&(A=d.biasAdd(A,n.bias.read(),n.dataFormat)),null!=n.activation&&(A=n.activation.apply(A)),A}))},t.prototype.computeOutputShape=function(e){var t,n,r,o=(e=E.getExactlyOneShape(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var l=this.kernelSize[0],c=this.kernelSize[1],f=this.strides[0],h=this.strides[1];return o[t]=this.filters,o[n]=N.deconvLength(o[n],f,l,this.padding),o[r]=N.deconvLength(o[r],h,c,this.padding),o},t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.dilationRate,t},t.className="Conv2DTranspose",t}(I);n.Conv2DTranspose=k,c.serialization.SerializationMap.register(k);var P=function(e){function t(t,n){var r=e.call(this,t,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new w.ValueError("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new w.ValueError("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new w.ValueError("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=x.getInitializer(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=_.getRegularizer(n.depthwiseRegularizer),r.depthwiseConstraint=y.getConstraint(n.depthwiseConstraint),r.pointwiseInitializer=x.getInitializer(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=_.getRegularizer(n.pointwiseRegularizer),r.pointwiseConstraint=y.getConstraint(n.pointwiseConstraint),r}return o(t,e),t.prototype.build=function(e){if((e=E.getExactlyOneShape(e)).length<this.rank+2)throw new w.ValueError("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(e));var t,n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n]||e[n]<0)throw new w.ValueError("The channel dimension of the inputs should be defined, but found "+JSON.stringify(e[n]));for(var r=e[n],o=this.kernelSize.concat([r,this.depthMultiplier]),l=[],i=0;i<this.rank;++i)l.push(1);l.push(r*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",l,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new v.InputSpec({ndim:this.rank+2,axes:(t={},t[n]=r,t)})],this.built=!0},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var output;if(e=E.getExactlyOneTensor(e),1===n.rank)throw new w.NotImplementedError("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=l.transpose(e,[0,2,3,1])),output=l.separableConv2d(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(output=d.biasAdd(output,n.bias.read(),n.dataFormat)),null!=n.activation&&(output=n.activation.apply(output)),"channelsFirst"===n.dataFormat&&(output=l.transpose(output,[0,3,1,2])),output}))},t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=x.serializeInitializer(this.depthwiseInitializer),t.pointwiseInitializer=x.serializeInitializer(this.pointwiseInitializer),t.depthwiseRegularizer=_.serializeRegularizer(this.depthwiseRegularizer),t.pointwiseRegularizer=_.serializeRegularizer(this.pointwiseRegularizer),t.depthwiseConstraint=y.serializeConstraint(this.depthwiseConstraint),t.pointwiseConstraint=y.serializeConstraint(this.pointwiseConstraint),t},t.className="SeparableConv",t}(T);n.SeparableConv=P;var C=function(e){function t(t){return e.call(this,2,t)||this}return o(t,e),t.className="SeparableConv2D",t}(P);n.SeparableConv2D=C,c.serialization.SerializationMap.register(C);var R=function(e){function t(t){var n=e.call(this,1,t)||this;return n.inputSpec=[{ndim:3}],n}return o(t,e),t.prototype.getConfig=function(){var t=e.prototype.getConfig.call(this);return delete t.rank,delete t.dataFormat,t},t.className="Conv1D",t}(T);n.Conv1D=R,c.serialization.SerializationMap.register(R);var z=function(e){function t(t){var n=e.call(this,t)||this;return"number"==typeof t.cropping?n.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?n.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:n.cropping=t.cropping,n.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,n.inputSpec=[{ndim:4}],n}return o(t,e),t.prototype.computeOutputShape=function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){if(e=E.getExactlyOneTensor(e),"channelsLast"===n.dataFormat){var t=d.sliceAlongAxis(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return d.sliceAlongAxis(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}return t=d.sliceAlongAxis(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),d.sliceAlongAxis(t,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))},t.prototype.getConfig=function(){var t={cropping:this.cropping,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Cropping2D",t}(v.Layer);n.Cropping2D=z,c.serialization.SerializationMap.register(z)},{"../activations":156,"../backend/common":157,"../backend/tfjs_backend":158,"../common":160,"../constraints":161,"../engine/topology":163,"../errors":165,"../initializers":168,"../regularizers":185,"../utils/conv_utils":187,"../utils/generic_utils":188,"@tensorflow/tfjs-core":50}],171:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../backend/common"),h=e("../backend/tfjs_backend"),d=e("../common"),m=e("../constraints"),y=e("../errors"),v=e("../initializers"),w=e("../regularizers"),x=e("../utils/conv_utils"),_=e("../utils/generic_utils"),N=e("./convolutional");function E(e,t,n,r,o,h){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),c.tidy((function(){null==o&&(o=f.imageDataFormat()),d.checkDataFormat(o);var c=N.preprocessConv2DInput(e,o);if(4!==e.rank)throw new y.ValueError("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(4!==t.rank)throw new y.ValueError("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return c=l.depthwiseConv2d(c,t,n,"same"===r?"same":"valid","NHWC",h),"channelsFirst"===o&&(c=l.transpose(c,[0,3,1,2])),c}))}n.depthwiseConv2d=E;var A=function(e){function t(t){var n=e.call(this,t)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,n.depthwiseInitializer=v.getInitializer(t.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=m.getConstraint(t.depthwiseConstraint),n.depthwiseRegularizer=w.getRegularizer(t.depthwiseRegularizer),n}return o(t,e),t.prototype.build=function(e){if((e=_.getExactlyOneShape(e)).length<4)throw new y.ValueError("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(e)+".");var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new y.ValueError("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+e[t]+").");var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var t=E(e=_.getExactlyOneTensor(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=h.biasAdd(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))},t.prototype.computeOutputShape=function(e){e=_.getExactlyOneShape(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=x.convOutputLength(t,this.kernelSize[0],this.padding,this.strides[0]),l=x.convOutputLength(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,o,l]:[e[0],o,l,r]},t.className="DepthwiseConv2D",t}(N.Conv2D);n.DepthwiseConv2D=A,c.serialization.SerializationMap.register(A)},{"../backend/common":157,"../backend/tfjs_backend":158,"../common":160,"../constraints":161,"../errors":165,"../initializers":168,"../regularizers":185,"../utils/conv_utils":187,"../utils/generic_utils":188,"./convolutional":170,"@tensorflow/tfjs-core":50}],172:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("../activations"),f=e("../backend/tfjs_backend"),h=e("../constraints"),d=e("../engine/topology"),m=e("../errors"),y=e("../initializers"),v=e("../regularizers"),w=e("../utils/generic_utils"),x=e("../utils/generic_utils"),_=e("../utils/math_utils"),N=function(e){function t(t){var n=e.call(this,t)||this;if(n.rate=Math.max(Math.min(t.rate,1),0),n.rateScalar=f.getScalar(n.rate),n.noiseShape=t.noiseShape,n.seed=t.seed,null!=n.seed)throw new m.NotImplementedError("Non-default seed is not implemented in Dropout layer yet: "+n.seed);return n.supportsMasking=!0,n}return o(t,e),t.prototype.getNoiseShape=function(input){if(null==this.noiseShape)return this.noiseShape;for(var e=input.shape,t=[],i=0;i<this.noiseShape.length;++i)t.push(null==this.noiseShape[i]?e[i]:this.noiseShape[i]);return t},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){n.invokeCallHook(e,t);var input=w.getExactlyOneTensor(e);if(null!=n.noiseShape&&!l.util.arraysEqual(input.shape,n.noiseShape))throw new m.NotImplementedError("Non-default noise shape is not implemented in Dropout layer yet: "+JSON.stringify(n.noiseShape));if(0<n.rate&&n.rate<1){var r=null!=t.training&&t.training,o=n.getNoiseShape(input);return f.inTrainPhase((function(){return f.dropout(input,n.rateScalar,o,n.seed)}),(function(){return input}),r)}return e}))},t.prototype.getConfig=function(){var t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Dropout",t}(d.Layer);n.Dropout=N,l.serialization.SerializationMap.register(N);var E=function(e){function t(t){var n=e.call(this,t)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){var r=null;null!=t.batchSize&&(r=t.batchSize),n.batchInputShape=[r,t.inputDim]}return n.units=t.units,n.activation=c.getActivation(t.activation),null!=t.useBias&&(n.useBias=t.useBias),n.kernelInitializer=y.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=y.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=h.getConstraint(t.kernelConstraint),n.biasConstraint=h.getConstraint(t.biasConstraint),n.kernelRegularizer=v.getRegularizer(t.kernelRegularizer),n.biasRegularizer=v.getRegularizer(t.biasRegularizer),n.activityRegularizer=v.getRegularizer(t.activityRegularizer),n.inputSpec=[{minNDim:2}],n}return o(t,e),t.prototype.build=function(e){var t,n=(e=w.getExactlyOneShape(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(t={},t[-1]=n,t)}],this.built=!0},t.prototype.computeOutputShape=function(e){var t=(e=w.getExactlyOneShape(e)).slice();return t[t.length-1]=this.units,t},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){n.invokeCallHook(e,t);var input=w.getExactlyOneTensor(e),output=f.dot(input,n.kernel.read());return null!=n.bias&&(output=f.biasAdd(output,n.bias.read())),null!=n.activation&&(output=n.activation.apply(output)),output}))},t.prototype.getConfig=function(){var t={units:this.units,activation:c.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:y.serializeInitializer(this.kernelInitializer),biasInitializer:y.serializeInitializer(this.biasInitializer),kernelRegularizer:v.serializeRegularizer(this.kernelRegularizer),biasRegularizer:v.serializeRegularizer(this.biasRegularizer),activityRegularizer:v.serializeRegularizer(this.activityRegularizer),kernelConstraint:h.serializeConstraint(this.kernelConstraint),biasConstraint:h.serializeConstraint(this.biasConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Dense",t}(d.Layer);n.Dense=E,l.serialization.SerializationMap.register(E);var A=function(e){function t(t){var n=e.call(this,t||{})||this;return n.inputSpec=[{minNDim:3}],n}return o(t,e),t.prototype.computeOutputShape=function(e){for(var t=0,n=(e=w.getExactlyOneShape(e)).slice(1);t<n.length;t++)if(null==n[t])throw new m.ValueError('The shape of the input to "Flatten" is not fully defined (got '+e.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],_.arrayProd(e,1)]},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){return n.invokeCallHook(e,t),f.batchFlatten(w.getExactlyOneTensor(e))}))},t.className="Flatten",t}(d.Layer);n.Flatten=A,l.serialization.SerializationMap.register(A);var O=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n.activation=c.getActivation(t.activation),n}return o(t,e),t.prototype.call=function(e,t){var n=this;return l.tidy((function(){n.invokeCallHook(e,t);var input=w.getExactlyOneTensor(e);return n.activation.apply(input)}))},t.prototype.getConfig=function(){var t={activation:c.serializeActivation(this.activation)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Activation",t}(d.Layer);n.Activation=O,l.serialization.SerializationMap.register(O);var S=function(e){function t(t){var n=e.call(this,t)||this;return n.n=t.n,n.inputSpec=[{ndim:2}],n}return o(t,e),t.prototype.computeOutputShape=function(e){return[e[0],this.n,e[1]]},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){return e=x.getExactlyOneTensor(e),f.repeat(e,n.n)}))},t.prototype.getConfig=function(){var t={n:this.n},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="RepeatVector",t}(d.Layer);n.RepeatVector=S,l.serialization.SerializationMap.register(S);var T=function(e){function t(t){var n=e.call(this,t)||this;n.targetShape=t.targetShape;for(var i=0;i<n.targetShape.length;++i)n.isUnknown(n.targetShape[i])&&(n.targetShape[i]=null);return n}return o(t,e),t.prototype.isUnknown=function(e){return e<0||null==e},t.prototype.fixUnknownDimension=function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),o=1,l=null,i=0;i<r.length;++i){var c=r[i];if(this.isUnknown(c)){if(null!==l)throw new m.ValueError("Can only specifiy one unknown dimension.");l=i}else o*=c}var f=_.arrayProd(e);if(null!==l){if(0===o||f%o!=0)throw new m.ValueError(n);r[l]=f/o}else if(f!==o)throw new m.ValueError(n);return r},t.prototype.computeOutputShape=function(e){for(var t=!1,i=0;i<e.length;++i)if(this.isUnknown(e[i])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){n.invokeCallHook(e,t);var input=w.getExactlyOneTensor(e),r=f.shape(input),o=r.slice(0,1).concat(n.fixUnknownDimension(r.slice(1),n.targetShape));return input.reshape(o)}))},t.prototype.getConfig=function(){var t={targetShape:this.targetShape},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Reshape",t}(d.Layer);n.Reshape=T,l.serialization.SerializationMap.register(T)},{"../activations":156,"../backend/tfjs_backend":158,"../constraints":161,"../engine/topology":163,"../errors":165,"../initializers":168,"../regularizers":185,"../utils/generic_utils":188,"../utils/math_utils":189,"@tensorflow/tfjs-core":50}],173:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("../backend/tfjs_backend"),f=e("../constraints"),h=e("../engine/topology"),d=e("../errors"),m=e("../initializers"),y=e("../regularizers"),v=e("../utils/generic_utils"),w=e("../utils/generic_utils"),x=function(e){function t(t){var n=e.call(this,t)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){var r=null;null!=t.batchSize&&(r=t.batchSize),null==t.inputLength?n.batchInputShape=[r,null]:n.batchInputShape=[r].concat(v.toList(t.inputLength))}return n.inputDim=t.inputDim,n.outputDim=t.outputDim,n.embeddingsInitializer=m.getInitializer(t.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=y.getRegularizer(t.embeddingsRegularizer),n.activityRegularizer=y.getRegularizer(t.activityRegularizer),n.embeddingsConstraint=f.getConstraint(t.embeddingsConstraint),n.maskZero=t.maskZero,n.inputLength=t.inputLength,n}return o(t,e),t.prototype.build=function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.computeMask=function(e,mask){throw new d.NotImplementedError("computeMask has not been implemented for Embedding yet")},t.prototype.computeOutputShape=function(e){if(e=v.getExactlyOneShape(e),null==this.inputLength)return e.concat([this.outputDim]);var t=v.toList(this.inputLength);if(t.length!==e.length-1)throw new d.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);for(var i=0,n=0;n<t.length;++n){var r=t[n],o=e[n+1];if(null!=r&&null!=o&&r!==o)throw new d.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);null==r&&(t[i]=o),i++}return[e[0]].concat(t,[this.outputDim])},t.prototype.call=function(e,t){var n=this;return l.tidy((function(){n.invokeCallHook(e,t);var input=v.getExactlyOneTensor(e);return"int32"!==c.dtype(input)&&(input=c.cast(input,"int32")),c.gather(n.embeddings.read(),input.as1D()).reshape(w.getExactlyOneShape(n.computeOutputShape(input.shape)))}))},t.prototype.getConfig=function(){var t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:m.serializeInitializer(this.embeddingsInitializer),embeddingsRegularizer:y.serializeRegularizer(this.embeddingsRegularizer),activityRegularizer:y.serializeRegularizer(this.activityRegularizer),embeddingsConstraint:f.serializeConstraint(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Embedding",t}(h.Layer);n.Embedding=x,l.serialization.SerializationMap.register(x)},{"../backend/tfjs_backend":158,"../constraints":161,"../engine/topology":163,"../errors":165,"../initializers":168,"../regularizers":185,"../utils/generic_utils":188,"@tensorflow/tfjs-core":50}],174:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../backend/tfjs_backend"),h=e("../engine/topology"),d=e("../errors"),m=e("../utils/generic_utils"),y=e("../utils/math_utils"),v=function(e){function t(t){var n=e.call(this,t||{})||this;return n.supportsMasking=!0,n}return o(t,e),t.prototype.mergeFunction=function(e){throw new d.NotImplementedError},t.prototype.computeElementwiseOpOutputShape=function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var i=e[e.length-t.length+r],o=t[r];if(null==i||null==o||i<0||o<0)n.push(null);else if(1===i)n.push(o);else if(1===o)n.push(i);else{if(i!==o)throw new d.ValueError("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(i)}}return n},t.prototype.build=function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[m.getExactlyOneShape(e)]),(e=e).length<2)throw new d.ValueError("A merge layer should be called on an Array of at least 2 inputs. Got "+e.length+" input(s).");for(var t=[],n=0,r=e;n<r.length;n++)null!=(l=r[n])&&null!==l[0]&&t.push(l[0]);if((t=m.unique(t)).length>1)throw new d.ValueError("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(e)+".");for(var o=null==e[0]?null:e[0].slice(1),i=1;i<e.length;++i){var l=null==e[i]?null:e[i].slice(1);o=this.computeElementwiseOpOutputShape(o,l)}var c=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===m.unique(c).length?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){if(e=e,n.reshapeRequired){var t=[],r=e.map((function(input){return input.rank}));if(-1===r.indexOf(null)){for(var o=y.max(r),c=0,h=e;c<h.length;c++){for(var d=(_=h[c]).rank,m=0;m<o-d;++m)_=f.expandDims(_,1);t.push(_)}return n.mergeFunction(t)}for(var v=!1,w=0,x=e;w<x.length;w++){var _;if(null==(d=(_=x[w]).rank)){var N=f.shape(_),E=N[0],A=N.slice(1).concat([E]),O=_.reshape([E].concat(y.arrayProd(N.slice(1))));O=(O=l.transpose(O,[1,0])).reshape(A),t.push(O),v=!0}else if(d>1){var S=y.range(1,d).concat([0]);t.push(l.transpose(_,S)),v=!0}else t.push(_)}var T=n.mergeFunction(t),I=T.rank;if(v)if(null==I){var k=f.shape(T);A=[E=k[k.length-1]].concat(k.slice(0,k.length-1)),T=l.transpose(T.reshape([-1,E]),[1,0]).reshape(A)}else I>1&&(S=[I-1].concat(y.range(0,I-1)),T=l.transpose(T,S));return T}return n.mergeFunction(e)}))},t.prototype.computeOutputShape=function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var i=1;i<e.length;++i){var n=null==e[i]?null:e[i].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}for(var r=[],o=0,l=e;o<l.length;o++)null!=(n=l[o])&&null!==n[0]&&r.push(n[0]);return t=1===(r=m.unique(r)).length?r.concat(t):[null].concat(t)},t}(h.Layer);n.Merge=v;var w=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.mergeFunction=function(e){return c.tidy((function(){for(var output=l.zeros(e[0].shape),t=0,n=e;t<n.length;t++){var input=n[t];output=l.add(output,input)}return output}))},t.className="Add",t}(v);n.Add=w,c.serialization.SerializationMap.register(w),n.add=function(e){return Array.isArray(e)?new w({}).apply(e):new w(e)};var x=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.mergeFunction=function(e){return c.tidy((function(){for(var output=l.ones(e[0].shape),t=0,n=e;t<n.length;t++){var input=n[t];output=l.mul(output,input)}return output}))},t.className="Multiply",t}(v);n.Multiply=x,c.serialization.SerializationMap.register(x),n.multiply=function(e){return Array.isArray(e)?new x({}).apply(e):new x(e)};var _=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.mergeFunction=function(e){return c.tidy((function(){for(var output=l.zeros(e[0].shape),t=0,n=e;t<n.length;t++){var input=n[t];output=l.add(output,input)}return f.scalarTimesArray(f.getScalar(1/e.length),output)}))},t.className="Average",t}(v);n.Average=_,c.serialization.SerializationMap.register(_),n.average=function(e){return Array.isArray(e)?new _({}).apply(e):new _(e)};var N=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.mergeFunction=function(e){return c.tidy((function(){for(var output=e[0],i=1;i<e.length;++i)output=l.maximum(output,e[i]);return output}))},t.className="Maximum",t}(v);n.Maximum=N,c.serialization.SerializationMap.register(N),n.maximum=function(e){return Array.isArray(e)?new N({}).apply(e):new N(e)};var E=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.mergeFunction=function(e){return c.tidy((function(){for(var output=e[0],i=1;i<e.length;++i)output=l.minimum(output,e[i]);return output}))},t.className="Minimum",t}(v);n.Minimum=E,c.serialization.SerializationMap.register(E),n.minimum=function(e){return Array.isArray(e)?new E({}).apply(e):new E(e)};var A=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_AXIS=-1,null==t&&(t={}),n.axis=null==t.axis?n.DEFAULT_AXIS:t.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return o(t,e),t.prototype.build=function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new d.ValueError("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var t=!0,n=0,r=e=e;n<r.length;n++)if(null!=(y=r[n])){t=!1;break}if(!t){for(var o=[],i=0;i<e.length;++i){var l=e[i].slice();l.splice(this.axis,1);for(var f=!1,h=0,m=o;h<m.length;h++){var y=m[h];if(c.util.arraysEqual(y,l)){f=!0;break}}f||o.push(l)}if(o.length>1)throw new d.ValueError("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}},t.prototype.mergeFunction=function(e){var t=this;return c.tidy((function(){return f.concatenate(e,t.axis)}))},t.prototype.computeOutputShape=function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new d.ValueError("A `Concatenate` layer should be called on a list of inputs.");for(var t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,o=0,l=t.slice(1);o<l.length;o++){var c=l[o];if(null==n[r]||null==c[r]){n[r]=null;break}n[r]+=c[r]}return n},t.prototype.getConfig=function(){var t={axis:this.axis},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="Concatenate",t}(v);n.Concatenate=A,c.serialization.SerializationMap.register(A),n.concatenate=function(e){return Array.isArray(e)?new A({}).apply(e):new A(e)}},{"../backend/tfjs_backend":158,"../engine/topology":163,"../errors":165,"../utils/generic_utils":188,"../utils/math_utils":189,"@tensorflow/tfjs-core":50}],175:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../backend/tfjs_backend"),h=e("../constraints"),d=e("../engine/topology"),m=e("../errors"),y=e("../initializers"),v=e("../regularizers"),w=e("../utils/generic_utils"),x=e("../utils/math_utils");function _(e,t,n,r,o,c){var f;if(void 0===c&&(c=.001),2===e.rank)f=l.batchNormalization2d(e,t,n,c,o,r);else if(3===e.rank)f=l.batchNormalization3d(e,t,n,c,o,r);else{if(4!==e.rank)throw new m.NotImplementedError("batchNormalization is not implememnted for array of rank "+e.rank+" yet");f=l.batchNormalization4d(e,t,n,c,o,r)}return f}function N(e,t,n,r,o){return void 0===o&&(o=.001),c.util.arraysEqual(r.slice().sort(),x.range(0,e.rank-1))?function(e,t,n,r,o){return void 0===o&&(o=.001),c.tidy((function(){var c=l.moments(e,r),f=c.mean,h=c.variance;return[_(e,f,h,n,t,o),f,h]}))}(e,t,n,r,o):function(e,t,n,r,o){return void 0===o&&(o=.001),c.tidy((function(){for(var c=l.moments(e,r),f=c.mean,h=c.variance,d=[],m=0,y=x.range(0,e.rank);m<y.length;m++){var v=y[m];-1!==r.indexOf(v)?d.push(1):d.push(e.shape[v])}var w=f.reshape(d),N=h.reshape(d),E=null==t?null:t.reshape(d),A=null==n?null:n.reshape(d);return[_(e,w,N,A,E,o),f,h]}))}(e,t,n,r,o)}n.batchNormalization=_,n.normalizeBatchInTraining=N;var E=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n.axis=null==t.axis?-1:t.axis,n.momentum=null==t.momentum?.99:t.momentum,n.epsilon=null==t.epsilon?.001:t.epsilon,n.center=null==t.center||t.center,n.scale=null==t.scale||t.scale,n.betaInitializer=y.getInitializer(t.betaInitializer||"zeros"),n.gammaInitializer=y.getInitializer(t.gammaInitializer||"ones"),n.movingMeanInitializer=y.getInitializer(t.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=y.getInitializer(t.movingVarianceInitializer||"ones"),n.betaConstraint=h.getConstraint(t.betaConstraint),n.gammaConstraint=h.getConstraint(t.gammaConstraint),n.betaRegularizer=v.getRegularizer(t.betaRegularizer),n.gammaRegularizer=v.getRegularizer(t.gammaRegularizer),n.stepCount=0,n}return o(t,e),t.prototype.build=function(e){e=w.getExactlyOneShape(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new m.ValueError("Axis "+t+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(e)+".");this.inputSpec=[new d.InputSpec({ndim:e.length,axes:(r={},r[t]=n,r)})];var r,o=[n];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var r=null!=t.training&&t.training,input=w.getExactlyOneTensor(e),o=f.shape(input),h=o.length,d=x.range(0,h),m=n.axis>=0?n.axis:n.axis+h;d.splice(m,1);var y=w.pyListRepeat(1,h);y[m]=o[m];var v=d.slice();v.sort();var E=!c.util.arraysEqual(v,x.range(0,h).slice(0,h-1));if(!r)return function(){if(E){var e=n.movingMean.read().reshape(y),t=n.movingVariance.read().reshape(y),r=n.center?n.beta.read().reshape(y):null,o=n.scale?n.gamma.read().reshape(y):null;return _(input,e,t,r,o,n.epsilon)}return _(input,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var A=N(input,n.gamma.read(),n.beta.read(),d,n.epsilon),O=A[0],S=A[1],T=A[2],I=x.arrayProd(d.map((function(e){return input.shape[e]}))),k=T.mul(f.getScalar(I/(I-(1+n.epsilon))));return function(){n.stepCount++;var e=l.movingAverage(n.movingMean.read(),S,n.momentum,n.stepCount);n.movingMean.write(e);var t=l.movingAverage(n.movingVariance.read(),k,n.momentum,n.stepCount);n.movingVariance.write(t)}(),O}))},t.prototype.getConfig=function(){var t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:y.serializeInitializer(this.betaInitializer),gammaInitializer:y.serializeInitializer(this.gammaInitializer),movingMeanInitializer:y.serializeInitializer(this.movingMeanInitializer),movingVarianceInitializer:y.serializeInitializer(this.movingVarianceInitializer),betaRegularizer:v.serializeRegularizer(this.betaRegularizer),gammaRegularizer:v.serializeRegularizer(this.gammaRegularizer),betaConstraint:h.serializeConstraint(this.betaConstraint),gammaConstraint:h.serializeConstraint(this.gammaConstraint)},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="BatchNormalization",t}(d.Layer);n.BatchNormalization=E,c.serialization.SerializationMap.register(E)},{"../backend/tfjs_backend":158,"../constraints":161,"../engine/topology":163,"../errors":165,"../initializers":168,"../regularizers":185,"../utils/generic_utils":188,"../utils/math_utils":189,"@tensorflow/tfjs-core":50}],176:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../backend/common"),h=e("../engine/topology"),d=e("../errors"),m=e("../utils/generic_utils");function y(e,t,n){return c.tidy((function(){if(4!==e.rank)throw new d.ValueError("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new d.ValueError("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n=f.imageDataFormat()),"channelsLast"!==n&&"channelsFirst"!==n)throw new d.ValueError("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var pattern;return pattern="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],l.pad(e,pattern)}))}n.temporalPadding=function(e,t){return c.tidy((function(){if(3!==e.rank)throw new d.ValueError("temporalPadding expects input tensor to be 3-D, but received a "+e.rank+"-D tensor.");if(null==t&&(t=[1,1]),2!==t.length)throw new d.ValueError("temporalPadding expects input padding pattern to be a length-2 array, but received a length-"+t.length+" array.");var pattern=[[0,0],t,[0,0]];return l.pad(e,pattern)}))},n.spatial2dPadding=y;var v=function(e){function t(t){var n=this;if(null==t&&(t={}),(n=e.call(this,t)||this).dataFormat=null==t.dataFormat?f.imageDataFormat():t.dataFormat,null==t.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)n.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new d.ValueError("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+t.padding.length+" array.");var r=void 0,o=void 0;if("number"==typeof t.padding[0])r=[t.padding[0],t.padding[0]],o=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new d.ValueError("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+t.padding[0].length+" array.");if(r=t.padding[0],2!==t.padding[1].length)throw new d.ValueError("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+t.padding[1].length+" array.");o=t.padding[1]}n.padding=[r,o]}return n.inputSpec=[new h.InputSpec({ndim:4})],n}return o(t,e),t.prototype.computeOutputShape=function(e){var t,n;return e=m.getExactlyOneShape(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){return y(m.getExactlyOneTensor(e),n.padding,n.dataFormat)}))},t.prototype.getConfig=function(){var t={padding:this.padding,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="ZeroPadding2D",t}(h.Layer);n.ZeroPadding2D=v,c.serialization.SerializationMap.register(v)},{"../backend/common":157,"../engine/topology":163,"../errors":165,"../utils/generic_utils":188,"@tensorflow/tfjs-core":50}],177:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../backend/common"),h=e("../backend/tfjs_backend"),d=e("../common"),m=e("../engine/topology"),y=e("../engine/topology"),v=e("../errors"),w=e("../utils/conv_utils"),x=e("../utils/generic_utils"),_=e("./convolutional");function N(e,t,n,r,o,h){return c.tidy((function(){var c;d.checkDataFormat(o),d.checkPoolMode(h),d.checkPaddingMode(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==o&&(o=f.imageDataFormat()),null==h&&(h="max"),e=_.preprocessConv2DInput(e,o);var m="same"===r?"same":"valid";return c="max"===h?l.maxPool(e,t,n,m):l.avgPool(e,t,n,m),"channelsFirst"===o&&(c=l.transpose(c,[0,3,1,2])),c}))}n.pool2d=N;var E=function(e){function t(t){var n=this;if(null==t.poolSize&&(t.poolSize=2),n=e.call(this,t)||this,"number"==typeof t.poolSize)n.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new v.ValueError("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));n.poolSize=t.poolSize}if(null==t.strides)n.strides=n.poolSize;else if("number"==typeof t.strides)n.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new v.ValueError("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));n.strides=t.strides}return n.padding=null==t.padding?"valid":t.padding,d.checkPaddingMode(n.padding),n.inputSpec=[new m.InputSpec({ndim:3})],n}return o(t,e),t.prototype.computeOutputShape=function(e){e=x.getExactlyOneShape(e);var t=w.convOutputLength(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){n.invokeCallHook(e,t),e=h.expandDims(x.getExactlyOneTensor(e),2);var output=n.poolingFunction(x.getExactlyOneTensor(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return l.squeeze(output,[2])}))},t.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(y.Layer);n.Pooling1D=E;var A=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return d.checkDataFormat(o),d.checkPaddingMode(r),N(e,t,n,r,o,"max")},t.className="MaxPooling1D",t}(E);n.MaxPooling1D=A,c.serialization.SerializationMap.register(A);var O=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return d.checkDataFormat(o),d.checkPaddingMode(r),N(e,t,n,r,o,"avg")},t.className="AveragePooling1D",t}(E);n.AveragePooling1D=O,c.serialization.SerializationMap.register(O);var S=function(e){function t(t){var n=this;return null==t.poolSize&&(t.poolSize=[2,2]),(n=e.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],n.strides=null==t.strides?n.poolSize:t.strides,n.padding=null==t.padding?"valid":t.padding,n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,d.checkDataFormat(n.dataFormat),d.checkPaddingMode(n.padding),n.inputSpec=[new m.InputSpec({ndim:4})],n}return o(t,e),t.prototype.computeOutputShape=function(e){e=x.getExactlyOneShape(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=w.convOutputLength(t,this.poolSize[0],this.padding,this.strides[0]),n=w.convOutputLength(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){return n.invokeCallHook(e,t),n.poolingFunction(x.getExactlyOneTensor(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))},t.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(y.Layer);n.Pooling2D=S;var T=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return d.checkDataFormat(o),d.checkPaddingMode(r),N(e,t,n,r,o,"max")},t.className="MaxPooling2D",t}(S);n.MaxPooling2D=T,c.serialization.SerializationMap.register(T);var I=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.poolingFunction=function(e,t,n,r,o){return d.checkDataFormat(o),d.checkPaddingMode(r),N(e,t,n,r,o,"avg")},t.className="AveragePooling2D",t}(S);n.AveragePooling2D=I,c.serialization.SerializationMap.register(I);var k=function(e){function t(t){var n=e.call(this,t)||this;return n.inputSpec=[new m.InputSpec({ndim:3})],n}return o(t,e),t.prototype.computeOutputShape=function(e){return[e[0],e[2]]},t.prototype.call=function(e,t){throw new v.NotImplementedError},t}(y.Layer);n.GlobalPooling1D=k;var P=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.call=function(e,t){return c.tidy((function(){var input=x.getExactlyOneTensor(e);return l.mean(input,1)}))},t.className="GlobalAveragePooling1D",t}(k);n.GlobalAveragePooling1D=P,c.serialization.SerializationMap.register(P);var C=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.call=function(e,t){return c.tidy((function(){var input=x.getExactlyOneTensor(e);return l.max(input,1)}))},t.className="GlobalMaxPooling1D",t}(k);n.GlobalMaxPooling1D=C,c.serialization.SerializationMap.register(C);var R=function(e){function t(t){var n=e.call(this,t)||this;return n.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,d.checkDataFormat(n.dataFormat),n.inputSpec=[new m.InputSpec({ndim:4})],n}return o(t,e),t.prototype.computeOutputShape=function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]},t.prototype.call=function(e,t){throw new v.NotImplementedError},t.prototype.getConfig=function(){var t={dataFormat:this.dataFormat},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t}(y.Layer);n.GlobalPooling2D=R;var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var input=x.getExactlyOneTensor(e);return"channelsLast"===n.dataFormat?l.mean(input,[1,2]):l.mean(input,[2,3])}))},t.className="GlobalAveragePooling2D",t}(R);n.GlobalAveragePooling2D=z,c.serialization.SerializationMap.register(z);var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.call=function(e,t){var n=this;return c.tidy((function(){var input=x.getExactlyOneTensor(e);return"channelsLast"===n.dataFormat?l.max(input,[1,2]):l.max(input,[2,3])}))},t.className="GlobalMaxPooling2D",t}(R);n.GlobalMaxPooling2D=M,c.serialization.SerializationMap.register(M)},{"../backend/common":157,"../backend/tfjs_backend":158,"../common":160,"../engine/topology":163,"../errors":165,"../utils/conv_utils":187,"../utils/generic_utils":188,"./convolutional":170,"@tensorflow/tfjs-core":50}],178:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs-core"),f=e("@tensorflow/tfjs-core"),h=e("../activations"),d=e("../backend/tfjs_backend"),m=e("../constraints"),y=e("../engine/topology"),v=e("../engine/topology"),w=e("../errors"),x=e("../initializers"),_=e("../regularizers"),N=e("../types"),E=e("../utils/generic_utils"),A=e("../utils/math_utils"),O=e("../variables"),S=e("./serialization");function T(e,t,n,r,mask,o,l,f){void 0===r&&(r=!1),void 0===l&&(l=!1);var h=t.shape.length;if(h<3)throw new w.ValueError("Input should be at least 3D, but is "+h+"D.");var m,y,v=[1,0].concat(A.range(2,h));if(t=c.transpose(t,v),null!=mask)throw new w.NotImplementedError("The rnn() function of the deeplearn.js backend does not support masking yet.");if(null!=o)throw new w.NotImplementedError("The rnn() functoin of the deeplearn.js backend does not support constants yet.");l&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r&&(t=c.reverse(t,0));for(var x=n,_=t.shape[0],N=0;N<_;++N){var E=d.sliceAlongFirstAxis(t,N,1),O=e(E=E.reshape(E.shape.slice(1)),x);y=O[0],m=0===N?y.reshape([1].concat(y.shape)):d.concatAlongFirstAxis(m,y.reshape([1].concat(y.shape))),x=O[1]}return[y,c.transpose(m,[1,0].concat(A.range(2,m.shape.length))),x]}n.rnn=T;var I=function(e){function t(t){var n,r=e.call(this,t)||this;if(null==t.cell)throw new w.ValueError("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(t.cell)?new D({cells:t.cell}):t.cell).stateSize)throw new w.ValueError("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=t.returnSequences&&t.returnSequences,r.returnState=null!=t.returnState&&t.returnState,r.goBackwards=null!=t.goBackwards&&t.goBackwards,r._stateful=null!=t.stateful&&t.stateful,r.unroll=null!=t.unroll&&t.unroll,r.supportsMasking=!0,r.inputSpec=[new y.InputSpec({ndim:3})],r.stateSpec=null,r.states=null,r.numConstants=null,r}return o(t,e),t.prototype.getStates=function(){if(null==this.states){var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return A.range(0,e).map((function(e){return null}))}return this.states},t.prototype.setStates=function(e){this.states=e},t.prototype.computeOutputShape=function(e){E.isArrayOfShapes(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){for(var o=[],l=0,c=t;l<c.length;l++){var f=c[l];o.push([e[0],f])}return[n].concat(o)}return n},t.prototype.computeMask=function(e,mask){throw new w.NotImplementedError("computeMask has not been implemented for RNN yet")},t.prototype.build=function(e){if(null!=this.numConstants)throw new w.NotImplementedError("Constants support is not implemented in RNN yet.");E.isArrayOfShapes(e)&&(e=e[0]),e=e;var t=this.stateful?e[0]:null,n=e[e.length-1];this.inputSpec[0]=new y.InputSpec({shape:[t,null,n]});var r,o=[e[0]].concat(e.slice(2));if(this.cell.build(o),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!f.util.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new w.ValueError("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=r.map((function(e){return new y.InputSpec({shape:[null,e]})}));if(this.stateful)throw new w.NotImplementedError("stateful RNN layer is not implemented yet")},t.prototype.resetStates=function(e){var t=this;f.tidy((function(){if(!t.stateful)throw new w.AttributeError("Cannot call resetState() on an RNN Layer that is not stateful.");var n=t.inputSpec[0].shape[0];if(null==n)throw new w.ValueError("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states)Array.isArray(t.cell.stateSize)?t.states=t.cell.stateSize.map((function(e){return c.zeros([n,e])})):t.states=[c.zeros([n,t.cell.stateSize])];else if(null==e)Array.isArray(t.cell.stateSize)?t.states=t.cell.stateSize.map((function(e){return c.zeros([n,e])})):t.states[0]=c.zeros([n,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states.length)throw new w.ValueError("Layer "+t.name+" expects "+t.states.length+" state(s), but it received "+e.length+" state value(s). Input received: "+e);for(var r=0;r<t.states.length;++r){var o=e[r],l=Array.isArray(t.cell.stateSize)?t.cell.stateSize[r]:t.cell.stateSize,h=[n,l];if(!f.util.arraysEqual(o.shape,h))throw new w.ValueError("State "+r+" is incompatible with layer "+t.name+": expected shape="+h+", received shape="+o.shape);t.states[r]=o}}}))},t.prototype.standardizeArgs=function(e,t,n){if(Array.isArray(e)){if(null!=t||null!=n)throw new w.ValueError("When inputs is an array, neither initialState or constants should be provided");null!=this.numConstants&&(n=e.slice(e.length-this.numConstants,e.length),e=e.slice(0,e.length-this.numConstants)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function r(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=r(t),constants:n=r(n)}},t.prototype.apply=function(t,n){var r=null==n?null:n.initialState,o=null==n?null:n.constants;null==n&&(n={});var l=this.standardizeArgs(t,r,o);t=l.inputs,r=l.initialState,o=l.constants;var c=[],f=[];if(null!=r){n.initialState=r,c=c.concat(r),this.stateSpec=[];for(var h=0,d=r;h<d.length;h++){var m=d[h];this.stateSpec.push(new y.InputSpec({shape:m.shape}))}f=f.concat(this.stateSpec)}if(null!=o&&(n.constants=o,c=c.concat(o),this.numConstants=o.length),c[0]instanceof N.SymbolicTensor){var v=[t].concat(c),w=this.inputSpec.concat(f),x=this.inputSpec;this.inputSpec=w;var output=e.prototype.apply.call(this,v,n);return this.inputSpec=x,output}return e.prototype.apply.call(this,t,n)},t.prototype.call=function(e,t){var n=this;return f.tidy((function(){var mask=null==t?null:t.mask,r=null==t?null:t.training,o=null==t?null:t.initialState;if(e=E.getExactlyOneTensor(e),null==o){if(n.stateful)throw new w.NotImplementedError("stateful RNN layer is not implemented yet.");o=n.getInitialState(e)}if(null!=mask)throw new w.NotImplementedError("Masking is not implemented for RNN yet");var l=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(o.length!==l)throw new w.ValueError("RNN Layer has "+l+" state(s) but was passed "+o.length+" initial state(s).");e.shape[1],n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var c={training:r},f=T((function(e,t){var r=n.cell.call([e].concat(t),c);return[r[0],r.slice(1)]}),e,o,n.goBackwards,null,null,n.unroll),h=f[0],d=f[1],m=f[2];if(n.stateful)throw new w.NotImplementedError("stateful RNN layer is not implemented yet");var output=n.returnSequences?d:h;return n.returnState?[output].concat(m):output}))},t.prototype.getInitialState=function(e){var t=this;return f.tidy((function(){var n=c.zeros(e.shape);return n=c.sum(n,[1,2]),n=d.expandDims(n),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?d.tile(n,[1,e]):n})):t.cell.stateSize>1?[d.tile(n,[1,t.cell.stateSize])]:[n]}))},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var n=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:n};var r=e.prototype.getConfig.call(this);return Object.assign(t,r),t},t.className="RNN",t}(v.Layer);n.RNN=I,f.serialization.SerializationMap.register(I);var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t=l([f.doc({heading:"Layers",subheading:"Classes"})],t)}(v.Layer);n.RNNCell=k;var P=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=h.getActivation(null==t.activation?n.DEFAULT_ACTIVATION:t.activation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=x.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=x.getInitializer(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=x.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=_.getRegularizer(t.kernelRegularizer),n.recurrentRegularizer=_.getRegularizer(t.recurrentRegularizer),n.biasRegularizer=_.getRegularizer(t.biasRegularizer),n.kernelConstraint=m.getConstraint(t.kernelConstraint),n.recurrentConstraint=m.getConstraint(t.recurrentConstraint),n.biasConstraint=m.getConstraint(t.biasConstraint),n.dropout=A.min([1,A.max([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=A.min([1,A.max([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.stateSize=n.units,n}return o(t,e),t.prototype.build=function(e){e=E.getExactlyOneShape(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(e,t){var n=this;return f.tidy((function(){if(2!==(e=e).length)throw new w.ValueError("SimpleRNNCell expects 2 input Tensors, got "+e.length+".");var t=e[1];if(e=e[0],0!==n.dropout||0!==n.recurrentDropout)throw new w.NotImplementedError("Dropout is not implemented for SimpleRNNCell yet");var r=d.dot(e,n.kernel.read());null!=n.bias&&(r=d.biasAdd(r,n.bias.read()));var output=c.add(r,d.dot(t,n.recurrentKernel.read()));return null!=n.activation&&(output=n.activation.apply(output)),[output,output]}))},t.prototype.getConfig=function(){var t={units:this.units,activation:h.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),recurrentInitializer:x.serializeInitializer(this.recurrentInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:_.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:m.serializeConstraint(this.kernelConstraint),recurrentConstraint:m.serializeConstraint(this.recurrentConstraint),biasConstraint:m.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="SimpleRNNCell",t}(k);n.SimpleRNNCell=P,f.serialization.SerializationMap.register(P);var C=function(e){function t(t){return t.cell=new P(t),e.call(this,t)||this}return o(t,e),t.prototype.call=function(t,n){var r=this;return f.tidy((function(){var mask=null==n?null:n.mask,o=null==n?null:n.training,l=null==n?null:n.initialState;return e.prototype.call.call(r,t,{mask:mask,training:o,initialState:l})}))},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:h.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),recurrentInitializer:x.serializeInitializer(this.recurrentInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:_.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:m.serializeConstraint(this.kernelConstraint),recurrentConstraint:m.serializeConstraint(this.recurrentConstraint),biasConstraint:m.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=e.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},t.className="SimpleRNN",t}(I);n.SimpleRNN=C,f.serialization.SerializationMap.register(C);var R=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=h.getActivation(void 0===t.activation?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=h.getActivation(void 0===t.activation?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=x.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=x.getInitializer(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=x.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=_.getRegularizer(t.kernelRegularizer),n.recurrentRegularizer=_.getRegularizer(t.recurrentRegularizer),n.biasRegularizer=_.getRegularizer(t.biasRegularizer),n.kernelConstraint=m.getConstraint(t.kernelConstraint),n.recurrentConstraint=m.getConstraint(t.recurrentConstraint),n.biasConstraint=m.getConstraint(t.biasConstraint),n.dropout=A.min([1,A.max([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=A.min([1,A.max([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=n.units,n}return o(t,e),t.prototype.build=function(e){var t=(e=E.getExactlyOneShape(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(e,t){var n=this;return f.tidy((function(){if(0!==n.dropout||0!==n.recurrentDropout)throw new w.NotImplementedError("Dropout is not implemented for GRUCell yet");if(2!==(e=e).length)throw new w.ValueError("GRUCell expects 2 input Tensors (inputs, h, c), got "+e.length+".");var t,r,o,l=e[1];if(e=e[0],1===n.implementation){var f=d.sliceAlongLastAxis(n.kernel.read(),0,n.units),h=d.sliceAlongLastAxis(n.kernel.read(),n.units,n.units),m=d.sliceAlongLastAxis(n.kernel.read(),2*n.units,n.units),y=d.sliceAlongLastAxis(n.recurrentKernel.read(),0,n.units),v=d.sliceAlongLastAxis(n.recurrentKernel.read(),n.units,n.units),x=d.sliceAlongLastAxis(n.recurrentKernel.read(),2*n.units,n.units),_=e,N=e,E=e,A=d.dot(_,f),O=d.dot(N,h),S=d.dot(E,m);if(n.useBias){var T=d.sliceAlongFirstAxis(n.bias.read(),0,n.units),I=d.sliceAlongFirstAxis(n.bias.read(),n.units,n.units),k=d.sliceAlongFirstAxis(n.bias.read(),2*n.units,n.units);A=d.biasAdd(A,T),O=d.biasAdd(O,I),S=d.biasAdd(S,k)}var P=l,C=l,R=l;t=n.recurrentActivation.apply(c.add(A,d.dot(P,y))),r=n.recurrentActivation.apply(c.add(O,d.dot(C,v))),o=n.activation.apply(c.add(S,d.dot(c.mul(r,R),x)))}else{var z=d.dot(e,n.kernel.read());n.useBias&&(z=d.biasAdd(z,n.bias.read()));var M=d.dot(l,d.sliceAlongLastAxis(n.recurrentKernel.read(),0,2*n.units)),L=(A=d.sliceAlongLastAxis(z,0,n.units),O=d.sliceAlongLastAxis(z,n.units,n.units),d.sliceAlongLastAxis(M,0,n.units)),D=d.sliceAlongLastAxis(M,n.units,n.units);t=n.recurrentActivation.apply(c.add(A,L)),r=n.recurrentActivation.apply(c.add(O,D)),S=d.sliceAlongLastAxis(z,2*n.units,n.units);var V=d.dot(c.mul(r,l),d.sliceAlongLastAxis(n.recurrentKernel.read(),2*n.units,n.units));o=n.activation.apply(c.add(S,V))}var j=c.add(c.mul(t,l),c.mul(d.scalarPlusArray(d.getScalar(1),c.neg(t)),o));return[j,j]}))},t.prototype.getConfig=function(){var t={units:this.units,activation:h.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),recurrentInitializer:x.serializeInitializer(this.recurrentInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:_.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:m.serializeConstraint(this.kernelConstraint),recurrentConstraint:m.serializeConstraint(this.recurrentConstraint),biasConstraint:m.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="GRUCell",t}(k);n.GRUCell=R,f.serialization.SerializationMap.register(R);var z=function(e){function t(t){return 0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new R(t),e.call(this,t)||this}return o(t,e),t.prototype.call=function(t,n){var r=this;return f.tidy((function(){var mask=null==n?null:n.mask,o=null==n?null:n.training,l=null==n?null:n.initialState;return e.prototype.call.call(r,t,{mask:mask,training:o,initialState:l})}))},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:h.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),recurrentInitializer:x.serializeInitializer(this.recurrentInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:_.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:m.serializeConstraint(this.kernelConstraint),recurrentConstraint:m.serializeConstraint(this.recurrentConstraint),biasConstraint:m.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},t.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},t.className="GRU",t}(I);n.GRU=z,f.serialization.SerializationMap.register(z);var M=function(e){function t(t){var n=e.call(this,t)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=t.units,n.activation=h.getActivation(void 0===t.activation?n.DEFAULT_ACTIVATION:t.activation),n.recurrentActivation=h.getActivation(void 0===t.activation?n.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),n.useBias=null==t.useBias||t.useBias,n.kernelInitializer=x.getInitializer(t.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=x.getInitializer(t.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=x.getInitializer(t.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=t.unitForgetBias,n.kernelRegularizer=_.getRegularizer(t.kernelRegularizer),n.recurrentRegularizer=_.getRegularizer(t.recurrentRegularizer),n.biasRegularizer=_.getRegularizer(t.biasRegularizer),n.kernelConstraint=m.getConstraint(t.kernelConstraint),n.recurrentConstraint=m.getConstraint(t.recurrentConstraint),n.biasConstraint=m.getConstraint(t.biasConstraint),n.dropout=A.min([1,A.max([0,null==t.dropout?0:t.dropout])]),n.recurrentDropout=A.min([1,A.max([0,null==t.recurrentDropout?0:t.recurrentDropout])]),n.implementation=t.implementation,n.stateSize=[n.units,n.units],n}return o(t,e),t.prototype.build=function(e){var t,n,r=(e=E.getExactlyOneShape(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var l=this.biasInitializer,c=this.units;t=new((n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.apply=function(e,t){var n=l.apply([c]),r=(new x.Ones).apply([c]),o=l.apply([2*c]);return d.concatAlongFirstAxis(d.concatAlongFirstAxis(n,r),o)},t}(x.Initializer)).className="CustomInit",n)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,t,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(e,t){var n=this;return f.tidy((function(){if(0!==n.dropout||0!==n.recurrentDropout)throw new w.NotImplementedError("Dropout is not implemented for LSTMCell yet");if(3!==(e=e).length)throw new w.ValueError("LSTMCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var i,t,r,o,l=e[1],f=e[2];if(e=e[0],1===n.implementation){var h=d.sliceAlongLastAxis(n.kernel.read(),0,n.units),m=d.sliceAlongLastAxis(n.kernel.read(),n.units,n.units),y=d.sliceAlongLastAxis(n.kernel.read(),2*n.units,n.units),v=d.sliceAlongLastAxis(n.kernel.read(),3*n.units,n.units),x=d.sliceAlongLastAxis(n.recurrentKernel.read(),0,n.units),_=d.sliceAlongLastAxis(n.recurrentKernel.read(),n.units,n.units),N=d.sliceAlongLastAxis(n.recurrentKernel.read(),2*n.units,n.units),E=d.sliceAlongLastAxis(n.recurrentKernel.read(),3*n.units,n.units),A=e,O=e,S=e,T=e,I=d.dot(A,h),k=d.dot(O,m),P=d.dot(S,y),C=d.dot(T,v);if(n.useBias){var R=d.sliceAlongFirstAxis(n.bias.read(),0,n.units),z=d.sliceAlongFirstAxis(n.bias.read(),n.units,n.units),M=d.sliceAlongFirstAxis(n.bias.read(),2*n.units,n.units),L=d.sliceAlongFirstAxis(n.bias.read(),3*n.units,n.units);I=d.biasAdd(I,R),k=d.biasAdd(k,z),P=d.biasAdd(P,M),C=d.biasAdd(C,L)}var D=l,V=l,j=l,F=l;i=n.recurrentActivation.apply(c.add(I,d.dot(D,x))),t=n.recurrentActivation.apply(c.add(k,d.dot(V,_))),r=c.add(c.mul(t,f),c.mul(i,n.activation.apply(c.add(P,d.dot(j,N))))),o=n.recurrentActivation.apply(c.add(C,d.dot(F,E)))}else{var B=d.dot(e,n.kernel.read());B=c.add(B,d.dot(l,n.recurrentKernel.read())),n.useBias&&(B=d.biasAdd(B,n.bias.read()));var U=d.sliceAlongLastAxis(B,0,n.units),G=d.sliceAlongLastAxis(B,n.units,n.units),W=d.sliceAlongLastAxis(B,2*n.units,n.units),H=d.sliceAlongLastAxis(B,3*n.units,n.units);i=n.recurrentActivation.apply(U),t=n.recurrentActivation.apply(G),r=c.add(c.mul(t,f),c.mul(i,n.activation.apply(W))),o=n.recurrentActivation.apply(H)}var K=c.mul(o,n.activation.apply(r));return[K,K,r]}))},t.prototype.getConfig=function(){var t={units:this.units,activation:h.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),recurrentInitializer:x.serializeInitializer(this.recurrentInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:_.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:m.serializeConstraint(this.kernelConstraint),recurrentConstraint:m.serializeConstraint(this.recurrentConstraint),biasConstraint:m.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.className="LSTMCell",t}(k);n.LSTMCell=M,f.serialization.SerializationMap.register(M);var L=function(e){function t(t){return 0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new M(t),e.call(this,t)||this}return o(t,e),t.prototype.call=function(t,n){var r=this;return f.tidy((function(){var mask=null==n?null:n.mask,o=null==n?null:n.training,l=null==n?null:n.initialState;return e.prototype.call.call(r,t,{mask:mask,training:o,initialState:l})}))},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={units:this.units,activation:h.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:x.serializeInitializer(this.kernelInitializer),recurrentInitializer:x.serializeInitializer(this.recurrentInitializer),biasInitializer:x.serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:_.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:_.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:_.serializeRegularizer(this.biasRegularizer),activityRegularizer:_.serializeRegularizer(this.activityRegularizer),kernelConstraint:m.serializeConstraint(this.kernelConstraint),recurrentConstraint:m.serializeConstraint(this.recurrentConstraint),biasConstraint:m.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=e.prototype.getConfig.call(this);return delete n.cell,Object.assign(t,n),t},t.fromConfig=function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)},t.className="LSTM",t}(I);n.LSTM=L,f.serialization.SerializationMap.register(L);var D=function(e){function t(t){var n=e.call(this,t)||this;return n.cells=t.cells,n}return o(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var e=[],t=0,n=this.cells.slice().reverse();t<n.length;t++){var r=n[t];Array.isArray(r.stateSize)?e.push.apply(e,r.stateSize):e.push(r.stateSize)}return e},enumerable:!0,configurable:!0}),t.prototype.call=function(e,t){var n=this;return f.tidy((function(){for(var r=(e=e).slice(1),o=[],l=0,c=n.cells.slice().reverse();l<c.length;l++){var f=c[l];Array.isArray(f.stateSize)?o.push(r.splice(0,f.stateSize.length)):o.push(r.splice(0,1))}o.reverse();for(var h,d=[],i=0;i<n.cells.length;++i)f=n.cells[i],r=o[i],h=0===i?[e[0]].concat(r):[h[0]].concat(r),h=f.call(h,t),d.push(h.slice(1));r=[];for(var m=0,y=d.slice().reverse();m<y.length;m++){var v=y[m];r.push.apply(r,v)}return[h[0]].concat(r)}))},t.prototype.build=function(e){var t;E.isArrayOfShapes(e)&&(e=e[0]),e=e;for(var n=0,r=this.cells;n<r.length;n++){var o=r[n];o.build(e),t=Array.isArray(o.stateSize)?o.stateSize[0]:o.stateSize,e=[e[0],t]}this.built=!0},t.prototype.getConfig=function(){for(var t=[],n=0,r=this.cells;n<r.length;n++){var o=r[n];t.push({className:this.getClassName(),config:o.getConfig()})}var l={cells:t},c=e.prototype.getConfig.call(this);return Object.assign(l,c),l},t.fromConfig=function(e,t,n){void 0===n&&(n={});for(var r=[],o=0,l=t.cells;o<l.length;o++){var c=l[o];r.push(S.deserialize(c,n))}return new e({cells:r})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var e=[],t=0,n=this.cells;t<n.length;t++){var r=n[t];e.push.apply(e,r.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var e=[],t=0,n=this.cells;t<n.length;t++){var r=n[t];e.push.apply(e,r.nonTrainableWeights)}if(!this.trainable){for(var o=[],l=0,c=this.cells;l<c.length;l++)r=c[l],o.push.apply(o,r.trainableWeights);return o.concat(e)}return e},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var e=[],t=0,n=this.cells;t<n.length;t++){var r=n[t];e.push.apply(e,r.weights)}return O.batchGetValue(e)},t.prototype.setWeights=function(e){for(var t=[],n=0,r=this.cells;n<r.length;n++)for(var o=r[n],l=o.weights.length,c=e.splice(l),i=0;i<o.weights.length;++i)t.push([o.weights[i],c[i]]);O.batchSetValue(t)},t.className="StackedRNNCells",t}(k);n.StackedRNNCells=D,f.serialization.SerializationMap.register(D)},{"../activations":156,"../backend/tfjs_backend":158,"../constraints":161,"../engine/topology":163,"../errors":165,"../initializers":168,"../regularizers":185,"../types":186,"../utils/generic_utils":188,"../utils/math_utils":189,"../variables":191,"./serialization":179,"@tensorflow/tfjs-core":50}],179:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("../utils/generic_utils");n.deserialize=function(e,t){return void 0===t&&(t={}),o.deserializeKerasObject(e,r.serialization.SerializationMap.getMap().classNameMap,t,"layer")}},{"../utils/generic_utils":188,"@tensorflow/tfjs-core":50}],180:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var l=e("@tensorflow/tfjs-core"),c=e("@tensorflow/tfjs-core"),f=e("../backend/tfjs_backend"),h=e("../engine/topology"),d=e("../errors"),m=e("../utils/generic_utils"),y=e("./recurrent"),v=e("./serialization"),w=function(e){function t(t){var n=e.call(this,t)||this;return n.layer=t.layer,n}return o(t,e),t.prototype.build=function(e){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(e){this.layer.setWeights(e)},t.prototype.getConfig=function(){var t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t,n){void 0===n&&(n={});var r=t.layer,o=v.deserialize(r,n);delete t.layer;var l={layer:o};return Object.assign(l,t),new e(l)},t}(h.Layer);n.Wrapper=w;var x=function(e){function t(t){var n=e.call(this,t)||this;return n.supportsMasking=!0,n}return o(t,e),t.prototype.build=function(t){if((t=m.getExactlyOneShape(t)).length<3)throw new d.ValueError("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];var n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),e.prototype.build.call(this,t)},t.prototype.computeOutputShape=function(e){var t=[(e=m.getExactlyOneShape(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){return e=m.getExactlyOneTensor(e),y.rnn((function(e,r){return[n.layer.call(e,t),[]]}),e,[],!1,null,null,!1,e.shape[1])[1]}))},t.className="TimeDistributed",t}(w);function _(e){m.checkStringTypeUnionValue(n.VALID_BIDIRECTIONAL_MERGE_MODES,"BidirectionalMergeMode",e)}n.TimeDistributed=x,c.serialization.SerializationMap.register(x),n.VALID_BIDIRECTIONAL_MERGE_MODES=["sum","mul","concat","ave"],n.checkBidirectionalMergeMode=_;var N=function(e){function t(t){var n=e.call(this,t)||this;n.forwardLayer=t.layer;var r=t.layer.getConfig();if(r.goBackwards=!0!==r.goBackwards,n.backwardLayer=v.deserialize({className:t.layer.getClassName(),config:r}),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,_(t.mergeMode),n.mergeMode=t.mergeMode,t.weights)throw new d.NotImplementedError("weights support is not implemented for Bidirectional layer yet.");return n._stateful=t.layer.stateful,n.returnSequences=t.layer.returnSequences,n.returnState=t.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=t.layer.inputSpec,n}return o(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))},t.prototype.computeOutputShape=function(e){var t,n,r,o=this.forwardLayer.computeOutputShape(e);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState?(r=o.slice(1),t=o[0]):t=o[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):m.singletonOrArray(n)},t.prototype.apply=function(t,n){var r=null;if(null!=n&&(r=n.initialState),Array.isArray(t)&&(r=t.slice(1),t=t[0]),null==r||0===r.length)return e.prototype.apply.call(this,t,n);throw new d.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.")},t.prototype.call=function(e,t){var n=this;return c.tidy((function(){if(null!=t.mask)throw new d.NotImplementedError("The support for masking is not implemented for Bidirectional layers yet.");if(null!=t.initialState)throw new d.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.");var r,output,o=n.forwardLayer.call(e,t),c=n.backwardLayer.call(e,t);return n.returnState&&(Array.isArray(o)&&(r=o.slice(1).concat(c.slice(1))),o=o[0],c=c[0]),n.returnSequences&&(c=l.reverse(c,1)),"concat"===n.mergeMode?output=f.concatenate([o,c]):"sum"===n.mergeMode?output=l.add(o,c):"ave"===n.mergeMode?output=f.scalarTimesArray(f.getScalar(.5),l.add(o,c)):"mul"===n.mergeMode?output=l.mul(o,c):null==n.mergeMode&&(output=[o,c]),n.returnState?null==n.mergeMode?output.concat(r):[output].concat(r):output}))},t.prototype.resetStates=function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(e){var t=this;f.nameScope(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),f.nameScope(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var t={mergeMode:this.mergeMode},n=e.prototype.getConfig.call(this);return Object.assign(t,n),t},t.fromConfig=function(e,t){var n=v.deserialize(t.layer);if(delete t.layer,null!=t.numConstants)throw new d.NotImplementedError("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)},t.className="Bidirectional",t}(w);n.Bidirectional=N,c.serialization.SerializationMap.register(N)},{"../backend/tfjs_backend":158,"../engine/topology":163,"../errors":165,"../utils/generic_utils":188,"./recurrent":178,"./serialization":179,"@tensorflow/tfjs-core":50}],181:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("@tensorflow/tfjs-core"),l=e("./backend/tfjs_backend"),c=e("./errors");function f(e,t){return o.tidy((function(){var n=r.sum(l.square(e),t,!0),c=l.scalarTimesArray(o.scalar(l.epsilon()),r.onesLike(e)),f=r.sqrt(r.maximum(n,c));return r.div(e,f)}))}function h(e,t){return o.tidy((function(){return r.mean(l.square(r.sub(t,e)),-1)}))}function d(e,t){return o.tidy((function(){return r.mean(r.abs(r.sub(t,e)),-1)}))}function m(e,t){return o.tidy((function(){var n=r.sub(e,t),o=r.clipByValue(r.abs(e),l.epsilon(),Number.MAX_VALUE),c=r.abs(r.div(n,o));return l.scalarTimesArray(l.getScalar(100),r.mean(c,-1))}))}function y(e,t){return o.tidy((function(){var n=l.getScalar(1),o=r.clipByValue(t,l.epsilon(),Number.MAX_VALUE),c=r.log(l.scalarPlusArray(n,o)),f=r.clipByValue(e,l.epsilon(),Number.MAX_VALUE),h=r.log(l.scalarPlusArray(n,f));return r.mean(l.square(r.sub(c,h)),-1)}))}function v(e,t){return o.tidy((function(){var n=l.getScalar(0),o=l.getScalar(1),c=r.maximum(n,r.sub(o,r.mul(e,t)));return r.mean(l.square(c),-1)}))}function w(e,t){return o.tidy((function(){var n=l.getScalar(0),o=l.getScalar(1),c=r.maximum(n,r.sub(o,r.mul(e,t)));return r.mean(c,-1)}))}function x(e,t){return o.tidy((function(){var n=l.getScalar(0),o=l.getScalar(1),c=r.sum(r.mul(e,t),-1),f=r.max(r.mul(r.sub(o,e),t),-1);return r.maximum(n,l.scalarPlusArray(o,r.sub(f,c)))}))}function _(e,t){return o.tidy((function(){var n=l.getScalar(Math.log(2)),o=r.sub(t,e),c=r.sub(r.add(o,r.softplus(l.scalarTimesArray(l.getScalar(-2),o))),n);return r.mean(c,-1)}))}function N(e,output,t){return void 0===t&&(t=!1),o.tidy((function(){if(t)output=r.softmax(output);else{var n=r.sum(output,l.shape(output).length-1,!0);output=r.div(output,n)}return output=r.clipByValue(output,l.epsilon(),1-l.epsilon()),r.neg(r.sum(r.mul(e.toFloat(),r.log(output)),l.shape(output).length-1))}))}function E(e,output,t){return void 0===t&&(t=!1),o.tidy((function(){var n=r.floor(l.flatten(e)).toInt(),o=l.shape(output);return N(r.oneHot(n,o[o.length-1]).reshape(o),output,t)}))}function A(e,output){return o.tidy((function(){var t=r.maximum(output,r.zerosLike(output)),n=r.mul(output,e),o=r.log(r.add(l.getScalar(1),r.exp(r.neg(r.abs(output)))));return r.add(r.sub(t,n),o)}))}function O(e,t){return o.tidy((function(){var n;return n=r.clipByValue(t,l.epsilon(),1-l.epsilon()),n=r.log(r.div(n,r.sub(r.onesLike(n),n))),r.mean(A(e,n),-1)}))}function S(e,t){return o.tidy((function(){var n=r.clipByValue(e,l.epsilon(),1),o=r.clipByValue(t,l.epsilon(),1);return r.sum(r.mul(e,r.log(r.div(n,o))),-1)}))}function T(e,t){return o.tidy((function(){var n=r.log(l.scalarPlusArray(l.getScalar(l.epsilon()),t));return r.mean(r.sub(t,r.mul(e,n)),-1)}))}function I(e,t){return o.tidy((function(){var n=f(e,-1),o=f(t,-1),l=r.mul(n,o);return r.neg(r.sum(l,-1))}))}n.l2Normalize=f,n.meanSquaredError=h,n.meanAbsoluteError=d,n.meanAbsolutePercentageError=m,n.meanSquaredLogarithmicError=y,n.squaredHinge=v,n.hinge=w,n.categoricalHinge=x,n.logcosh=_,n.categoricalCrossentropy=N,n.sparseCategoricalCrossentropy=E,n.sigmoidCrossEntropyWithLogits=A,n.binaryCrossentropy=O,n.kullbackLeiblerDivergence=S,n.poisson=T,n.cosineProximity=I,n.mse=h,n.MSE=h,n.mae=d,n.MAE=d,n.mape=m,n.MAPE=m,n.msle=y,n.MSLE=y,n.kld=S,n.KLD=S,n.cosine=I,n.get=function(e){var t={meanSquaredError:h,meanAbsoluteError:d,meanAbsolutePercentageError:m,meanSquaredLogarithmicError:y,squaredHinge:v,hinge:w,categoricalHinge:x,logcosh:_,categoricalCrossentropy:N,sparseCategoricalCrossentropy:E,binaryCrossentropy:O,kullbackLeiblerDivergence:S,poisson:T,cosineProximity:I};if("string"==typeof e){if(e in t)return t[e];throw new c.ValueError("Unknown loss "+e)}return e}},{"./backend/tfjs_backend":158,"./errors":165,"@tensorflow/tfjs-core":50}],182:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("@tensorflow/tfjs-core"),l=e("./backend/tfjs_backend"),c=e("./errors"),f=e("./losses"),h=e("./losses");function d(e,t){return o.tidy((function(){var n=l.scalarTimesArray(l.getScalar(.5),r.onesLike(t)),o=l.cast(r.greater(t,n),e.dtype);return r.mean(r.equal(e,o),-1)}))}function m(e,t){return o.tidy((function(){return l.cast(r.equal(r.argMax(e,-1),r.argMax(t,-1)),"float32")}))}n.binaryAccuracy=d,n.categoricalAccuracy=m,n.binaryCrossentropy=function(e,t){return h.binaryCrossentropy(e,t)},n.sparseCategoricalAccuracy=function(e,t){throw new c.NotImplementedError},n.topKCategoricalAccuracy=function(e,t){throw new c.NotImplementedError},n.sparseTopKCategoricalAccuracy=function(e,t){throw new c.NotImplementedError},n.mse=f.meanSquaredError,n.MSE=f.meanSquaredError,n.mae=f.meanAbsoluteError,n.MAE=f.meanAbsoluteError,n.mape=f.meanAbsolutePercentageError,n.MAPE=f.meanAbsolutePercentageError,n.categoricalCrossentropy=f.categoricalCrossentropy,n.cosine=f.cosineProximity,n.sparseCategoricalCrossentropy=f.sparseCategoricalCrossentropy,n.get=function(e){var t={binaryAccuracy:d,categoricalAccuracy:m,categoricalCrossentropy:n.categoricalCrossentropy,sparseCategoricalCrossentropy:n.sparseCategoricalCrossentropy,mse:n.mse,MSE:n.MSE,mae:n.mae,MAE:n.MAE,mape:n.mape,MAPE:n.MAPE,cosine:n.cosine};if("string"==typeof e&&e in t)return t[e];if("string"!=typeof e&&null!=e)return e;throw new c.ValueError("Unknown metric "+e)}},{"./backend/tfjs_backend":158,"./errors":165,"./losses":181,"@tensorflow/tfjs-core":50}],183:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l},c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},f=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var h=e("@tensorflow/tfjs-core"),d=e("./backend/tfjs_backend"),m=e("./engine/topology"),y=e("./engine/training"),v=e("./errors"),w=e("./layers/serialization"),x=e("./utils/generic_utils"),_=e("./utils/serialization_utils");function N(e,t){return c(this,void 0,void 0,(function(){var n,r,o,l,c,d,m,y;return f(this,(function(f){switch(f.label){case 0:return null!=(n=e.modelTopology).model_config&&(n=n.model_config),r=_.convertPythonicToTs(n),o=w.deserialize(r,t),null==e.weightsManifest?[3,2]:[4,h.io.loadWeights(e.weightsManifest,e.pathPrefix,o.weights.map((function(e){return e.originalName})))];case 1:for(l=f.sent(),c={},d=0,m=o.weights;d<m.length;d++)y=m[d],c[y.originalName]=l[y.originalName];o.loadWeights(c,null,!0),f.label=2;case 2:return[2,o]}}))}))}function E(e,t){return c(this,void 0,void 0,(function(){var n,r;return f(this,(function(o){switch(o.label){case 0:if(null==e.load)throw new v.ValueError("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(n=o.sent(),r=w.deserialize(_.convertPythonicToTs(n.modelTopology),t),null!=n.weightData){if(null==n.weightSpecs)throw new v.ValueError("Model artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");r.loadWeights(h.io.decodeWeights(n.weightData,n.weightSpecs),!1,!0)}return[2,r]}}))}))}function A(e){return c(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:return[4,n.sent().json()];case 2:if(null==(t=n.sent()).modelTopology)throw new v.ValueError('Missing field "modelTopology" from model JSON at path'+e);if(null==t.weightsManifest)throw new v.ValueError('Missing field "weightsManifest" from model JSON at path'+e);return t.pathPrefix=e.substring(0,e.lastIndexOf("/")),[2,N(t)]}}))}))}n.modelFromJSON=N,n.loadModelInternal=function(e){return c(this,void 0,void 0,(function(){var t;return f(this,(function(n){if("string"==typeof e){if(0===(t=h.io.getLoadHandlers(e)).length)return[2,A(e)];if(t.length>1)throw new v.ValueError("Found more than one ("+t.length+") load handlers for URL '"+e+"'");e=t[0]}return[2,E(e)]}))}))},n.loadModelFromIOHandler=E,n.loadModelFromPath=A;var O=function(e){function t(t){var n=e.call(this,{inputs:[],outputs:[]})||this;if(t=t||{},n.trainable=!0,n._updatable=!0,n.built=!1,n.name=null!=t.name?t.name:d.getUid("sequential_"),null!=t.layers)for(var r=0,o=t.layers;r<o.length;r++){var l=o[r];n.add(l)}return n}return o(t,e),n=t,t.prototype.add=function(e){if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new v.ValueError("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var t=m.Input({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(1!==e.inboundNodes.length)throw new v.ValueError("A layer added to a Sequential model must not already be connected somewhere else. Model received layer "+e.name+" which has "+e.inboundNodes.length+" pre-existing inbound connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new v.ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=m.getSourceInputs(this.outputs[0]),new m.Node({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:x.pyListRepeat(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var n=e.apply(this.outputs[0]);if(Array.isArray(n))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[n],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1},t.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(e,t){return null==this.model&&this.build(),this.model.call(e,t)},t.prototype.build=function(e){if(0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new y.Model({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.model.updatable=this.updatable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.setWeights=function(e){null==this.model&&this.build(),this.model.setWeights(e)},Object.defineProperty(t.prototype,"updatable",{get:function(){return this._updatable},set:function(e){this.built&&(this.model.updatable=e),this._updatable=e},enumerable:!0,configurable:!0}),t.prototype.evaluate=function(e,t,n){if(void 0===n&&(n={}),!this.built)throw new v.RuntimeError("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)},t.prototype.predict=function(e,t){return void 0===t&&(t={}),null==this.model&&this.build(),this.model.predict(e,t)},t.prototype.predictOnBatch=function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)},t.prototype.compile=function(e){this.build(),this.model.compile(e),this.optimizer=this.model.optimizer,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},t.prototype.fit=function(e,t,n){return void 0===n&&(n={}),c(this,void 0,void 0,(function(){return f(this,(function(r){if(!this.built)throw new v.RuntimeError("The model needs to be compiled before being used.");return[2,this.model.fit(e,t,n)]}))}))},t.fromConfig=function(e,t){var r=new e({});if(!(r instanceof n))throw new v.ValueError("Sequential.fromConfig called on non-Sequential input: "+r);if(!(t instanceof Array))throw new v.ValueError("Sequential.fromConfig called without an array of configs");if(null==t[0].className||"Merge"===t[0].className)throw new v.ValueError("Legacy serialization format not supported yet.");for(var o=0,l=t;o<l.length;o++){var c=l[o],f=w.deserialize(c);r.add(f)}return r},t.prototype.getConfig=function(){for(var e=[],t=0,n=this.layers;t<n.length;t++){var r=n[t];e.push({className:r.getClassName(),config:r.getConfig()})}return e},t.className="Sequential",l([h.doc({heading:"Models",subheading:"Classes"})],t.prototype,"add",null),l([h.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"evaluate",null),l([h.doc({heading:"Models",subheading:"Classes",configParamIndices:[1]})],t.prototype,"predict",null),l([h.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],t.prototype,"fit",null),t=n=l([h.doc({heading:"Models",subheading:"Classes"})],t);var n}(y.Model);n.Sequential=O,h.serialization.SerializationMap.register(O)},{"./backend/tfjs_backend":158,"./engine/topology":163,"./engine/training":164,"./errors":165,"./layers/serialization":179,"./utils/generic_utils":188,"./utils/serialization_utils":190,"@tensorflow/tfjs-core":50}],184:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./backend/tfjs_backend"),l=e("./errors");n.getOptimizer=function(e){var t={Adagrad:function(){return r.train.adagrad(.01)},Adam:function(){return r.train.adam(.001,.9,.999,o.epsilon())},RMSProp:function(){return r.train.rmsprop(.001,.9,null,o.epsilon())},SGD:function(){return r.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adam=t.Adam,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new l.ValueError("Unknown Optimizer "+e)}},{"./backend/tfjs_backend":158,"./errors":165,"@tensorflow/tfjs-core":50}],185:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs-core"),f=e("./backend/tfjs_backend"),h=e("./utils/generic_utils"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(c.serialization.Serializable);n.Regularizer=d;var m=function(e){function t(t){var n=e.call(this)||this,r=null==t||null==t.l1?.01:t.l1,o=null==t||null==t.l2?.01:t.l2;return n.hasL1=0!==r,n.hasL2=0!==o,n.l1=f.getScalar(r),n.l2=f.getScalar(o),n}return o(t,e),t.prototype.apply=function(e){var t=this;return c.tidy((function(){var n=c.zeros([1]);return t.hasL1&&(n=c.add(n,c.sum(f.scalarTimesArray(t.l1,c.abs(e))))),t.hasL2&&(n=c.add(n,c.sum(f.scalarTimesArray(t.l2,f.square(e))))),n.asScalar()}))},t.prototype.getConfig=function(){return{l1:this.l1.dataSync()[0],l2:this.l2.dataSync()[0]}},t.fromConfig=function(e,t){return new e({l1:t.l1,l2:t.l2})},t.className="L1L2",t=l([c.doc({heading:"Regularizers",namespace:"regularizers"})],t)}(d);function y(e,t){return void 0===t&&(t={}),h.deserializeKerasObject(e,c.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}n.L1L2=m,c.serialization.SerializationMap.register(m),n.l1=function(e){return new m({l1:null!=e?e.l1:null,l2:0})},n.l2=function(e){return new m({l2:null!=e?e.l2:null,l1:0})},n.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={l1l2:"L1L2"},n.serializeRegularizer=function(e){return h.serializeKerasObject(e)},n.deserializeRegularizer=y,n.getRegularizer=function(e){return null==e?null:"string"==typeof e?y({className:e in n.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?n.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e,config:{}}):e instanceof d?e:y(e)}},{"./backend/tfjs_backend":158,"./utils/generic_utils":188,"@tensorflow/tfjs-core":50}],186:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(n,"__esModule",{value:!0});var o=e("@tensorflow/tfjs-core"),l=e("./common"),c=0;function f(){return c++}n.getNextUniqueTensorId=f;var h=function(){function e(e,t,n,r,o,c,h){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=o,this.outputTensorIndex=h,this.id=f(),null!=c&&(this.originalName=l.getScopedTensorName(c),this.name=l.getUniqueTensorName(this.originalName)),this.rank=t.length}return e=r([o.doc({heading:"Models",subheading:"Classes"})],e)}();n.SymbolicTensor=h},{"./common":160,"@tensorflow/tfjs-core":50}],187:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../errors"),o=e("./generic_utils"),l=e("./math_utils");n.normalizeArray=function(e,t,n){if("number"==typeof e)return o.pyListRepeat(e,t);if(e.length!==t)throw new r.ValueError("The "+n+" argument must be a tuple of "+t+" integers. Received: "+e.length+" elements.");for(var i=0;i<t;++i){var c=e[i];if(!l.isInteger(c))throw new r.ValueError("The "+n+" argument must be a tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+c)}return e},n.convOutputLength=function(e,t,n,r,o){return void 0===o&&(o=1),null==e?e:(l="same"===n?e:e-(t+(t-1)*(o-1))+1,Math.floor((l+r-1)/r));var l},n.deconvLength=function(e,t,n,o){if(null==e)return null;if("valid"===o)e=e*t+l.max([n-t,0]);else{if("same"!==o)throw new r.ValueError("Unsupport padding mode: "+o+".");e*=t}return e}},{"../errors":165,"./generic_utils":188,"./math_utils":189}],188:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../errors");function l(e){return Array.isArray(e)?e:[e]}n.pyListRepeat=function(e,t){if(Array.isArray(e)){for(var n=[],i=0;i<t;i++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n},n.assert=function(e,t){if(!e)throw new o.AssertionError(t)},n.count=function(e,t){for(var n=0,r=0,o=e;r<o.length;r++)o[r]===t&&n++;return n},n.singletonOrArray=function(e){return 1===e.length?e[0]:e},n.toList=l,n.objectListUid=function(e){for(var t="",n=0,r=l(e);n<r.length;n++){var c=r[n];if(null==c.id)throw new o.ValueError("Object "+c+" passed to objectListUid without an id");""!==t&&(t+=", "),t+=Math.abs(c.id)}return t},n.isArrayOfShapes=function(e){return Array.isArray(e)&&Array.isArray(e[0])},n.normalizeShapeList=function(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]},n.toSnakeCase=function(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t},n.toCamelCase=function(e){return e.length<=1?e:-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))};var c={};function f(a,b){return a<b?-1:a>b?1:0}n.serializeKerasObject=function(e){return null==e?null:{className:e.getClassName(),config:e.getConfig()}},n.deserializeKerasObject=function(e,t,n,l){if(void 0===t&&(t={}),void 0===n&&(n={}),void 0===l&&(l="object"),"string"==typeof e){var f=e,h=void 0;if(f in n)h=n[f];else if(f in c)h=c[f];else if(null==(h=t[f]))throw new o.ValueError("Unknown "+l+": "+e);return h}var d=e;if(null==d.className||null==d.config)throw new o.ValueError(l+": Improper config format: "+JSON.stringify(d)+".\n'className' and 'config' must set.");var m,y,v,w=d.className,x=void 0,_=void 0;if(w in n?(x=(m=n.get(w))[0],_=m[1]):w in c?(x=(y=c.className)[0],_=y[1]):w in t&&(x=(v=t[w])[0],_=v[1]),null==x)throw new o.ValueError("Unknown "+l+": "+w);if(null!=_){for(var N={},E=0,A=Object.keys(c);E<A.length;E++)N[P=A[E]]=c[P];for(var O=0,S=Object.keys(n);O<S.length;O++)N[P=S[O]]=n[P];d.config.customObjects=N;for(var T=r({},c),I=0,k=Object.keys(n);I<k.length;I++){var P=k[I];c[P]=n[P]}var C=_(x,d.config);return c=r({},T),C}T=r({},c);for(var R=0,z=Object.keys(n);R<z.length;R++)P=z[R],c[P]=n[P];return C=new x(d.config),c=r({},T),C},n.getExactlyOneTensor=function(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new o.ValueError("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t},n.getExactlyOneShape=function(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new o.ValueError("Expected exactly 1 Shape; got "+e.length)}return e},n.numberCompare=f,n.reverseNumberCompare=function(a,b){return-1*f(a,b)},n.stringToDType=function(e){switch(e){case"float32":return"float32";default:throw new o.ValueError("Invalid dtype: "+e)}},n.stringsEqual=function(e,t){if(null==e||null==t)return e===t;if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0},n.unique=function(e){if(null==e)return e;for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];-1===t.indexOf(o)&&t.push(o)}return t},n.isObjectEmpty=function(e){if(null==e)throw new o.ValueError("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},n.checkStringTypeUnionValue=function(e,label,t){if(null!=t&&e.indexOf(t)<0)throw new o.ValueError(t+" is not a valid "+label+".  Valid values are "+e+" or null/undefined.")}},{"../errors":165}],189:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("@tensorflow/tfjs-core"),l=e("../errors");function c(e){return e=Array.isArray(e)?new Float32Array(e):e,o.tensor1d(e)}function f(e){return r.sum(c(e)).dataSync()[0]}function h(e){return f(e)/e.length}n.isInteger=function(e){return e===parseInt(e.toString(),10)},n.arrayProd=function(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r},n.min=function(e){return r.min(c(e)).dataSync()[0]},n.max=function(e){return r.max(c(e)).dataSync()[0]},n.sum=f,n.mean=h,n.variance=function(e){var t=r.sub(c(e),o.scalar(h(e)));return r.sum(r.mulStrict(t,t)).dataSync()[0]/e.length},n.median=function(e){var t=e.slice().sort((function(a,b){return a-b})),n=Math.floor((t.length-1)/2),r=Math.ceil((t.length-1)/2);return n===r?t[n]:(t[n]+t[r])/2},n.range=function(e,t){if(t<e)throw new l.ValueError("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],i=e;i<t;++i)n.push(i);return n}},{"../errors":165,"@tensorflow/tfjs-core":50}],190:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../utils/generic_utils");function o(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}n.convertPythonicToTs=function e(t,n){if(null===t)return null;if("string"==typeof t)return r.toCamelCase(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var l=[],c=t.length,i=0;i<c;++i){var f=t[i];o(n,i,f)?l.push(f):l.push(e(f,n))}return l}for(var h={},d=0,m=Object.keys(t);d<m.length;d++){var y=m[d],v=t[y];if("name"===y&&"string"==typeof v)h[y]=v;else{var w=r.toCamelCase(y);h[w]=e(v,w)}}return h},n.convertTsToPythonic=function e(t,n){if(null==t)return null;if("string"==typeof t)return r.toSnakeCase(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var l=[],c=t.length,i=0;i<c;++i){var f=t[i];o(n,i,f)?l.push(f):l.push(e(f,n))}return l}for(var h={},d=0,m=Object.keys(t);d<m.length;d++){var y=m[d],v=t[y],w=r.toSnakeCase(y);h[w]="name"!==y&&"className"!==y||"string"!=typeof v?e(v,y):v}return h}},{"../utils/generic_utils":188}],191:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=e("./backend/tfjs_backend"),l=e("./common"),c=e("./errors"),f=e("./types"),h="Variable",d=function(){function e(e,t,n,o,c){void 0===t&&(t="float32"),void 0===n&&(n=h),void 0===o&&(o=!0),void 0===c&&(c=null),this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=f.getNextUniqueTensorId(),n=null==n?h:n,this.originalName=l.getScopedTensorName(n),this.name=l.getUniqueTensorName(this.originalName),this.trainable=o,this.constraint=c,this.val=r.variable(e,this.trainable,this.name,this.dtype)}return e.prototype.read=function(){return this.val},e.prototype.write=function(e){return function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val)),this},e}();n.LayerVariable=d,n.variable=function(e,t,n,r){return new d(e,t,n,!0,r)},n.zerosVariable=function(e,t,n){return new d(r.zeros(e),t,n)},n.zerosLike=function(e,t,n){return new d(r.zerosLike(e),t,n)},n.onesVariable=function(e,t,n){var o=r.ones(e);return new d(o,t,n)},n.onesLike=function(e,t,n){var o=r.onesLike(e);return new d(o,t,n)},n.eyeVariable=function(e,t,n){return new d(r.eye(e),t,n)},n.randomUniformVariable=function(e,t,n,o,l,c){return void 0===c&&(c="randomUniform"),new d(r.randomUniform(e,t,n,o),o,c)},n.truncatedNormalVariable=function(e,t,n,o,l,f){if(void 0===t&&(t=0),void 0===n&&(n=1),void 0===f&&(f="truncatedNormal"),"bool"===o)throw new c.NotImplementedError("randomNormal does not support dType bool.");return new d(r.truncatedNormal(e,t,n,o,l),o,f)},n.randomNormalVariable=function(e,t,n,r,l,f){if(void 0===t&&(t=0),void 0===n&&(n=1),void 0===f&&(f="randomNormal"),"bool"===r)throw new c.NotImplementedError("randomNormalVariable does not support dType bool.");return new d(o.randomNormal(e,t,n,r,l),r,f)},n.update=function(e,t){return e.write(t)},n.updateAdd=function(e,t){return e.write(r.add(e.read(),t))},n.updateSub=function(e,t){return e.write(r.sub(e.read(),t))},n.batchGetValue=function(e){return e.map((function(e){return e.read()}))},n.batchSetValue=function(e){e.map((function(e){e[0].write(e[1])}))}},{"./backend/tfjs_backend":158,"./common":160,"./errors":165,"./types":186,"@tensorflow/tfjs-core":50}],192:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.version="0.6.2"},{}],193:[function(e,t,n){"use strict";function r(e){for(var p in e)n.hasOwnProperty(p)||(n[p]=e[p])}Object.defineProperty(n,"__esModule",{value:!0}),r(e("@tensorflow/tfjs-core")),r(e("@tensorflow/tfjs-layers")),r(e("@tensorflow/tfjs-converter"));var o=e("@tensorflow/tfjs-core"),l=e("@tensorflow/tfjs-layers"),c=e("@tensorflow/tfjs-converter"),f=e("./version");n.version={"tfjs-core":o.version_core,"tfjs-layers":l.version_layers,"tfjs-converter":c.version_converter,tfjs:f.version}},{"./version":194,"@tensorflow/tfjs-converter":12,"@tensorflow/tfjs-core":50,"@tensorflow/tfjs-layers":167}],194:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.version="0.11.2"},{}],195:[function(e,t,n){},{}],196:[function(e,t,n){(function(e){(function(){var r,o=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",f="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",m=1,y=2,v=4,w=1,x=2,_=1,N=2,E=4,A=8,O=16,S=32,T=64,I=128,k=256,P=512,C=30,R="...",z=800,M=16,L=1,D=2,V=1/0,j=9007199254740991,F=17976931348623157e292,B=NaN,U=4294967295,G=U-1,W=U>>>1,H=[["ary",I],["bind",_],["bindKey",N],["curry",A],["curryRight",O],["flip",P],["partial",S],["partialRight",T],["rearg",k]],K="[object Arguments]",X="[object Array]",Y="[object AsyncFunction]",J="[object Boolean]",Z="[object Date]",Q="[object DOMException]",$="[object Error]",ee="[object Function]",te="[object GeneratorFunction]",ne="[object Map]",re="[object Number]",ae="[object Null]",oe="[object Object]",ie="[object Proxy]",se="[object RegExp]",ue="[object Set]",le="[object String]",ce="[object Symbol]",pe="[object Undefined]",fe="[object WeakMap]",he="[object WeakSet]",de="[object ArrayBuffer]",me="[object DataView]",ge="[object Float32Array]",ye="[object Float64Array]",ve="[object Int8Array]",be="[object Int16Array]",we="[object Int32Array]",xe="[object Uint8Array]",_e="[object Uint8ClampedArray]",Ne="[object Uint16Array]",Ee="[object Uint32Array]",Ae=/\b__p \+= '';/g,Oe=/\b(__p \+=) '' \+/g,Se=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Te=/&(?:amp|lt|gt|quot|#39);/g,Ie=/[&<>"']/g,ke=RegExp(Te.source),Pe=RegExp(Ie.source),Ce=/<%-([\s\S]+?)%>/g,Re=/<%([\s\S]+?)%>/g,ze=/<%=([\s\S]+?)%>/g,Me=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Le=/^\w*$/,De=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ve=/[\\^$.*+?()[\]{}|]/g,je=RegExp(Ve.source),Fe=/^\s+|\s+$/g,Be=/^\s+/,Ue=/\s+$/,Ge=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,We=/\{\n\/\* \[wrapped with (.+)\] \*/,qe=/,? & /,He=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ke=/\\(\\)?/g,Xe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ye=/\w*$/,Je=/^[-+]0x[0-9a-f]+$/i,Ze=/^0b[01]+$/i,Qe=/^\[object .+?Constructor\]$/,$e=/^0o[0-7]+$/i,et=/^(?:0|[1-9]\d*)$/,tt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,nt=/($^)/,at=/['\n\r\u2028\u2029\\]/g,ot="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",it="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",st="[\\ud800-\\udfff]",ut="["+it+"]",lt="["+ot+"]",ct="\\d+",pt="[\\u2700-\\u27bf]",ft="[a-z\\xdf-\\xf6\\xf8-\\xff]",ht="[^\\ud800-\\udfff"+it+ct+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",mt="\\ud83c[\\udffb-\\udfff]",gt="[^\\ud800-\\udfff]",yt="(?:\\ud83c[\\udde6-\\uddff]){2}",vt="[\\ud800-\\udbff][\\udc00-\\udfff]",bt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",wt="(?:"+ft+"|"+ht+")",xt="(?:"+bt+"|"+ht+")",_t="(?:"+lt+"|"+mt+")?",Nt="[\\ufe0e\\ufe0f]?"+_t+"(?:\\u200d(?:"+[gt,yt,vt].join("|")+")[\\ufe0e\\ufe0f]?"+_t+")*",Et="(?:"+[pt,yt,vt].join("|")+")"+Nt,At="(?:"+[gt+lt+"?",lt,yt,vt,st].join("|")+")",Ot=RegExp("['’]","g"),St=RegExp(lt,"g"),Tt=RegExp(mt+"(?="+mt+")|"+At+Nt,"g"),It=RegExp([bt+"?"+ft+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ut,bt,"$"].join("|")+")",xt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ut,bt+wt,"$"].join("|")+")",bt+"?"+wt+"+(?:['’](?:d|ll|m|re|s|t|ve))?",bt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ct,Et].join("|"),"g"),kt=RegExp("[\\u200d\\ud800-\\udfff"+ot+"\\ufe0e\\ufe0f]"),Pt=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ct=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Rt=-1,zt={};zt[ge]=zt[ye]=zt[ve]=zt[be]=zt[we]=zt[xe]=zt[_e]=zt[Ne]=zt[Ee]=!0,zt[K]=zt[X]=zt[de]=zt[J]=zt[me]=zt[Z]=zt[$]=zt[ee]=zt[ne]=zt[re]=zt[oe]=zt[se]=zt[ue]=zt[le]=zt[fe]=!1;var Mt={};Mt[K]=Mt[X]=Mt[de]=Mt[me]=Mt[J]=Mt[Z]=Mt[ge]=Mt[ye]=Mt[ve]=Mt[be]=Mt[we]=Mt[ne]=Mt[re]=Mt[oe]=Mt[se]=Mt[ue]=Mt[le]=Mt[ce]=Mt[xe]=Mt[_e]=Mt[Ne]=Mt[Ee]=!0,Mt[$]=Mt[ee]=Mt[fe]=!1;var Lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Dt=parseFloat,Vt=parseInt,jt="object"==typeof e&&e&&e.Object===Object&&e,Ft="object"==typeof self&&self&&self.Object===Object&&self,Bt=jt||Ft||Function("return this")(),Ut="object"==typeof n&&n&&!n.nodeType&&n,Gt=Ut&&"object"==typeof t&&t&&!t.nodeType&&t,Wt=Gt&&Gt.exports===Ut,qt=Wt&&jt.process,Ht=function(){try{var e=Gt&&Gt.require&&Gt.require("util").types;return e||qt&&qt.binding&&qt.binding("util")}catch(e){}}(),Kt=Ht&&Ht.isArrayBuffer,Xt=Ht&&Ht.isDate,Yt=Ht&&Ht.isMap,Jt=Ht&&Ht.isRegExp,Zt=Ht&&Ht.isSet,Qt=Ht&&Ht.isTypedArray;function $t(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function en(e,t,n,r){for(var o=-1,l=null==e?0:e.length;++o<l;){var c=e[o];t(r,c,n(c),e)}return r}function tn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function nn(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function rn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function an(e,t){for(var n=-1,r=null==e?0:e.length,o=0,l=[];++n<r;){var c=e[n];t(c,n,e)&&(l[o++]=c)}return l}function on(e,t){return!(null==e||!e.length)&&gn(e,t,0)>-1}function sn(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function un(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function ln(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function cn(e,t,n,r){var o=-1,l=null==e?0:e.length;for(r&&l&&(n=e[++o]);++o<l;)n=t(n,e[o],o,e);return n}function pn(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function fn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var hn=wn("length");function dn(e,t,n){var r;return n(e,(function(e,n,o){if(t(e,n,o))return r=n,!1})),r}function mn(e,t,n,r){for(var o=e.length,l=n+(r?1:-1);r?l--:++l<o;)if(t(e[l],l,e))return l;return-1}function gn(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):mn(e,vn,n)}function yn(e,t,n,r){for(var o=n-1,l=e.length;++o<l;)if(r(e[o],t))return o;return-1}function vn(e){return e!=e}function bn(e,t){var n=null==e?0:e.length;return n?Nn(e,t)/n:B}function wn(e){return function(object){return null==object?r:object[e]}}function xn(object){return function(e){return null==object?r:object[e]}}function _n(e,t,n,r,o){return o(e,(function(e,o,l){n=r?(r=!1,e):t(n,e,o,l)})),n}function Nn(e,t){for(var n,o=-1,l=e.length;++o<l;){var c=t(e[o]);c!==r&&(n=n===r?c:n+c)}return n}function En(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function An(e){return function(t){return e(t)}}function On(object,e){return un(e,(function(e){return object[e]}))}function Sn(e,t){return e.has(t)}function Tn(e,t){for(var n=-1,r=e.length;++n<r&&gn(t,e[n],0)>-1;);return n}function In(e,t){for(var n=e.length;n--&&gn(t,e[n],0)>-1;);return n}var kn=xn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Pn=xn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Cn(e){return"\\"+Lt[e]}function Rn(e){return kt.test(e)}function zn(map){var e=-1,t=Array(map.size);return map.forEach((function(n,r){t[++e]=[r,n]})),t}function Mn(e,t){return function(n){return e(t(n))}}function Ln(e,t){for(var n=-1,r=e.length,o=0,l=[];++n<r;){var c=e[n];c!==t&&c!==d||(e[n]=d,l[o++]=n)}return l}function Dn(object,e){return"__proto__"==e?r:object[e]}function Vn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function jn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Fn(e){return Rn(e)?function(e){for(var t=Tt.lastIndex=0;Tt.test(e);)++t;return t}(e):hn(e)}function Bn(e){return Rn(e)?function(e){return e.match(Tt)||[]}(e):function(e){return e.split("")}(e)}var Un=xn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Gn=function e(t){var n,ot=(t=null==t?Bt:Gn.defaults(Bt.Object(),t,Gn.pick(Bt,Ct))).Array,it=t.Date,st=t.Error,ut=t.Function,lt=t.Math,ct=t.Object,pt=t.RegExp,ft=t.String,ht=t.TypeError,mt=ot.prototype,gt=ut.prototype,yt=ct.prototype,vt=t["__core-js_shared__"],bt=gt.toString,wt=yt.hasOwnProperty,xt=0,_t=(n=/[^.]+$/.exec(vt&&vt.keys&&vt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Nt=yt.toString,Et=bt.call(ct),At=Bt._,Tt=pt("^"+bt.call(wt).replace(Ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=Wt?t.Buffer:r,Lt=t.Symbol,jt=t.Uint8Array,Ft=kt?kt.allocUnsafe:r,Ut=Mn(ct.getPrototypeOf,ct),Gt=ct.create,qt=yt.propertyIsEnumerable,Ht=mt.splice,hn=Lt?Lt.isConcatSpreadable:r,xn=Lt?Lt.iterator:r,Wn=Lt?Lt.toStringTag:r,qn=function(){try{var e=$o(ct,"defineProperty");return e({},"",{}),e}catch(e){}}(),Hn=t.clearTimeout!==Bt.clearTimeout&&t.clearTimeout,Kn=it&&it.now!==Bt.Date.now&&it.now,Xn=t.setTimeout!==Bt.setTimeout&&t.setTimeout,Yn=lt.ceil,Jn=lt.floor,Zn=ct.getOwnPropertySymbols,Qn=kt?kt.isBuffer:r,$n=t.isFinite,er=mt.join,nr=Mn(ct.keys,ct),rr=lt.max,ar=lt.min,or=it.now,ir=t.parseInt,sr=lt.random,ur=mt.reverse,lr=$o(t,"DataView"),cr=$o(t,"Map"),pr=$o(t,"Promise"),fr=$o(t,"Set"),dr=$o(t,"WeakMap"),mr=$o(ct,"create"),gr=dr&&new dr,yr={},vr=Ai(lr),wr=Ai(cr),xr=Ai(pr),_r=Ai(fr),Nr=Ai(dr),Er=Lt?Lt.prototype:r,Ar=Er?Er.valueOf:r,Or=Er?Er.toString:r;function Sr(e){if(Fs(e)&&!Is(e)&&!(e instanceof Pr)){if(e instanceof kr)return e;if(wt.call(e,"__wrapped__"))return Oi(e)}return new kr(e)}var Tr=function(){function object(){}return function(e){if(!js(e))return{};if(Gt)return Gt(e);object.prototype=e;var t=new object;return object.prototype=r,t}}();function Ir(){}function kr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}function Pr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=U,this.__views__=[]}function Cr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Rr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function zr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Mr(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new zr;++t<n;)this.add(e[t])}function Lr(e){var data=this.__data__=new Rr(e);this.size=data.size}function Dr(e,t){var n=Is(e),r=!n&&Ts(e),o=!n&&!r&&Rs(e),l=!n&&!r&&!o&&Xs(e),c=n||r||o||l,f=c?En(e.length,ft):[],h=f.length;for(var d in e)!t&&!wt.call(e,d)||c&&("length"==d||o&&("offset"==d||"parent"==d)||l&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||ii(d,h))||f.push(d);return f}function Vr(e){var t=e.length;return t?e[Ma(0,t-1)]:r}function jr(e,t){return _i(yo(e),Xr(t,0,e.length))}function Fr(e){return _i(yo(e))}function Br(object,e,t){(t===r||As(object[e],t))&&(t!==r||e in object)||Hr(object,e,t)}function Ur(object,e,t){var n=object[e];wt.call(object,e)&&As(n,t)&&(t!==r||e in object)||Hr(object,e,t)}function Gr(e,t){for(var n=e.length;n--;)if(As(e[n][0],t))return n;return-1}function Wr(e,t,n,r){return $r(e,(function(e,o,l){t(r,e,n(e),l)})),r}function qr(object,source){return object&&vo(source,gu(source),object)}function Hr(object,e,t){"__proto__"==e&&qn?qn(object,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):object[e]=t}function Kr(object,e){for(var t=-1,n=e.length,o=ot(n),l=null==object;++t<n;)o[t]=l?r:pu(object,e[t]);return o}function Xr(e,t,n){return e==e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function Yr(e,t,n,o,object,l){var c,f=t&m,h=t&y,d=t&v;if(n&&(c=object?n(e,o,object,l):n(e)),c!==r)return c;if(!js(e))return e;var w=Is(e);if(w){if(c=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&wt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!f)return yo(e,c)}else{var x=ni(e),_=x==ee||x==te;if(Rs(e))return co(e,f);if(x==oe||x==K||_&&!object){if(c=h||_?{}:ai(e),!f)return h?function(source,object){return vo(source,ti(source),object)}(e,function(object,source){return object&&vo(source,yu(source),object)}(c,e)):function(source,object){return vo(source,ei(source),object)}(e,qr(c,e))}else{if(!Mt[x])return object?e:{};c=function(object,e,t){var symbol,n=object.constructor;switch(e){case de:return po(object);case J:case Z:return new n(+object);case me:return function(e,t){var n=t?po(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(object,t);case ge:case ye:case ve:case be:case we:case xe:case _e:case Ne:case Ee:return fo(object,t);case ne:return new n;case re:case le:return new n(object);case se:return function(e){var t=new e.constructor(e.source,Ye.exec(e));return t.lastIndex=e.lastIndex,t}(object);case ue:return new n;case ce:return symbol=object,Ar?ct(Ar.call(symbol)):{}}}(e,x,f)}}l||(l=new Lr);var N=l.get(e);if(N)return N;if(l.set(e,c),qs(e))return e.forEach((function(r){c.add(Yr(r,t,n,r,e,l))})),c;if(Bs(e))return e.forEach((function(r,o){c.set(o,Yr(r,t,n,o,e,l))})),c;var E=w?r:(d?h?Ho:qo:h?yu:gu)(e);return tn(E||e,(function(r,o){E&&(r=e[o=r]),Ur(c,o,Yr(r,t,n,o,e,l))})),c}function Jr(object,source,e){var t=e.length;if(null==object)return!t;for(object=ct(object);t--;){var n=e[t],o=source[n],l=object[n];if(l===r&&!(n in object)||!o(l))return!1}return!0}function Zr(e,t,n){if("function"!=typeof e)throw new ht(c);return vi((function(){e.apply(r,n)}),t)}function Qr(e,t,n,r){var l=-1,c=on,f=!0,h=e.length,d=[],m=t.length;if(!h)return d;n&&(t=un(t,An(n))),r?(c=sn,f=!1):t.length>=o&&(c=Sn,f=!1,t=new Mr(t));e:for(;++l<h;){var y=e[l],v=null==n?y:n(y);if(y=r||0!==y?y:0,f&&v==v){for(var w=m;w--;)if(t[w]===v)continue e;d.push(y)}else c(t,v,r)||d.push(y)}return d}Sr.templateSettings={escape:Ce,evaluate:Re,interpolate:ze,variable:"",imports:{_:Sr}},Sr.prototype=Ir.prototype,Sr.prototype.constructor=Sr,kr.prototype=Tr(Ir.prototype),kr.prototype.constructor=kr,Pr.prototype=Tr(Ir.prototype),Pr.prototype.constructor=Pr,Cr.prototype.clear=function(){this.__data__=mr?mr(null):{},this.size=0},Cr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Cr.prototype.get=function(e){var data=this.__data__;if(mr){var t=data[e];return t===f?r:t}return wt.call(data,e)?data[e]:r},Cr.prototype.has=function(e){var data=this.__data__;return mr?data[e]!==r:wt.call(data,e)},Cr.prototype.set=function(e,t){var data=this.__data__;return this.size+=this.has(e)?0:1,data[e]=mr&&t===r?f:t,this},Rr.prototype.clear=function(){this.__data__=[],this.size=0},Rr.prototype.delete=function(e){var data=this.__data__,t=Gr(data,e);return!(t<0||(t==data.length-1?data.pop():Ht.call(data,t,1),--this.size,0))},Rr.prototype.get=function(e){var data=this.__data__,t=Gr(data,e);return t<0?r:data[t][1]},Rr.prototype.has=function(e){return Gr(this.__data__,e)>-1},Rr.prototype.set=function(e,t){var data=this.__data__,n=Gr(data,e);return n<0?(++this.size,data.push([e,t])):data[n][1]=t,this},zr.prototype.clear=function(){this.size=0,this.__data__={hash:new Cr,map:new(cr||Rr),string:new Cr}},zr.prototype.delete=function(e){var t=Zo(this,e).delete(e);return this.size-=t?1:0,t},zr.prototype.get=function(e){return Zo(this,e).get(e)},zr.prototype.has=function(e){return Zo(this,e).has(e)},zr.prototype.set=function(e,t){var data=Zo(this,e),n=data.size;return data.set(e,t),this.size+=data.size==n?0:1,this},Mr.prototype.add=Mr.prototype.push=function(e){return this.__data__.set(e,f),this},Mr.prototype.has=function(e){return this.__data__.has(e)},Lr.prototype.clear=function(){this.__data__=new Rr,this.size=0},Lr.prototype.delete=function(e){var data=this.__data__,t=data.delete(e);return this.size=data.size,t},Lr.prototype.get=function(e){return this.__data__.get(e)},Lr.prototype.has=function(e){return this.__data__.has(e)},Lr.prototype.set=function(e,t){var data=this.__data__;if(data instanceof Rr){var n=data.__data__;if(!cr||n.length<o-1)return n.push([e,t]),this.size=++data.size,this;data=this.__data__=new zr(n)}return data.set(e,t),this.size=data.size,this};var $r=xo(sa),ea=xo(ua,!0);function ta(e,t){var n=!0;return $r(e,(function(e,r,o){return n=!!t(e,r,o)})),n}function na(e,t,n){for(var o=-1,l=e.length;++o<l;){var c=e[o],f=t(c);if(null!=f&&(h===r?f==f&&!Ks(f):n(f,h)))var h=f,d=c}return d}function ra(e,t){var n=[];return $r(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}function aa(e,t,n,r,o){var l=-1,c=e.length;for(n||(n=oi),o||(o=[]);++l<c;){var f=e[l];t>0&&n(f)?t>1?aa(f,t-1,n,r,o):ln(o,f):r||(o[o.length]=f)}return o}var oa=_o(),ia=_o(!0);function sa(object,e){return object&&oa(object,e,gu)}function ua(object,e){return object&&ia(object,e,gu)}function la(object,e){return an(e,(function(e){return Ls(object[e])}))}function ca(object,path){for(var e=0,t=(path=io(path,object)).length;null!=object&&e<t;)object=object[Ei(path[e++])];return e&&e==t?object:r}function pa(object,e,t){var n=e(object);return Is(object)?n:ln(n,t(object))}function fa(e){return null==e?e===r?pe:ae:Wn&&Wn in ct(e)?function(e){var t=wt.call(e,Wn),n=e[Wn];try{e[Wn]=r;var o=!0}catch(e){}var l=Nt.call(e);return o&&(t?e[Wn]=n:delete e[Wn]),l}(e):function(e){return Nt.call(e)}(e)}function ha(e,t){return e>t}function da(object,e){return null!=object&&wt.call(object,e)}function ma(object,e){return null!=object&&e in ct(object)}function ga(e,t,n){for(var o=n?sn:on,l=e[0].length,c=e.length,f=c,h=ot(c),d=1/0,m=[];f--;){var y=e[f];f&&t&&(y=un(y,An(t))),d=ar(y.length,d),h[f]=!n&&(t||l>=120&&y.length>=120)?new Mr(f&&y):r}y=e[0];var v=-1,w=h[0];e:for(;++v<l&&m.length<d;){var x=y[v],_=t?t(x):x;if(x=n||0!==x?x:0,!(w?Sn(w,_):o(m,_,n))){for(f=c;--f;){var N=h[f];if(!(N?Sn(N,_):o(e[f],_,n)))continue e}w&&w.push(_),m.push(x)}}return m}function ya(object,path,e){var t=null==(object=gi(object,path=io(path,object)))?object:object[Ei(Li(path))];return null==t?r:$t(t,object,e)}function va(e){return Fs(e)&&fa(e)==K}function ba(e,t,n,o,l){return e===t||(null==e||null==t||!Fs(e)&&!Fs(t)?e!=e&&t!=t:function(object,e,t,n,o,l){var c=Is(object),f=Is(e),h=c?X:ni(object),d=f?X:ni(e),m=(h=h==K?oe:h)==oe,y=(d=d==K?oe:d)==oe,v=h==d;if(v&&Rs(object)){if(!Rs(e))return!1;c=!0,m=!1}if(v&&!m)return l||(l=new Lr),c||Xs(object)?Go(object,e,t,n,o,l):function(object,e,t,n,r,o,l){switch(t){case me:if(object.byteLength!=e.byteLength||object.byteOffset!=e.byteOffset)return!1;object=object.buffer,e=e.buffer;case de:return!(object.byteLength!=e.byteLength||!o(new jt(object),new jt(e)));case J:case Z:case re:return As(+object,+e);case $:return object.name==e.name&&object.message==e.message;case se:case le:return object==e+"";case ne:var c=zn;case ue:var f=n&w;if(c||(c=Vn),object.size!=e.size&&!f)return!1;var h=l.get(object);if(h)return h==e;n|=x,l.set(object,e);var d=Go(c(object),c(e),n,r,o,l);return l.delete(object),d;case ce:if(Ar)return Ar.call(object)==Ar.call(e)}return!1}(object,e,h,t,n,o,l);if(!(t&w)){var _=m&&wt.call(object,"__wrapped__"),N=y&&wt.call(e,"__wrapped__");if(_||N){var E=_?object.value():object,A=N?e.value():e;return l||(l=new Lr),o(E,A,t,n,l)}}return!!v&&(l||(l=new Lr),function(object,e,t,n,o,l){var c=t&w,f=qo(object),h=f.length,d=qo(e).length;if(h!=d&&!c)return!1;for(var m=h;m--;){var y=f[m];if(!(c?y in e:wt.call(e,y)))return!1}var v=l.get(object);if(v&&l.get(e))return v==e;var x=!0;l.set(object,e),l.set(e,object);for(var _=c;++m<h;){y=f[m];var N=object[y],E=e[y];if(n)var A=c?n(E,N,y,e,object,l):n(N,E,y,object,e,l);if(!(A===r?N===E||o(N,E,t,n,l):A)){x=!1;break}_||(_="constructor"==y)}if(x&&!_){var O=object.constructor,S=e.constructor;O!=S&&"constructor"in object&&"constructor"in e&&!("function"==typeof O&&O instanceof O&&"function"==typeof S&&S instanceof S)&&(x=!1)}return l.delete(object),l.delete(e),x}(object,e,t,n,o,l))}(e,t,n,o,ba,l))}function wa(object,source,e,t){var n=e.length,o=n,l=!t;if(null==object)return!o;for(object=ct(object);n--;){var data=e[n];if(l&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++n<o;){var c=(data=e[n])[0],f=object[c],h=data[1];if(l&&data[2]){if(f===r&&!(c in object))return!1}else{var d=new Lr;if(t)var m=t(f,h,c,object,source,d);if(!(m===r?ba(h,f,w|x,t,d):m))return!1}}return!0}function xa(e){return!(!js(e)||(t=e,_t&&_t in t))&&(Ls(e)?Tt:Qe).test(Ai(e));var t}function _a(e){return"function"==typeof e?e:null==e?Uu:"object"==typeof e?Is(e)?Ta(e[0],e[1]):Sa(e):Zu(e)}function Na(object){if(!fi(object))return nr(object);var e=[];for(var t in ct(object))wt.call(object,t)&&"constructor"!=t&&e.push(t);return e}function Ea(object){if(!js(object))return function(object){var e=[];if(null!=object)for(var t in ct(object))e.push(t);return e}(object);var e=fi(object),t=[];for(var n in object)("constructor"!=n||!e&&wt.call(object,n))&&t.push(n);return t}function Aa(e,t){return e<t}function Oa(e,t){var n=-1,r=Ps(e)?ot(e.length):[];return $r(e,(function(e,o,l){r[++n]=t(e,o,l)})),r}function Sa(source){var e=Qo(source);return 1==e.length&&e[0][2]?di(e[0][0],e[0][1]):function(object){return object===source||wa(object,source,e)}}function Ta(path,e){return ui(path)&&hi(e)?di(Ei(path),e):function(object){var t=pu(object,path);return t===r&&t===e?fu(object,path):ba(e,t,w|x)}}function Ia(object,source,e,t,n){object!==source&&oa(source,(function(o,l){if(js(o))n||(n=new Lr),function(object,source,e,t,n,o,l){var c=Dn(object,e),f=Dn(source,e),h=l.get(f);if(h)Br(object,e,h);else{var d=o?o(c,f,e+"",object,source,l):r,m=d===r;if(m){var y=Is(f),v=!y&&Rs(f),w=!y&&!v&&Xs(f);d=f,y||v||w?Is(c)?d=c:Cs(c)?d=yo(c):v?(m=!1,d=co(f,!0)):w?(m=!1,d=fo(f,!0)):d=[]:Gs(f)||Ts(f)?(d=c,Ts(c)?d=nu(c):(!js(c)||t&&Ls(c))&&(d=ai(f))):m=!1}m&&(l.set(f,d),n(d,f,t,o,l),l.delete(f)),Br(object,e,d)}}(object,source,l,e,Ia,t,n);else{var c=t?t(Dn(object,l),o,l+"",object,source,n):r;c===r&&(c=o),Br(object,l,c)}}),yu)}function ka(e,t){var n=e.length;if(n)return ii(t+=t<0?n:0,n)?e[t]:r}function Pa(e,t,n){var r=-1;return t=un(t.length?t:[Uu],An(Jo())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Oa(e,(function(e,n,o){return{criteria:un(t,(function(t){return t(e)})),index:++r,value:e}})),(function(object,e){return function(object,e,t){for(var n=-1,r=object.criteria,o=e.criteria,l=r.length,c=t.length;++n<l;){var f=ho(r[n],o[n]);if(f){if(n>=c)return f;var h=t[n];return f*("desc"==h?-1:1)}}return object.index-e.index}(object,e,n)}))}function Ca(object,e,t){for(var n=-1,r=e.length,o={};++n<r;){var path=e[n],l=ca(object,path);t(l,path)&&Fa(o,io(path,object),l)}return o}function Ra(e,t,n,r){var o=r?yn:gn,l=-1,c=t.length,f=e;for(e===t&&(t=yo(t)),n&&(f=un(e,An(n)));++l<c;)for(var h=0,d=t[l],m=n?n(d):d;(h=o(f,m,h,r))>-1;)f!==e&&Ht.call(f,h,1),Ht.call(e,h,1);return e}function za(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==l){var l=o;ii(o)?Ht.call(e,o,1):Qa(e,o)}}return e}function Ma(e,t){return e+Jn(sr()*(t-e+1))}function La(e,t){var n="";if(!e||t<1||t>j)return n;do{t%2&&(n+=e),(t=Jn(t/2))&&(e+=e)}while(t);return n}function Da(e,t){return bi(mi(e,t,Uu),e+"")}function Va(e){return Vr(Au(e))}function ja(e,t){var n=Au(e);return _i(n,Xr(t,0,n.length))}function Fa(object,path,e,t){if(!js(object))return object;for(var n=-1,o=(path=io(path,object)).length,l=o-1,c=object;null!=c&&++n<o;){var f=Ei(path[n]),h=e;if(n!=l){var d=c[f];(h=t?t(d,f,c):r)===r&&(h=js(d)?d:ii(path[n+1])?[]:{})}Ur(c,f,h),c=c[f]}return object}var Ba=gr?function(e,data){return gr.set(e,data),e}:Uu,Ua=qn?function(e,t){return qn(e,"toString",{configurable:!0,enumerable:!1,value:ju(t),writable:!0})}:Uu;function Ga(e){return _i(Au(e))}function Wa(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var l=ot(o);++r<o;)l[r]=e[r+t];return l}function qa(e,t){var n;return $r(e,(function(e,r,o){return!(n=t(e,r,o))})),!!n}function Ha(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t==t&&o<=W){for(;r<o;){var l=r+o>>>1,c=e[l];null!==c&&!Ks(c)&&(n?c<=t:c<t)?r=l+1:o=l}return o}return Ka(e,t,Uu,n)}function Ka(e,t,n,o){t=n(t);for(var l=0,c=null==e?0:e.length,f=t!=t,h=null===t,d=Ks(t),m=t===r;l<c;){var y=Jn((l+c)/2),v=n(e[y]),w=v!==r,x=null===v,_=v==v,N=Ks(v);if(f)var E=o||_;else E=m?_&&(o||w):h?_&&w&&(o||!x):d?_&&w&&!x&&(o||!N):!x&&!N&&(o?v<=t:v<t);E?l=y+1:c=y}return ar(c,G)}function Xa(e,t){for(var n=-1,r=e.length,o=0,l=[];++n<r;){var c=e[n],f=t?t(c):c;if(!n||!As(f,h)){var h=f;l[o++]=0===c?0:c}}return l}function Ya(e){return"number"==typeof e?e:Ks(e)?B:+e}function Ja(e){if("string"==typeof e)return e;if(Is(e))return un(e,Ja)+"";if(Ks(e))return Or?Or.call(e):"";var t=e+"";return"0"==t&&1/e==-V?"-0":t}function Za(e,t,n){var r=-1,l=on,c=e.length,f=!0,h=[],d=h;if(n)f=!1,l=sn;else if(c>=o){var m=t?null:Do(e);if(m)return Vn(m);f=!1,l=Sn,d=new Mr}else d=t?[]:h;e:for(;++r<c;){var y=e[r],v=t?t(y):y;if(y=n||0!==y?y:0,f&&v==v){for(var w=d.length;w--;)if(d[w]===v)continue e;t&&d.push(v),h.push(y)}else l(d,v,n)||(d!==h&&d.push(v),h.push(y))}return h}function Qa(object,path){return null==(object=gi(object,path=io(path,object)))||delete object[Ei(Li(path))]}function $a(object,path,e,t){return Fa(object,path,e(ca(object,path)),t)}function eo(e,t,n,r){for(var o=e.length,l=r?o:-1;(r?l--:++l<o)&&t(e[l],l,e););return n?Wa(e,r?0:l,r?l+1:o):Wa(e,r?l+1:0,r?o:l)}function to(e,t){var n=e;return n instanceof Pr&&(n=n.value()),cn(t,(function(e,t){return t.func.apply(t.thisArg,ln([e],t.args))}),n)}function no(e,t,n){var r=e.length;if(r<2)return r?Za(e[0]):[];for(var o=-1,l=ot(r);++o<r;)for(var c=e[o],f=-1;++f<r;)f!=o&&(l[o]=Qr(l[o]||c,e[f],t,n));return Za(aa(l,1),t,n)}function ro(e,t,n){for(var o=-1,l=e.length,c=t.length,f={};++o<l;){var h=o<c?t[o]:r;n(f,e[o],h)}return f}function ao(e){return Cs(e)?e:[]}function oo(e){return"function"==typeof e?e:Uu}function io(e,object){return Is(e)?e:ui(e,object)?[e]:Ni(ru(e))}var so=Da;function uo(e,t,n){var o=e.length;return n=n===r?o:n,!t&&n>=o?e:Wa(e,t,n)}var lo=Hn||function(e){return Bt.clearTimeout(e)};function co(e,t){if(t)return e.slice();var n=e.length,r=Ft?Ft(n):new e.constructor(n);return e.copy(r),r}function po(e){var t=new e.constructor(e.byteLength);return new jt(t).set(new jt(e)),t}function fo(e,t){var n=t?po(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ho(e,t){if(e!==t){var n=e!==r,o=null===e,l=e==e,c=Ks(e),f=t!==r,h=null===t,d=t==t,m=Ks(t);if(!h&&!m&&!c&&e>t||c&&f&&d&&!h&&!m||o&&f&&d||!n&&d||!l)return 1;if(!o&&!c&&!m&&e<t||m&&n&&l&&!o&&!c||h&&n&&l||!f&&l||!d)return-1}return 0}function mo(e,t,n,r){for(var o=-1,l=e.length,c=n.length,f=-1,h=t.length,d=rr(l-c,0),m=ot(h+d),y=!r;++f<h;)m[f]=t[f];for(;++o<c;)(y||o<l)&&(m[n[o]]=e[o]);for(;d--;)m[f++]=e[o++];return m}function go(e,t,n,r){for(var o=-1,l=e.length,c=-1,f=n.length,h=-1,d=t.length,m=rr(l-f,0),y=ot(m+d),v=!r;++o<m;)y[o]=e[o];for(var w=o;++h<d;)y[w+h]=t[h];for(;++c<f;)(v||o<l)&&(y[w+n[c]]=e[o++]);return y}function yo(source,e){var t=-1,n=source.length;for(e||(e=ot(n));++t<n;)e[t]=source[t];return e}function vo(source,e,object,t){var n=!object;object||(object={});for(var o=-1,l=e.length;++o<l;){var c=e[o],f=t?t(object[c],source[c],c,object,source):r;f===r&&(f=source[c]),n?Hr(object,c,f):Ur(object,c,f)}return object}function bo(e,t){return function(n,r){var o=Is(n)?en:Wr,l=t?t():{};return o(n,e,Jo(r,2),l)}}function wo(e){return Da((function(object,t){var n=-1,o=t.length,l=o>1?t[o-1]:r,c=o>2?t[2]:r;for(l=e.length>3&&"function"==typeof l?(o--,l):r,c&&si(t[0],t[1],c)&&(l=o<3?r:l,o=1),object=ct(object);++n<o;){var source=t[n];source&&e(object,source,n,l)}return object}))}function xo(e,t){return function(n,r){if(null==n)return n;if(!Ps(n))return e(n,r);for(var o=n.length,l=t?o:-1,c=ct(n);(t?l--:++l<o)&&!1!==r(c[l],l,c););return n}}function _o(e){return function(object,t,n){for(var r=-1,o=ct(object),l=n(object),c=l.length;c--;){var f=l[e?c:++r];if(!1===t(o[f],f,o))break}return object}}function No(e){return function(t){var n=Rn(t=ru(t))?Bn(t):r,o=n?n[0]:t.charAt(0),l=n?uo(n,1).join(""):t.slice(1);return o[e]()+l}}function Eo(e){return function(t){return cn(Lu(Tu(t).replace(Ot,"")),e,"")}}function Ao(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Tr(e.prototype),r=e.apply(n,t);return js(r)?r:n}}function Oo(e){return function(t,n,o){var l=ct(t);if(!Ps(t)){var c=Jo(n,3);t=gu(t),n=function(e){return c(l[e],e,l)}}var f=e(t,n,o);return f>-1?l[c?t[f]:f]:r}}function So(e){return Wo((function(t){var n=t.length,o=n,l=kr.prototype.thru;for(e&&t.reverse();o--;){var f=t[o];if("function"!=typeof f)throw new ht(c);if(l&&!h&&"wrapper"==Xo(f))var h=new kr([],!0)}for(o=h?o:n;++o<n;){var d=Xo(f=t[o]),data="wrapper"==d?Ko(f):r;h=data&&ci(data[0])&&data[1]==(I|A|S|k)&&!data[4].length&&1==data[9]?h[Xo(data[0])].apply(h,data[3]):1==f.length&&ci(f)?h[d]():h.thru(f)}return function(){var e=arguments,r=e[0];if(h&&1==e.length&&Is(r))return h.plant(r).value();for(var o=0,l=n?t[o].apply(this,e):r;++o<n;)l=t[o].call(this,l);return l}}))}function To(e,t,n,o,l,c,f,h,d,m){var y=t&I,v=t&_,w=t&N,x=t&(A|O),E=t&P,S=w?r:Ao(e);return function _(){for(var N=arguments.length,A=ot(N),O=N;O--;)A[O]=arguments[O];if(x)var T=Yo(_),I=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(A,T);if(o&&(A=mo(A,o,l,x)),c&&(A=go(A,c,f,x)),N-=I,x&&N<m){var k=Ln(A,T);return Mo(e,t,To,_.placeholder,n,A,k,h,d,m-N)}var P=v?n:this,C=w?P[e]:e;return N=A.length,h?A=function(e,t){for(var n=e.length,o=ar(t.length,n),l=yo(e);o--;){var c=t[o];e[o]=ii(c,n)?l[c]:r}return e}(A,h):E&&N>1&&A.reverse(),y&&d<N&&(A.length=d),this&&this!==Bt&&this instanceof _&&(C=S||Ao(C)),C.apply(P,A)}}function Io(e,t){return function(object,n){return function(object,e,t,n){return sa(object,(function(r,o,object){e(n,t(r),o,object)})),n}(object,e,t(n),{})}}function ko(e,t){return function(n,o){var l;if(n===r&&o===r)return t;if(n!==r&&(l=n),o!==r){if(l===r)return o;"string"==typeof n||"string"==typeof o?(n=Ja(n),o=Ja(o)):(n=Ya(n),o=Ya(o)),l=e(n,o)}return l}}function Po(e){return Wo((function(t){return t=un(t,An(Jo())),Da((function(n){var r=this;return e(t,(function(e){return $t(e,r,n)}))}))}))}function Co(e,t){var n=(t=t===r?" ":Ja(t)).length;if(n<2)return n?La(t,e):t;var o=La(t,Yn(e/Fn(t)));return Rn(t)?uo(Bn(o),0,e).join(""):o.slice(0,e)}function Ro(e){return function(t,n,o){return o&&"number"!=typeof o&&si(t,n,o)&&(n=o=r),t=Qs(t),n===r?(n=t,t=0):n=Qs(n),function(e,t,n,r){for(var o=-1,l=rr(Yn((t-e)/(n||1)),0),c=ot(l);l--;)c[r?l:++o]=e,e+=n;return c}(t,n,o=o===r?t<n?1:-1:Qs(o),e)}}function zo(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=tu(t),n=tu(n)),e(t,n)}}function Mo(e,t,n,o,l,c,f,h,d,m){var y=t&A;t|=y?S:T,(t&=~(y?T:S))&E||(t&=~(_|N));var v=[e,t,l,y?c:r,y?f:r,y?r:c,y?r:f,h,d,m],w=n.apply(r,v);return ci(e)&&yi(w,v),w.placeholder=o,wi(w,e,t)}function Lo(e){var t=lt[e];return function(e,n){if(e=tu(e),n=null==n?0:ar($s(n),292)){var r=(ru(e)+"e").split("e");return+((r=(ru(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Do=fr&&1/Vn(new fr([,-0]))[1]==V?function(e){return new fr(e)}:Ku;function Vo(e){return function(object){var t=ni(object);return t==ne?zn(object):t==ue?jn(object):function(object,e){return un(e,(function(e){return[e,object[e]]}))}(object,e(object))}}function jo(e,t,n,o,l,f,h,m){var y=t&N;if(!y&&"function"!=typeof e)throw new ht(c);var v=o?o.length:0;if(v||(t&=~(S|T),o=l=r),h=h===r?h:rr($s(h),0),m=m===r?m:$s(m),v-=l?l.length:0,t&T){var w=o,x=l;o=l=r}var data=y?r:Ko(e),P=[e,t,n,o,l,w,x,f,h,m];if(data&&function(data,source){var e=data[1],t=source[1],n=e|t,r=n<(_|N|I),o=t==I&&e==A||t==I&&e==k&&data[7].length<=source[8]||t==(I|k)&&source[7].length<=source[8]&&e==A;if(!r&&!o)return data;t&_&&(data[2]=source[2],n|=e&_?0:E);var l=source[3];if(l){var c=data[3];data[3]=c?mo(c,l,source[4]):l,data[4]=c?Ln(data[3],d):source[4]}(l=source[5])&&(c=data[5],data[5]=c?go(c,l,source[6]):l,data[6]=c?Ln(data[5],d):source[6]),(l=source[7])&&(data[7]=l),t&I&&(data[8]=null==data[8]?source[8]:ar(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=n}(P,data),e=P[0],t=P[1],n=P[2],o=P[3],l=P[4],!(m=P[9]=P[9]===r?y?0:e.length:rr(P[9]-v,0))&&t&(A|O)&&(t&=~(A|O)),t&&t!=_)C=t==A||t==O?function(e,t,n){var o=Ao(e);return function l(){for(var c=arguments.length,f=ot(c),h=c,d=Yo(l);h--;)f[h]=arguments[h];var m=c<3&&f[0]!==d&&f[c-1]!==d?[]:Ln(f,d);return(c-=m.length)<n?Mo(e,t,To,l.placeholder,r,f,m,r,r,n-c):$t(this&&this!==Bt&&this instanceof l?o:e,this,f)}}(e,t,m):t!=S&&t!=(_|S)||l.length?To.apply(r,P):function(e,t,n,r){var o=t&_,l=Ao(e);return function t(){for(var c=-1,f=arguments.length,h=-1,d=r.length,m=ot(d+f),y=this&&this!==Bt&&this instanceof t?l:e;++h<d;)m[h]=r[h];for(;f--;)m[h++]=arguments[++c];return $t(y,o?n:this,m)}}(e,t,n,o);else var C=function(e,t,n){var r=t&_,o=Ao(e);return function t(){return(this&&this!==Bt&&this instanceof t?o:e).apply(r?n:this,arguments)}}(e,t,n);return wi((data?Ba:yi)(C,P),e,t)}function Fo(e,t,n,object){return e===r||As(e,yt[n])&&!wt.call(object,n)?t:e}function Bo(e,t,n,object,source,o){return js(e)&&js(t)&&(o.set(t,e),Ia(e,t,r,Bo,o),o.delete(t)),e}function Uo(e){return Gs(e)?r:e}function Go(e,t,n,o,l,c){var f=n&w,h=e.length,d=t.length;if(h!=d&&!(f&&d>h))return!1;var m=c.get(e);if(m&&c.get(t))return m==t;var y=-1,v=!0,_=n&x?new Mr:r;for(c.set(e,t),c.set(t,e);++y<h;){var N=e[y],E=t[y];if(o)var A=f?o(E,N,y,t,e,c):o(N,E,y,e,t,c);if(A!==r){if(A)continue;v=!1;break}if(_){if(!fn(t,(function(e,t){if(!Sn(_,t)&&(N===e||l(N,e,n,o,c)))return _.push(t)}))){v=!1;break}}else if(N!==E&&!l(N,E,n,o,c)){v=!1;break}}return c.delete(e),c.delete(t),v}function Wo(e){return bi(mi(e,r,Ci),e+"")}function qo(object){return pa(object,gu,ei)}function Ho(object){return pa(object,yu,ti)}var Ko=gr?function(e){return gr.get(e)}:Ku;function Xo(e){for(var t=e.name+"",n=yr[t],r=wt.call(yr,t)?n.length:0;r--;){var data=n[r],o=data.func;if(null==o||o==e)return data.name}return t}function Yo(e){return(wt.call(Sr,"placeholder")?Sr:e).placeholder}function Jo(){var e=Sr.iteratee||Gu;return e=e===Gu?_a:e,arguments.length?e(arguments[0],arguments[1]):e}function Zo(map,e){var t,n,data=map.__data__;return("string"==(n=typeof(t=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?data["string"==typeof e?"string":"hash"]:data.map}function Qo(object){for(var e=gu(object),t=e.length;t--;){var n=e[t],r=object[n];e[t]=[n,r,hi(r)]}return e}function $o(object,e){var t=function(object,e){return null==object?r:object[e]}(object,e);return xa(t)?t:r}var ei=Zn?function(object){return null==object?[]:(object=ct(object),an(Zn(object),(function(symbol){return qt.call(object,symbol)})))}:el,ti=Zn?function(object){for(var e=[];object;)ln(e,ei(object)),object=Ut(object);return e}:el,ni=fa;function ri(object,path,e){for(var t=-1,n=(path=io(path,object)).length,r=!1;++t<n;){var o=Ei(path[t]);if(!(r=null!=object&&e(object,o)))break;object=object[o]}return r||++t!=n?r:!!(n=null==object?0:object.length)&&Vs(n)&&ii(o,n)&&(Is(object)||Ts(object))}function ai(object){return"function"!=typeof object.constructor||fi(object)?{}:Tr(Ut(object))}function oi(e){return Is(e)||Ts(e)||!!(hn&&e&&e[hn])}function ii(e,t){var n=typeof e;return!!(t=null==t?j:t)&&("number"==n||"symbol"!=n&&et.test(e))&&e>-1&&e%1==0&&e<t}function si(e,t,object){if(!js(object))return!1;var n=typeof t;return!!("number"==n?Ps(object)&&ii(t,object.length):"string"==n&&t in object)&&As(object[t],e)}function ui(e,object){if(Is(e))return!1;var t=typeof e;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=e&&!Ks(e))||Le.test(e)||!Me.test(e)||null!=object&&e in ct(object)}function ci(e){var t=Xo(e),n=Sr[t];if("function"!=typeof n||!(t in Pr.prototype))return!1;if(e===n)return!0;var data=Ko(n);return!!data&&e===data[0]}(lr&&ni(new lr(new ArrayBuffer(1)))!=me||cr&&ni(new cr)!=ne||pr&&"[object Promise]"!=ni(pr.resolve())||fr&&ni(new fr)!=ue||dr&&ni(new dr)!=fe)&&(ni=function(e){var t=fa(e),n=t==oe?e.constructor:r,o=n?Ai(n):"";if(o)switch(o){case vr:return me;case wr:return ne;case xr:return"[object Promise]";case _r:return ue;case Nr:return fe}return t});var pi=vt?Ls:tl;function fi(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||yt)}function hi(e){return e==e&&!js(e)}function di(e,t){return function(object){return null!=object&&object[e]===t&&(t!==r||e in ct(object))}}function mi(e,t,n){return t=rr(t===r?e.length-1:t,0),function(){for(var r=arguments,o=-1,l=rr(r.length-t,0),c=ot(l);++o<l;)c[o]=r[t+o];o=-1;for(var f=ot(t+1);++o<t;)f[o]=r[o];return f[t]=n(c),$t(e,this,f)}}function gi(object,path){return path.length<2?object:ca(object,Wa(path,0,-1))}var yi=xi(Ba),vi=Xn||function(e,t){return Bt.setTimeout(e,t)},bi=xi(Ua);function wi(e,t,n){var source=t+"";return bi(e,function(source,details){var e=details.length;if(!e)return source;var t=e-1;return details[t]=(e>1?"& ":"")+details[t],details=details.join(e>2?", ":" "),source.replace(Ge,"{\n/* [wrapped with "+details+"] */\n")}(source,function(details,e){return tn(H,(function(t){var n="_."+t[0];e&t[1]&&!on(details,n)&&details.push(n)})),details.sort()}(function(source){var e=source.match(We);return e?e[1].split(qe):[]}(source),n)))}function xi(e){var t=0,n=0;return function(){var o=or(),l=M-(o-n);if(n=o,l>0){if(++t>=z)return arguments[0]}else t=0;return e.apply(r,arguments)}}function _i(e,t){var n=-1,o=e.length,l=o-1;for(t=t===r?o:t;++n<t;){var c=Ma(n,l),f=e[c];e[c]=e[n],e[n]=f}return e.length=t,e}var Ni=function(e){var t=bs(e,(function(e){return n.size===h&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(De,(function(e,n,r,o){t.push(r?o.replace(Ke,"$1"):n||e)})),t}));function Ei(e){if("string"==typeof e||Ks(e))return e;var t=e+"";return"0"==t&&1/e==-V?"-0":t}function Ai(e){if(null!=e){try{return bt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Oi(e){if(e instanceof Pr)return e.clone();var t=new kr(e.__wrapped__,e.__chain__);return t.__actions__=yo(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Si=Da((function(e,t){return Cs(e)?Qr(e,aa(t,1,Cs,!0)):[]})),Ti=Da((function(e,t){var n=Li(t);return Cs(n)&&(n=r),Cs(e)?Qr(e,aa(t,1,Cs,!0),Jo(n,2)):[]})),Ii=Da((function(e,t){var n=Li(t);return Cs(n)&&(n=r),Cs(e)?Qr(e,aa(t,1,Cs,!0),r,n):[]}));function ki(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:$s(n);return o<0&&(o=rr(r+o,0)),mn(e,Jo(t,3),o)}function Pi(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var l=o-1;return n!==r&&(l=$s(n),l=n<0?rr(o+l,0):ar(l,o-1)),mn(e,Jo(t,3),l,!0)}function Ci(e){return null!=e&&e.length?aa(e,1):[]}function head(e){return e&&e.length?e[0]:r}var Ri=Da((function(e){var t=un(e,ao);return t.length&&t[0]===e[0]?ga(t):[]})),zi=Da((function(e){var t=Li(e),n=un(e,ao);return t===Li(n)?t=r:n.pop(),n.length&&n[0]===e[0]?ga(n,Jo(t,2)):[]})),Mi=Da((function(e){var t=Li(e),n=un(e,ao);return(t="function"==typeof t?t:r)&&n.pop(),n.length&&n[0]===e[0]?ga(n,r,t):[]}));function Li(e){var t=null==e?0:e.length;return t?e[t-1]:r}var Di=Da(Vi);function Vi(e,t){return e&&e.length&&t&&t.length?Ra(e,t):e}var ji=Wo((function(e,t){var n=null==e?0:e.length,r=Kr(e,t);return za(e,un(t,(function(e){return ii(e,n)?+e:e})).sort(ho)),r}));function Fi(e){return null==e?e:ur.call(e)}var Bi=Da((function(e){return Za(aa(e,1,Cs,!0))})),Ui=Da((function(e){var t=Li(e);return Cs(t)&&(t=r),Za(aa(e,1,Cs,!0),Jo(t,2))})),Gi=Da((function(e){var t=Li(e);return t="function"==typeof t?t:r,Za(aa(e,1,Cs,!0),r,t)}));function Wi(e){if(!e||!e.length)return[];var t=0;return e=an(e,(function(e){if(Cs(e))return t=rr(e.length,t),!0})),En(t,(function(t){return un(e,wn(t))}))}function qi(e,t){if(!e||!e.length)return[];var n=Wi(e);return null==t?n:un(n,(function(e){return $t(t,r,e)}))}var Hi=Da((function(e,t){return Cs(e)?Qr(e,t):[]})),Ki=Da((function(e){return no(an(e,Cs))})),Xi=Da((function(e){var t=Li(e);return Cs(t)&&(t=r),no(an(e,Cs),Jo(t,2))})),Yi=Da((function(e){var t=Li(e);return t="function"==typeof t?t:r,no(an(e,Cs),r,t)})),Ji=Da(Wi),Zi=Da((function(e){var t=e.length,n=t>1?e[t-1]:r;return n="function"==typeof n?(e.pop(),n):r,qi(e,n)}));function Qi(e){var t=Sr(e);return t.__chain__=!0,t}function $i(e,t){return t(e)}var es=Wo((function(e){var t=e.length,n=t?e[0]:0,o=this.__wrapped__,l=function(object){return Kr(object,e)};return!(t>1||this.__actions__.length)&&o instanceof Pr&&ii(n)?((o=o.slice(n,+n+(t?1:0))).__actions__.push({func:$i,args:[l],thisArg:r}),new kr(o,this.__chain__).thru((function(e){return t&&!e.length&&e.push(r),e}))):this.thru(l)})),ts=bo((function(e,t,n){wt.call(e,n)?++e[n]:Hr(e,n,1)})),ns=Oo(ki),rs=Oo(Pi);function as(e,t){return(Is(e)?tn:$r)(e,Jo(t,3))}function os(e,t){return(Is(e)?nn:ea)(e,Jo(t,3))}var is=bo((function(e,t,n){wt.call(e,n)?e[n].push(t):Hr(e,n,[t])})),ss=Da((function(e,path,t){var n=-1,r="function"==typeof path,o=Ps(e)?ot(e.length):[];return $r(e,(function(e){o[++n]=r?$t(path,e,t):ya(e,path,t)})),o})),us=bo((function(e,t,n){Hr(e,n,t)}));function map(e,t){return(Is(e)?un:Oa)(e,Jo(t,3))}var ls=bo((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),cs=Da((function(e,t){if(null==e)return[];var n=t.length;return n>1&&si(e,t[0],t[1])?t=[]:n>2&&si(t[0],t[1],t[2])&&(t=[t[0]]),Pa(e,aa(t,1),[])})),ps=Kn||function(){return Bt.Date.now()};function fs(e,t,n){return t=n?r:t,t=e&&null==t?e.length:t,jo(e,I,r,r,r,r,t)}function hs(e,t){var n;if("function"!=typeof t)throw new ht(c);return e=$s(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var ds=Da((function(e,t,n){var r=_;if(n.length){var o=Ln(n,Yo(ds));r|=S}return jo(e,r,t,n,o)})),ms=Da((function(object,e,t){var n=_|N;if(t.length){var r=Ln(t,Yo(ms));n|=S}return jo(e,n,object,t,r)}));function gs(e,t,n){var o,l,f,h,d,m,y=0,v=!1,w=!1,x=!0;if("function"!=typeof e)throw new ht(c);function _(time){var t=o,n=l;return o=l=r,y=time,h=e.apply(n,t)}function N(time){var e=time-m;return m===r||e>=t||e<0||w&&time-y>=f}function E(){var time=ps();if(N(time))return A(time);d=vi(E,function(time){var e=t-(time-m);return w?ar(e,f-(time-y)):e}(time))}function A(time){return d=r,x&&o?_(time):(o=l=r,h)}function O(){var time=ps(),e=N(time);if(o=arguments,l=this,m=time,e){if(d===r)return function(time){return y=time,d=vi(E,t),v?_(time):h}(m);if(w)return d=vi(E,t),_(m)}return d===r&&(d=vi(E,t)),h}return t=tu(t)||0,js(n)&&(v=!!n.leading,f=(w="maxWait"in n)?rr(tu(n.maxWait)||0,t):f,x="trailing"in n?!!n.trailing:x),O.cancel=function(){d!==r&&lo(d),y=0,o=m=l=d=r},O.flush=function(){return d===r?h:A(ps())},O}var ys=Da((function(e,t){return Zr(e,1,t)})),vs=Da((function(e,t,n){return Zr(e,tu(t)||0,n)}));function bs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ht(c);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],l=n.cache;if(l.has(o))return l.get(o);var c=e.apply(this,r);return n.cache=l.set(o,c)||l,c};return n.cache=new(bs.Cache||zr),n}function ws(e){if("function"!=typeof e)throw new ht(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}bs.Cache=zr;var xs=so((function(e,t){var n=(t=1==t.length&&Is(t[0])?un(t[0],An(Jo())):un(aa(t,1),An(Jo()))).length;return Da((function(r){for(var o=-1,l=ar(r.length,n);++o<l;)r[o]=t[o].call(this,r[o]);return $t(e,this,r)}))})),_s=Da((function(e,t){var n=Ln(t,Yo(_s));return jo(e,S,r,t,n)})),Ns=Da((function(e,t){var n=Ln(t,Yo(Ns));return jo(e,T,r,t,n)})),Es=Wo((function(e,t){return jo(e,k,r,r,r,t)}));function As(e,t){return e===t||e!=e&&t!=t}var Os=zo(ha),Ss=zo((function(e,t){return e>=t})),Ts=va(function(){return arguments}())?va:function(e){return Fs(e)&&wt.call(e,"callee")&&!qt.call(e,"callee")},Is=ot.isArray,ks=Kt?An(Kt):function(e){return Fs(e)&&fa(e)==de};function Ps(e){return null!=e&&Vs(e.length)&&!Ls(e)}function Cs(e){return Fs(e)&&Ps(e)}var Rs=Qn||tl,zs=Xt?An(Xt):function(e){return Fs(e)&&fa(e)==Z};function Ms(e){if(!Fs(e))return!1;var t=fa(e);return t==$||t==Q||"string"==typeof e.message&&"string"==typeof e.name&&!Gs(e)}function Ls(e){if(!js(e))return!1;var t=fa(e);return t==ee||t==te||t==Y||t==ie}function Ds(e){return"number"==typeof e&&e==$s(e)}function Vs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=j}function js(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Fs(e){return null!=e&&"object"==typeof e}var Bs=Yt?An(Yt):function(e){return Fs(e)&&ni(e)==ne};function Us(e){return"number"==typeof e||Fs(e)&&fa(e)==re}function Gs(e){if(!Fs(e)||fa(e)!=oe)return!1;var t=Ut(e);if(null===t)return!0;var n=wt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&bt.call(n)==Et}var Ws=Jt?An(Jt):function(e){return Fs(e)&&fa(e)==se},qs=Zt?An(Zt):function(e){return Fs(e)&&ni(e)==ue};function Hs(e){return"string"==typeof e||!Is(e)&&Fs(e)&&fa(e)==le}function Ks(e){return"symbol"==typeof e||Fs(e)&&fa(e)==ce}var Xs=Qt?An(Qt):function(e){return Fs(e)&&Vs(e.length)&&!!zt[fa(e)]},Ys=zo(Aa),Js=zo((function(e,t){return e<=t}));function Zs(e){if(!e)return[];if(Ps(e))return Hs(e)?Bn(e):yo(e);if(xn&&e[xn])return function(e){for(var data,t=[];!(data=e.next()).done;)t.push(data.value);return t}(e[xn]());var t=ni(e);return(t==ne?zn:t==ue?Vn:Au)(e)}function Qs(e){return e?(e=tu(e))===V||e===-V?(e<0?-1:1)*F:e==e?e:0:0===e?e:0}function $s(e){var t=Qs(e),n=t%1;return t==t?n?t-n:t:0}function eu(e){return e?Xr($s(e),0,U):0}function tu(e){if("number"==typeof e)return e;if(Ks(e))return B;if(js(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=js(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Fe,"");var n=Ze.test(e);return n||$e.test(e)?Vt(e.slice(2),n?2:8):Je.test(e)?B:+e}function nu(e){return vo(e,yu(e))}function ru(e){return null==e?"":Ja(e)}var au=wo((function(object,source){if(fi(source)||Ps(source))vo(source,gu(source),object);else for(var e in source)wt.call(source,e)&&Ur(object,e,source[e])})),ou=wo((function(object,source){vo(source,yu(source),object)})),iu=wo((function(object,source,e,t){vo(source,yu(source),object,t)})),su=wo((function(object,source,e,t){vo(source,gu(source),object,t)})),uu=Wo(Kr),lu=Da((function(object,e){object=ct(object);var t=-1,n=e.length,o=n>2?e[2]:r;for(o&&si(e[0],e[1],o)&&(n=1);++t<n;)for(var source=e[t],l=yu(source),c=-1,f=l.length;++c<f;){var h=l[c],d=object[h];(d===r||As(d,yt[h])&&!wt.call(object,h))&&(object[h]=source[h])}return object})),cu=Da((function(e){return e.push(r,Bo),$t(bu,r,e)}));function pu(object,path,e){var t=null==object?r:ca(object,path);return t===r?e:t}function fu(object,path){return null!=object&&ri(object,path,ma)}var hu=Io((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Nt.call(t)),e[t]=n}),ju(Uu)),du=Io((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Nt.call(t)),wt.call(e,t)?e[t].push(n):e[t]=[n]}),Jo),mu=Da(ya);function gu(object){return Ps(object)?Dr(object):Na(object)}function yu(object){return Ps(object)?Dr(object,!0):Ea(object)}var vu=wo((function(object,source,e){Ia(object,source,e)})),bu=wo((function(object,source,e,t){Ia(object,source,e,t)})),wu=Wo((function(object,e){var t={};if(null==object)return t;var n=!1;e=un(e,(function(path){return path=io(path,object),n||(n=path.length>1),path})),vo(object,Ho(object),t),n&&(t=Yr(t,m|y|v,Uo));for(var r=e.length;r--;)Qa(t,e[r]);return t})),xu=Wo((function(object,e){return null==object?{}:function(object,e){return Ca(object,e,(function(e,path){return fu(object,path)}))}(object,e)}));function _u(object,e){if(null==object)return{};var t=un(Ho(object),(function(e){return[e]}));return e=Jo(e),Ca(object,t,(function(t,path){return e(t,path[0])}))}var Nu=Vo(gu),Eu=Vo(yu);function Au(object){return null==object?[]:On(object,gu(object))}var Ou=Eo((function(e,t,n){return t=t.toLowerCase(),e+(n?Su(t):t)}));function Su(e){return Mu(ru(e).toLowerCase())}function Tu(e){return(e=ru(e))&&e.replace(tt,kn).replace(St,"")}var Iu=Eo((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),ku=Eo((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Pu=No("toLowerCase"),Cu=Eo((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Ru=Eo((function(e,t,n){return e+(n?" ":"")+Mu(t)})),zu=Eo((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Mu=No("toUpperCase");function Lu(e,pattern,t){return e=ru(e),(pattern=t?r:pattern)===r?function(e){return Pt.test(e)}(e)?function(e){return e.match(It)||[]}(e):function(e){return e.match(He)||[]}(e):e.match(pattern)||[]}var Du=Da((function(e,t){try{return $t(e,r,t)}catch(e){return Ms(e)?e:new st(e)}})),Vu=Wo((function(object,e){return tn(e,(function(e){e=Ei(e),Hr(object,e,ds(object[e],object))})),object}));function ju(e){return function(){return e}}var Fu=So(),Bu=So(!0);function Uu(e){return e}function Gu(e){return _a("function"==typeof e?e:Yr(e,m))}var Wu=Da((function(path,e){return function(object){return ya(object,path,e)}})),qu=Da((function(object,e){return function(path){return ya(object,path,e)}}));function Hu(object,source,e){var t=gu(source),n=la(source,t);null!=e||js(source)&&(n.length||!t.length)||(e=source,source=object,object=this,n=la(source,gu(source)));var r=!(js(e)&&"chain"in e&&!e.chain),o=Ls(object);return tn(n,(function(e){var t=source[e];object[e]=t,o&&(object.prototype[e]=function(){var e=this.__chain__;if(r||e){var n=object(this.__wrapped__),o=n.__actions__=yo(this.__actions__);return o.push({func:t,args:arguments,thisArg:object}),n.__chain__=e,n}return t.apply(object,ln([this.value()],arguments))})})),object}function Ku(){}var Xu=Po(un),Yu=Po(rn),Ju=Po(fn);function Zu(path){return ui(path)?wn(Ei(path)):function(path){return function(object){return ca(object,path)}}(path)}var Qu=Ro(),$u=Ro(!0);function el(){return[]}function tl(){return!1}var source,nl=ko((function(e,t){return e+t}),0),rl=Lo("ceil"),al=ko((function(e,t){return e/t}),1),il=Lo("floor"),sl=ko((function(e,t){return e*t}),1),ll=Lo("round"),cl=ko((function(e,t){return e-t}),0);return Sr.after=function(e,t){if("function"!=typeof t)throw new ht(c);return e=$s(e),function(){if(--e<1)return t.apply(this,arguments)}},Sr.ary=fs,Sr.assign=au,Sr.assignIn=ou,Sr.assignInWith=iu,Sr.assignWith=su,Sr.at=uu,Sr.before=hs,Sr.bind=ds,Sr.bindAll=Vu,Sr.bindKey=ms,Sr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Is(e)?e:[e]},Sr.chain=Qi,Sr.chunk=function(e,t,n){t=(n?si(e,t,n):t===r)?1:rr($s(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var l=0,c=0,f=ot(Yn(o/t));l<o;)f[c++]=Wa(e,l,l+=t);return f},Sr.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var l=e[t];l&&(o[r++]=l)}return o},Sr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=ot(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return ln(Is(n)?yo(n):[n],aa(t,1))},Sr.cond=function(e){var t=null==e?0:e.length,n=Jo();return e=t?un(e,(function(e){if("function"!=typeof e[1])throw new ht(c);return[n(e[0]),e[1]]})):[],Da((function(n){for(var r=-1;++r<t;){var o=e[r];if($t(o[0],this,n))return $t(o[1],this,n)}}))},Sr.conforms=function(source){return function(source){var e=gu(source);return function(object){return Jr(object,source,e)}}(Yr(source,m))},Sr.constant=ju,Sr.countBy=ts,Sr.create=function(e,t){var n=Tr(e);return null==t?n:qr(n,t)},Sr.curry=function e(t,n,o){var l=jo(t,A,r,r,r,r,r,n=o?r:n);return l.placeholder=e.placeholder,l},Sr.curryRight=function e(t,n,o){var l=jo(t,O,r,r,r,r,r,n=o?r:n);return l.placeholder=e.placeholder,l},Sr.debounce=gs,Sr.defaults=lu,Sr.defaultsDeep=cu,Sr.defer=ys,Sr.delay=vs,Sr.difference=Si,Sr.differenceBy=Ti,Sr.differenceWith=Ii,Sr.drop=function(e,t,n){var o=null==e?0:e.length;return o?Wa(e,(t=n||t===r?1:$s(t))<0?0:t,o):[]},Sr.dropRight=function(e,t,n){var o=null==e?0:e.length;return o?Wa(e,0,(t=o-(t=n||t===r?1:$s(t)))<0?0:t):[]},Sr.dropRightWhile=function(e,t){return e&&e.length?eo(e,Jo(t,3),!0,!0):[]},Sr.dropWhile=function(e,t){return e&&e.length?eo(e,Jo(t,3),!0):[]},Sr.fill=function(e,t,n,o){var l=null==e?0:e.length;return l?(n&&"number"!=typeof n&&si(e,t,n)&&(n=0,o=l),function(e,t,n,o){var l=e.length;for((n=$s(n))<0&&(n=-n>l?0:l+n),(o=o===r||o>l?l:$s(o))<0&&(o+=l),o=n>o?0:eu(o);n<o;)e[n++]=t;return e}(e,t,n,o)):[]},Sr.filter=function(e,t){return(Is(e)?an:ra)(e,Jo(t,3))},Sr.flatMap=function(e,t){return aa(map(e,t),1)},Sr.flatMapDeep=function(e,t){return aa(map(e,t),V)},Sr.flatMapDepth=function(e,t,n){return n=n===r?1:$s(n),aa(map(e,t),n)},Sr.flatten=Ci,Sr.flattenDeep=function(e){return null!=e&&e.length?aa(e,V):[]},Sr.flattenDepth=function(e,t){return null!=e&&e.length?aa(e,t=t===r?1:$s(t)):[]},Sr.flip=function(e){return jo(e,P)},Sr.flow=Fu,Sr.flowRight=Bu,Sr.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r},Sr.functions=function(object){return null==object?[]:la(object,gu(object))},Sr.functionsIn=function(object){return null==object?[]:la(object,yu(object))},Sr.groupBy=is,Sr.initial=function(e){return null!=e&&e.length?Wa(e,0,-1):[]},Sr.intersection=Ri,Sr.intersectionBy=zi,Sr.intersectionWith=Mi,Sr.invert=hu,Sr.invertBy=du,Sr.invokeMap=ss,Sr.iteratee=Gu,Sr.keyBy=us,Sr.keys=gu,Sr.keysIn=yu,Sr.map=map,Sr.mapKeys=function(object,e){var t={};return e=Jo(e,3),sa(object,(function(n,r,object){Hr(t,e(n,r,object),n)})),t},Sr.mapValues=function(object,e){var t={};return e=Jo(e,3),sa(object,(function(n,r,object){Hr(t,r,e(n,r,object))})),t},Sr.matches=function(source){return Sa(Yr(source,m))},Sr.matchesProperty=function(path,e){return Ta(path,Yr(e,m))},Sr.memoize=bs,Sr.merge=vu,Sr.mergeWith=bu,Sr.method=Wu,Sr.methodOf=qu,Sr.mixin=Hu,Sr.negate=ws,Sr.nthArg=function(e){return e=$s(e),Da((function(t){return ka(t,e)}))},Sr.omit=wu,Sr.omitBy=function(object,e){return _u(object,ws(Jo(e)))},Sr.once=function(e){return hs(2,e)},Sr.orderBy=function(e,t,n,o){return null==e?[]:(Is(t)||(t=null==t?[]:[t]),Is(n=o?r:n)||(n=null==n?[]:[n]),Pa(e,t,n))},Sr.over=Xu,Sr.overArgs=xs,Sr.overEvery=Yu,Sr.overSome=Ju,Sr.partial=_s,Sr.partialRight=Ns,Sr.partition=ls,Sr.pick=xu,Sr.pickBy=_u,Sr.property=Zu,Sr.propertyOf=function(object){return function(path){return null==object?r:ca(object,path)}},Sr.pull=Di,Sr.pullAll=Vi,Sr.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Ra(e,t,Jo(n,2)):e},Sr.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Ra(e,t,r,n):e},Sr.pullAt=ji,Sr.range=Qu,Sr.rangeRight=$u,Sr.rearg=Es,Sr.reject=function(e,t){return(Is(e)?an:ra)(e,ws(Jo(t,3)))},Sr.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],l=e.length;for(t=Jo(t,3);++r<l;){var c=e[r];t(c,r,e)&&(n.push(c),o.push(r))}return za(e,o),n},Sr.rest=function(e,t){if("function"!=typeof e)throw new ht(c);return Da(e,t=t===r?t:$s(t))},Sr.reverse=Fi,Sr.sampleSize=function(e,t,n){return t=(n?si(e,t,n):t===r)?1:$s(t),(Is(e)?jr:ja)(e,t)},Sr.set=function(object,path,e){return null==object?object:Fa(object,path,e)},Sr.setWith=function(object,path,e,t){return t="function"==typeof t?t:r,null==object?object:Fa(object,path,e,t)},Sr.shuffle=function(e){return(Is(e)?Fr:Ga)(e)},Sr.slice=function(e,t,n){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&si(e,t,n)?(t=0,n=o):(t=null==t?0:$s(t),n=n===r?o:$s(n)),Wa(e,t,n)):[]},Sr.sortBy=cs,Sr.sortedUniq=function(e){return e&&e.length?Xa(e):[]},Sr.sortedUniqBy=function(e,t){return e&&e.length?Xa(e,Jo(t,2)):[]},Sr.split=function(e,t,n){return n&&"number"!=typeof n&&si(e,t,n)&&(t=n=r),(n=n===r?U:n>>>0)?(e=ru(e))&&("string"==typeof t||null!=t&&!Ws(t))&&!(t=Ja(t))&&Rn(e)?uo(Bn(e),0,n):e.split(t,n):[]},Sr.spread=function(e,t){if("function"!=typeof e)throw new ht(c);return t=null==t?0:rr($s(t),0),Da((function(n){var r=n[t],o=uo(n,0,t);return r&&ln(o,r),$t(e,this,o)}))},Sr.tail=function(e){var t=null==e?0:e.length;return t?Wa(e,1,t):[]},Sr.take=function(e,t,n){return e&&e.length?Wa(e,0,(t=n||t===r?1:$s(t))<0?0:t):[]},Sr.takeRight=function(e,t,n){var o=null==e?0:e.length;return o?Wa(e,(t=o-(t=n||t===r?1:$s(t)))<0?0:t,o):[]},Sr.takeRightWhile=function(e,t){return e&&e.length?eo(e,Jo(t,3),!1,!0):[]},Sr.takeWhile=function(e,t){return e&&e.length?eo(e,Jo(t,3)):[]},Sr.tap=function(e,t){return t(e),e},Sr.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new ht(c);return js(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),gs(e,t,{leading:r,maxWait:t,trailing:o})},Sr.thru=$i,Sr.toArray=Zs,Sr.toPairs=Nu,Sr.toPairsIn=Eu,Sr.toPath=function(e){return Is(e)?un(e,Ei):Ks(e)?[e]:yo(Ni(ru(e)))},Sr.toPlainObject=nu,Sr.transform=function(object,e,t){var n=Is(object),r=n||Rs(object)||Xs(object);if(e=Jo(e,4),null==t){var o=object&&object.constructor;t=r?n?new o:[]:js(object)&&Ls(o)?Tr(Ut(object)):{}}return(r?tn:sa)(object,(function(n,r,object){return e(t,n,r,object)})),t},Sr.unary=function(e){return fs(e,1)},Sr.union=Bi,Sr.unionBy=Ui,Sr.unionWith=Gi,Sr.uniq=function(e){return e&&e.length?Za(e):[]},Sr.uniqBy=function(e,t){return e&&e.length?Za(e,Jo(t,2)):[]},Sr.uniqWith=function(e,t){return t="function"==typeof t?t:r,e&&e.length?Za(e,r,t):[]},Sr.unset=function(object,path){return null==object||Qa(object,path)},Sr.unzip=Wi,Sr.unzipWith=qi,Sr.update=function(object,path,e){return null==object?object:$a(object,path,oo(e))},Sr.updateWith=function(object,path,e,t){return t="function"==typeof t?t:r,null==object?object:$a(object,path,oo(e),t)},Sr.values=Au,Sr.valuesIn=function(object){return null==object?[]:On(object,yu(object))},Sr.without=Hi,Sr.words=Lu,Sr.wrap=function(e,t){return _s(oo(t),e)},Sr.xor=Ki,Sr.xorBy=Xi,Sr.xorWith=Yi,Sr.zip=Ji,Sr.zipObject=function(e,t){return ro(e||[],t||[],Ur)},Sr.zipObjectDeep=function(e,t){return ro(e||[],t||[],Fa)},Sr.zipWith=Zi,Sr.entries=Nu,Sr.entriesIn=Eu,Sr.extend=ou,Sr.extendWith=iu,Hu(Sr,Sr),Sr.add=nl,Sr.attempt=Du,Sr.camelCase=Ou,Sr.capitalize=Su,Sr.ceil=rl,Sr.clamp=function(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=(n=tu(n))==n?n:0),t!==r&&(t=(t=tu(t))==t?t:0),Xr(tu(e),t,n)},Sr.clone=function(e){return Yr(e,v)},Sr.cloneDeep=function(e){return Yr(e,m|v)},Sr.cloneDeepWith=function(e,t){return Yr(e,m|v,t="function"==typeof t?t:r)},Sr.cloneWith=function(e,t){return Yr(e,v,t="function"==typeof t?t:r)},Sr.conformsTo=function(object,source){return null==source||Jr(object,source,gu(source))},Sr.deburr=Tu,Sr.defaultTo=function(e,t){return null==e||e!=e?t:e},Sr.divide=al,Sr.endsWith=function(e,t,n){e=ru(e),t=Ja(t);var o=e.length,l=n=n===r?o:Xr($s(n),0,o);return(n-=t.length)>=0&&e.slice(n,l)==t},Sr.eq=As,Sr.escape=function(e){return(e=ru(e))&&Pe.test(e)?e.replace(Ie,Pn):e},Sr.escapeRegExp=function(e){return(e=ru(e))&&je.test(e)?e.replace(Ve,"\\$&"):e},Sr.every=function(e,t,n){var o=Is(e)?rn:ta;return n&&si(e,t,n)&&(t=r),o(e,Jo(t,3))},Sr.find=ns,Sr.findIndex=ki,Sr.findKey=function(object,e){return dn(object,Jo(e,3),sa)},Sr.findLast=rs,Sr.findLastIndex=Pi,Sr.findLastKey=function(object,e){return dn(object,Jo(e,3),ua)},Sr.floor=il,Sr.forEach=as,Sr.forEachRight=os,Sr.forIn=function(object,e){return null==object?object:oa(object,Jo(e,3),yu)},Sr.forInRight=function(object,e){return null==object?object:ia(object,Jo(e,3),yu)},Sr.forOwn=function(object,e){return object&&sa(object,Jo(e,3))},Sr.forOwnRight=function(object,e){return object&&ua(object,Jo(e,3))},Sr.get=pu,Sr.gt=Os,Sr.gte=Ss,Sr.has=function(object,path){return null!=object&&ri(object,path,da)},Sr.hasIn=fu,Sr.head=head,Sr.identity=Uu,Sr.includes=function(e,t,n,r){e=Ps(e)?e:Au(e),n=n&&!r?$s(n):0;var o=e.length;return n<0&&(n=rr(o+n,0)),Hs(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&gn(e,t,n)>-1},Sr.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:$s(n);return o<0&&(o=rr(r+o,0)),gn(e,t,o)},Sr.inRange=function(e,t,n){return t=Qs(t),n===r?(n=t,t=0):n=Qs(n),function(e,t,n){return e>=ar(t,n)&&e<rr(t,n)}(e=tu(e),t,n)},Sr.invoke=mu,Sr.isArguments=Ts,Sr.isArray=Is,Sr.isArrayBuffer=ks,Sr.isArrayLike=Ps,Sr.isArrayLikeObject=Cs,Sr.isBoolean=function(e){return!0===e||!1===e||Fs(e)&&fa(e)==J},Sr.isBuffer=Rs,Sr.isDate=zs,Sr.isElement=function(e){return Fs(e)&&1===e.nodeType&&!Gs(e)},Sr.isEmpty=function(e){if(null==e)return!0;if(Ps(e)&&(Is(e)||"string"==typeof e||"function"==typeof e.splice||Rs(e)||Xs(e)||Ts(e)))return!e.length;var t=ni(e);if(t==ne||t==ue)return!e.size;if(fi(e))return!Na(e).length;for(var n in e)if(wt.call(e,n))return!1;return!0},Sr.isEqual=function(e,t){return ba(e,t)},Sr.isEqualWith=function(e,t,n){var o=(n="function"==typeof n?n:r)?n(e,t):r;return o===r?ba(e,t,r,n):!!o},Sr.isError=Ms,Sr.isFinite=function(e){return"number"==typeof e&&$n(e)},Sr.isFunction=Ls,Sr.isInteger=Ds,Sr.isLength=Vs,Sr.isMap=Bs,Sr.isMatch=function(object,source){return object===source||wa(object,source,Qo(source))},Sr.isMatchWith=function(object,source,e){return e="function"==typeof e?e:r,wa(object,source,Qo(source),e)},Sr.isNaN=function(e){return Us(e)&&e!=+e},Sr.isNative=function(e){if(pi(e))throw new st(l);return xa(e)},Sr.isNil=function(e){return null==e},Sr.isNull=function(e){return null===e},Sr.isNumber=Us,Sr.isObject=js,Sr.isObjectLike=Fs,Sr.isPlainObject=Gs,Sr.isRegExp=Ws,Sr.isSafeInteger=function(e){return Ds(e)&&e>=-j&&e<=j},Sr.isSet=qs,Sr.isString=Hs,Sr.isSymbol=Ks,Sr.isTypedArray=Xs,Sr.isUndefined=function(e){return e===r},Sr.isWeakMap=function(e){return Fs(e)&&ni(e)==fe},Sr.isWeakSet=function(e){return Fs(e)&&fa(e)==he},Sr.join=function(e,t){return null==e?"":er.call(e,t)},Sr.kebabCase=Iu,Sr.last=Li,Sr.lastIndexOf=function(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var l=o;return n!==r&&(l=(l=$s(n))<0?rr(o+l,0):ar(l,o-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,l):mn(e,vn,l,!0)},Sr.lowerCase=ku,Sr.lowerFirst=Pu,Sr.lt=Ys,Sr.lte=Js,Sr.max=function(e){return e&&e.length?na(e,Uu,ha):r},Sr.maxBy=function(e,t){return e&&e.length?na(e,Jo(t,2),ha):r},Sr.mean=function(e){return bn(e,Uu)},Sr.meanBy=function(e,t){return bn(e,Jo(t,2))},Sr.min=function(e){return e&&e.length?na(e,Uu,Aa):r},Sr.minBy=function(e,t){return e&&e.length?na(e,Jo(t,2),Aa):r},Sr.stubArray=el,Sr.stubFalse=tl,Sr.stubObject=function(){return{}},Sr.stubString=function(){return""},Sr.stubTrue=function(){return!0},Sr.multiply=sl,Sr.nth=function(e,t){return e&&e.length?ka(e,$s(t)):r},Sr.noConflict=function(){return Bt._===this&&(Bt._=At),this},Sr.noop=Ku,Sr.now=ps,Sr.pad=function(e,t,n){e=ru(e);var r=(t=$s(t))?Fn(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return Co(Jn(o),n)+e+Co(Yn(o),n)},Sr.padEnd=function(e,t,n){e=ru(e);var r=(t=$s(t))?Fn(e):0;return t&&r<t?e+Co(t-r,n):e},Sr.padStart=function(e,t,n){e=ru(e);var r=(t=$s(t))?Fn(e):0;return t&&r<t?Co(t-r,n)+e:e},Sr.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),ir(ru(e).replace(Be,""),t||0)},Sr.random=function(e,t,n){if(n&&"boolean"!=typeof n&&si(e,t,n)&&(t=n=r),n===r&&("boolean"==typeof t?(n=t,t=r):"boolean"==typeof e&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=Qs(e),t===r?(t=e,e=0):t=Qs(t)),e>t){var o=e;e=t,t=o}if(n||e%1||t%1){var l=sr();return ar(e+l*(t-e+Dt("1e-"+((l+"").length-1))),t)}return Ma(e,t)},Sr.reduce=function(e,t,n){var r=Is(e)?cn:_n,o=arguments.length<3;return r(e,Jo(t,4),n,o,$r)},Sr.reduceRight=function(e,t,n){var r=Is(e)?pn:_n,o=arguments.length<3;return r(e,Jo(t,4),n,o,ea)},Sr.repeat=function(e,t,n){return t=(n?si(e,t,n):t===r)?1:$s(t),La(ru(e),t)},Sr.replace=function(){var e=arguments,t=ru(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Sr.result=function(object,path,e){var t=-1,n=(path=io(path,object)).length;for(n||(n=1,object=r);++t<n;){var o=null==object?r:object[Ei(path[t])];o===r&&(t=n,o=e),object=Ls(o)?o.call(object):o}return object},Sr.round=ll,Sr.runInContext=e,Sr.sample=function(e){return(Is(e)?Vr:Va)(e)},Sr.size=function(e){if(null==e)return 0;if(Ps(e))return Hs(e)?Fn(e):e.length;var t=ni(e);return t==ne||t==ue?e.size:Na(e).length},Sr.snakeCase=Cu,Sr.some=function(e,t,n){var o=Is(e)?fn:qa;return n&&si(e,t,n)&&(t=r),o(e,Jo(t,3))},Sr.sortedIndex=function(e,t){return Ha(e,t)},Sr.sortedIndexBy=function(e,t,n){return Ka(e,t,Jo(n,2))},Sr.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Ha(e,t);if(r<n&&As(e[r],t))return r}return-1},Sr.sortedLastIndex=function(e,t){return Ha(e,t,!0)},Sr.sortedLastIndexBy=function(e,t,n){return Ka(e,t,Jo(n,2),!0)},Sr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Ha(e,t,!0)-1;if(As(e[n],t))return n}return-1},Sr.startCase=Ru,Sr.startsWith=function(e,t,n){return e=ru(e),n=null==n?0:Xr($s(n),0,e.length),t=Ja(t),e.slice(n,n+t.length)==t},Sr.subtract=cl,Sr.sum=function(e){return e&&e.length?Nn(e,Uu):0},Sr.sumBy=function(e,t){return e&&e.length?Nn(e,Jo(t,2)):0},Sr.template=function(e,t,n){var o=Sr.templateSettings;n&&si(e,t,n)&&(t=r),e=ru(e),t=iu({},t,o,Fo);var l,c,f=iu({},t.imports,o.imports,Fo),h=gu(f),d=On(f,h),m=0,y=t.interpolate||nt,source="__p += '",v=pt((t.escape||nt).source+"|"+y.source+"|"+(y===ze?Xe:nt).source+"|"+(t.evaluate||nt).source+"|$","g"),w="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Rt+"]")+"\n";e.replace(v,(function(t,n,r,o,f,h){return r||(r=o),source+=e.slice(m,h).replace(at,Cn),n&&(l=!0,source+="' +\n__e("+n+") +\n'"),f&&(c=!0,source+="';\n"+f+";\n__p += '"),r&&(source+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),m=h+t.length,t})),source+="';\n";var x=t.variable;x||(source="with (obj) {\n"+source+"\n}\n"),source=(c?source.replace(Ae,""):source).replace(Oe,"$1").replace(Se,"$1;"),source="function("+(x||"obj")+") {\n"+(x?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(l?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var _=Du((function(){return ut(h,w+"return "+source).apply(r,d)}));if(_.source=source,Ms(_))throw _;return _},Sr.times=function(e,t){if((e=$s(e))<1||e>j)return[];var n=U,r=ar(e,U);t=Jo(t),e-=U;for(var o=En(r,t);++n<e;)t(n);return o},Sr.toFinite=Qs,Sr.toInteger=$s,Sr.toLength=eu,Sr.toLower=function(e){return ru(e).toLowerCase()},Sr.toNumber=tu,Sr.toSafeInteger=function(e){return e?Xr($s(e),-j,j):0===e?e:0},Sr.toString=ru,Sr.toUpper=function(e){return ru(e).toUpperCase()},Sr.trim=function(e,t,n){if((e=ru(e))&&(n||t===r))return e.replace(Fe,"");if(!e||!(t=Ja(t)))return e;var o=Bn(e),l=Bn(t);return uo(o,Tn(o,l),In(o,l)+1).join("")},Sr.trimEnd=function(e,t,n){if((e=ru(e))&&(n||t===r))return e.replace(Ue,"");if(!e||!(t=Ja(t)))return e;var o=Bn(e);return uo(o,0,In(o,Bn(t))+1).join("")},Sr.trimStart=function(e,t,n){if((e=ru(e))&&(n||t===r))return e.replace(Be,"");if(!e||!(t=Ja(t)))return e;var o=Bn(e);return uo(o,Tn(o,Bn(t))).join("")},Sr.truncate=function(e,t){var n=C,o=R;if(js(t)){var l="separator"in t?t.separator:l;n="length"in t?$s(t.length):n,o="omission"in t?Ja(t.omission):o}var c=(e=ru(e)).length;if(Rn(e)){var f=Bn(e);c=f.length}if(n>=c)return e;var h=n-Fn(o);if(h<1)return o;var d=f?uo(f,0,h).join(""):e.slice(0,h);if(l===r)return d+o;if(f&&(h+=d.length-h),Ws(l)){if(e.slice(h).search(l)){var m,y=d;for(l.global||(l=pt(l.source,ru(Ye.exec(l))+"g")),l.lastIndex=0;m=l.exec(y);)var v=m.index;d=d.slice(0,v===r?h:v)}}else if(e.indexOf(Ja(l),h)!=h){var w=d.lastIndexOf(l);w>-1&&(d=d.slice(0,w))}return d+o},Sr.unescape=function(e){return(e=ru(e))&&ke.test(e)?e.replace(Te,Un):e},Sr.uniqueId=function(e){var t=++xt;return ru(e)+t},Sr.upperCase=zu,Sr.upperFirst=Mu,Sr.each=as,Sr.eachRight=os,Sr.first=head,Hu(Sr,(source={},sa(Sr,(function(e,t){wt.call(Sr.prototype,t)||(source[t]=e)})),source),{chain:!1}),Sr.VERSION="4.17.10",tn(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Sr[e].placeholder=Sr})),tn(["drop","take"],(function(e,t){Pr.prototype[e]=function(n){n=n===r?1:rr($s(n),0);var o=this.__filtered__&&!t?new Pr(this):this.clone();return o.__filtered__?o.__takeCount__=ar(n,o.__takeCount__):o.__views__.push({size:ar(n,U),type:e+(o.__dir__<0?"Right":"")}),o},Pr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),tn(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=n==L||3==n;Pr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Jo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),tn(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Pr.prototype[e]=function(){return this[n](1).value()[0]}})),tn(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Pr.prototype[e]=function(){return this.__filtered__?new Pr(this):this[n](1)}})),Pr.prototype.compact=function(){return this.filter(Uu)},Pr.prototype.find=function(e){return this.filter(e).head()},Pr.prototype.findLast=function(e){return this.reverse().find(e)},Pr.prototype.invokeMap=Da((function(path,e){return"function"==typeof path?new Pr(this):this.map((function(t){return ya(t,path,e)}))})),Pr.prototype.reject=function(e){return this.filter(ws(Jo(e)))},Pr.prototype.slice=function(e,t){e=$s(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Pr(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(n=(t=$s(t))<0?n.dropRight(-t):n.take(t-e)),n)},Pr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pr.prototype.toArray=function(){return this.take(U)},sa(Pr.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),l=Sr[o?"take"+("last"==t?"Right":""):t],c=o||/^find/.test(t);l&&(Sr.prototype[t]=function(){var t=this.__wrapped__,f=o?[1]:arguments,h=t instanceof Pr,d=f[0],m=h||Is(t),y=function(e){var t=l.apply(Sr,ln([e],f));return o&&v?t[0]:t};m&&n&&"function"==typeof d&&1!=d.length&&(h=m=!1);var v=this.__chain__,w=!!this.__actions__.length,x=c&&!v,_=h&&!w;if(!c&&m){t=_?t:new Pr(this);var N=e.apply(t,f);return N.__actions__.push({func:$i,args:[y],thisArg:r}),new kr(N,v)}return x&&_?e.apply(this,f):(N=this.thru(y),x?o?N.value()[0]:N.value():N)})})),tn(["pop","push","shift","sort","splice","unshift"],(function(e){var t=mt[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Sr.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(Is(o)?o:[],e)}return this[n]((function(n){return t.apply(Is(n)?n:[],e)}))}})),sa(Pr.prototype,(function(e,t){var n=Sr[t];if(n){var r=n.name+"";(yr[r]||(yr[r]=[])).push({name:t,func:n})}})),yr[To(r,N).name]=[{name:"wrapper",func:r}],Pr.prototype.clone=function(){var e=new Pr(this.__wrapped__);return e.__actions__=yo(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=yo(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=yo(this.__views__),e},Pr.prototype.reverse=function(){if(this.__filtered__){var e=new Pr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Pr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Is(e),r=t<0,o=n?e.length:0,view=function(e,t,n){for(var r=-1,o=n.length;++r<o;){var data=n[r],l=data.size;switch(data.type){case"drop":e+=l;break;case"dropRight":t-=l;break;case"take":t=ar(t,e+l);break;case"takeRight":e=rr(e,t-l)}}return{start:e,end:t}}(0,o,this.__views__),l=view.start,c=view.end,f=c-l,h=r?c:l-1,d=this.__iteratees__,m=d.length,y=0,v=ar(f,this.__takeCount__);if(!n||!r&&o==f&&v==f)return to(e,this.__actions__);var w=[];e:for(;f--&&y<v;){for(var x=-1,_=e[h+=t];++x<m;){var data=d[x],N=data.iteratee,E=data.type,A=N(_);if(E==D)_=A;else if(!A){if(E==L)continue e;break e}}w[y++]=_}return w},Sr.prototype.at=es,Sr.prototype.chain=function(){return Qi(this)},Sr.prototype.commit=function(){return new kr(this.value(),this.__chain__)},Sr.prototype.next=function(){this.__values__===r&&(this.__values__=Zs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?r:this.__values__[this.__index__++]}},Sr.prototype.plant=function(e){for(var t,n=this;n instanceof Ir;){var o=Oi(n);o.__index__=0,o.__values__=r,t?l.__wrapped__=o:t=o;var l=o;n=n.__wrapped__}return l.__wrapped__=e,t},Sr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Pr){var t=e;return this.__actions__.length&&(t=new Pr(this)),(t=t.reverse()).__actions__.push({func:$i,args:[Fi],thisArg:r}),new kr(t,this.__chain__)}return this.thru(Fi)},Sr.prototype.toJSON=Sr.prototype.valueOf=Sr.prototype.value=function(){return to(this.__wrapped__,this.__actions__)},Sr.prototype.first=Sr.prototype.head,xn&&(Sr.prototype[xn]=function(){return this}),Sr}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Bt._=Gn,define((function(){return Gn}))):Gt?((Gt.exports=Gn)._=Gn,Ut._=Gn):Bt._=Gn}).call(this)}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],197:[function(e,t,n){"use strict";t.exports=e("./src/index-minimal")},{"./src/index-minimal":198}],198:[function(e,t,n){"use strict";var r=n;function o(){r.Reader._configure(r.BufferReader),r.util._configure()}r.build="minimal",r.Writer=e("./writer"),r.BufferWriter=e("./writer_buffer"),r.Reader=e("./reader"),r.BufferReader=e("./reader_buffer"),r.util=e("./util/minimal"),r.rpc=e("./rpc"),r.roots=e("./roots"),r.configure=o,r.Writer._configure(r.BufferWriter),o()},{"./reader":199,"./reader_buffer":200,"./roots":201,"./rpc":202,"./util/minimal":205,"./writer":206,"./writer_buffer":207}],199:[function(e,t,n){"use strict";t.exports=h;var r,o=e("./util/minimal"),l=o.LongBits,c=o.utf8;function f(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function h(e){this.buf=e,this.pos=0,this.len=e.length}var d,m="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new h(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new h(e);throw Error("illegal buffer")};function y(){var e=new l(0,0),i=0;if(!(this.len-this.pos>4)){for(;i<3;++i){if(this.pos>=this.len)throw f(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*i)>>>0,e}for(;i<4;++i)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(i=0,this.len-this.pos>4){for(;i<5;++i)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return e}else for(;i<5;++i){if(this.pos>=this.len)throw f(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function v(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function w(){if(this.pos+8>this.len)throw f(this,8);return new l(v(this.buf,this.pos+=4),v(this.buf,this.pos+=4))}h.create=o.Buffer?function(e){return(h.create=function(e){return o.Buffer.isBuffer(e)?new r(e):m(e)})(e)}:m,h.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,h.prototype.uint32=(d=4294967295,function(){if(d=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return d;if((this.pos+=5)>this.len)throw this.pos=this.len,f(this,10);return d}),h.prototype.int32=function(){return 0|this.uint32()},h.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},h.prototype.bool=function(){return 0!==this.uint32()},h.prototype.fixed32=function(){if(this.pos+4>this.len)throw f(this,4);return v(this.buf,this.pos+=4)},h.prototype.sfixed32=function(){if(this.pos+4>this.len)throw f(this,4);return 0|v(this.buf,this.pos+=4)},h.prototype.float=function(){if(this.pos+4>this.len)throw f(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},h.prototype.double=function(){if(this.pos+8>this.len)throw f(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},h.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw f(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},h.prototype.string=function(){var e=this.bytes();return c.read(e,0,e.length)},h.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw f(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw f(this)}while(128&this.buf[this.pos++]);return this},h.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},h._configure=function(e){r=e;var t=o.Long?"toLong":"toNumber";o.merge(h.prototype,{int64:function(){return y.call(this)[t](!1)},uint64:function(){return y.call(this)[t](!0)},sint64:function(){return y.call(this).zzDecode()[t](!1)},fixed64:function(){return w.call(this)[t](!0)},sfixed64:function(){return w.call(this)[t](!1)}})}},{"./util/minimal":205}],200:[function(e,t,n){"use strict";t.exports=l;var r=e("./reader");(l.prototype=Object.create(r.prototype)).constructor=l;var o=e("./util/minimal");function l(e){r.call(this,e)}o.Buffer&&(l.prototype._slice=o.Buffer.prototype.slice),l.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},{"./reader":199,"./util/minimal":205}],201:[function(e,t,n){"use strict";t.exports={}},{}],202:[function(e,t,n){"use strict";n.Service=e("./rpc/service")},{"./rpc/service":203}],203:[function(e,t,n){"use strict";t.exports=o;var r=e("../util/minimal");function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,l,c){if(!l)throw TypeError("request must be specified");var f=this;if(!c)return r.asPromise(e,f,t,n,o,l);if(f.rpcImpl)try{return f.rpcImpl(t,n[f.requestDelimited?"encodeDelimited":"encode"](l).finish(),(function(e,n){if(e)return f.emit("error",e,t),c(e);if(null!==n){if(!(n instanceof o))try{n=o[f.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return f.emit("error",e,t),c(e)}return f.emit("data",n,t),c(null,n)}f.end(!0)}))}catch(e){return f.emit("error",e,t),void setTimeout((function(){c(e)}),0)}else setTimeout((function(){c(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{"../util/minimal":205}],204:[function(e,t,n){"use strict";t.exports=o;var r=e("../util/minimal");function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var l=o.zero=new o(0,0);l.toNumber=function(){return 0},l.zzEncode=l.zzDecode=function(){return this},l.length=function(){return 1};var c=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return l;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new o(n,r)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(r.isString(e)){if(!r.Long)return o.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):l},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var f=String.prototype.charCodeAt;o.fromHash=function(e){return e===c?l:new o((f.call(e,0)|f.call(e,1)<<8|f.call(e,2)<<16|f.call(e,3)<<24)>>>0,(f.call(e,4)|f.call(e,5)<<8|f.call(e,6)<<16|f.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var mask=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^mask)>>>0,this.lo=(this.lo<<1^mask)>>>0,this},o.prototype.zzDecode=function(){var mask=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^mask)>>>0,this.hi=(this.hi>>>1^mask)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},{"../util/minimal":205}],205:[function(e,t,n){(function(t){"use strict";var r=n;function o(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function l(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=e("@protobufjs/aspromise"),r.base64=e("@protobufjs/base64"),r.EventEmitter=e("@protobufjs/eventemitter"),r.float=e("@protobufjs/float"),r.inquire=e("@protobufjs/inquire"),r.utf8=e("@protobufjs/utf8"),r.pool=e("@protobufjs/pool"),r.LongBits=e("./longbits"),r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isNode=Boolean(t.process&&t.process.versions&&t.process.versions.node),r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=t.dcodeIO&&t.dcodeIO.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=o,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=l,r.ProtocolError=l("ProtocolError"),r.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},r.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./longbits":204,"@protobufjs/aspromise":1,"@protobufjs/base64":2,"@protobufjs/eventemitter":3,"@protobufjs/float":4,"@protobufjs/inquire":5,"@protobufjs/pool":6,"@protobufjs/utf8":7}],206:[function(e,t,n){"use strict";t.exports=y;var r,o=e("./util/minimal"),l=o.LongBits,c=o.base64,f=o.utf8;function h(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function d(){}function m(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function y(){this.len=0,this.head=new h(d,0,0),this.tail=this.head,this.states=null}function v(e,t,n){t[n]=255&e}function w(e,t){this.len=e,this.next=void 0,this.val=t}function x(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function _(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}y.create=o.Buffer?function(){return(y.create=function(){return new r})()}:function(){return new y},y.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(y.alloc=o.pool(y.alloc,o.Array.prototype.subarray)),y.prototype._push=function(e,t,n){return this.tail=this.tail.next=new h(e,t,n),this.len+=t,this},w.prototype=Object.create(h.prototype),w.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},y.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new w((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},y.prototype.int32=function(e){return e<0?this._push(x,10,l.fromNumber(e)):this.uint32(e)},y.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},y.prototype.uint64=function(e){var t=l.from(e);return this._push(x,t.length(),t)},y.prototype.int64=y.prototype.uint64,y.prototype.sint64=function(e){var t=l.from(e).zzEncode();return this._push(x,t.length(),t)},y.prototype.bool=function(e){return this._push(v,1,e?1:0)},y.prototype.fixed32=function(e){return this._push(_,4,e>>>0)},y.prototype.sfixed32=y.prototype.fixed32,y.prototype.fixed64=function(e){var t=l.from(e);return this._push(_,4,t.lo)._push(_,4,t.hi)},y.prototype.sfixed64=y.prototype.fixed64,y.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},y.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var N=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};y.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(v,1,0);if(o.isString(e)){var n=y.alloc(t=c.length(e));c.decode(e,n,0),e=n}return this.uint32(t)._push(N,t,e)},y.prototype.string=function(e){var t=f.length(e);return t?this.uint32(t)._push(f.write,t,e):this._push(v,1,0)},y.prototype.fork=function(){return this.states=new m(this),this.head=this.tail=new h(d,0,0),this.len=0,this},y.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new h(d,0,0),this.len=0),this},y.prototype.ldelim=function(){var head=this.head,e=this.tail,t=this.len;return this.reset().uint32(t),t&&(this.tail.next=head.next,this.tail=e,this.len+=t),this},y.prototype.finish=function(){for(var head=this.head.next,e=this.constructor.alloc(this.len),t=0;head;)head.fn(head.val,e,t),t+=head.len,head=head.next;return e},y._configure=function(e){r=e}},{"./util/minimal":205}],207:[function(e,t,n){"use strict";t.exports=c;var r=e("./writer");(c.prototype=Object.create(r.prototype)).constructor=c;var o=e("./util/minimal"),l=o.Buffer;function c(){r.call(this)}c.alloc=function(e){return(c.alloc=o._Buffer_allocUnsafe)(e)};var f=l&&l.prototype instanceof Uint8Array&&"set"===l.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]};function h(e,t,n){e.length<40?o.utf8.write(e,t,n):t.utf8Write(e,n)}c.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(f,t,e),this},c.prototype.string=function(e){var t=l.byteLength(e);return this.uint32(t),t&&this._push(h,t,e),this}},{"./util/minimal":205,"./writer":206}],208:[function(e,t,n){(function(e){!function(r){var o="object"==typeof n&&n&&!n.nodeType&&n,l="object"==typeof t&&t&&!t.nodeType&&t,c="object"==typeof e&&e;c.global!==c&&c.window!==c&&c.self!==c||(r=c);var f,h,d=2147483647,base=36,m=1,y=26,v=38,w=700,x=72,_=128,N="-",E=/^xn--/,A=/[^\x20-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=base-m,I=Math.floor,k=String.fromCharCode;function P(e){throw new RangeError(S[e])}function map(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function C(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+map((e=e.replace(O,".")).split("."),t).join(".")}function R(e){for(var t,n,output=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?output.push(((1023&t)<<10)+(1023&n)+65536):(output.push(t),r--):output.push(t);return output}function z(e){return map(e,(function(e){var output="";return e>65535&&(output+=k((e-=65536)>>>10&1023|55296),e=56320|1023&e),output+=k(e)})).join("")}function M(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function L(e,t,n){var r=0;for(e=n?I(e/w):e>>1,e+=I(e/t);e>T*y>>1;r+=base)e=I(e/T);return I(r+(T+1)*e/(e+v))}function D(input){var e,t,n,r,o,l,c,f,h,v,w,output=[],E=input.length,i=0,A=_,O=x;for((t=input.lastIndexOf(N))<0&&(t=0),n=0;n<t;++n)input.charCodeAt(n)>=128&&P("not-basic"),output.push(input.charCodeAt(n));for(r=t>0?t+1:0;r<E;){for(o=i,l=1,c=base;r>=E&&P("invalid-input"),((f=(w=input.charCodeAt(r++))-48<10?w-22:w-65<26?w-65:w-97<26?w-97:base)>=base||f>I((d-i)/l))&&P("overflow"),i+=f*l,!(f<(h=c<=O?m:c>=O+y?y:c-O));c+=base)l>I(d/(v=base-h))&&P("overflow"),l*=v;O=L(i-o,e=output.length+1,0==o),I(i/e)>d-A&&P("overflow"),A+=I(i/e),i%=e,output.splice(i++,0,A)}return z(output)}function V(input){var e,t,n,r,o,l,c,q,f,h,v,w,E,A,O,output=[];for(w=(input=R(input)).length,e=_,t=0,o=x,l=0;l<w;++l)(v=input[l])<128&&output.push(k(v));for(n=r=output.length,r&&output.push(N);n<w;){for(c=d,l=0;l<w;++l)(v=input[l])>=e&&v<c&&(c=v);for(c-e>I((d-t)/(E=n+1))&&P("overflow"),t+=(c-e)*E,e=c,l=0;l<w;++l)if((v=input[l])<e&&++t>d&&P("overflow"),v==e){for(q=t,f=base;!(q<(h=f<=o?m:f>=o+y?y:f-o));f+=base)O=q-h,A=base-h,output.push(k(M(h+O%A,0))),q=I(O/A);output.push(k(M(q,0))),o=L(t,E,n==r),t=0,++n}++t,++e}return output.join("")}if(f={version:"1.4.1",ucs2:{decode:R,encode:z},decode:D,encode:V,toASCII:function(input){return C(input,(function(e){return A.test(e)?"xn--"+V(e):e}))},toUnicode:function(input){return C(input,(function(e){return E.test(e)?D(e.slice(4).toLowerCase()):e}))}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",(function(){return f}));else if(o&&l)if(t.exports==o)l.exports=f;else for(h in f)f.hasOwnProperty(h)&&(o[h]=f[h]);else r.punycode=f}(this)}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],209:[function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,l){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var f=/\+/g;e=e.split(t);var h=1e3;l&&"number"==typeof l.maxKeys&&(h=l.maxKeys);var d=e.length;h>0&&d>h&&(d=h);for(var i=0;i<d;++i){var m,y,v,w,x=e[i].replace(f,"%20"),_=x.indexOf(n);_>=0?(m=x.substr(0,_),y=x.substr(_+1)):(m=x,y=""),v=decodeURIComponent(m),w=decodeURIComponent(y),r(c,v)?o(c[v])?c[v].push(w):c[v]=[c[v],w]:c[v]=w}return c};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],210:[function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?map(l(e),(function(l){var c=encodeURIComponent(r(l))+n;return o(e[l])?map(e[l],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[l]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function map(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var l=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],211:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":209,"./encode":210}],212:[function(e,t,n){var r=e("./lib/alea"),o=e("./lib/xor128"),l=e("./lib/xorwow"),c=e("./lib/xorshift7"),f=e("./lib/xor4096"),h=e("./lib/tychei"),d=e("./seedrandom");d.alea=r,d.xor128=o,d.xorwow=l,d.xorshift7=c,d.xor4096=f,d.tychei=h,t.exports=d},{"./lib/alea":213,"./lib/tychei":214,"./lib/xor128":215,"./lib/xor4096":216,"./lib/xorshift7":217,"./lib/xorwow":218,"./seedrandom":219}],213:[function(e,t,n){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(data){data=data.toString();for(var i=0;i<data.length;i++){var e=.02519603282416938*(t+=data.charCodeAt(i));e-=t=e>>>0,t=(e*=t)>>>0,t+=4294967296*(e-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var n=new r(e),l=t&&t.state,c=n.next;return c.int32=function(){return 4294967296*n.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&("object"==typeof l&&o(l,n),c.state=function(){return o(n,{})}),c}t&&t.exports?t.exports=l:n&&n.amd?n((function(){return l})):this.alea=l}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],214:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var b=t.b,e=t.c,n=t.d,a=t.a;return b=b<<25^b>>>7^e,e=e-n|0,n=n<<24^n>>>8^a,a=a-b|0,t.b=b=b<<20^b>>>12^e,t.c=e=e-n|0,t.d=n<<16^e>>>16^a,t.a=a-b|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var n=new r(e),l=t&&t.state,c=function(){return(n.next()>>>0)/4294967296};return c.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},c.int32=n.next,c.quick=c,l&&("object"==typeof l&&o(l,n),c.state=function(){return o(n,{})}),c}t&&t.exports?t.exports=l:n&&n.amd?n((function(){return l})):this.tychei=l}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],215:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var n=new r(e),l=t&&t.state,c=function(){return(n.next()>>>0)/4294967296};return c.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},c.int32=n.next,c.quick=c,l&&("object"==typeof l&&o(l,n),c.state=function(){return o(n,{})}),c}t&&t.exports?t.exports=l:n&&n.amd?n((function(){return l})):this.xor128=l}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],216:[function(e,t,n){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,l,c=[],f=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,f=Math.max(f,t.length)),i=0,o=-32;o<f;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(l=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(l=l+1640531527|0,i=0==(n=c[127&o]^=r+l)?i+1:0);for(i>=128&&(c[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=c[i+34&127],n=c[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,c[i]=r^n;e.w=l,e.X=c,e.i=i}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var n=new r(e),l=t&&t.state,c=function(){return(n.next()>>>0)/4294967296};return c.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},c.int32=n.next,c.quick=c,l&&(l.X&&o(l,n),c.state=function(){return o(n,{})}),c}t&&t.exports?t.exports=l:n&&n.amd?n((function(){return l})):this.xor4096=l}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],217:[function(e,t,n){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var n=new r(e),l=t&&t.state,c=function(){return(n.next()>>>0)/4294967296};return c.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},c.int32=n.next,c.quick=c,l&&(l.x&&o(l,n),c.state=function(){return o(n,{})}),c}t&&t.exports?t.exports=l:n&&n.amd?n((function(){return l})):this.xorshift7=l}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],218:[function(e,t,n){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var n=new r(e),l=t&&t.state,c=function(){return(n.next()>>>0)/4294967296};return c.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},c.int32=n.next,c.quick=c,l&&("object"==typeof l&&o(l,n),c.state=function(){return o(n,{})}),c}t&&t.exports?t.exports=l:n&&n.amd?n((function(){return l})):this.xorwow=l}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],219:[function(e,t,n){!function(n,r){var o,l=this,c=256,f=6,h="random",d=r.pow(c,f),m=r.pow(2,52),y=2*m,mask=c-1;function v(e,t,v){var E=[],A=_(function e(t,n){var r,o=[],l=typeof t;if(n&&"object"==l)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==l?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,N(n)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(c):(e=new Uint8Array(c),(l.crypto||l.msCrypto).getRandomValues(e)),N(e)}catch(e){var t=l.navigator,r=t&&t.plugins;return[+new Date,l,r,l.screen,N(n)]}}():e,3),E),O=new w(E),S=function(){for(var e=O.g(f),t=d,n=0;e<m;)e=(e+n)*c,t*=c,n=O.g(1);for(;e>=y;)e/=2,t/=2,n>>>=1;return(e+n)/t};return S.int32=function(){return 0|O.g(4)},S.quick=function(){return O.g(4)/4294967296},S.double=S,_(N(O.S),n),(t.pass||v||function(e,t,n,o){return o&&(o.S&&x(o,O),e.state=function(){return x(O,{})}),n?(r[h]=e,t):e})(S,A,"global"in t?t.global:this==r,t.state)}function w(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);i<c;)s[i]=i++;for(i=0;i<c;i++)s[i]=s[o=mask&o+e[i%n]+(t=s[i])],s[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,s=r.S;e--;)t=s[i=mask&i+1],n=n*c+s[mask&(s[i]=s[o=mask&o+t])+(s[o]=t)];return r.i=i,r.j=o,n})(c)}function x(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function _(e,t){for(var n,r=e+"",o=0;o<r.length;)t[mask&o]=mask&(n^=19*t[mask&o])+r.charCodeAt(o++);return N(t)}function N(a){return String.fromCharCode.apply(0,a)}if(r["seed"+h]=v,_(r.random(),n),"object"==typeof t&&t.exports){t.exports=v;try{o=e("crypto")}catch(e){}}else"function"==typeof define&&define.amd&&define((function(){return v}))}([],Math)},{crypto:195}],220:[function(e,t,n){"use strict";var r=e("punycode"),o=e("./util");function l(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=O,n.resolve=function(source,e){return O(source,!1,!0).resolve(e)},n.resolveObject=function(source,e){return source?O(source,!1,!0).resolveObject(e):e},n.format=function(e){return o.isString(e)&&(e=O(e)),e instanceof l?e.format():l.prototype.format.call(e)},n.Url=l;var c=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),m=["'"].concat(d),y=["%","/","?",";","#"].concat(m),v=["/","?","#"],w=/^[+a-z0-9A-Z_-]{0,63}$/,x=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},N={javascript:!0,"javascript:":!0},E={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=e("querystring");function O(e,t,n){if(e&&o.isObject(e)&&e instanceof l)return e;var u=new l;return u.parse(e,t,n),u}l.prototype.parse=function(e,t,n){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var l=e.indexOf("?"),f=-1!==l&&l<e.indexOf("#")?"?":"#",d=e.split(f);d[0]=d[0].replace(/\\/g,"/");var O=e=d.join(f);if(O=O.trim(),!n&&1===e.split("#").length){var S=h.exec(O);if(S)return this.path=O,this.href=O,this.pathname=S[1],S[2]?(this.search=S[2],this.query=t?A.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var T=c.exec(O);if(T){var I=(T=T[0]).toLowerCase();this.protocol=I,O=O.substr(T.length)}if(n||T||O.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===O.substr(0,2);!k||T&&N[T]||(O=O.substr(2),this.slashes=!0)}if(!N[T]&&(k||T&&!E[T])){for(var P,C,R=-1,i=0;i<v.length;i++)-1!==(z=O.indexOf(v[i]))&&(-1===R||z<R)&&(R=z);for(-1!==(C=-1===R?O.lastIndexOf("@"):O.lastIndexOf("@",R))&&(P=O.slice(0,C),O=O.slice(C+1),this.auth=decodeURIComponent(P)),R=-1,i=0;i<y.length;i++){var z;-1!==(z=O.indexOf(y[i]))&&(-1===R||z<R)&&(R=z)}-1===R&&(R=O.length),this.host=O.slice(0,R),O=O.slice(R),this.parseHost(),this.hostname=this.hostname||"";var M="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!M)for(var L=this.hostname.split(/\./),D=(i=0,L.length);i<D;i++){var V=L[i];if(V&&!V.match(w)){for(var j="",F=0,B=V.length;F<B;F++)V.charCodeAt(F)>127?j+="x":j+=V[F];if(!j.match(w)){var U=L.slice(0,i),G=L.slice(i+1),W=V.match(x);W&&(U.push(W[1]),G.unshift(W[2])),G.length&&(O="/"+G.join(".")+O),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),M||(this.hostname=r.toASCII(this.hostname));var p=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+p,this.href+=this.host,M&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==O[0]&&(O="/"+O))}if(!_[I])for(i=0,D=m.length;i<D;i++){var K=m[i];if(-1!==O.indexOf(K)){var X=encodeURIComponent(K);X===K&&(X=escape(K)),O=O.split(K).join(X)}}var Y=O.indexOf("#");-1!==Y&&(this.hash=O.substr(Y),O=O.slice(0,Y));var J=O.indexOf("?");if(-1!==J?(this.search=O.substr(J),this.query=O.substr(J+1),t&&(this.query=A.parse(this.query)),O=O.slice(0,J)):t&&(this.search="",this.query={}),O&&(this.pathname=O),E[I]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},l.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",l=!1,c="";this.host?l=e+this.host:this.hostname&&(l=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(l+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(c=A.stringify(this.query));var f=this.search||c&&"?"+c||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||E[t])&&!1!==l?(l="//"+(l||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):l||(l=""),r&&"#"!==r.charAt(0)&&(r="#"+r),f&&"?"!==f.charAt(0)&&(f="?"+f),t+l+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(f=f.replace("#","%23"))+r},l.prototype.resolve=function(e){return this.resolveObject(O(e,!1,!0)).format()},l.prototype.resolveObject=function(e){if(o.isString(e)){var t=new l;t.parse(e,!1,!0),e=t}for(var n=new l,r=Object.keys(this),c=0;c<r.length;c++){var f=r[c];n[f]=this[f]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var h=Object.keys(e),d=0;d<h.length;d++){var m=h[d];"protocol"!==m&&(n[m]=e[m])}return E[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!E[e.protocol]){for(var y=Object.keys(e),v=0;v<y.length;v++){var w=y[v];n[w]=e[w]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||N[e.protocol])n.pathname=e.pathname;else{for(var x=(e.pathname||"").split("/");x.length&&!(e.host=x.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==x[0]&&x.unshift(""),x.length<2&&x.unshift(""),n.pathname=x.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",s=n.search||"";n.path=p+s}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var _=n.pathname&&"/"===n.pathname.charAt(0),A=e.host||e.pathname&&"/"===e.pathname.charAt(0),O=A||_||n.host&&e.pathname,S=O,T=n.pathname&&n.pathname.split("/")||[],I=(x=e.pathname&&e.pathname.split("/")||[],n.protocol&&!E[n.protocol]);if(I&&(n.hostname="",n.port=null,n.host&&(""===T[0]?T[0]=n.host:T.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===x[0]?x[0]=e.host:x.unshift(e.host)),e.host=null),O=O&&(""===x[0]||""===T[0])),A)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,T=x;else if(x.length)T||(T=[]),T.pop(),T=T.concat(x),n.search=e.search,n.query=e.query;else if(!o.isNullOrUndefined(e.search))return I&&(n.hostname=n.host=T.shift(),(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift())),n.search=e.search,n.query=e.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!T.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=T.slice(-1)[0],P=(n.host||e.host||T.length>1)&&("."===k||".."===k)||""===k,C=0,i=T.length;i>=0;i--)"."===(k=T[i])?T.splice(i,1):".."===k?(T.splice(i,1),C++):C&&(T.splice(i,1),C--);if(!O&&!S)for(;C--;C)T.unshift("..");!O||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),P&&"/"!==T.join("/").substr(-1)&&T.push("");var R,z=""===T[0]||T[0]&&"/"===T[0].charAt(0);return I&&(n.hostname=n.host=z?"":T.length?T.shift():"",(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift())),(O=O||n.host&&T.length)&&!z&&T.unshift(""),T.length?n.pathname=T.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},l.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":221,punycode:208,querystring:211}],221:[function(e,t,n){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],222:[function(e,t,n){var r=e("./v1"),o=e("./v4"),l=o;l.v1=r,l.v4=o,t.exports=l},{"./v1":225,"./v4":226}],223:[function(e,t,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var i=t||0,n=r;return n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]}},{}],224:[function(e,t,n){var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var o=new Uint8Array(16);t.exports=function(){return r(o),o}}else{var l=new Array(16);t.exports=function(){for(var e,i=0;i<16;i++)0==(3&i)&&(e=4294967296*Math.random()),l[i]=e>>>((3&i)<<3)&255;return l}}},{}],225:[function(e,t,n){var r,o,l=e("./lib/rng"),c=e("./lib/bytesToUuid"),f=0,h=0;t.exports=function(e,t,n){var i=t&&n||0,b=t||[],d=(e=e||{}).node||r,m=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==m){var y=l();null==d&&(d=r=[1|y[0],y[1],y[2],y[3],y[4],y[5]]),null==m&&(m=o=16383&(y[6]<<8|y[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),w=void 0!==e.nsecs?e.nsecs:h+1,dt=v-f+(w-h)/1e4;if(dt<0&&void 0===e.clockseq&&(m=m+1&16383),(dt<0||v>f)&&void 0===e.nsecs&&(w=0),w>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=v,h=w,o=m;var x=(1e4*(268435455&(v+=122192928e5))+w)%4294967296;b[i++]=x>>>24&255,b[i++]=x>>>16&255,b[i++]=x>>>8&255,b[i++]=255&x;var _=v/4294967296*1e4&268435455;b[i++]=_>>>8&255,b[i++]=255&_,b[i++]=_>>>24&15|16,b[i++]=_>>>16&255,b[i++]=m>>>8|128,b[i++]=255&m;for(var N=0;N<6;++N)b[i+N]=d[N];return t||c(b)}},{"./lib/bytesToUuid":223,"./lib/rng":224}],226:[function(e,t,n){var r=e("./lib/rng"),o=e("./lib/bytesToUuid");t.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t)for(var c=0;c<16;++c)t[i+c]=l[c];return t||o(l)}},{"./lib/bytesToUuid":223,"./lib/rng":224}],227:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./reimprove/model");n.Model=r.Model,n.LayerType=r.LayerType;var o=e("./reimprove/academy");n.Academy=o.Academy;var l=e("./reimprove/networks");n.NeuralNetwork=l.NeuralNetwork,n.ConvolutionalNeuralNetwork=l.ConvolutionalNeuralNetwork;var c=e("@tensorflow/tfjs");n.setBackend=c.setBackend},{"./reimprove/academy":228,"./reimprove/model":233,"./reimprove/networks":234,"@tensorflow/tfjs":193}],228:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("./agent"),f=e("./teacher"),h=e("uuid"),d=e("./misc/learning_data_logger"),m={parentLogsElement:null,agentsLogs:!1,memoryLogs:!1},y=function(){function e(e){this.config=r({},m,e),this.agents=new Map,this.teachers=new Map,this.assigments=new Map,this.config.parentLogsElement&&this.createLogger(this.config.parentLogsElement)}return e.prototype.addAgent=function(e,t){var n=new c.Agent(e.model,e.agentConfig,t);return n.Name||(n.Name=h.v4()),this.agents.set(n.Name,n),n.Name},e.prototype.addTeacher=function(e,t){var n=new f.Teacher(e,t);return n.Name||(n.Name=h.v4()),this.teachers.set(n.Name,n),n.Name},e.prototype.assignTeacherToAgent=function(e,t){if(!this.agents.has(e))throw new Error("No such agent has been registered");if(!this.teachers.has(t))throw new Error("No such teacher has been registered");this.assigments.set(e,t),this.teachers.get(t).affectStudent(this.agents.get(e))},e.prototype.step=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,input;return l(this,(function(l){switch(l.label){case 0:t=new Map,n=e instanceof Array?e:[e],r=0,o=n,l.label=1;case 1:if(!(r<o.length))return[3,4];if(input=o[r],!this.teachers.has(input.teacherName))throw new Error("No teacher has name "+input.teacherName);return[4,this.teachers.get(input.teacherName).teach(input.agentsInput)];case 2:l.sent().forEach((function(e,n){if(t.has(n))throw new Error("Agent "+n+" has already registered an action.");t.set(n,e)})),l.label=3;case 3:return r++,[3,1];case 4:return this.logger&&this.logger.updateTables(!0),[2,t]}}))}))},e.prototype.addRewardToAgent=function(e,t){this.agents.has(e)&&this.agents.get(e).addReward(t)},e.prototype.setRewardOfAgent=function(e,t){this.agents.has(e)&&this.agents.get(e).setReward(t)},e.prototype.OnLearningLessonEnded=function(e,t){this.teachers.has(e)&&(this.teachers.get(e).onLearningLessonEnded=t)},e.prototype.OnLessonEnded=function(e,t){this.teachers.has(e)&&(this.teachers.get(e).onLessonEnded=t)},e.prototype.OnTeachingEnded=function(e,t){this.teachers.has(e)&&(this.teachers.get(e).onTeachingEnded=t)},e.prototype.resetTeachersAndAgents=function(){this.teachers.forEach((function(e){return e.reset()})),this.agents.forEach((function(a){return a.reset()}))},e.prototype.reset=function(){this.resetTeachersAndAgents(),this.teachers.clear(),this.agents.clear()},e.prototype.resetTeacherLesson=function(e){this.teachers.get(e).resetLesson()},Object.defineProperty(e.prototype,"Teachers",{get:function(){return Array.from(this.teachers.keys())},enumerable:!0,configurable:!0}),e.prototype.getTeacherData=function(e){return this.teachers.get(e).getData()},e.prototype.createLogger=function(e){this.logger&&this.logger.dispose(),this.config.parentLogsElement=e,this.logger=new d.LearningDataLogger(e,this)},e.prototype.toggleLogs=function(e){void 0===e&&(e=!1);var t=this.config.agentsLogs;this.config.agentsLogs=!t,t&&(this.config.memoryLogs=e)},e}();n.Academy=y},{"./agent":229,"./misc/learning_data_logger":231,"./teacher":235,uuid:222}],229:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("./memory"),f=e("@tensorflow/tfjs-core"),h=e("lodash"),d=e("./misc/typed_window"),m=2,y=100,v=0,w={memorySize:3e4,batchSize:32,temporalWindow:1},x=function(){function e(e,t,n){this.model=e,this.name=n,this.agentConfig=r({},w,t),this.done=!1,this.currentReward=0,this.lossesHistory=new d.TypedWindow(y,v,-1),this.rewardsHistory=new d.TypedWindow(y,v,null),this.memory=new c.Memory({size:this.agentConfig.memorySize}),this.netInputWindowSize=Math.max(this.agentConfig.temporalWindow,m),this.actionsBuffer=new Array(this.netInputWindowSize),this.inputsBuffer=new Array(this.netInputWindowSize),this.statesBuffer=new Array(this.netInputWindowSize),this.forwardPasses=0}return e.prototype.createNeuralNetInput=function(input){var e=this;return f.tidy((function(){for(var t=input.clone(),n=function(i){t=t.concat(e.statesBuffer[e.netInputWindowSize-1-i],1);var n=f.tensor([h.range(0,e.model.OutputSize).map((function(t){return t==e.actionsBuffer[e.netInputWindowSize-1-i]?1:0}))]);t=t.concat(n,1)},i=0;i<e.agentConfig.temporalWindow;++i)n(i);return t}))},e.prototype.policy=function(input){return this.model.predict(input).getAction()},e.prototype.forward=function(input,e,t){var n,r;void 0===t&&(t=!0),this.forwardPasses+=1;var o=f.tensor2d(input,[1,input.length]);if(this.forwardPasses>this.agentConfig.temporalWindow?(r=this.createNeuralNetInput(o),n=h.random(0,1,!0)<e?this.model.randomOutput():this.policy(r)):(n=this.model.randomOutput(),r=f.tensor([])),t){this.actionsBuffer.shift();var l=this.statesBuffer.shift();l&&l.dispose(),this.inputsBuffer.shift(),this.actionsBuffer.push(n),this.statesBuffer.push(o),this.inputsBuffer.push({tensor:r,references:0})}else o.dispose(),r.dispose();return n},e.prototype.memorize=function(){this.rewardsHistory.add(this.currentReward),this.forwardPasses<=this.agentConfig.temporalWindow+1||this.memory.remember({action:this.actionsBuffer[this.netInputWindowSize-m],reward:this.currentReward,state:this.inputsBuffer[this.netInputWindowSize-m],nextState:this.inputsBuffer[this.netInputWindowSize-1]})},e.prototype.createTrainingDataFromMemento=function(e,t){var n=this;return f.tidy((function(){var r=e.reward;n.done||(r=e.reward+t*n.model.predict(e.nextState.tensor).getHighestValue());var o=n.model.predict(e.state.tensor).getValue();return o[e.action]=r,{x:e.state.tensor.clone(),y:f.tensor2d(o,[1,n.model.OutputSize])}}))},e.prototype.listen=function(input,e){var t=this.forward(input,e,!0);return this.memorize(),this.setReward(0),t},e.prototype.learn=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o=this;return l(this,(function(l){switch(l.label){case 0:return t=this.memory.sample(this.agentConfig.batchSize).map((function(t){return o.createTrainingDataFromMemento(t,e)})).reduce((function(e,t){var n={x:e.x.concat(t.x),y:e.y.concat(t.y)};return e.x.dispose(),e.y.dispose(),t.x.dispose(),t.y.dispose(),n})),[4,this.model.fit(t.x,t.y)];case 1:return n=l.sent(),r=n.history.loss[0],this.lossesHistory.add(r),t.x.dispose(),t.y.dispose(),[2]}}))}))},e.prototype.addReward=function(e){this.currentReward+=e},e.prototype.setReward=function(e){this.currentReward=e},e.prototype.reset=function(){this.memory.reset(),this.inputsBuffer.forEach((function(i){return i.tensor.dispose()})),this.statesBuffer.forEach((function(s){return s.dispose()})),this.forwardPasses=0},Object.defineProperty(e.prototype,"Config",{get:function(){return this.agentConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),e.prototype.getTrackingInformation=function(){return{averageReward:this.rewardsHistory.mean(),averageLoss:this.lossesHistory.mean(),name:this.name}},e}();n.Agent=x},{"./memory":230,"./misc/typed_window":232,"@tensorflow/tfjs-core":50,lodash:196}],230:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("lodash"),o=function(){function e(e){this.config=e,this.memory=new Array(this.config.size),this.currentSize=0}return e.prototype.remember=function(t,n){if(void 0===n&&(n=!0),t.state.references+=1,t.nextState.references+=1,this.currentSize<this.config.size)this.memory[this.currentSize++]=t;else if(n){var o=r.random(0,this.memory.length-1);e.freeMemento(this.memory[o]),this.memory[o]=t}},e.prototype.sample=function(e,t){void 0===t&&(t=!0);var n=this.memory.slice(0,this.currentSize);return t?r.sampleSize(n,e):r.range(e).map((function(){return r.sample(n)}))},Object.defineProperty(e.prototype,"CurrentSize",{get:function(){return this.currentSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){return this.memory.length},enumerable:!0,configurable:!0}),e.freeMemento=function(e){e.nextState.references-=1,e.state.references-=1,e.nextState.references<=0&&e.nextState.tensor.dispose(),e.state.references<=0&&e.state.tensor.dispose()},e.prototype.reset=function(){this.memory.forEach((function(e){e.state.tensor.dispose(),e.nextState.tensor.dispose()})),this.memory=new Array(this.config.size),this.currentSize=0},e.prototype.merge=function(e){var t=this;e.memory.forEach((function(e){return t.remember(e)}))},e}();n.Memory=o},{lodash:196}],231:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("@tensorflow/tfjs-core"),o=function(){function e(element,e){var t=this;this.academy=e,this.parent="string"==typeof element?document.getElementById(element):element,this.tables=[],this.academy.Teachers.forEach((function(e){return t.createTeacherTable(e)})),this.tables.forEach((function(e){return t.parent.appendChild(e.table)})),this.createMemoryTable(),this.parent.appendChild(this.memory)}return e.prototype.createMemoryTable=function(){this.memory=document.createElement("table");var thead=this.memory.createTHead(),tbody=this.memory.createTBody(),t=thead.insertRow(0);t.insertCell(0).innerHTML="Bytes allocated (undisposed)",t.insertCell(1).innerHTML="Unique tensors allocated",t.insertCell(2).innerHTML="Data buffers allocated",t.insertCell(3).innerHTML="Unreliable";var n=tbody.insertRow(0);n.insertCell(0).innerHTML="",n.insertCell(1).innerHTML="",n.insertCell(2).innerHTML="",n.insertCell(3).innerHTML="",e.tableStyle(this.memory)},e.prototype.createTeacherTable=function(t){var table=document.createElement("table"),thead=table.createTHead(),tbody=table.createTBody(),n=thead.insertRow(0);n.insertCell(0).innerHTML="Name",n.insertCell(1).innerHTML="Q loss average",n.insertCell(2).innerHTML="Average reward",n.insertCell(3).innerHTML="Epsilon",n.insertCell(4).innerHTML="Lesson number";for(var r=this.academy.getTeacherData(t).students.length,i=0;i<r;++i){var o=tbody.insertRow(i);o.insertCell(0).innerHTML="",o.insertCell(1).innerHTML="",o.insertCell(2).innerHTML="",o.insertCell(3).innerHTML="",o.insertCell(4).innerHTML=""}e.tableStyle(table),this.tables.push({teacherName:t,table:table})},e.prototype.updateTables=function(e){var t=this;if(void 0===e&&(e=!1),this.tables.forEach((function(table){var e=t.academy.getTeacherData(table.teacherName);e.students.forEach((function(data,t){table.table.tBodies.item(0).rows.item(t).cells.item(0).innerHTML=data.name,table.table.tBodies.item(0).rows.item(t).cells.item(1).innerHTML=data.averageLoss.toString().substr(0,5),table.table.tBodies.item(0).rows.item(t).cells.item(2).innerHTML=data.averageReward.toString().substr(0,5),table.table.tBodies.item(0).rows.item(t).cells.item(3).innerHTML=e.epsilon.toString().substr(0,5),table.table.tBodies.item(0).rows.item(t).cells.item(4).innerHTML=e.lessonNumber.toString()}))})),e){var n=r.memory();this.memory.tBodies.item(0).rows.item(0).cells.item(0).innerHTML=n.numBytes.toString(),this.memory.tBodies.item(0).rows.item(0).cells.item(1).innerHTML=n.numTensors.toString(),this.memory.tBodies.item(0).rows.item(0).cells.item(2).innerHTML=n.numDataBuffers.toString(),this.memory.tBodies.item(0).rows.item(0).cells.item(3).innerHTML=n.unreliable.toString()}},e.prototype.dispose=function(){var e=this;this.tables.forEach((function(table){e.parent.removeChild(table.table)}))},e.tableStyle=function(table){table.style.border="medium solid #6495ed",table.style.borderCollapse="collapse",table.tHead.style.fontFamily="monospace",table.tHead.style.border="thin solid #6495ed",table.tHead.style.padding="5px",table.tHead.style.backgroundColor="#d0e3fa",table.tHead.style.textAlign="center",table.tHead.style.margin="8px";for(var i=0;i<table.tBodies.length;++i){var e=table.tBodies.item(i);e.style.fontFamily="sans-serif",e.style.border="thin solid #6495ed",e.style.padding="5px",e.style.textAlign="center",e.style.backgroundColor="#ffffff",e.style.margin="3px"}},e}();n.LearningDataLogger=o},{"@tensorflow/tfjs-core":50}],232:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("lodash"),o=function(){function e(e,t,n){this.size=e,this.minSize=t,this.nullValue=n,this.window=[]}return e.prototype.add=function(e){e!=this.nullValue&&(this.window.push(e),this.window.length>this.size&&this.window.shift())},e.prototype.mean=function(){return this.window.length<this.minSize?-1:r.mean(this.window)},Object.defineProperty(e.prototype,"Window",{get:function(){return this.window},enumerable:!0,configurable:!0}),e}();n.TypedWindow=o},{lodash:196}],233:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var h,d=c(e("@tensorflow/tfjs-layers")),m=e("@tensorflow/tfjs-core"),y=e("lodash"),v=f(e("uuid/v4")),w={epochs:10,stepsPerEpoch:200};!function(e){e.DENSE="DENSE",e.CONV2D="CONV2D",e.FLATTEN="FLATTEN"}(h=n.LayerType||(n.LayerType={}));var x={units:32,activation:"relu",useBias:!1},_=function(){function e(e,t){this.model=new d.Sequential(e),this.fitConfig=r({},w,t)}return e.prototype.loadFromFile=function(e){return o(this,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return t=this,[4,d.loadModel(e)];case 1:return t.model=n.sent(),[2]}}))}))},e.prototype.addLayer=function(e,t){if(!(this.model instanceof d.Sequential))throw new Error("Unable to add a layer to an already created model managed by tensorflowjs");var n=x;switch(t.inputShape&&(n.inputShape=t.inputShape),e){case h.DENSE:n.units=t.units,n.activation=t.activation,this.model.add(d.layers.dense(n));break;case h.CONV2D:n.filters=t.units,n.activation=t.activation,n.useBias=t.useBias,this.model.add(d.layers.conv2d(n));break;case h.FLATTEN:n={},this.model.add(d.layers.flatten(n))}},e.prototype.compile=function(e){return this.model.compile(e),this},e.prototype.predict=function(e,t){return new N(this.model.predict(e,t))},e.prototype.fit=function(e,t){return this.model.fit(e,t,this.fitConfig)},e.prototype.randomOutput=function(){return y.random(0,this.OutputSize)},Object.defineProperty(e.prototype,"OutputSize",{get:function(){return this.model.getOutputAt(0).shape[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InputSize",{get:function(){return this.model.layers[0].batchInputShape[1]},enumerable:!0,configurable:!0}),e.FromNetwork=function(t,n,r){return void 0===r&&(r=v.default()),new e({name:r,layers:t.createLayers()},n)},e}();n.Model=_;var N=function(){function e(e){this.result=e}return e.prototype.getResultAndDispose=function(e){return this.result.dispose(),e.dataSync()},e.prototype.getHighestValue=function(){var e=this;return m.tidy((function(){return e.getResultAndDispose(e.result.as1D().max())[0]}))},e.prototype.getAction=function(){var e=this;return m.tidy((function(){return e.getResultAndDispose(e.result.as1D().argMax())[0]}))},e.prototype.getValue=function(){var e=this.result.as1D(),t=e.dataSync();return e.dispose(),this.result.dispose(),t},e}();n.Result=N},{"@tensorflow/tfjs-core":50,"@tensorflow/tfjs-layers":167,lodash:196,"uuid/v4":226}],234:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e};Object.defineProperty(n,"__esModule",{value:!0});var c=e("@tensorflow/tfjs"),f=function(){function e(){this.neuralNetworkLayers=[],this.inputShape=[0]}return e.prototype.addNeuralNetworkLayer=function(t){"number"==typeof t?this.neuralNetworkLayers.push({units:t,activation:e.DEFAULT_LAYER.activation,type:"dense"}):this.neuralNetworkLayers.push(l({},e.DEFAULT_LAYER,t))},e.prototype.addNeuralNetworkLayers=function(e){var t=this;e.forEach((function(e){return t.addNeuralNetworkLayer(e)}))},Object.defineProperty(e.prototype,"InputShape",{set:function(e){this.inputShape=e},enumerable:!0,configurable:!0}),e.prototype.createLayers=function(e){void 0===e&&(e=!0);var t=[];e&&(this.neuralNetworkLayers[0].inputShape=this.inputShape);for(var n=0,r=this.neuralNetworkLayers;n<r.length;n++){var o=r[n];t.push("dense"==o.type?c.layers.dense(o):c.layers.dropout(o))}return t},e.prototype.getLayers=function(){return this.neuralNetworkLayers},e.DEFAULT_LAYER={units:32,activation:"relu",type:"dense"},e}();n.NeuralNetwork=f;var h=function(e){function t(){var t=e.call(this)||this;return t.convolutionalLayers=[],t.flattenLayer={type:"flatten"},t}return o(t,e),t.prototype.addMaxPooling2DLayer=function(e){this.convolutionalLayers.push(l({},t.DEFAULT_POOLING_LAYER,e))},t.prototype.addConvolutionalLayer=function(e){"number"==typeof e?this.convolutionalLayers.push({filters:e,activation:t.DEFAULT_CONV_LAYER.activation,type:"convolutional",kernelSize:t.DEFAULT_CONV_LAYER.kernelSize}):this.convolutionalLayers.push(l({},t.DEFAULT_CONV_LAYER,e))},t.prototype.addConvolutionalLayers=function(e){var t=this;e.forEach((function(e){return t.addConvolutionalLayer(e)}))},t.prototype.createLayers=function(t){void 0===t&&(t=!0);var n=[];this.convolutionalLayers[0].inputShape=this.inputShape;for(var r=0,o=this.convolutionalLayers;r<o.length;r++){var l=o[r];n.push("convolutional"==l.type?c.layers.conv2d(l):c.layers.maxPooling2d(l))}return n.push(c.layers.flatten(this.flattenLayer)),n.concat(e.prototype.createLayers.call(this,!1))},Object.defineProperty(t.prototype,"FlattenLayer",{set:function(e){this.flattenLayer=e},enumerable:!0,configurable:!0}),t.prototype.getLayers=function(){return this.convolutionalLayers.concat(this.flattenLayer,e.prototype.getLayers.call(this))},t.DEFAULT_CONV_LAYER={filters:32,kernelSize:3,activation:"relu",type:"convolutional"},t.DEFAULT_POOLING_LAYER={poolSize:2,strides:null,type:"maxpooling"},t}(f);n.ConvolutionalNeuralNetwork=h},{"@tensorflow/tfjs":193}],235:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{h(r.next(e))}catch(e){l(e)}}function f(e){try{h(r.throw(e))}catch(e){l(e)}}function h(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(c,f)}h((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=n[2&l[0]?"return":l[0]?"throw":"next"])&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[0,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(n,"__esModule",{value:!0});var c,f={lessonLength:1e3,lessonsQuantity:30,lessonsWithRandom:2,epsilon:1,epsilonMin:.05,epsilonDecay:.95,gamma:.9};!function(e){e[e.EXPERIENCING=0]="EXPERIENCING",e[e.LEARNING=1]="LEARNING",e[e.TESTING=2]="TESTING",e[e.NONE=-1]="NONE",e[e.STOPPED=-2]="STOPPED"}(c=n.TeachingState||(n.TeachingState={}));var h=function(){function e(e,t){this.config=r({},f,e),this.agents=new Set,this.currentLessonLength=0,this.lessonsTaught=0,this.state=c.NONE,this.currentEpsilon=this.config.epsilon,this.onLessonEnded=null,this.onLearningLessonEnded=null,this.onTeachingEnded=null,this.name=t}return e.prototype.affectStudent=function(e){this.agents.add(e)},e.prototype.removeStudent=function(e){return this.agents.delete(e)},e.prototype.start=function(){this.lessonsTaught=0,this.currentLessonLength=0,this.state=c.EXPERIENCING},e.prototype.teach=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o=this;return l(this,(function(l){switch(l.label){case 0:return this.state==c.STOPPED?[2,null]:(this.state==c.NONE&&this.start(),t=new Map,this.state==c.TESTING?(this.agents.forEach((function(a){return t.set(a.Name,a.forward(e,o.currentEpsilon,!1))})),[2,t]):(this.currentLessonLength+=1,this.currentLessonLength>=this.config.lessonLength&&(this.state=c.LEARNING),this.state!=c.EXPERIENCING?[3,1]:(this.agents.forEach((function(a){return t.set(a.Name,a.listen(e,o.currentEpsilon))})),[3,6])));case 1:if(this.state!=c.LEARNING)return[3,6];this.onLessonEnded&&this.onLessonEnded(this.name,this.lessonsTaught),n=0,r=Array.from(this.agents.keys()),l.label=2;case 2:return n<r.length?[4,r[n].learn(this.config.gamma)]:[3,5];case 3:l.sent(),l.label=4;case 4:return n++,[3,2];case 5:this.updateParameters(),this.lessonsTaught+=1,this.currentLessonLength=0,this.lessonsTaught>=this.config.lessonsQuantity?(this.state=c.TESTING,this.onTeachingEnded&&this.onTeachingEnded(this.name)):this.state=c.EXPERIENCING,this.agents.forEach((function(a){return t.set(a.Name,a.listen(e,o.currentEpsilon))})),this.onLearningLessonEnded&&this.onLearningLessonEnded(this.name),l.label=6;case 6:return[2,t]}}))}))},e.prototype.updateParameters=function(){this.lessonsTaught>this.config.lessonsWithRandom&&this.currentEpsilon>this.config.epsilonMin&&(this.currentEpsilon*=this.config.epsilonDecay,this.currentEpsilon<this.config.epsilonMin&&(this.currentEpsilon=this.config.epsilonMin))},e.prototype.getData=function(){var data=[];return this.agents.forEach((function(e){return data.push(e.getTrackingInformation())})),{epsilon:this.currentEpsilon,gamma:this.config.gamma,lessonNumber:this.lessonsTaught,currentLessonLength:this.currentLessonLength,maxLessons:this.config.lessonsQuantity,name:this.name,students:data}},e.prototype.resetLesson=function(){this.currentLessonLength=0,this.state=c.EXPERIENCING},e.prototype.reset=function(){this.lessonsTaught=0,this.currentLessonLength=0,this.state=c.NONE},e.prototype.stop=function(){this.state=c.STOPPED},Object.defineProperty(e.prototype,"OnLearningLessonEnded",{set:function(e){this.onLearningLessonEnded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OnLessonEnded",{set:function(e){this.onLessonEnded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OnTeachingEnded",{set:function(e){this.onTeachingEnded=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"State",{get:function(){return this.state},enumerable:!0,configurable:!0}),e}();n.Teacher=h},{}]},{},[227])(227)},module.exports=f()}).call(this,__webpack_require__(31))}}]);