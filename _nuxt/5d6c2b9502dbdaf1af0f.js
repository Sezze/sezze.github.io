(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{252:function(e,t,r){var content=r(265);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(30).default)("0d29ddce",content,!0,{sourceMap:!1})},260:function(e,t,r){var n=r(13),c=r(261)(!0);n(n.S,"Object",{entries:function(e){return c(e)}})},261:function(e,t,r){var n=r(19),c=r(45),o=r(41),l=r(61).f;e.exports=function(e){return function(t){for(var r,h=o(t),v=c(h),d=v.length,i=0,m=[];d>i;)r=v[i++],n&&!l.call(h,r)||m.push(e?[r,h[r]]:h[r]);return m}}},262:function(e,t,r){"use strict";var n=r(13),c=r(263),o=r(158),l=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*l,"String",{padStart:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},263:function(e,t,r){var n=r(32),c=r(159),o=r(33);e.exports=function(e,t,r,l){var h=String(o(e)),v=h.length,d=void 0===r?" ":String(r),m=n(t);if(m<=v||""==d)return h;var f=m-v,_=c.call(d,Math.ceil(f/d.length));return _.length>f&&(_=_.slice(0,f)),l?_+h:h+_}},264:function(e,t,r){"use strict";var n=r(252);r.n(n).a},265:function(e,t,r){(e.exports=r(29)(!1)).push([e.i,"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}.spinning{-webkit-animation:spin .75s infinite;animation:spin .75s infinite}",""])},287:function(e,t,r){"use strict";r.r(t);var n,c=r(58),o=(r(2),r(260),r(62),r(18)),l=(r(34),r(35),r(1),r(262),{data:function(){return{fetchError:null,activeVehicleKey:null,vehicles:{},currentTime:new Date,updateTimeInterval:null,isSyncing:!1}},layout:"experiment",computed:{app:function(){return this.$store.experiments.foli},activeVehicle:function(){return this.vehicles.hasOwnProperty(this.activeVehicleKey)?this.vehicles[this.activeVehicleKey]:null},activeVehicleProgress:function(){if(!this.activeVehicle)return 0;var progress=(this.currentTime-this.departureTime)/(this.aimedArrival-this.departureTime)*100;return Math.max(Math.min(progress,100),0)},aimedArrival:function(){return this.activeVehicle&&this.activeVehicle.destinationaimedarrivaltime?new Date(1e3*this.activeVehicle.destinationaimedarrivaltime):new Date},departureTime:function(){return this.activeVehicle&&this.activeVehicle.originaimeddeparturetime?new Date(1e3*this.activeVehicle.originaimeddeparturetime):new Date},formattedAimedArrival:function(){return"".concat(this.aimedArrival.getHours().toString().padStart(2,"0"),":").concat(this.aimedArrival.getMinutes().toString().padStart(2,"0"))},formattedDepartureTime:function(){return"".concat(this.departureTime.getHours().toString().padStart(2,"0"),":").concat(this.departureTime.getMinutes().toString().padStart(2,"0"))}},mounted:function(){var e=this;this.fetchVehicles(),this.updateTimeInterval=setInterval((function(){e.currentTime=new Date}),1e3)},destroyed:function(){clearInterval(this.updateTimeInterval)},methods:{fetchVehicles:(n=Object(o.a)(regeneratorRuntime.mark((function e(){var t,r,n,o,l,h,v,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isSyncing=!0,e.next=4,fetch("https://data.foli.fi/siri/vm");case 4:return t=e.sent,e.next=7,t.json();case 7:for(r=e.sent.result,n=r.vehicles,o={},l=0,h=Object.entries(n);l<h.length;l++)v=Object(c.a)(h[l],2),d=v[0],(m=v[1]).monitored&&(o[d]=m);this.vehicles=o,this.isSyncing=!1,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.fetchError=e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return n.apply(this,arguments)})}}),h=(r(264),r(10)),component=Object(h.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-alert",{attrs:{variant:"danger",show:e.fetchError}},[e._v("\n    "+e._s(e.fetchError)+"\n  ")]),e._v(" "),r("b-row",[r("b-col",{staticStyle:{},attrs:{cols:"12",md:"6"}},[r("client-only",[r("GmapMap",{staticStyle:{width:"100%",height:"360px"},attrs:{center:{lat:60.45148,lng:22.26869},zoom:11,"map-type-id":"terrain"}},e._l(e.vehicles,(function(t,n){return r("GmapMarker",{key:n,attrs:{position:{lat:t.latitude,lng:t.longitude},clickable:!0},on:{click:function(t){e.activeVehicleKey=n}}})})),1)],1)],1),e._v(" "),r("b-col",{attrs:{cols:"12",md:"6"}},[r("div",{staticClass:"text-secondary"},[r("p",[r("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.fetchVehicles(t)}}},[r("Icon",{class:{spinning:e.isSyncing},attrs:{icon:"sync-alt"}}),e._v("\n            Update\n          ")],1)]),e._v(" "),r("p",[e._v("\n          Displaying "+e._s(Object.keys(e.vehicles).length)+" vehicles, click on any\n          vehicle for more information.\n        ")])]),e._v(" "),e.activeVehicle?r("div",[r("h3",[r("Icon",{attrs:{icon:"bus"}}),e._v(" Buss line\n          "+e._s(e.activeVehicle.publishedlinename)+"\n        ")],1),e._v(" "),r("b-progress",{staticStyle:{"margin-bottom":".5rem"}},[r("b-progress-bar",{attrs:{value:e.activeVehicleProgress,label:Math.round(e.activeVehicleProgress)+"%"}})],1),e._v(" "),r("h4",[r("Icon",{attrs:{icon:"map-marker-alt"}}),e._v("\n          "+e._s(e.activeVehicle.originname)+"\n          â€“\n          "+e._s(e.activeVehicle.destinationname)+"\n        ")],1),e._v(" "),r("ul",{staticStyle:{padding:"0","list-style-type":"none"}},[r("li",[e._v("Next stop: "+e._s(e.activeVehicle.next_stoppointname))]),e._v(" "),r("li",[e._v("Departure: "+e._s(e.formattedDepartureTime))]),e._v(" "),r("li",[e._v("Aimed arrival: "+e._s(e.formattedAimedArrival))])])],1):e._e()])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);