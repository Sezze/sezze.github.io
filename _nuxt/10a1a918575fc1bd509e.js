(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{252:function(e,t,n){var content=n(269);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(30).default)("0d29ddce",content,!0,{sourceMap:!1})},263:function(e,t,n){var r=n(13),c=n(264)(!0);r(r.S,"Object",{entries:function(e){return c(e)}})},264:function(e,t,n){var r=n(20),c=n(45),o=n(42),l=n(67).f;e.exports=function(e){return function(t){for(var n,h=o(t),v=c(h),d=v.length,i=0,m=[];d>i;)n=v[i++],r&&!l.call(h,n)||m.push(e?[n,h[n]]:h[n]);return m}}},265:function(e,t,n){"use strict";var r=n(13),c=n(266),o=n(166),l=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*l,"String",{padStart:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},266:function(e,t,n){var r=n(32),c=n(167),o=n(35);e.exports=function(e,t,n,l){var h=String(o(e)),v=h.length,d=void 0===n?" ":String(n),m=r(t);if(m<=v||""==d)return h;var f=m-v,A=c.call(d,Math.ceil(f/d.length));return A.length>f&&(A=A.slice(0,f)),l?A+h:h+A}},267:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wCDAADQVNkqAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wsRDyIdDJmvowAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAKdSURBVEjHrZW7ixNRFMZ/80zcRzYJ2U1SWBixUFmxE2QbK0GxFPEPWLBQC4utRFGsLKxtxErExm5hrdZKsBKEWLiwu/jcbJ6bjXGSmclYeG6Yjcnsw71w4M69c7/vnm/OfEcjemgj5gDBiPlIgMF1XcKQUM8APQlfQj0HuxFoAhYDJoEpIAkkY8bpzLiWnQT4FZS2O36xAjQktoBtoCOEwSgJTCADnDo6eePyRKxw3jQTBSA1IoO65zVXW53Vd1+3ny4Cn4AK4CmSMIEBpHNj165PJy7cBabZ3yiXm8uPNtqvXgI1yaR/IyXNTCYxd/MA4ADTcnZGsDREEkUQA3IaVlKdcNxSVIH0j8atrMysJJADviiZzPDtC6mFefmwAKTPzu7p6u3ipppOFVIL86v1x+tCEiiJTCA/HitcBezIAo4udlsw8kqd8DeI7xM2iq6PpYc2XA5v9LEUgQeUfb/9Qer7oKMnGGXBxAh5iVtuv1nLTly6CNoYgJG0CegRBBHh9fCqjsKvFTdv3wGKwG9VRYrA+cuse/0yXanvMwHdk9s7qr71AUf0D0H/HV40SBD0N7MOQaq9K1qQakPWGY4R+pP/8XVLy9Drufh0IgnMXgpds3BpDe0N5gC4I5aLu9Hamx5bHfytTlged1gGSv9qrfX+RXri3C3pBwS4Tderr+nY3R31SNe2zNQxDSshS62W83kRqIabj7njDDS+t56/njpy8ophJGYBOt3Kx5Xag3vAZqgIDGDmRPr+w7idnwPw/eb6WuPJs7BVD5OoC/xwvOrbcSNxHPAct7QkjaQR+gl1oOK4paW4nT8DmI5XXQa+CUYQ1TJt8fScAP6ULjVoJZZ0v7wQbkiWkQTh5mOGbMQf0hj2+l6kK2r/+94fDskQxBtOHAwAAAAASUVORK5CYII="},268:function(e,t,n){"use strict";var r=n(252);n.n(r).a},269:function(e,t,n){(e.exports=n(29)(!1)).push([e.i,"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}.spinning{-webkit-animation:spin .75s infinite;animation:spin .75s infinite}",""])},299:function(e,t,n){"use strict";n.r(t);var r,c=n(58),o=(n(2),n(263),n(62),n(18)),l=(n(33),n(34),n(1),n(265),{data:function(){return{fetchError:null,activeVehicleKey:null,vehicles:{},currentTime:new Date,updateTimeInterval:null,isSyncing:!1,busIcon:n(267)}},layout:"experiment",computed:{app:function(){return this.$store.experiments.foli},activeVehicle:function(){return this.vehicles.hasOwnProperty(this.activeVehicleKey)?this.vehicles[this.activeVehicleKey]:null},activeVehicleProgress:function(){if(!this.activeVehicle)return 0;var progress=(this.currentTime-this.departureTime)/(this.aimedArrival-this.departureTime)*100;return Math.max(Math.min(progress,100),0)},aimedArrival:function(){return this.activeVehicle&&this.activeVehicle.destinationaimedarrivaltime?new Date(1e3*this.activeVehicle.destinationaimedarrivaltime):new Date},departureTime:function(){return this.activeVehicle&&this.activeVehicle.originaimeddeparturetime?new Date(1e3*this.activeVehicle.originaimeddeparturetime):new Date},formattedAimedArrival:function(){return"".concat(this.aimedArrival.getHours().toString().padStart(2,"0"),":").concat(this.aimedArrival.getMinutes().toString().padStart(2,"0"))},formattedDepartureTime:function(){return"".concat(this.departureTime.getHours().toString().padStart(2,"0"),":").concat(this.departureTime.getMinutes().toString().padStart(2,"0"))}},mounted:function(){var e=this;this.fetchVehicles(),this.updateTimeInterval=setInterval((function(){e.currentTime=new Date}),1e3)},destroyed:function(){clearInterval(this.updateTimeInterval)},methods:{fetchVehicles:(r=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,l,h,v,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isSyncing=!0,e.next=4,fetch("https://data.foli.fi/siri/vm");case 4:return t=e.sent,e.next=7,t.json();case 7:for(n=e.sent.result,r=n.vehicles,o={},l=0,h=Object.entries(r);l<h.length;l++)v=Object(c.a)(h[l],2),d=v[0],(m=v[1]).monitored&&(o[d]=m);this.vehicles=o,this.isSyncing=!1,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.fetchError=e.t0;case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return r.apply(this,arguments)})}}),h=(n(268),n(10)),component=Object(h.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-alert",{attrs:{variant:"danger",show:e.fetchError}},[e._v("\n    "+e._s(e.fetchError)+"\n  ")]),e._v(" "),n("b-row",[n("b-col",{staticStyle:{},attrs:{cols:"12",md:"6"}},[n("client-only",[n("GmapMap",{staticStyle:{width:"100%",height:"360px"},attrs:{center:{lat:60.45148,lng:22.26869},zoom:11,"map-type-id":"terrain"}},e._l(e.vehicles,(function(t,r){return n("GmapMarker",{key:r,attrs:{position:{lat:t.latitude,lng:t.longitude},clickable:!0,icon:e.busIcon},on:{click:function(t){e.activeVehicleKey=r}}})})),1)],1)],1),e._v(" "),n("b-col",{attrs:{cols:"12",md:"6"}},[n("div",{staticClass:"text-secondary"},[n("p",[n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.fetchVehicles(t)}}},[n("Icon",{class:{spinning:e.isSyncing},attrs:{icon:"sync-alt"}}),e._v("\n            Update\n          ")],1)]),e._v(" "),n("p",[e._v("\n          Displaying "+e._s(Object.keys(e.vehicles).length)+" vehicles, click on any\n          vehicle for more information.\n        ")])]),e._v(" "),e.activeVehicle?n("div",[n("h3",[n("Icon",{attrs:{icon:"bus"}}),e._v(" Buss line\n          "+e._s(e.activeVehicle.publishedlinename)+"\n        ")],1),e._v(" "),n("b-progress",{staticStyle:{"margin-bottom":".5rem"}},[n("b-progress-bar",{attrs:{value:e.activeVehicleProgress,label:Math.round(e.activeVehicleProgress)+"%"}})],1),e._v(" "),n("h4",[n("Icon",{attrs:{icon:"map-marker-alt"}}),e._v("\n          "+e._s(e.activeVehicle.originname)+"\n          â€“\n          "+e._s(e.activeVehicle.destinationname)+"\n        ")],1),e._v(" "),n("ul",{staticStyle:{padding:"0","list-style-type":"none"}},[n("li",[e._v("Next stop: "+e._s(e.activeVehicle.next_stoppointname))]),e._v(" "),n("li",[e._v("Departure: "+e._s(e.formattedDepartureTime))]),e._v(" "),n("li",[e._v("Aimed arrival: "+e._s(e.formattedAimedArrival))])])],1):e._e()])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);